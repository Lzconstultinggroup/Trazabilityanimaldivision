/*! For license information please see main.e784f912.js.LICENSE.txt */
(()=>{"use strict";var t={43:(t,e,i)=>{t.exports=i(202)},153:(t,e,i)=>{var n=i(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,i){var n,s={},c=null,u=null;for(n in void 0!==i&&(c=""+i),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)a.call(e,n)&&!l.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===s[n]&&(s[n]=e[n]);return{$$typeof:r,type:t,key:c,ref:u,props:s,_owner:o.current}}e.Fragment=s,e.jsx=c,e.jsxs=c},202:(t,e)=>{var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(t,e,i){this.props=t,this.context=e,this.refs=m,this.updater=i||p}function y(){}function b(t,e,i){this.props=t,this.context=e,this.refs=m,this.updater=i||p}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var S=b.prototype=new y;S.constructor=b,g(S,v.prototype),S.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,E={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,n){var r,s={},a=null,o=null;if(null!=e)for(r in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(a=""+e.key),e)x.call(e,r)&&!L.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(1===l)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:i,type:t,key:a,ref:o,props:s,_owner:E.current}}function A(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var _=/\/+/g;function k(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function P(t,e,r,s,a){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l=!1;if(null===t)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case i:case n:l=!0}}if(l)return a=a(l=t),t=""===s?"."+k(l,0):s,w(a)?(r="",null!=t&&(r=t.replace(_,"$&/")+"/"),P(a,e,r,"",(function(t){return t}))):null!=a&&(A(a)&&(a=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(_,"$&/")+"/")+t)),e.push(a)),1;if(l=0,s=""===s?".":s+":",w(t))for(var c=0;c<t.length;c++){var u=s+k(o=t[c],c);l+=P(o,e,r,u,a)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),c=0;!(o=t.next()).done;)l+=P(o=o.value,e,r,u=s+k(o,c++),a);else if("object"===o)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function R(t,e,i){if(null==t)return t;var n=[],r=0;return P(t,n,"","",(function(t){return e.call(i,t,r++)})),n}function I(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var C={current:null},D={transition:null},N={ReactCurrentDispatcher:C,ReactCurrentBatchConfig:D,ReactCurrentOwner:E};function O(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:R,forEach:function(t,e,i){R(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return R(t,(function(){e++})),e},toArray:function(t){return R(t,(function(t){return t}))||[]},only:function(t){if(!A(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=r,e.Profiler=a,e.PureComponent=b,e.StrictMode=s,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,e.act=O,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=g({},t.props),s=t.key,a=t.ref,o=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,o=E.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)x.call(e,c)&&!L.hasOwnProperty(c)&&(r[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:i,type:t.type,key:s,ref:a,props:r,_owner:o}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=A,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:I}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=D.transition;D.transition={};try{t()}finally{D.transition=e}},e.unstable_act=O,e.useCallback=function(t,e){return C.current.useCallback(t,e)},e.useContext=function(t){return C.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return C.current.useDeferredValue(t)},e.useEffect=function(t,e){return C.current.useEffect(t,e)},e.useId=function(){return C.current.useId()},e.useImperativeHandle=function(t,e,i){return C.current.useImperativeHandle(t,e,i)},e.useInsertionEffect=function(t,e){return C.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return C.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return C.current.useMemo(t,e)},e.useReducer=function(t,e,i){return C.current.useReducer(t,e,i)},e.useRef=function(t){return C.current.useRef(t)},e.useState=function(t){return C.current.useState(t)},e.useSyncExternalStore=function(t,e,i){return C.current.useSyncExternalStore(t,e,i)},e.useTransition=function(){return C.current.useTransition()},e.version="18.3.1"},234:(t,e)=>{function i(t,e){var i=t.length;t.push(e);t:for(;0<i;){var n=i-1>>>1,r=t[n];if(!(0<s(r,e)))break t;t[n]=e,t[i]=r,i=n}}function n(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var n=0,r=t.length,a=r>>>1;n<a;){var o=2*(n+1)-1,l=t[o],c=o+1,u=t[c];if(0>s(l,i))c<r&&0>s(u,l)?(t[n]=u,t[c]=i,n=c):(t[n]=l,t[o]=i,n=o);else{if(!(c<r&&0>s(u,i)))break t;t[n]=u,t[c]=i,n=c}}}return e}function s(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function S(t){for(var e=n(u);null!==e;){if(null===e.callback)r(u);else{if(!(e.startTime<=t))break;r(u),e.sortIndex=e.expirationTime,i(c,e)}e=n(u)}}function w(t){if(m=!1,S(t),!g)if(null!==n(c))g=!0,D(x);else{var e=n(u);null!==e&&N(w,e.startTime-t)}}function x(t,i){g=!1,m&&(m=!1,y(A),A=-1),p=!0;var s=f;try{for(S(i),d=n(c);null!==d&&(!(d.expirationTime>i)||t&&!P());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var o=a(d.expirationTime<=i);i=e.unstable_now(),"function"===typeof o?d.callback=o:d===n(c)&&r(c),S(i)}else r(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&N(w,h.startTime-i),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,L=!1,T=null,A=-1,_=5,k=-1;function P(){return!(e.unstable_now()-k<_)}function R(){if(null!==T){var t=e.unstable_now();k=t;var i=!0;try{i=T(!0,t)}finally{i?E():(L=!1,T=null)}}else L=!1}if("function"===typeof b)E=function(){b(R)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,C=I.port2;I.port1.onmessage=R,E=function(){C.postMessage(null)}}else E=function(){v(R,0)};function D(t){T=t,L||(L=!0,E())}function N(t,i){A=v((function(){t(e.unstable_now())}),i)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,D(x))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var i=f;f=e;try{return t()}finally{f=i}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=f;f=t;try{return e()}finally{f=i}},e.unstable_scheduleCallback=function(t,r,s){var a=e.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,t){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(t.sortIndex=s,i(u,t),null===n(c)&&t===n(u)&&(m?(y(A),A=-1):m=!0,N(w,s-a))):(t.sortIndex=o,i(c,t),g||p||(g=!0,D(x))),t},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(t){var e=f;return function(){var i=f;f=e;try{return t.apply(this,arguments)}finally{f=i}}}},284:(t,e,i)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}i.d(e,{A:()=>n})},391:(t,e,i)=>{var n=i(950);e.createRoot=n.createRoot,e.hydrateRoot=n.hydrateRoot},579:(t,e,i)=>{t.exports=i(153)},730:(t,e,i)=>{var n=i(43),r=i(853);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(o[t]=e,t=0;t<e.length;t++)a.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(t,e,i,n,r,s,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function b(t,e,i,n){var r=m.hasOwnProperty(e)?m[e]:null;(null!==r?0!==r.type:n||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,i,n){if(null===e||"undefined"===typeof e||function(t,e,i,n){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,r,n)&&(i=null),n||null===r?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):r.mustUseProperty?t[r.propertyName]=null===i?3!==r.type&&"":i:(e=r.attributeName,n=r.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var S=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),_=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),C=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function O(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=N&&t[N]||t["@@iterator"])?t:null}var M,F=Object.assign;function B(t){if(void 0===M)try{throw Error()}catch(Py){var e=Py.stack.trim().match(/\n( *(at )?)/);M=e&&e[1]||""}return"\n"+M+t}var U=!1;function j(t,e){if(!t||U)return"";U=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(Cy){var n=Cy}Reflect.construct(t,[],e)}else{try{e.call()}catch(Cy){n=Cy}t.call(e.prototype)}else{try{throw Error()}catch(Cy){n=Cy}t()}}catch(Cy){if(Cy&&n&&"string"===typeof Cy.stack){for(var r=Cy.stack.split("\n"),s=n.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?B(t):""}function $(t){switch(t.tag){case 5:return B(t.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return t=j(t.type,!1);case 11:return t=j(t.type.render,!1);case 1:return t=j(t.type,!0);default:return""}}function z(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case E:return"Fragment";case x:return"Portal";case T:return"Profiler";case L:return"StrictMode";case P:return"Suspense";case R:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case _:return(t.displayName||"Context")+".Consumer";case A:return(t._context.displayName||"Context")+".Provider";case k:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case I:return null!==(e=t.displayName||null)?e:z(t.type)||"Memo";case C:e=t._payload,t=t._init;try{return z(t(e))}catch(Py){}}return null}function H(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(e);case 8:return e===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function q(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function G(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function V(t){t._valueTracker||(t._valueTracker=function(t){var e=G(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){n=""+t,s.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(t){n=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function W(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=G(t)?t.checked?"true":"false":t.value),(t=n)!==i&&(e.setValue(t),!0)}function K(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(Uy){return t.body}}function Y(t,e){var i=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function X(t,e){var i=null==e.defaultValue?"":e.defaultValue,n=null!=e.checked?e.checked:e.defaultChecked;i=q(null!=e.value?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Q(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function J(t,e){Q(t,e);var i=q(e.value),n=e.type;if(null!=i)"number"===n?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===n||"reset"===n)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,i):e.hasOwnProperty("defaultValue")&&tt(t,e.type,q(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Z(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!("submit"!==n&&"reset"!==n||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function tt(t,e,i){"number"===e&&K(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var et=Array.isArray;function it(t,e,i,n){if(t=t.options,e){e={};for(var r=0;r<i.length;r++)e["$"+i[r]]=!0;for(i=0;i<t.length;i++)r=e.hasOwnProperty("$"+t[i].value),t[i].selected!==r&&(t[i].selected=r),r&&n&&(t[i].defaultSelected=!0)}else{for(i=""+q(i),e=null,r=0;r<t.length;r++){if(t[r].value===i)return t[r].selected=!0,void(n&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function nt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(s(92));if(et(i)){if(1<i.length)throw Error(s(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:q(i)}}function st(t,e){var i=q(e.value),n=q(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=n&&(t.defaultValue=""+n)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function ot(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?ot(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut=function(t){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,i,n,r){MSApp.execUnsafeLocalFunction((function(){return t(e,i)}))}:t}((function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}));function ht(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function pt(t,e,i){return null==e||"boolean"===typeof e||""===e?"":i||"number"!==typeof e||0===e||dt.hasOwnProperty(t)&&dt[t]?(""+e).trim():e+"px"}function gt(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=pt(i,e[i],n);"float"===i&&(i="cssFloat"),n?t.setProperty(i,r):t[i]=r}}Object.keys(dt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dt[e]=dt[t]}))}));var mt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(mt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62))}}function yt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function St(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,xt=null,Et=null;function Lt(t){if(t=yr(t)){if("function"!==typeof wt)throw Error(s(280));var e=t.stateNode;e&&(e=Sr(e),wt(t.stateNode,t.type,e))}}function Tt(t){xt?Et?Et.push(t):Et=[t]:xt=t}function At(){if(xt){var t=xt,e=Et;if(Et=xt=null,Lt(t),e)for(t=0;t<e.length;t++)Lt(e[t])}}function _t(t,e){return t(e)}function kt(){}var Pt=!1;function Rt(t,e,i){if(Pt)return t(e,i);Pt=!0;try{return _t(t,e,i)}finally{Pt=!1,(null!==xt||null!==Et)&&(kt(),At())}}function It(t,e){var i=t.stateNode;if(null===i)return null;var n=Sr(i);if(null===n)return null;i=n[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!n;break t;default:t=!1}if(t)return null;if(i&&"function"!==typeof i)throw Error(s(231,e,typeof i));return i}var Ct=!1;if(u)try{var Dt={};Object.defineProperty(Dt,"passive",{get:function(){Ct=!0}}),window.addEventListener("test",Dt,Dt),window.removeEventListener("test",Dt,Dt)}catch(Ay){Ct=!1}function Nt(t,e,i,n,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(i,c)}catch(Fy){this.onError(Fy)}}var Ot=!1,Mt=null,Ft=!1,Bt=null,Ut={onError:function(t){Ot=!0,Mt=t}};function jt(t,e,i,n,r,s,a,o,l){Ot=!1,Mt=null,Nt.apply(Ut,arguments)}function $t(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function zt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Ht(t){if($t(t)!==t)throw Error(s(188))}function qt(t){return t=function(t){var e=t.alternate;if(!e){if(null===(e=$t(t)))throw Error(s(188));return e!==t?null:t}for(var i=t,n=e;;){var r=i.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(n=r.return)){i=n;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===i)return Ht(r),t;if(a===n)return Ht(r),e;a=a.sibling}throw Error(s(188))}if(i.return!==n.return)i=r,n=a;else{for(var o=!1,l=r.child;l;){if(l===i){o=!0,i=r,n=a;break}if(l===n){o=!0,n=r,i=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===i){o=!0,i=a,n=r;break}if(l===n){o=!0,n=a,i=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(i.alternate!==n)throw Error(s(190))}if(3!==i.tag)throw Error(s(188));return i.stateNode.current===i?t:e}(t),null!==t?Gt(t):null}function Gt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Gt(t);if(null!==e)return e;t=t.sibling}return null}var Vt=r.unstable_scheduleCallback,Wt=r.unstable_cancelCallback,Kt=r.unstable_shouldYield,Yt=r.unstable_requestPaint,Xt=r.unstable_now,Qt=r.unstable_getCurrentPriorityLevel,Jt=r.unstable_ImmediatePriority,Zt=r.unstable_UserBlockingPriority,te=r.unstable_NormalPriority,ee=r.unstable_LowPriority,ie=r.unstable_IdlePriority,ne=null,re=null;var se=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(ae(t)/oe|0)|0},ae=Math.log,oe=Math.LN2;var le=64,ce=4194304;function ue(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function he(t,e){var i=t.pendingLanes;if(0===i)return 0;var n=0,r=t.suspendedLanes,s=t.pingedLanes,a=268435455&i;if(0!==a){var o=a&~r;0!==o?n=ue(o):0!==(s&=a)&&(n=ue(s))}else 0!==(a=i&~r)?n=ue(a):0!==s&&(n=ue(s));if(0===n)return 0;if(0!==e&&e!==n&&0===(e&r)&&((r=n&-n)>=(s=e&-e)||16===r&&0!==(4194240&s)))return e;if(0!==(4&n)&&(n|=16&i),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=n;0<e;)r=1<<(i=31-se(e)),n|=t[i],e&=~r;return n}function de(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function pe(){var t=le;return 0===(4194240&(le<<=1))&&(le=64),t}function ge(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function me(t,e,i){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-se(e)]=i}function ve(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var n=31-se(i),r=1<<n;r&e|t[n]&e&&(t[n]|=e),i&=~r}}var ye=0;function be(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var Se,we,xe,Ee,Le,Te=!1,Ae=[],_e=null,ke=null,Pe=null,Re=new Map,Ie=new Map,Ce=[],De="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ne(t,e){switch(t){case"focusin":case"focusout":_e=null;break;case"dragenter":case"dragleave":ke=null;break;case"mouseover":case"mouseout":Pe=null;break;case"pointerover":case"pointerout":Re.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ie.delete(e.pointerId)}}function Oe(t,e,i,n,r,s){return null===t||t.nativeEvent!==s?(t={blockedOn:e,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},null!==e&&(null!==(e=yr(e))&&we(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function Me(t){var e=vr(t.target);if(null!==e){var i=$t(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=zt(i)))return t.blockedOn=e,void Le(t.priority,(function(){xe(i)}))}else if(3===e&&i.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function Fe(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=Ke(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=yr(i))&&we(e),t.blockedOn=i,!1;var n=new(i=t.nativeEvent).constructor(i.type,i);bt=n,i.target.dispatchEvent(n),bt=null,e.shift()}return!0}function Be(t,e,i){Fe(t)&&i.delete(e)}function Ue(){Te=!1,null!==_e&&Fe(_e)&&(_e=null),null!==ke&&Fe(ke)&&(ke=null),null!==Pe&&Fe(Pe)&&(Pe=null),Re.forEach(Be),Ie.forEach(Be)}function je(t,e){t.blockedOn===e&&(t.blockedOn=null,Te||(Te=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ue)))}function $e(t){function e(e){return je(e,t)}if(0<Ae.length){je(Ae[0],t);for(var i=1;i<Ae.length;i++){var n=Ae[i];n.blockedOn===t&&(n.blockedOn=null)}}for(null!==_e&&je(_e,t),null!==ke&&je(ke,t),null!==Pe&&je(Pe,t),Re.forEach(e),Ie.forEach(e),i=0;i<Ce.length;i++)(n=Ce[i]).blockedOn===t&&(n.blockedOn=null);for(;0<Ce.length&&null===(i=Ce[0]).blockedOn;)Me(i),null===i.blockedOn&&Ce.shift()}var ze=S.ReactCurrentBatchConfig,He=!0;function qe(t,e,i,n){var r=ye,s=ze.transition;ze.transition=null;try{ye=1,Ve(t,e,i,n)}finally{ye=r,ze.transition=s}}function Ge(t,e,i,n){var r=ye,s=ze.transition;ze.transition=null;try{ye=4,Ve(t,e,i,n)}finally{ye=r,ze.transition=s}}function Ve(t,e,i,n){if(He){var r=Ke(t,e,i,n);if(null===r)Hn(t,e,n,We,i),Ne(t,n);else if(function(t,e,i,n,r){switch(e){case"focusin":return _e=Oe(_e,t,e,i,n,r),!0;case"dragenter":return ke=Oe(ke,t,e,i,n,r),!0;case"mouseover":return Pe=Oe(Pe,t,e,i,n,r),!0;case"pointerover":var s=r.pointerId;return Re.set(s,Oe(Re.get(s)||null,t,e,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Ie.set(s,Oe(Ie.get(s)||null,t,e,i,n,r)),!0}return!1}(r,t,e,i,n))n.stopPropagation();else if(Ne(t,n),4&e&&-1<De.indexOf(t)){for(;null!==r;){var s=yr(r);if(null!==s&&Se(s),null===(s=Ke(t,e,i,n))&&Hn(t,e,n,We,i),s===r)break;r=s}null!==r&&n.stopPropagation()}else Hn(t,e,n,null,i)}}var We=null;function Ke(t,e,i,n){if(We=null,null!==(t=vr(t=St(n))))if(null===(e=$t(t)))t=null;else if(13===(i=e.tag)){if(null!==(t=zt(e)))return t;t=null}else if(3===i){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return We=t,null}function Ye(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case Zt:return 4;case te:case ee:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Xe=null,Qe=null,Je=null;function Ze(){if(Je)return Je;var t,e,i=Qe,n=i.length,r="value"in Xe?Xe.value:Xe.textContent,s=r.length;for(t=0;t<n&&i[t]===r[t];t++);var a=n-t;for(e=1;e<=a&&i[n-e]===r[s-e];e++);return Je=r.slice(t,1<e?1-e:void 0)}function ti(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function ei(){return!0}function ii(){return!1}function ni(t){function e(e,i,n,r,s){for(var a in this._reactName=e,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=s,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ei:ii,this.isPropagationStopped=ii,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=ei)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=ei)},persist:function(){},isPersistent:ei}),e}var ri,si,ai,oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},li=ni(oi),ci=F({},oi,{view:0,detail:0}),ui=ni(ci),hi=F({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ei,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ai&&(ai&&"mousemove"===t.type?(ri=t.screenX-ai.screenX,si=t.screenY-ai.screenY):si=ri=0,ai=t),ri)},movementY:function(t){return"movementY"in t?t.movementY:si}}),di=ni(hi),fi=ni(F({},hi,{dataTransfer:0})),pi=ni(F({},ci,{relatedTarget:0})),gi=ni(F({},oi,{animationName:0,elapsedTime:0,pseudoElement:0})),mi=F({},oi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vi=ni(mi),yi=ni(F({},oi,{data:0})),bi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Si={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xi(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=wi[t])&&!!e[t]}function Ei(){return xi}var Li=F({},ci,{key:function(t){if(t.key){var e=bi[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ti(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Si[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ei,charCode:function(t){return"keypress"===t.type?ti(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ti(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Ti=ni(Li),Ai=ni(F({},hi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_i=ni(F({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ei})),ki=ni(F({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pi=F({},hi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ri=ni(Pi),Ii=[9,13,27,32],Ci=u&&"CompositionEvent"in window,Di=null;u&&"documentMode"in document&&(Di=document.documentMode);var Ni=u&&"TextEvent"in window&&!Di,Oi=u&&(!Ci||Di&&8<Di&&11>=Di),Mi=String.fromCharCode(32),Fi=!1;function Bi(t,e){switch(t){case"keyup":return-1!==Ii.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ui(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var ji=!1;var $i={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!$i[t.type]:"textarea"===e}function Hi(t,e,i,n){Tt(n),0<(e=Gn(e,"onChange")).length&&(i=new li("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var qi=null,Gi=null;function Vi(t){Fn(t,0)}function Wi(t){if(W(br(t)))return t}function Ki(t,e){if("change"===t)return e}var Yi=!1;if(u){var Xi;if(u){var Qi="oninput"in document;if(!Qi){var Ji=document.createElement("div");Ji.setAttribute("oninput","return;"),Qi="function"===typeof Ji.oninput}Xi=Qi}else Xi=!1;Yi=Xi&&(!document.documentMode||9<document.documentMode)}function Zi(){qi&&(qi.detachEvent("onpropertychange",tn),Gi=qi=null)}function tn(t){if("value"===t.propertyName&&Wi(Gi)){var e=[];Hi(e,Gi,t,St(t)),Rt(Vi,e)}}function en(t,e,i){"focusin"===t?(Zi(),Gi=i,(qi=e).attachEvent("onpropertychange",tn)):"focusout"===t&&Zi()}function nn(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Wi(Gi)}function rn(t,e){if("click"===t)return Wi(e)}function sn(t,e){if("input"===t||"change"===t)return Wi(e)}var an="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function on(t,e){if(an(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!h.call(e,r)||!an(t[r],e[r]))return!1}return!0}function ln(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function cn(t,e){var i,n=ln(t);for(t=0;n;){if(3===n.nodeType){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=ln(n)}}function un(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?un(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function hn(){for(var t=window,e=K();e instanceof t.HTMLIFrameElement;){try{var i="string"===typeof e.contentWindow.location.href}catch(Ny){i=!1}if(!i)break;e=K((t=e.contentWindow).document)}return e}function dn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function fn(t){var e=hn(),i=t.focusedElem,n=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&un(i.ownerDocument.documentElement,i)){if(null!==n&&dn(i))if(e=n.start,void 0===(t=n.end)&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if((t=(e=i.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=void 0===n.end?s:Math.min(n.end,r),!t.extend&&s>n&&(r=n,n=s,s=r),r=cn(i,s);var a=cn(i,n);r&&a&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=i;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<e.length;i++)(t=e[i]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,mn=null,vn=null,yn=!1;function bn(t,e,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;yn||null==gn||gn!==K(n)||("selectionStart"in(n=gn)&&dn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&on(vn,n)||(vn=n,0<(n=Gn(mn,"onSelect")).length&&(e=new li("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=gn)))}function Sn(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var wn={animationend:Sn("Animation","AnimationEnd"),animationiteration:Sn("Animation","AnimationIteration"),animationstart:Sn("Animation","AnimationStart"),transitionend:Sn("Transition","TransitionEnd")},xn={},En={};function Ln(t){if(xn[t])return xn[t];if(!wn[t])return t;var e,i=wn[t];for(e in i)if(i.hasOwnProperty(e)&&e in En)return xn[t]=i[e];return t}u&&(En=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var Tn=Ln("animationend"),An=Ln("animationiteration"),_n=Ln("animationstart"),kn=Ln("transitionend"),Pn=new Map,Rn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(t,e){Pn.set(t,e),l(e,[t])}for(var Cn=0;Cn<Rn.length;Cn++){var Dn=Rn[Cn];In(Dn.toLowerCase(),"on"+(Dn[0].toUpperCase()+Dn.slice(1)))}In(Tn,"onAnimationEnd"),In(An,"onAnimationIteration"),In(_n,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(kn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),On=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nn));function Mn(t,e,i){var n=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,n,r,a,o,l,c){if(jt.apply(this,arguments),Ot){if(!Ot)throw Error(s(198));var u=Mt;Ot=!1,Mt=null,Ft||(Ft=!0,Bt=u)}}(n,e,void 0,t),t.currentTarget=null}function Fn(t,e){e=0!==(4&e);for(var i=0;i<t.length;i++){var n=t[i],r=n.event;n=n.listeners;t:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break t;Mn(r,o,c),s=l}else for(a=0;a<n.length;a++){if(l=(o=n[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break t;Mn(r,o,c),s=l}}}if(Ft)throw t=Bt,Ft=!1,Bt=null,t}function Bn(t,e){var i=e[pr];void 0===i&&(i=e[pr]=new Set);var n=t+"__bubble";i.has(n)||(zn(e,t,2,!1),i.add(n))}function Un(t,e,i){var n=0;e&&(n|=4),zn(i,t,n,e)}var jn="_reactListening"+Math.random().toString(36).slice(2);function $n(t){if(!t[jn]){t[jn]=!0,a.forEach((function(e){"selectionchange"!==e&&(On.has(e)||Un(e,!1,t),Un(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[jn]||(e[jn]=!0,Un("selectionchange",!1,e))}}function zn(t,e,i,n){switch(Ye(e)){case 1:var r=qe;break;case 4:r=Ge;break;default:r=Ve}i=r.bind(null,e,i,t),r=void 0,!Ct||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),n?void 0!==r?t.addEventListener(e,i,{capture:!0,passive:r}):t.addEventListener(e,i,!0):void 0!==r?t.addEventListener(e,i,{passive:r}):t.addEventListener(e,i,!1)}function Hn(t,e,i,n,r){var s=n;if(0===(1&e)&&0===(2&e)&&null!==n)t:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var o=n.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=vr(o)))return;if(5===(l=a.tag)||6===l){n=s=a;continue t}o=o.parentNode}}n=n.return}Rt((function(){var n=s,r=St(i),a=[];t:{var o=Pn.get(t);if(void 0!==o){var l=li,c=t;switch(t){case"keypress":if(0===ti(i))break t;case"keydown":case"keyup":l=Ti;break;case"focusin":c="focus",l=pi;break;case"focusout":c="blur",l=pi;break;case"beforeblur":case"afterblur":l=pi;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=di;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=_i;break;case Tn:case An:case _n:l=gi;break;case kn:l=ki;break;case"scroll":l=ui;break;case"wheel":l=Ri;break;case"copy":case"cut":case"paste":l=vi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ai}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=n;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=It(p,d))&&u.push(qn(p,g,f)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,i,r),a.push({event:o,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(o="mouseover"===t||"pointerover"===t)||i===bt||!(c=i.relatedTarget||i.fromElement)||!vr(c)&&!c[fr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=i.relatedTarget||i.toElement)?vr(c):null)&&(c!==(h=$t(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=di,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(u=Ai,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:br(l),f=null==c?o:br(c),(o=new u(g,p+"leave",l,i,r)).target=h,o.relatedTarget=f,g=null,vr(r)===n&&((u=new u(d,p+"enter",c,i,r)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)t:{for(d=c,p=0,f=u=l;f;f=Vn(f))p++;for(f=0,g=d;g;g=Vn(g))f++;for(;0<p-f;)u=Vn(u),p--;for(;0<f-p;)d=Vn(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break t;u=Vn(u),d=Vn(d)}u=null}else u=null;null!==l&&Wn(a,o,l,u,!1),null!==c&&null!==h&&Wn(a,h,c,u,!0)}if("select"===(l=(o=n?br(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=Ki;else if(zi(o))if(Yi)m=sn;else{m=nn;var v=en}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=rn);switch(m&&(m=m(t,n))?Hi(a,m,i,r):(v&&v(t,o,n),"focusout"===t&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&tt(o,"number",o.value)),v=n?br(n):window,t){case"focusin":(zi(v)||"true"===v.contentEditable)&&(gn=v,mn=n,vn=null);break;case"focusout":vn=mn=gn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,bn(a,i,r);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":bn(a,i,r)}var y;if(Ci)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else ji?Bi(t,i)&&(b="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(b="onCompositionStart");b&&(Oi&&"ko"!==i.locale&&(ji||"onCompositionStart"!==b?"onCompositionEnd"===b&&ji&&(y=Ze()):(Qe="value"in(Xe=r)?Xe.value:Xe.textContent,ji=!0)),0<(v=Gn(n,b)).length&&(b=new yi(b,t,null,i,r),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Ui(i))&&(b.data=y))),(y=Ni?function(t,e){switch(t){case"compositionend":return Ui(e);case"keypress":return 32!==e.which?null:(Fi=!0,Mi);case"textInput":return(t=e.data)===Mi&&Fi?null:t;default:return null}}(t,i):function(t,e){if(ji)return"compositionend"===t||!Ci&&Bi(t,e)?(t=Ze(),Je=Qe=Xe=null,ji=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Oi&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(n=Gn(n,"onBeforeInput")).length&&(r=new yi("onBeforeInput","beforeinput",null,i,r),a.push({event:r,listeners:n}),r.data=y))}Fn(a,e)}))}function qn(t,e,i){return{instance:t,listener:e,currentTarget:i}}function Gn(t,e){for(var i=e+"Capture",n=[];null!==t;){var r=t,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=It(t,i))&&n.unshift(qn(t,s,r)),null!=(s=It(t,e))&&n.push(qn(t,s,r))),t=t.return}return n}function Vn(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Wn(t,e,i,n,r){for(var s=e._reactName,a=[];null!==i&&i!==n;){var o=i,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=It(i,s))&&a.unshift(qn(i,l,o)):r||null!=(l=It(i,s))&&a.push(qn(i,l,o))),i=i.return}0!==a.length&&t.push({event:e,listeners:a})}var Kn=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Xn(t){return("string"===typeof t?t:""+t).replace(Kn,"\n").replace(Yn,"")}function Qn(t,e,i){if(e=Xn(e),Xn(t)!==e&&i)throw Error(s(425))}function Jn(){}var Zn=null,tr=null;function er(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,nr="function"===typeof clearTimeout?clearTimeout:void 0,rr="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rr?function(t){return rr.resolve(null).then(t).catch(ar)}:ir;function ar(t){setTimeout((function(){throw t}))}function or(t,e){var i=e,n=0;do{var r=i.nextSibling;if(t.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return t.removeChild(r),void $e(e);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);$e(e)}function lr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function cr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var ur=Math.random().toString(36).slice(2),hr="__reactFiber$"+ur,dr="__reactProps$"+ur,fr="__reactContainer$"+ur,pr="__reactEvents$"+ur,gr="__reactListeners$"+ur,mr="__reactHandles$"+ur;function vr(t){var e=t[hr];if(e)return e;for(var i=t.parentNode;i;){if(e=i[fr]||i[hr]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=cr(t);null!==t;){if(i=t[hr])return i;t=cr(t)}return e}i=(t=i).parentNode}return null}function yr(t){return!(t=t[hr]||t[fr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function br(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function Sr(t){return t[dr]||null}var wr=[],xr=-1;function Er(t){return{current:t}}function Lr(t){0>xr||(t.current=wr[xr],wr[xr]=null,xr--)}function Tr(t,e){xr++,wr[xr]=t.current,t.current=e}var Ar={},_r=Er(Ar),kr=Er(!1),Pr=Ar;function Rr(t,e){var i=t.type.contextTypes;if(!i)return Ar;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in i)s[r]=e[r];return n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ir(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Cr(){Lr(kr),Lr(_r)}function Dr(t,e,i){if(_r.current!==Ar)throw Error(s(168));Tr(_r,e),Tr(kr,i)}function Nr(t,e,i){var n=t.stateNode;if(e=e.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in e))throw Error(s(108,H(t)||"Unknown",r));return F({},i,n)}function Or(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ar,Pr=_r.current,Tr(_r,t),Tr(kr,kr.current),!0}function Mr(t,e,i){var n=t.stateNode;if(!n)throw Error(s(169));i?(t=Nr(t,e,Pr),n.__reactInternalMemoizedMergedChildContext=t,Lr(kr),Lr(_r),Tr(_r,t)):Lr(kr),Tr(kr,i)}var Fr=null,Br=!1,Ur=!1;function jr(t){null===Fr?Fr=[t]:Fr.push(t)}function $r(){if(!Ur&&null!==Fr){Ur=!0;var t=0,e=ye;try{var i=Fr;for(ye=1;t<i.length;t++){var n=i[t];do{n=n(!0)}while(null!==n)}Fr=null,Br=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(t+1)),Vt(Jt,$r),r}finally{ye=e,Ur=!1}}return null}var zr=[],Hr=0,qr=null,Gr=0,Vr=[],Wr=0,Kr=null,Yr=1,Xr="";function Qr(t,e){zr[Hr++]=Gr,zr[Hr++]=qr,qr=t,Gr=e}function Jr(t,e,i){Vr[Wr++]=Yr,Vr[Wr++]=Xr,Vr[Wr++]=Kr,Kr=t;var n=Yr;t=Xr;var r=32-se(n)-1;n&=~(1<<r),i+=1;var s=32-se(e)+r;if(30<s){var a=r-r%5;s=(n&(1<<a)-1).toString(32),n>>=a,r-=a,Yr=1<<32-se(e)+r|i<<r|n,Xr=s+t}else Yr=1<<s|i<<r|n,Xr=t}function Zr(t){null!==t.return&&(Qr(t,1),Jr(t,1,0))}function ts(t){for(;t===qr;)qr=zr[--Hr],zr[Hr]=null,Gr=zr[--Hr],zr[Hr]=null;for(;t===Kr;)Kr=Vr[--Wr],Vr[Wr]=null,Xr=Vr[--Wr],Vr[Wr]=null,Yr=Vr[--Wr],Vr[Wr]=null}var es=null,is=null,ns=!1,rs=null;function ss(t,e){var i=Rc(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,null===(e=t.deletions)?(t.deletions=[i],t.flags|=16):e.push(i)}function as(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,es=t,is=lr(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,es=t,is=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(i=null!==Kr?{id:Yr,overflow:Xr}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},(i=Rc(18,null,null,0)).stateNode=e,i.return=t,t.child=i,es=t,is=null,!0);default:return!1}}function os(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ls(t){if(ns){var e=is;if(e){var i=e;if(!as(t,e)){if(os(t))throw Error(s(418));e=lr(i.nextSibling);var n=es;e&&as(t,e)?ss(n,i):(t.flags=-4097&t.flags|2,ns=!1,es=t)}}else{if(os(t))throw Error(s(418));t.flags=-4097&t.flags|2,ns=!1,es=t}}}function cs(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;es=t}function us(t){if(t!==es)return!1;if(!ns)return cs(t),ns=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!er(t.type,t.memoizedProps)),e&&(e=is)){if(os(t))throw hs(),Error(s(418));for(;e;)ss(t,e),e=lr(e.nextSibling)}if(cs(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){is=lr(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}is=null}}else is=es?lr(t.stateNode.nextSibling):null;return!0}function hs(){for(var t=is;t;)t=lr(t.nextSibling)}function ds(){is=es=null,ns=!1}function fs(t){null===rs?rs=[t]:rs.push(t)}var ps=S.ReactCurrentBatchConfig;function gs(t,e,i){if(null!==(t=i.ref)&&"function"!==typeof t&&"object"!==typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(s(309));var n=i.stateNode}if(!n)throw Error(s(147,t));var r=n,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=r.refs;null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(s(284));if(!i._owner)throw Error(s(290,t))}return t}function ms(t,e){throw t=Object.prototype.toString.call(e),Error(s(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vs(t){return(0,t._init)(t._payload)}function ys(t){function e(e,i){if(t){var n=e.deletions;null===n?(e.deletions=[i],e.flags|=16):n.push(i)}}function i(i,n){if(!t)return null;for(;null!==n;)e(i,n),n=n.sibling;return null}function n(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Cc(t,e)).index=0,t.sibling=null,t}function a(e,i,n){return e.index=n,t?null!==(n=e.alternate)?(n=n.index)<i?(e.flags|=2,i):n:(e.flags|=2,i):(e.flags|=1048576,i)}function o(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,i,n){return null===e||6!==e.tag?((e=Mc(i,t.mode,n)).return=t,e):((e=r(e,i)).return=t,e)}function c(t,e,i,n){var s=i.type;return s===E?h(t,e,i.props.children,n,i.key):null!==e&&(e.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===C&&vs(s)===e.type)?((n=r(e,i.props)).ref=gs(t,e,i),n.return=t,n):((n=Dc(i.type,i.key,i.props,null,t.mode,n)).ref=gs(t,e,i),n.return=t,n)}function u(t,e,i,n){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=Fc(i,t.mode,n)).return=t,e):((e=r(e,i.children||[])).return=t,e)}function h(t,e,i,n,s){return null===e||7!==e.tag?((e=Nc(i,t.mode,n,s)).return=t,e):((e=r(e,i)).return=t,e)}function d(t,e,i){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Mc(""+e,t.mode,i)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(i=Dc(e.type,e.key,e.props,null,t.mode,i)).ref=gs(t,null,e),i.return=t,i;case x:return(e=Fc(e,t.mode,i)).return=t,e;case C:return d(t,(0,e._init)(e._payload),i)}if(et(e)||O(e))return(e=Nc(e,t.mode,i,null)).return=t,e;ms(t,e)}return null}function f(t,e,i,n){var r=null!==e?e.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==r?null:l(t,e,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return i.key===r?c(t,e,i,n):null;case x:return i.key===r?u(t,e,i,n):null;case C:return f(t,e,(r=i._init)(i._payload),n)}if(et(i)||O(i))return null!==r?null:h(t,e,i,n,null);ms(t,i)}return null}function p(t,e,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return l(e,t=t.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return c(e,t=t.get(null===n.key?i:n.key)||null,n,r);case x:return u(e,t=t.get(null===n.key?i:n.key)||null,n,r);case C:return p(t,e,i,(0,n._init)(n._payload),r)}if(et(n)||O(n))return h(e,t=t.get(i)||null,n,r,null);ms(e,n)}return null}function g(r,s,o,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<o.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(r,h,o[g],l);if(null===v){null===h&&(h=m);break}t&&h&&null===v.alternate&&e(r,h),s=a(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===o.length)return i(r,h),ns&&Qr(r,g),c;if(null===h){for(;g<o.length;g++)null!==(h=d(r,o[g],l))&&(s=a(h,s,g),null===u?c=h:u.sibling=h,u=h);return ns&&Qr(r,g),c}for(h=n(r,h);g<o.length;g++)null!==(m=p(h,r,g,o[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=a(m,s,g),null===u?c=m:u.sibling=m,u=m);return t&&h.forEach((function(t){return e(r,t)})),ns&&Qr(r,g),c}function m(r,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,g=o,m=o=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(r,g,y.value,c);if(null===b){null===g&&(g=v);break}t&&g&&null===b.alternate&&e(r,g),o=a(b,o,m),null===h?u=b:h.sibling=b,h=b,g=v}if(y.done)return i(r,g),ns&&Qr(r,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return ns&&Qr(r,m),u}for(g=n(r,g);!y.done;m++,y=l.next())null!==(y=p(g,r,m,y.value,c))&&(t&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return t&&g.forEach((function(t){return e(r,t)})),ns&&Qr(r,m),u}return function t(n,s,a,l){if("object"===typeof a&&null!==a&&a.type===E&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:t:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===E){if(7===u.tag){i(n,u.sibling),(s=r(u,a.props.children)).return=n,n=s;break t}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===C&&vs(c)===u.type){i(n,u.sibling),(s=r(u,a.props)).ref=gs(n,u,a),s.return=n,n=s;break t}i(n,u);break}e(n,u),u=u.sibling}a.type===E?((s=Nc(a.props.children,n.mode,l,a.key)).return=n,n=s):((l=Dc(a.type,a.key,a.props,null,n.mode,l)).ref=gs(n,s,a),l.return=n,n=l)}return o(n);case x:t:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){i(n,s.sibling),(s=r(s,a.children||[])).return=n,n=s;break t}i(n,s);break}e(n,s),s=s.sibling}(s=Fc(a,n.mode,l)).return=n,n=s}return o(n);case C:return t(n,s,(u=a._init)(a._payload),l)}if(et(a))return g(n,s,a,l);if(O(a))return m(n,s,a,l);ms(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(i(n,s.sibling),(s=r(s,a)).return=n,n=s):(i(n,s),(s=Mc(a,n.mode,l)).return=n,n=s),o(n)):i(n,s)}}var bs=ys(!0),Ss=ys(!1),ws=Er(null),xs=null,Es=null,Ls=null;function Ts(){Ls=Es=xs=null}function As(t){var e=ws.current;Lr(ws),t._currentValue=e}function _s(t,e,i){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==n&&(n.childLanes|=e)):null!==n&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===i)break;t=t.return}}function ks(t,e){xs=t,Ls=Es=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(yo=!0),t.firstContext=null)}function Ps(t){var e=t._currentValue;if(Ls!==t)if(t={context:t,memoizedValue:e,next:null},null===Es){if(null===xs)throw Error(s(308));Es=t,xs.dependencies={lanes:0,firstContext:t}}else Es=Es.next=t;return e}var Rs=null;function Is(t){null===Rs?Rs=[t]:Rs.push(t)}function Cs(t,e,i,n){var r=e.interleaved;return null===r?(i.next=i,Is(e)):(i.next=r.next,r.next=i),e.interleaved=i,Ds(t,n)}function Ds(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}var Ns=!1;function Os(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ms(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bs(t,e,i){var n=t.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&_l)){var r=n.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),n.pending=e,Ds(t,i)}return null===(r=n.interleaved)?(e.next=e,Is(n)):(e.next=r.next,r.next=e),n.interleaved=e,Ds(t,i)}function Us(t,e,i){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&i))){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,ve(t,i)}}function js(t,e){var i=t.updateQueue,n=t.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,s=null;if(null!==(i=i.firstBaseUpdate)){do{var a={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===s?r=s=a:s=s.next=a,i=i.next}while(null!==i);null===s?r=s=e:s=s.next=e}else r=s=e;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function $s(t,e,i,n){var r=t.updateQueue;Ns=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=t.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(a=0,u=c=l=null,o=s;;){var d=o.lane,f=o.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});t:{var p=t,g=o;switch(d=e,f=i,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break t;h=F({},h,d);break t;case 2:Ns=!0}}null!==o.callback&&0!==o.lane&&(t.flags|=64,null===(d=r.effects)?r.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(d=o).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(e=r.shared.interleaved)){r=e;do{a|=r.lane,r=r.next}while(r!==e)}else null===s&&(r.shared.lanes=0);Ol|=a,t.lanes=a,t.memoizedState=h}}function zs(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var n=t[e],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(s(191,r));r.call(n)}}}var Hs={},qs=Er(Hs),Gs=Er(Hs),Vs=Er(Hs);function Ws(t){if(t===Hs)throw Error(s(174));return t}function Ks(t,e){switch(Tr(Vs,e),Tr(Gs,t),Tr(qs,Hs),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Lr(qs),Tr(qs,e)}function Ys(){Lr(qs),Lr(Gs),Lr(Vs)}function Xs(t){Ws(Vs.current);var e=Ws(qs.current),i=lt(e,t.type);e!==i&&(Tr(Gs,t),Tr(qs,i))}function Qs(t){Gs.current===t&&(Lr(qs),Lr(Gs))}var Js=Er(0);function Zs(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ta=[];function ea(){for(var t=0;t<ta.length;t++)ta[t]._workInProgressVersionPrimary=null;ta.length=0}var ia=S.ReactCurrentDispatcher,na=S.ReactCurrentBatchConfig,ra=0,sa=null,aa=null,oa=null,la=!1,ca=!1,ua=0,ha=0;function da(){throw Error(s(321))}function fa(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!an(t[i],e[i]))return!1;return!0}function pa(t,e,i,n,r,a){if(ra=a,sa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ia.current=null===t||null===t.memoizedState?Qa:Ja,t=i(n,r),ca){a=0;do{if(ca=!1,ua=0,25<=a)throw Error(s(301));a+=1,oa=aa=null,e.updateQueue=null,ia.current=Za,t=i(n,r)}while(ca)}if(ia.current=Xa,e=null!==aa&&null!==aa.next,ra=0,oa=aa=sa=null,la=!1,e)throw Error(s(300));return t}function ga(){var t=0!==ua;return ua=0,t}function ma(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===oa?sa.memoizedState=oa=t:oa=oa.next=t,oa}function va(){if(null===aa){var t=sa.alternate;t=null!==t?t.memoizedState:null}else t=aa.next;var e=null===oa?sa.memoizedState:oa.next;if(null!==e)oa=e,aa=t;else{if(null===t)throw Error(s(310));t={memoizedState:(aa=t).memoizedState,baseState:aa.baseState,baseQueue:aa.baseQueue,queue:aa.queue,next:null},null===oa?sa.memoizedState=oa=t:oa=oa.next=t}return oa}function ya(t,e){return"function"===typeof e?e(t):e}function ba(t){var e=va(),i=e.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=t;var n=aa,r=n.baseQueue,a=i.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}n.baseQueue=r=a,i.pending=null}if(null!==r){a=r.next,n=n.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((ra&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=n):c=c.next=d,sa.lanes|=h,Ol|=h}u=u.next}while(null!==u&&u!==a);null===c?o=n:c.next=l,an(n,e.memoizedState)||(yo=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,i.lastRenderedState=n}if(null!==(t=i.interleaved)){r=t;do{a=r.lane,sa.lanes|=a,Ol|=a,r=r.next}while(r!==t)}else null===r&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function Sa(t){var e=va(),i=e.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=t;var n=i.dispatch,r=i.pending,a=e.memoizedState;if(null!==r){i.pending=null;var o=r=r.next;do{a=t(a,o.action),o=o.next}while(o!==r);an(a,e.memoizedState)||(yo=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),i.lastRenderedState=a}return[a,n]}function wa(){}function xa(t,e){var i=sa,n=va(),r=e(),a=!an(n.memoizedState,r);if(a&&(n.memoizedState=r,yo=!0),n=n.queue,Na(Ta.bind(null,i,n,t),[t]),n.getSnapshot!==e||a||null!==oa&&1&oa.memoizedState.tag){if(i.flags|=2048,Pa(9,La.bind(null,i,n,r,e),void 0,null),null===kl)throw Error(s(349));0!==(30&ra)||Ea(i,e,r)}return r}function Ea(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},null===(e=sa.updateQueue)?(e={lastEffect:null,stores:null},sa.updateQueue=e,e.stores=[t]):null===(i=e.stores)?e.stores=[t]:i.push(t)}function La(t,e,i,n){e.value=i,e.getSnapshot=n,Aa(e)&&_a(t)}function Ta(t,e,i){return i((function(){Aa(e)&&_a(t)}))}function Aa(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!an(t,i)}catch(Ny){return!0}}function _a(t){var e=Ds(t,1);null!==e&&ec(e,t,1,-1)}function ka(t){var e=ma();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:t},e.queue=t,t=t.dispatch=Va.bind(null,sa,t),[e.memoizedState,t]}function Pa(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},null===(e=sa.updateQueue)?(e={lastEffect:null,stores:null},sa.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t),t}function Ra(){return va().memoizedState}function Ia(t,e,i,n){var r=ma();sa.flags|=t,r.memoizedState=Pa(1|e,i,void 0,void 0===n?null:n)}function Ca(t,e,i,n){var r=va();n=void 0===n?null:n;var s=void 0;if(null!==aa){var a=aa.memoizedState;if(s=a.destroy,null!==n&&fa(n,a.deps))return void(r.memoizedState=Pa(e,i,s,n))}sa.flags|=t,r.memoizedState=Pa(1|e,i,s,n)}function Da(t,e){return Ia(8390656,8,t,e)}function Na(t,e){return Ca(2048,8,t,e)}function Oa(t,e){return Ca(4,2,t,e)}function Ma(t,e){return Ca(4,4,t,e)}function Fa(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ba(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Ca(4,4,Fa.bind(null,e,t),i)}function Ua(){}function ja(t,e){var i=va();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&fa(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function $a(t,e){var i=va();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&fa(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function za(t,e,i){return 0===(21&ra)?(t.baseState&&(t.baseState=!1,yo=!0),t.memoizedState=i):(an(i,e)||(i=pe(),sa.lanes|=i,Ol|=i,t.baseState=!0),e)}function Ha(t,e){var i=ye;ye=0!==i&&4>i?i:4,t(!0);var n=na.transition;na.transition={};try{t(!1),e()}finally{ye=i,na.transition=n}}function qa(){return va().memoizedState}function Ga(t,e,i){var n=tc(t);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},Wa(t))Ka(e,i);else if(null!==(i=Cs(t,e,i,n))){ec(i,t,n,Zl()),Ya(i,e,n)}}function Va(t,e,i){var n=tc(t),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(Wa(t))Ka(e,r);else{var s=t.alternate;if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var a=e.lastRenderedState,o=s(a,i);if(r.hasEagerState=!0,r.eagerState=o,an(o,a)){var l=e.interleaved;return null===l?(r.next=r,Is(e)):(r.next=l.next,l.next=r),void(e.interleaved=r)}}catch(Cy){}null!==(i=Cs(t,e,r,n))&&(ec(i,t,n,r=Zl()),Ya(i,e,n))}}function Wa(t){var e=t.alternate;return t===sa||null!==e&&e===sa}function Ka(t,e){ca=la=!0;var i=t.pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function Ya(t,e,i){if(0!==(4194240&i)){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,ve(t,i)}}var Xa={readContext:Ps,useCallback:da,useContext:da,useEffect:da,useImperativeHandle:da,useInsertionEffect:da,useLayoutEffect:da,useMemo:da,useReducer:da,useRef:da,useState:da,useDebugValue:da,useDeferredValue:da,useTransition:da,useMutableSource:da,useSyncExternalStore:da,useId:da,unstable_isNewReconciler:!1},Qa={readContext:Ps,useCallback:function(t,e){return ma().memoizedState=[t,void 0===e?null:e],t},useContext:Ps,useEffect:Da,useImperativeHandle:function(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Ia(4194308,4,Fa.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Ia(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ia(4,2,t,e)},useMemo:function(t,e){var i=ma();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=ma();return e=void 0!==i?i(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Ga.bind(null,sa,t),[n.memoizedState,t]},useRef:function(t){return t={current:t},ma().memoizedState=t},useState:ka,useDebugValue:Ua,useDeferredValue:function(t){return ma().memoizedState=t},useTransition:function(){var t=ka(!1),e=t[0];return t=Ha.bind(null,t[1]),ma().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var n=sa,r=ma();if(ns){if(void 0===i)throw Error(s(407));i=i()}else{if(i=e(),null===kl)throw Error(s(349));0!==(30&ra)||Ea(n,e,i)}r.memoizedState=i;var a={value:i,getSnapshot:e};return r.queue=a,Da(Ta.bind(null,n,a,t),[t]),n.flags|=2048,Pa(9,La.bind(null,n,a,i,e),void 0,null),i},useId:function(){var t=ma(),e=kl.identifierPrefix;if(ns){var i=Xr;e=":"+e+"R"+(i=(Yr&~(1<<32-se(Yr)-1)).toString(32)+i),0<(i=ua++)&&(e+="H"+i.toString(32)),e+=":"}else e=":"+e+"r"+(i=ha++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Ja={readContext:Ps,useCallback:ja,useContext:Ps,useEffect:Na,useImperativeHandle:Ba,useInsertionEffect:Oa,useLayoutEffect:Ma,useMemo:$a,useReducer:ba,useRef:Ra,useState:function(){return ba(ya)},useDebugValue:Ua,useDeferredValue:function(t){return za(va(),aa.memoizedState,t)},useTransition:function(){return[ba(ya)[0],va().memoizedState]},useMutableSource:wa,useSyncExternalStore:xa,useId:qa,unstable_isNewReconciler:!1},Za={readContext:Ps,useCallback:ja,useContext:Ps,useEffect:Na,useImperativeHandle:Ba,useInsertionEffect:Oa,useLayoutEffect:Ma,useMemo:$a,useReducer:Sa,useRef:Ra,useState:function(){return Sa(ya)},useDebugValue:Ua,useDeferredValue:function(t){var e=va();return null===aa?e.memoizedState=t:za(e,aa.memoizedState,t)},useTransition:function(){return[Sa(ya)[0],va().memoizedState]},useMutableSource:wa,useSyncExternalStore:xa,useId:qa,unstable_isNewReconciler:!1};function to(t,e){if(t&&t.defaultProps){for(var i in e=F({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}function eo(t,e,i,n){i=null===(i=i(n,e=t.memoizedState))||void 0===i?e:F({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var io={isMounted:function(t){return!!(t=t._reactInternals)&&$t(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=Zl(),r=tc(t),s=Fs(n,r);s.payload=e,void 0!==i&&null!==i&&(s.callback=i),null!==(e=Bs(t,s,r))&&(ec(e,t,r,n),Us(e,t,r))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=Zl(),r=tc(t),s=Fs(n,r);s.tag=1,s.payload=e,void 0!==i&&null!==i&&(s.callback=i),null!==(e=Bs(t,s,r))&&(ec(e,t,r,n),Us(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Zl(),n=tc(t),r=Fs(i,n);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),null!==(e=Bs(t,r,n))&&(ec(e,t,n,i),Us(e,t,n))}};function no(t,e,i,n,r,s,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(n,s,a):!e.prototype||!e.prototype.isPureReactComponent||(!on(i,n)||!on(r,s))}function ro(t,e,i){var n=!1,r=Ar,s=e.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(r=Ir(e)?Pr:_r.current,s=(n=null!==(n=e.contextTypes)&&void 0!==n)?Rr(t,r):Ar),e=new e(i,s),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=io,t.stateNode=e,e._reactInternals=t,n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function so(t,e,i,n){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,n),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&io.enqueueReplaceState(e,e.state,null)}function ao(t,e,i,n){var r=t.stateNode;r.props=i,r.state=t.memoizedState,r.refs={},Os(t);var s=e.contextType;"object"===typeof s&&null!==s?r.context=Ps(s):(s=Ir(e)?Pr:_r.current,r.context=Rr(t,s)),r.state=t.memoizedState,"function"===typeof(s=e.getDerivedStateFromProps)&&(eo(t,e,s,i),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&io.enqueueReplaceState(r,r.state,null),$s(t,i,r,n),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308)}function oo(t,e){try{var i="",n=e;do{i+=$(n),n=n.return}while(n);var r=i}catch(Dy){r="\nError generating stack: "+Dy.message+"\n"+Dy.stack}return{value:t,source:e,stack:r,digest:null}}function lo(t,e,i){return{value:t,source:null,stack:null!=i?i:null,digest:null!=e?e:null}}function co(t,e){try{console.error(e.value)}catch(Py){setTimeout((function(){throw Py}))}}var uo="function"===typeof WeakMap?WeakMap:Map;function ho(t,e,i){(i=Fs(-1,i)).tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){Hl||(Hl=!0,ql=n),co(0,e)},i}function fo(t,e,i){(i=Fs(-1,i)).tag=3;var n=t.type.getDerivedStateFromError;if("function"===typeof n){var r=e.value;i.payload=function(){return n(r)},i.callback=function(){co(0,e)}}var s=t.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(i.callback=function(){co(0,e),"function"!==typeof n&&(null===Gl?Gl=new Set([this]):Gl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}function po(t,e,i){var n=t.pingCache;if(null===n){n=t.pingCache=new uo;var r=new Set;n.set(e,r)}else void 0===(r=n.get(e))&&(r=new Set,n.set(e,r));r.has(i)||(r.add(i),t=Lc.bind(null,t,e,i),e.then(t,t))}function go(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function mo(t,e,i,n,r){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((e=Fs(-1,1)).tag=2,Bs(i,e,1))),i.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var vo=S.ReactCurrentOwner,yo=!1;function bo(t,e,i,n){e.child=null===t?Ss(e,null,i,n):bs(e,t.child,i,n)}function So(t,e,i,n,r){i=i.render;var s=e.ref;return ks(e,r),n=pa(t,e,i,n,s,r),i=ga(),null===t||yo?(ns&&i&&Zr(e),e.flags|=1,bo(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ho(t,e,r))}function wo(t,e,i,n,r){if(null===t){var s=i.type;return"function"!==typeof s||Ic(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=Dc(i.type,null,n,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,xo(t,e,s,n,r))}if(s=t.child,0===(t.lanes&r)){var a=s.memoizedProps;if((i=null!==(i=i.compare)?i:on)(a,n)&&t.ref===e.ref)return Ho(t,e,r)}return e.flags|=1,(t=Cc(s,n)).ref=e.ref,t.return=e,e.child=t}function xo(t,e,i,n,r){if(null!==t){var s=t.memoizedProps;if(on(s,n)&&t.ref===e.ref){if(yo=!1,e.pendingProps=n=s,0===(t.lanes&r))return e.lanes=t.lanes,Ho(t,e,r);0!==(131072&t.flags)&&(yo=!0)}}return To(t,e,i,n,r)}function Eo(t,e,i){var n=e.pendingProps,r=n.children,s=null!==t?t.memoizedState:null;if("hidden"===n.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Cl,Il),Il|=i;else{if(0===(1073741824&i))return t=null!==s?s.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tr(Cl,Il),Il|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:i,Tr(Cl,Il),Il|=n}else null!==s?(n=s.baseLanes|i,e.memoizedState=null):n=i,Tr(Cl,Il),Il|=n;return bo(t,e,r,i),e.child}function Lo(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function To(t,e,i,n,r){var s=Ir(i)?Pr:_r.current;return s=Rr(e,s),ks(e,r),i=pa(t,e,i,n,s,r),n=ga(),null===t||yo?(ns&&n&&Zr(e),e.flags|=1,bo(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ho(t,e,r))}function Ao(t,e,i,n,r){if(Ir(i)){var s=!0;Or(e)}else s=!1;if(ks(e,r),null===e.stateNode)zo(t,e),ro(e,i,n),ao(e,i,n,r),n=!0;else if(null===t){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=i.contextType;"object"===typeof c&&null!==c?c=Ps(c):c=Rr(e,c=Ir(i)?Pr:_r.current);var u=i.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==n||l!==c)&&so(e,a,n,c),Ns=!1;var d=e.memoizedState;a.state=d,$s(e,n,a,r),l=e.memoizedState,o!==n||d!==l||kr.current||Ns?("function"===typeof u&&(eo(e,i,u,n),l=e.memoizedState),(o=Ns||no(e,i,o,n,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):("function"===typeof a.componentDidMount&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Ms(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:to(e.type,o),a.props=c,h=e.pendingProps,d=a.context,"object"===typeof(l=i.contextType)&&null!==l?l=Ps(l):l=Rr(e,l=Ir(i)?Pr:_r.current);var f=i.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==h||d!==l)&&so(e,a,n,l),Ns=!1,d=e.memoizedState,a.state=d,$s(e,n,a,r);var p=e.memoizedState;o!==h||d!==p||kr.current||Ns?("function"===typeof f&&(eo(e,i,f,n),p=e.memoizedState),(c=Ns||no(e,i,c,n,d,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),a.props=n,a.state=p,a.context=l,n=c):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return _o(t,e,i,n,s,r)}function _o(t,e,i,n,r,s){Lo(t,e);var a=0!==(128&e.flags);if(!n&&!a)return r&&Mr(e,i,!1),Ho(t,e,s);n=e.stateNode,vo.current=e;var o=a&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return e.flags|=1,null!==t&&a?(e.child=bs(e,t.child,null,s),e.child=bs(e,null,o,s)):bo(t,e,o,s),e.memoizedState=n.state,r&&Mr(e,i,!0),e.child}function ko(t){var e=t.stateNode;e.pendingContext?Dr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Dr(0,e.context,!1),Ks(t,e.containerInfo)}function Po(t,e,i,n,r){return ds(),fs(r),e.flags|=256,bo(t,e,i,n),e.child}var Ro,Io,Co,Do,No={dehydrated:null,treeContext:null,retryLane:0};function Oo(t){return{baseLanes:t,cachePool:null,transitions:null}}function Mo(t,e,i){var n,r=e.pendingProps,a=Js.current,o=!1,l=0!==(128&e.flags);if((n=l)||(n=(null===t||null!==t.memoizedState)&&0!==(2&a)),n?(o=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Tr(Js,1&a),null===t)return ls(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=r.children,t=r.fallback,o?(r=e.mode,o=e.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,r,0,null),t=Nc(t,r,i,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Oo(i),e.memoizedState=No,t):Fo(e,l));if(null!==(a=t.memoizedState)&&null!==(n=a.dehydrated))return function(t,e,i,n,r,a,o){if(i)return 256&e.flags?(e.flags&=-257,Bo(t,e,o,n=lo(Error(s(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=n.fallback,r=e.mode,n=Oc({mode:"visible",children:n.children},r,0,null),(a=Nc(a,r,o,null)).flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,0!==(1&e.mode)&&bs(e,t.child,null,o),e.child.memoizedState=Oo(o),e.memoizedState=No,a);if(0===(1&e.mode))return Bo(t,e,o,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,Bo(t,e,o,n=lo(a=Error(s(419)),n,void 0))}if(l=0!==(o&t.childLanes),yo||l){if(null!==(n=kl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Ds(t,r),ec(n,t,r,-1))}return pc(),Bo(t,e,o,n=lo(Error(s(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Ac.bind(null,t),r._reactRetry=e,null):(t=a.treeContext,is=lr(r.nextSibling),es=e,ns=!0,rs=null,null!==t&&(Vr[Wr++]=Yr,Vr[Wr++]=Xr,Vr[Wr++]=Kr,Yr=t.id,Xr=t.overflow,Kr=e),e=Fo(e,n.children),e.flags|=4096,e)}(t,e,l,r,n,a,i);if(o){o=r.fallback,l=e.mode,n=(a=t.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&e.child!==a?((r=e.child).childLanes=0,r.pendingProps=c,e.deletions=null):(r=Cc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==n?o=Cc(n,o):(o=Nc(o,l,i,null)).flags|=2,o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,l=null===(l=t.child.memoizedState)?Oo(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=t.childLanes&~i,e.memoizedState=No,r}return t=(o=t.child).sibling,r=Cc(o,{mode:"visible",children:r.children}),0===(1&e.mode)&&(r.lanes=i),r.return=e,r.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=r,e.memoizedState=null,r}function Fo(t,e){return(e=Oc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Bo(t,e,i,n){return null!==n&&fs(n),bs(e,t.child,null,i),(t=Fo(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Uo(t,e,i){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),_s(t.return,e,i)}function jo(t,e,i,n,r){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function $o(t,e,i){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(bo(t,e,n.children,i),0!==(2&(n=Js.current)))n=1&n|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Uo(t,i,e);else if(19===t.tag)Uo(t,i,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Tr(Js,n),0===(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(i=e.child,r=null;null!==i;)null!==(t=i.alternate)&&null===Zs(t)&&(r=i),i=i.sibling;null===(i=r)?(r=e.child,e.child=null):(r=i.sibling,i.sibling=null),jo(e,!1,r,i,s);break;case"backwards":for(i=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===Zs(t)){e.child=r;break}t=r.sibling,r.sibling=i,i=r,r=t}jo(e,!0,i,null,s);break;case"together":jo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function zo(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ho(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Ol|=e.lanes,0===(i&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(i=Cc(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Cc(t,t.pendingProps)).return=e;i.sibling=null}return e.child}function qo(t,e){if(!ns)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?e||null===t.tail?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Go(t){var e=null!==t.alternate&&t.alternate.child===t.child,i=0,n=0;if(e)for(var r=t.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=n,t.childLanes=i,e}function Vo(t,e,i){var n=e.pendingProps;switch(ts(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(e),null;case 1:case 17:return Ir(e.type)&&Cr(),Go(e),null;case 3:return n=e.stateNode,Ys(),Lr(kr),Lr(_r),ea(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||(us(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==rs&&(sc(rs),rs=null))),Io(t,e),Go(e),null;case 5:Qs(e);var r=Ws(Vs.current);if(i=e.type,null!==t&&null!=e.stateNode)Co(t,e,i,n,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(null===e.stateNode)throw Error(s(166));return Go(e),null}if(t=Ws(qs.current),us(e)){n=e.stateNode,i=e.type;var a=e.memoizedProps;switch(n[hr]=e,n[dr]=a,t=0!==(1&e.mode),i){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(r=0;r<Nn.length;r++)Bn(Nn[r],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":X(n,a),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Bn("invalid",n);break;case"textarea":rt(n,a),Bn("invalid",n)}for(var l in vt(i,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qn(n.textContent,c,t),r=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qn(n.textContent,c,t),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bn("scroll",n)}switch(i){case"input":V(n),Z(n,a,!0);break;case"textarea":V(n),at(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=Jn)}n=r,e.updateQueue=n,null!==n&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=ot(i)),"http://www.w3.org/1999/xhtml"===t?"script"===i?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof n.is?t=l.createElement(i,{is:n.is}):(t=l.createElement(i),"select"===i&&(l=t,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):t=l.createElementNS(t,i),t[hr]=e,t[dr]=n,Ro(t,e,!1,!1),e.stateNode=t;t:{switch(l=yt(i,n),i){case"dialog":Bn("cancel",t),Bn("close",t),r=n;break;case"iframe":case"object":case"embed":Bn("load",t),r=n;break;case"video":case"audio":for(r=0;r<Nn.length;r++)Bn(Nn[r],t);r=n;break;case"source":Bn("error",t),r=n;break;case"img":case"image":case"link":Bn("error",t),Bn("load",t),r=n;break;case"details":Bn("toggle",t),r=n;break;case"input":X(t,n),r=Y(t,n),Bn("invalid",t);break;case"option":default:r=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},r=F({},n,{value:void 0}),Bn("invalid",t);break;case"textarea":rt(t,n),r=nt(t,n),Bn("invalid",t)}for(a in vt(i,r),c=r)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?gt(t,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ut(t,u):"children"===a?"string"===typeof u?("textarea"!==i||""!==u)&&ht(t,u):"number"===typeof u&&ht(t,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Bn("scroll",t):null!=u&&b(t,a,u,l))}switch(i){case"input":V(t),Z(t,n,!1);break;case"textarea":V(t),at(t);break;case"option":null!=n.value&&t.setAttribute("value",""+q(n.value));break;case"select":t.multiple=!!n.multiple,null!=(a=n.value)?it(t,!!n.multiple,a,!1):null!=n.defaultValue&&it(t,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(t.onclick=Jn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break t;case"img":n=!0;break t;default:n=!1}}n&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Go(e),null;case 6:if(t&&null!=e.stateNode)Do(t,e,t.memoizedProps,n);else{if("string"!==typeof n&&null===e.stateNode)throw Error(s(166));if(i=Ws(Vs.current),Ws(qs.current),us(e)){if(n=e.stateNode,i=e.memoizedProps,n[hr]=e,(a=n.nodeValue!==i)&&null!==(t=es))switch(t.tag){case 3:Qn(n.nodeValue,i,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qn(n.nodeValue,i,0!==(1&t.mode))}a&&(e.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[hr]=e,e.stateNode=n}return Go(e),null;case 13:if(Lr(Js),n=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ns&&null!==is&&0!==(1&e.mode)&&0===(128&e.flags))hs(),ds(),e.flags|=98560,a=!1;else if(a=us(e),null!==n&&null!==n.dehydrated){if(null===t){if(!a)throw Error(s(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hr]=e}else ds(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Go(e),a=!1}else null!==rs&&(sc(rs),rs=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=i,e):((n=null!==n)!==(null!==t&&null!==t.memoizedState)&&n&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&Js.current)?0===Dl&&(Dl=3):pc())),null!==e.updateQueue&&(e.flags|=4),Go(e),null);case 4:return Ys(),Io(t,e),null===t&&$n(e.stateNode.containerInfo),Go(e),null;case 10:return As(e.type._context),Go(e),null;case 19:if(Lr(Js),null===(a=e.memoizedState))return Go(e),null;if(n=0!==(128&e.flags),null===(l=a.rendering))if(n)qo(a,!1);else{if(0!==Dl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=Zs(t))){for(e.flags|=128,qo(a,!1),null!==(n=l.updateQueue)&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=i,i=e.child;null!==i;)t=n,(a=i).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Tr(Js,1&Js.current|2),e.child}t=t.sibling}null!==a.tail&&Xt()>$l&&(e.flags|=128,n=!0,qo(a,!1),e.lanes=4194304)}else{if(!n)if(null!==(t=Zs(l))){if(e.flags|=128,n=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),qo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ns)return Go(e),null}else 2*Xt()-a.renderingStartTime>$l&&1073741824!==i&&(e.flags|=128,n=!0,qo(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(i=a.last)?i.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Xt(),e.sibling=null,i=Js.current,Tr(Js,n?1&i|2:1&i),e):(Go(e),null);case 22:case 23:return uc(),n=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==n&&(e.flags|=8192),n&&0!==(1&e.mode)?0!==(1073741824&Il)&&(Go(e),6&e.subtreeFlags&&(e.flags|=8192)):Go(e),null;case 24:case 25:return null}throw Error(s(156,e.tag))}function Wo(t,e){switch(ts(e),e.tag){case 1:return Ir(e.type)&&Cr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Ys(),Lr(kr),Lr(_r),ea(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Qs(e),null;case 13:if(Lr(Js),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(s(340));ds()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Lr(Js),null;case 4:return Ys(),null;case 10:return As(e.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ro=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Io=function(){},Co=function(t,e,i,n){var r=t.memoizedProps;if(r!==n){t=e.stateNode,Ws(qs.current);var s,a=null;switch(i){case"input":r=Y(t,r),n=Y(t,n),a=[];break;case"select":r=F({},r,{value:void 0}),n=F({},n,{value:void 0}),a=[];break;case"textarea":r=nt(t,r),n=nt(t,n),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(t.onclick=Jn)}for(u in vt(i,n),i=null,r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(i||(i={}),i[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=r?r[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(i||(i={}),i[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(i||(i={}),i[s]=c[s])}else i||(a||(a=[]),a.push(u,i)),i=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Bn("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}i&&(a=a||[]).push("style",i);var u=a;(e.updateQueue=u)&&(e.flags|=4)}},Do=function(t,e,i,n){i!==n&&(e.flags|=4)};var Ko=!1,Yo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,Qo=null;function Jo(t,e){var i=t.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(Ny){Ec(t,e,Ny)}else i.current=null}function Zo(t,e,i){try{i()}catch(Ny){Ec(t,e,Ny)}}var tl=!1;function el(t,e,i){var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,void 0!==s&&Zo(e,i,s)}r=r.next}while(r!==n)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function nl(t){var e=t.ref;if(null!==e){var i=t.stateNode;t.tag,t=i,"function"===typeof e?e(t):e.current=t}}function rl(t){var e=t.alternate;null!==e&&(t.alternate=null,rl(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[hr],delete e[dr],delete e[pr],delete e[gr],delete e[mr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sl(t){return 5===t.tag||3===t.tag||4===t.tag}function al(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||sl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ol(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!==(i=i._reactRootContainer)&&void 0!==i||null!==e.onclick||(e.onclick=Jn));else if(4!==n&&null!==(t=t.child))for(ol(t,e,i),t=t.sibling;null!==t;)ol(t,e,i),t=t.sibling}function ll(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==n&&null!==(t=t.child))for(ll(t,e,i),t=t.sibling;null!==t;)ll(t,e,i),t=t.sibling}var cl=null,ul=!1;function hl(t,e,i){for(i=i.child;null!==i;)dl(t,e,i),i=i.sibling}function dl(t,e,i){if(re&&"function"===typeof re.onCommitFiberUnmount)try{re.onCommitFiberUnmount(ne,i)}catch(Iy){}switch(i.tag){case 5:Yo||Jo(i,e);case 6:var n=cl,r=ul;cl=null,hl(t,e,i),ul=r,null!==(cl=n)&&(ul?(t=cl,i=i.stateNode,8===t.nodeType?t.parentNode.removeChild(i):t.removeChild(i)):cl.removeChild(i.stateNode));break;case 18:null!==cl&&(ul?(t=cl,i=i.stateNode,8===t.nodeType?or(t.parentNode,i):1===t.nodeType&&or(t,i),$e(t)):or(cl,i.stateNode));break;case 4:n=cl,r=ul,cl=i.stateNode.containerInfo,ul=!0,hl(t,e,i),cl=n,ul=r;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&Zo(i,e,a),r=r.next}while(r!==n)}hl(t,e,i);break;case 1:if(!Yo&&(Jo(i,e),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(Iy){Ec(i,e,Iy)}hl(t,e,i);break;case 21:hl(t,e,i);break;case 22:1&i.mode?(Yo=(n=Yo)||null!==i.memoizedState,hl(t,e,i),Yo=n):hl(t,e,i);break;default:hl(t,e,i)}}function fl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Xo),e.forEach((function(e){var n=_c.bind(null,t,e);i.has(e)||(i.add(e),e.then(n,n))}))}}function pl(t,e){var i=e.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var a=t,o=e,l=o;t:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,ul=!1;break t;case 3:case 4:cl=l.stateNode.containerInfo,ul=!0;break t}l=l.return}if(null===cl)throw Error(s(160));dl(a,o,r),cl=null,ul=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(Cy){Ec(r,e,Cy)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var i=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pl(e,t),ml(t),4&n){try{el(3,t,t.return),il(3,t)}catch(lS){Ec(t,t.return,lS)}try{el(5,t,t.return)}catch(lS){Ec(t,t.return,lS)}}break;case 1:pl(e,t),ml(t),512&n&&null!==i&&Jo(i,i.return);break;case 5:if(pl(e,t),ml(t),512&n&&null!==i&&Jo(i,i.return),32&t.flags){var r=t.stateNode;try{ht(r,"")}catch(lS){Ec(t,t.return,lS)}}if(4&n&&null!=(r=t.stateNode)){var a=t.memoizedProps,o=null!==i?i.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(r,a),yt(l,o);var u=yt(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?gt(r,d):"dangerouslySetInnerHTML"===h?ut(r,d):"children"===h?ht(r,d):b(r,h,d,u)}switch(l){case"input":J(r,a);break;case"textarea":st(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?it(r,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?it(r,!!a.multiple,a.defaultValue,!0):it(r,!!a.multiple,a.multiple?[]:"",!1))}r[dr]=a}catch(lS){Ec(t,t.return,lS)}}break;case 6:if(pl(e,t),ml(t),4&n){if(null===t.stateNode)throw Error(s(162));r=t.stateNode,a=t.memoizedProps;try{r.nodeValue=a}catch(lS){Ec(t,t.return,lS)}}break;case 3:if(pl(e,t),ml(t),4&n&&null!==i&&i.memoizedState.isDehydrated)try{$e(e.containerInfo)}catch(lS){Ec(t,t.return,lS)}break;case 4:default:pl(e,t),ml(t);break;case 13:pl(e,t),ml(t),8192&(r=t.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(jl=Xt())),4&n&&fl(t);break;case 22:if(h=null!==i&&null!==i.memoizedState,1&t.mode?(Yo=(u=Yo)||h,pl(e,t),Yo=u):pl(e,t),ml(t),8192&n){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for(Qo=t,h=t.child;null!==h;){for(d=Qo=h;null!==Qo;){switch(p=(f=Qo).child,f.tag){case 0:case 11:case 14:case 15:el(4,f,f.return);break;case 1:Jo(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){n=f,i=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(lS){Ec(n,i,lS)}}break;case 5:Jo(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(d);continue}}null!==p?(p.return=f,Qo=p):Sl(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pt("display",o))}catch(lS){Ec(t,t.return,lS)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(lS){Ec(t,t.return,lS)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(e,t),ml(t),4&n&&fl(t);case 21:}}function ml(t){var e=t.flags;if(2&e){try{t:{for(var i=t.return;null!==i;){if(sl(i)){var n=i;break t}i=i.return}throw Error(s(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(ht(r,""),n.flags&=-33),ll(t,al(t),r);break;case 3:case 4:var a=n.stateNode.containerInfo;ol(t,al(t),a);break;default:throw Error(s(161))}}catch(Yy){Ec(t,t.return,Yy)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function vl(t,e,i){Qo=t,yl(t,e,i)}function yl(t,e,i){for(var n=0!==(1&t.mode);null!==Qo;){var r=Qo,s=r.child;if(22===r.tag&&n){var a=null!==r.memoizedState||Ko;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Ko;var c=Yo;if(Ko=a,(Yo=l)&&!c)for(Qo=r;null!==Qo;)l=(a=Qo).child,22===a.tag&&null!==a.memoizedState?wl(r):null!==l?(l.return=a,Qo=l):wl(r);for(;null!==s;)Qo=s,yl(s,e,i),s=s.sibling;Qo=r,Ko=o,Yo=c}bl(t)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Qo=s):bl(t)}}function bl(t){for(;null!==Qo;){var e=Qo;if(0!==(8772&e.flags)){var i=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Yo||il(5,e);break;case 1:var n=e.stateNode;if(4&e.flags&&!Yo)if(null===i)n.componentDidMount();else{var r=e.elementType===e.type?i.memoizedProps:to(e.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&zs(e,a,n);break;case 3:var o=e.updateQueue;if(null!==o){if(i=null,null!==e.child)switch(e.child.tag){case 5:case 1:i=e.child.stateNode}zs(e,o,i)}break;case 5:var l=e.stateNode;if(null===i&&4&e.flags){i=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&i.focus();break;case"img":c.src&&(i.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&$e(d)}}}break;default:throw Error(s(163))}Yo||512&e.flags&&nl(e)}catch(f){Ec(e,e.return,f)}}if(e===t){Qo=null;break}if(null!==(i=e.sibling)){i.return=e.return,Qo=i;break}Qo=e.return}}function Sl(t){for(;null!==Qo;){var e=Qo;if(e===t){Qo=null;break}var i=e.sibling;if(null!==i){i.return=e.return,Qo=i;break}Qo=e.return}}function wl(t){for(;null!==Qo;){var e=Qo;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{il(4,e)}catch(Yy){Ec(e,i,Yy)}break;case 1:var n=e.stateNode;if("function"===typeof n.componentDidMount){var r=e.return;try{n.componentDidMount()}catch(Yy){Ec(e,r,Yy)}}var s=e.return;try{nl(e)}catch(Yy){Ec(e,s,Yy)}break;case 5:var a=e.return;try{nl(e)}catch(Yy){Ec(e,a,Yy)}}}catch(Yy){Ec(e,e.return,Yy)}if(e===t){Qo=null;break}var o=e.sibling;if(null!==o){o.return=e.return,Qo=o;break}Qo=e.return}}var xl,El=Math.ceil,Ll=S.ReactCurrentDispatcher,Tl=S.ReactCurrentOwner,Al=S.ReactCurrentBatchConfig,_l=0,kl=null,Pl=null,Rl=0,Il=0,Cl=Er(0),Dl=0,Nl=null,Ol=0,Ml=0,Fl=0,Bl=null,Ul=null,jl=0,$l=1/0,zl=null,Hl=!1,ql=null,Gl=null,Vl=!1,Wl=null,Kl=0,Yl=0,Xl=null,Ql=-1,Jl=0;function Zl(){return 0!==(6&_l)?Xt():-1!==Ql?Ql:Ql=Xt()}function tc(t){return 0===(1&t.mode)?1:0!==(2&_l)&&0!==Rl?Rl&-Rl:null!==ps.transition?(0===Jl&&(Jl=pe()),Jl):0!==(t=ye)?t:t=void 0===(t=window.event)?16:Ye(t.type)}function ec(t,e,i,n){if(50<Yl)throw Yl=0,Xl=null,Error(s(185));me(t,i,n),0!==(2&_l)&&t===kl||(t===kl&&(0===(2&_l)&&(Ml|=i),4===Dl&&ac(t,Rl)),ic(t,n),1===i&&0===_l&&0===(1&e.mode)&&($l=Xt()+500,Br&&$r()))}function ic(t,e){var i=t.callbackNode;!function(t,e){for(var i=t.suspendedLanes,n=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-se(s),o=1<<a,l=r[a];-1===l?0!==(o&i)&&0===(o&n)||(r[a]=de(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}(t,e);var n=he(t,t===kl?Rl:0);if(0===n)null!==i&&Wt(i),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(null!=i&&Wt(i),1===e)0===t.tag?function(t){Br=!0,jr(t)}(oc.bind(null,t)):jr(oc.bind(null,t)),sr((function(){0===(6&_l)&&$r()})),i=null;else{switch(be(n)){case 1:i=Jt;break;case 4:i=Zt;break;case 16:default:i=te;break;case 536870912:i=ie}i=kc(i,nc.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function nc(t,e){if(Ql=-1,Jl=0,0!==(6&_l))throw Error(s(327));var i=t.callbackNode;if(wc()&&t.callbackNode!==i)return null;var n=he(t,t===kl?Rl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&t.expiredLanes)||e)e=gc(t,n);else{e=n;var r=_l;_l|=2;var a=fc();for(kl===t&&Rl===e||(zl=null,$l=Xt()+500,hc(t,e));;)try{vc();break}catch(Iy){dc(t,Iy)}Ts(),Ll.current=a,_l=r,null!==Pl?e=0:(kl=null,Rl=0,e=Dl)}if(0!==e){if(2===e&&(0!==(r=fe(t))&&(n=r,e=rc(t,r))),1===e)throw i=Nl,hc(t,0),ac(t,n),ic(t,Xt()),i;if(6===e)ac(t,n);else{if(r=t.current.alternate,0===(30&n)&&!function(t){for(var e=t;;){if(16384&e.flags){var i=e.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!an(s(),r))return!1}catch(o){return!1}}}if(i=e.child,16384&e.subtreeFlags&&null!==i)i.return=e,e=i;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=gc(t,n))&&(0!==(a=fe(t))&&(n=a,e=rc(t,a))),1===e))throw i=Nl,hc(t,0),ac(t,n),ic(t,Xt()),i;switch(t.finishedWork=r,t.finishedLanes=n,e){case 0:case 1:throw Error(s(345));case 2:case 5:Sc(t,Ul,zl);break;case 3:if(ac(t,n),(130023424&n)===n&&10<(e=jl+500-Xt())){if(0!==he(t,0))break;if(((r=t.suspendedLanes)&n)!==n){Zl(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(Sc.bind(null,t,Ul,zl),e);break}Sc(t,Ul,zl);break;case 4:if(ac(t,n),(4194240&n)===n)break;for(e=t.eventTimes,r=-1;0<n;){var o=31-se(n);a=1<<o,(o=e[o])>r&&(r=o),n&=~a}if(n=r,10<(n=(120>(n=Xt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*El(n/1960))-n)){t.timeoutHandle=ir(Sc.bind(null,t,Ul,zl),n);break}Sc(t,Ul,zl);break;default:throw Error(s(329))}}}return ic(t,Xt()),t.callbackNode===i?nc.bind(null,t):null}function rc(t,e){var i=Bl;return t.current.memoizedState.isDehydrated&&(hc(t,e).flags|=256),2!==(t=gc(t,e))&&(e=Ul,Ul=i,null!==e&&sc(e)),t}function sc(t){null===Ul?Ul=t:Ul.push.apply(Ul,t)}function ac(t,e){for(e&=~Fl,e&=~Ml,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-se(e),n=1<<i;t[i]=-1,e&=~n}}function oc(t){if(0!==(6&_l))throw Error(s(327));wc();var e=he(t,0);if(0===(1&e))return ic(t,Xt()),null;var i=gc(t,e);if(0!==t.tag&&2===i){var n=fe(t);0!==n&&(e=n,i=rc(t,n))}if(1===i)throw i=Nl,hc(t,0),ac(t,e),ic(t,Xt()),i;if(6===i)throw Error(s(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sc(t,Ul,zl),ic(t,Xt()),null}function lc(t,e){var i=_l;_l|=1;try{return t(e)}finally{0===(_l=i)&&($l=Xt()+500,Br&&$r())}}function cc(t){null!==Wl&&0===Wl.tag&&0===(6&_l)&&wc();var e=_l;_l|=1;var i=Al.transition,n=ye;try{if(Al.transition=null,ye=1,t)return t()}finally{ye=n,Al.transition=i,0===(6&(_l=e))&&$r()}}function uc(){Il=Cl.current,Lr(Cl)}function hc(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,nr(i)),null!==Pl)for(i=Pl.return;null!==i;){var n=i;switch(ts(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Cr();break;case 3:Ys(),Lr(kr),Lr(_r),ea();break;case 5:Qs(n);break;case 4:Ys();break;case 13:case 19:Lr(Js);break;case 10:As(n.type._context);break;case 22:case 23:uc()}i=i.return}if(kl=t,Pl=t=Cc(t.current,null),Rl=Il=e,Dl=0,Nl=null,Fl=Ml=Ol=0,Ul=Bl=null,null!==Rs){for(e=0;e<Rs.length;e++)if(null!==(n=(i=Rs[e]).interleaved)){i.interleaved=null;var r=n.next,s=i.pending;if(null!==s){var a=s.next;s.next=r,n.next=a}i.pending=n}Rs=null}return t}function dc(t,e){for(;;){var i=Pl;try{if(Ts(),ia.current=Xa,la){for(var n=sa.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}la=!1}if(ra=0,oa=aa=sa=null,ca=!1,ua=0,Tl.current=null,null===i||null===i.return){Dl=1,Nl=e,Pl=null;break}t:{var a=t,o=i.return,l=i,c=e;if(e=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,mo(p,o,l,0,e),1&p.mode&&po(a,u,e),c=u;var g=(e=p).updateQueue;if(null===g){var m=new Set;m.add(c),e.updateQueue=m}else g.add(c);break t}if(0===(1&e)){po(a,u,e),pc();break t}c=Error(s(426))}else if(ns&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),mo(v,o,l,0,e),fs(oo(c,l));break t}}a=c=oo(c,l),4!==Dl&&(Dl=2),null===Bl?Bl=[a]:Bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,js(a,ho(0,c,e));break t;case 1:l=c;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Gl||!Gl.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e,js(a,fo(a,l,e));break t}}a=a.return}while(null!==a)}bc(i)}catch(S){e=S,Pl===i&&null!==i&&(Pl=i=i.return);continue}break}}function fc(){var t=Ll.current;return Ll.current=Xa,null===t?Xa:t}function pc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===kl||0===(268435455&Ol)&&0===(268435455&Ml)||ac(kl,Rl)}function gc(t,e){var i=_l;_l|=2;var n=fc();for(kl===t&&Rl===e||(zl=null,hc(t,e));;)try{mc();break}catch(r){dc(t,r)}if(Ts(),_l=i,Ll.current=n,null!==Pl)throw Error(s(261));return kl=null,Rl=0,Dl}function mc(){for(;null!==Pl;)yc(Pl)}function vc(){for(;null!==Pl&&!Kt();)yc(Pl)}function yc(t){var e=xl(t.alternate,t,Il);t.memoizedProps=t.pendingProps,null===e?bc(t):Pl=e,Tl.current=null}function bc(t){var e=t;do{var i=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(i=Vo(i,e,Il)))return void(Pl=i)}else{if(null!==(i=Wo(i,e)))return i.flags&=32767,void(Pl=i);if(null===t)return Dl=6,void(Pl=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Pl=e);Pl=e=t}while(null!==e);0===Dl&&(Dl=5)}function Sc(t,e,i){var n=ye,r=Al.transition;try{Al.transition=null,ye=1,function(t,e,i,n){do{wc()}while(null!==Wl);if(0!==(6&_l))throw Error(s(327));i=t.finishedWork;var r=t.finishedLanes;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(s(177));t.callbackNode=null,t.callbackPriority=0;var a=i.lanes|i.childLanes;if(function(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<i;){var r=31-se(i),s=1<<r;e[r]=0,n[r]=-1,t[r]=-1,i&=~s}}(t,a),t===kl&&(Pl=kl=null,Rl=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Vl||(Vl=!0,kc(te,(function(){return wc(),null}))),a=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=ye;ye=1;var l=_l;_l|=4,Tl.current=null,function(t,e){if(Zn=He,dn(t=hn())){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{var n=(i=(i=t.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{i.nodeType,a.nodeType}catch(Qy){i=null;break t}var o=0,l=-1,c=-1,u=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==i||0!==r&&3!==d.nodeType||(l=o+r),d!==a||0!==n&&3!==d.nodeType||(c=o+n),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===i&&++u===r&&(l=o),f===a&&++h===n&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:t,selectionRange:i},He=!1,Qo=e;null!==Qo;)if(t=(e=Qo).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Qo=t;else for(;null!==Qo;){e=Qo;try{var g=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:to(e.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;1===S.nodeType?S.textContent="":9===S.nodeType&&S.documentElement&&S.removeChild(S.documentElement);break;default:throw Error(s(163))}}catch(Qy){Ec(e,e.return,Qy)}if(null!==(t=e.sibling)){t.return=e.return,Qo=t;break}Qo=e.return}g=tl,tl=!1}(t,i),gl(i,t),fn(tr),He=!!Zn,tr=Zn=null,t.current=i,vl(i,t,r),Yt(),_l=l,ye=o,Al.transition=a}else t.current=i;if(Vl&&(Vl=!1,Wl=t,Kl=r),a=t.pendingLanes,0===a&&(Gl=null),function(t){if(re&&"function"===typeof re.onCommitFiberRoot)try{re.onCommitFiberRoot(ne,t,void 0,128===(128&t.current.flags))}catch(e){}}(i.stateNode),ic(t,Xt()),null!==e)for(n=t.onRecoverableError,i=0;i<e.length;i++)r=e[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,t=ql,ql=null,t;0!==(1&Kl)&&0!==t.tag&&wc(),a=t.pendingLanes,0!==(1&a)?t===Xl?Yl++:(Yl=0,Xl=t):Yl=0,$r()}(t,e,i,n)}finally{Al.transition=r,ye=n}return null}function wc(){if(null!==Wl){var t=be(Kl),e=Al.transition,i=ye;try{if(Al.transition=null,ye=16>t?16:t,null===Wl)var n=!1;else{if(t=Wl,Wl=null,Kl=0,0!==(6&_l))throw Error(s(331));var r=_l;for(_l|=4,Qo=t.current;null!==Qo;){var a=Qo,o=a.child;if(0!==(16&Qo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qo=u;null!==Qo;){var h=Qo;switch(h.tag){case 0:case 11:case 15:el(8,h,a)}var d=h.child;if(null!==d)d.return=h,Qo=d;else for(;null!==Qo;){var f=(h=Qo).sibling,p=h.return;if(rl(h),h===u){Qo=null;break}if(null!==f){f.return=p,Qo=f;break}Qo=p}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Qo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Qo=o;else t:for(;null!==Qo;){if(0!==(2048&(a=Qo).flags))switch(a.tag){case 0:case 11:case 15:el(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Qo=y;break t}Qo=a.return}}var b=t.current;for(Qo=b;null!==Qo;){var S=(o=Qo).child;if(0!==(2064&o.subtreeFlags)&&null!==S)S.return=o,Qo=S;else t:for(o=b;null!==Qo;){if(0!==(2048&(l=Qo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(x){Ec(l,l.return,x)}if(l===o){Qo=null;break t}var w=l.sibling;if(null!==w){w.return=l.return,Qo=w;break t}Qo=l.return}}if(_l=r,$r(),re&&"function"===typeof re.onPostCommitFiberRoot)try{re.onPostCommitFiberRoot(ne,t)}catch(x){}n=!0}return n}finally{ye=i,Al.transition=e}}return!1}function xc(t,e,i){t=Bs(t,e=ho(0,e=oo(i,e),1),1),e=Zl(),null!==t&&(me(t,1,e),ic(t,e))}function Ec(t,e,i){if(3===t.tag)xc(t,t,i);else for(;null!==e;){if(3===e.tag){xc(e,t,i);break}if(1===e.tag){var n=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Gl||!Gl.has(n))){e=Bs(e,t=fo(e,t=oo(i,t),1),1),t=Zl(),null!==e&&(me(e,1,t),ic(e,t));break}}e=e.return}}function Lc(t,e,i){var n=t.pingCache;null!==n&&n.delete(e),e=Zl(),t.pingedLanes|=t.suspendedLanes&i,kl===t&&(Rl&i)===i&&(4===Dl||3===Dl&&(130023424&Rl)===Rl&&500>Xt()-jl?hc(t,0):Fl|=i),ic(t,e)}function Tc(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ce,0===(130023424&(ce<<=1))&&(ce=4194304)));var i=Zl();null!==(t=Ds(t,e))&&(me(t,e,i),ic(t,i))}function Ac(t){var e=t.memoizedState,i=0;null!==e&&(i=e.retryLane),Tc(t,i)}function _c(t,e){var i=0;switch(t.tag){case 13:var n=t.stateNode,r=t.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(s(314))}null!==n&&n.delete(e),Tc(t,i)}function kc(t,e){return Vt(t,e)}function Pc(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(t,e,i,n){return new Pc(t,e,i,n)}function Ic(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Cc(t,e){var i=t.alternate;return null===i?((i=Rc(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&t.flags,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function Dc(t,e,i,n,r,a){var o=2;if(n=t,"function"===typeof t)Ic(t)&&(o=1);else if("string"===typeof t)o=5;else t:switch(t){case E:return Nc(i.children,r,a,e);case L:o=8,r|=8;break;case T:return(t=Rc(12,i,e,2|r)).elementType=T,t.lanes=a,t;case P:return(t=Rc(13,i,e,r)).elementType=P,t.lanes=a,t;case R:return(t=Rc(19,i,e,r)).elementType=R,t.lanes=a,t;case D:return Oc(i,r,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case A:o=10;break t;case _:o=9;break t;case k:o=11;break t;case I:o=14;break t;case C:o=16,n=null;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=Rc(o,i,e,r)).elementType=t,e.type=n,e.lanes=a,e}function Nc(t,e,i,n){return(t=Rc(7,t,n,e)).lanes=i,t}function Oc(t,e,i,n){return(t=Rc(22,t,n,e)).elementType=D,t.lanes=i,t.stateNode={isHidden:!1},t}function Mc(t,e,i){return(t=Rc(6,t,null,e)).lanes=i,t}function Fc(t,e,i){return(e=Rc(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Bc(t,e,i,n,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Uc(t,e,i,n,r,s,a,o,l){return t=new Bc(t,e,i,o,l),1===e?(e=1,!0===s&&(e|=8)):e=0,s=Rc(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Os(s),t}function jc(t){if(!t)return Ar;t:{if($t(t=t._reactInternals)!==t||1!==t.tag)throw Error(s(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ir(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(s(171))}if(1===t.tag){var i=t.type;if(Ir(i))return Nr(t,i,e)}return e}function $c(t,e,i,n,r,s,a,o,l){return(t=Uc(i,n,!0,t,0,s,0,o,l)).context=jc(null),i=t.current,(s=Fs(n=Zl(),r=tc(i))).callback=void 0!==e&&null!==e?e:null,Bs(i,s,r),t.current.lanes=r,me(t,r,n),ic(t,n),t}function zc(t,e,i,n){var r=e.current,s=Zl(),a=tc(r);return i=jc(i),null===e.context?e.context=i:e.pendingContext=i,(e=Fs(s,a)).payload={element:t},null!==(n=void 0===n?null:n)&&(e.callback=n),null!==(t=Bs(r,e,a))&&(ec(t,r,a,s),Us(t,r,a)),a}function Hc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function qc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function Gc(t,e){qc(t,e),(t=t.alternate)&&qc(t,e)}xl=function(t,e,i){if(null!==t)if(t.memoizedProps!==e.pendingProps||kr.current)yo=!0;else{if(0===(t.lanes&i)&&0===(128&e.flags))return yo=!1,function(t,e,i){switch(e.tag){case 3:ko(e),ds();break;case 5:Xs(e);break;case 1:Ir(e.type)&&Or(e);break;case 4:Ks(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;Tr(ws,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=e.memoizedState))return null!==n.dehydrated?(Tr(Js,1&Js.current),e.flags|=128,null):0!==(i&e.child.childLanes)?Mo(t,e,i):(Tr(Js,1&Js.current),null!==(t=Ho(t,e,i))?t.sibling:null);Tr(Js,1&Js.current);break;case 19:if(n=0!==(i&e.childLanes),0!==(128&t.flags)){if(n)return $o(t,e,i);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Tr(Js,Js.current),n)break;return null;case 22:case 23:return e.lanes=0,Eo(t,e,i)}return Ho(t,e,i)}(t,e,i);yo=0!==(131072&t.flags)}else yo=!1,ns&&0!==(1048576&e.flags)&&Jr(e,Gr,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;zo(t,e),t=e.pendingProps;var r=Rr(e,_r.current);ks(e,i),r=pa(null,e,n,t,r,i);var a=ga();return e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ir(n)?(a=!0,Or(e)):a=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Os(e),r.updater=io,e.stateNode=r,r._reactInternals=e,ao(e,n,t,i),e=_o(null,e,n,!0,a,i)):(e.tag=0,ns&&a&&Zr(e),bo(null,e,r,i),e=e.child),e;case 16:n=e.elementType;t:{switch(zo(t,e),t=e.pendingProps,n=(r=n._init)(n._payload),e.type=n,r=e.tag=function(t){if("function"===typeof t)return Ic(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===k)return 11;if(t===I)return 14}return 2}(n),t=to(n,t),r){case 0:e=To(null,e,n,t,i);break t;case 1:e=Ao(null,e,n,t,i);break t;case 11:e=So(null,e,n,t,i);break t;case 14:e=wo(null,e,n,to(n.type,t),i);break t}throw Error(s(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,To(t,e,n,r=e.elementType===n?r:to(n,r),i);case 1:return n=e.type,r=e.pendingProps,Ao(t,e,n,r=e.elementType===n?r:to(n,r),i);case 3:t:{if(ko(e),null===t)throw Error(s(387));n=e.pendingProps,r=(a=e.memoizedState).element,Ms(t,e),$s(e,n,null,i);var o=e.memoizedState;if(n=o.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Po(t,e,n,i,r=oo(Error(s(423)),e));break t}if(n!==r){e=Po(t,e,n,i,r=oo(Error(s(424)),e));break t}for(is=lr(e.stateNode.containerInfo.firstChild),es=e,ns=!0,rs=null,i=Ss(e,null,n,i),e.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(ds(),n===r){e=Ho(t,e,i);break t}bo(t,e,n,i)}e=e.child}return e;case 5:return Xs(e),null===t&&ls(e),n=e.type,r=e.pendingProps,a=null!==t?t.memoizedProps:null,o=r.children,er(n,r)?o=null:null!==a&&er(n,a)&&(e.flags|=32),Lo(t,e),bo(t,e,o,i),e.child;case 6:return null===t&&ls(e),null;case 13:return Mo(t,e,i);case 4:return Ks(e,e.stateNode.containerInfo),n=e.pendingProps,null===t?e.child=bs(e,null,n,i):bo(t,e,n,i),e.child;case 11:return n=e.type,r=e.pendingProps,So(t,e,n,r=e.elementType===n?r:to(n,r),i);case 7:return bo(t,e,e.pendingProps,i),e.child;case 8:case 12:return bo(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(n=e.type._context,r=e.pendingProps,a=e.memoizedProps,o=r.value,Tr(ws,n._currentValue),n._currentValue=o,null!==a)if(an(a.value,o)){if(a.children===r.children&&!kr.current){e=Ho(t,e,i);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===a.tag){(c=Fs(-1,i&-i)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=i,null!==(c=a.alternate)&&(c.lanes|=i),_s(a.return,i,e),l.lanes|=i;break}c=c.next}}else if(10===a.tag)o=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),_s(o,i,e),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(t,e,r.children,i),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,ks(e,i),n=n(r=Ps(r)),e.flags|=1,bo(t,e,n,i),e.child;case 14:return r=to(n=e.type,e.pendingProps),wo(t,e,n,r=to(n.type,r),i);case 15:return xo(t,e,e.type,e.pendingProps,i);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:to(n,r),zo(t,e),e.tag=1,Ir(n)?(t=!0,Or(e)):t=!1,ks(e,i),ro(e,n,r),ao(e,n,r,i),_o(null,e,n,!0,t,i);case 19:return $o(t,e,i);case 22:return Eo(t,e,i)}throw Error(s(156,e.tag))};var Vc="function"===typeof reportError?reportError:function(t){console.error(t)};function Wc(t){this._internalRoot=t}function Kc(t){this._internalRoot=t}function Yc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Xc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Qc(){}function Jc(t,e,i,n,r){var s=i._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var t=Hc(a);o.call(t)}}zc(e,a,t,r)}else a=function(t,e,i,n,r){if(r){if("function"===typeof n){var s=n;n=function(){var t=Hc(a);s.call(t)}}var a=$c(e,n,t,0,null,!1,0,"",Qc);return t._reactRootContainer=a,t[fr]=a.current,$n(8===t.nodeType?t.parentNode:t),cc(),a}for(;r=t.lastChild;)t.removeChild(r);if("function"===typeof n){var o=n;n=function(){var t=Hc(l);o.call(t)}}var l=Uc(t,0,!1,null,0,!1,0,"",Qc);return t._reactRootContainer=l,t[fr]=l.current,$n(8===t.nodeType?t.parentNode:t),cc((function(){zc(e,l,i,n)})),l}(i,e,t,r,n);return Hc(a)}Kc.prototype.render=Wc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(s(409));zc(t,e,null,null)},Kc.prototype.unmount=Wc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;cc((function(){zc(null,t,null,null)})),e[fr]=null}},Kc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ee();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Ce.length&&0!==e&&e<Ce[i].priority;i++);Ce.splice(i,0,t),0===i&&Me(t)}},Se=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=ue(e.pendingLanes);0!==i&&(ve(e,1|i),ic(e,Xt()),0===(6&_l)&&($l=Xt()+500,$r()))}break;case 13:cc((function(){var e=Ds(t,1);if(null!==e){var i=Zl();ec(e,t,1,i)}})),Gc(t,1)}},we=function(t){if(13===t.tag){var e=Ds(t,134217728);if(null!==e)ec(e,t,134217728,Zl());Gc(t,134217728)}},xe=function(t){if(13===t.tag){var e=tc(t),i=Ds(t,e);if(null!==i)ec(i,t,e,Zl());Gc(t,e)}},Ee=function(){return ye},Le=function(t,e){var i=ye;try{return ye=t,e()}finally{ye=i}},wt=function(t,e,i){switch(e){case"input":if(J(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var r=Sr(n);if(!r)throw Error(s(90));W(n),J(n,r)}}}break;case"textarea":st(t,i);break;case"select":null!=(e=i.value)&&it(t,!!i.multiple,e,!1)}},_t=lc,kt=cc;var Zc={usingClientEntryPoint:!1,Events:[yr,br,Sr,Tt,At,lc]},tu={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=qt(t))?null:t.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{ne=iu.inject(eu),re=iu}catch(Ay){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,e.createPortal=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(e))throw Error(s(200));return function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==n?null:""+n,children:t,containerInfo:e,implementation:i}}(t,e,null,i)},e.createRoot=function(t,e){if(!Yc(t))throw Error(s(299));var i=!1,n="",r=Vc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(i=!0),void 0!==e.identifierPrefix&&(n=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=Uc(t,1,!1,null,0,i,0,n,r),t[fr]=e.current,$n(8===t.nodeType?t.parentNode:t),new Wc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw t=Object.keys(t).join(","),Error(s(268,t))}return t=null===(t=qt(e))?null:t.stateNode},e.flushSync=function(t){return cc(t)},e.hydrate=function(t,e,i){if(!Xc(e))throw Error(s(200));return Jc(null,t,e,!0,i)},e.hydrateRoot=function(t,e,i){if(!Yc(t))throw Error(s(405));var n=null!=i&&i.hydratedSources||null,r=!1,a="",o=Vc;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(a=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),e=$c(e,null,t,1,null!=i?i:null,r,0,a,o),t[fr]=e.current,$n(t),n)for(t=0;t<n.length;t++)r=(r=(i=n[t])._getVersion)(i._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[i,r]:e.mutableSourceEagerHydrationData.push(i,r);return new Kc(e)},e.render=function(t,e,i){if(!Xc(e))throw Error(s(200));return Jc(null,t,e,!1,i)},e.unmountComponentAtNode=function(t){if(!Xc(t))throw Error(s(40));return!!t._reactRootContainer&&(cc((function(){Jc(null,null,t,!1,(function(){t._reactRootContainer=null,t[fr]=null}))})),!0)},e.unstable_batchedUpdates=lc,e.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!Xc(i))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return Jc(t,e,i,!1,n)},e.version="18.3.1-next-f1338f8080-20240426"},853:(t,e,i)=>{t.exports=i(234)},950:(t,e,i)=>{!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(ny){console.error(ny)}}(),t.exports=i(730)}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.m=t,(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var s=Object.create(null);i.r(s);var a={};t=t||[null,e({}),e([]),e(e)];for(var o=2&r&&n;"object"==typeof o&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((t=>a[t]=()=>n[t]));return a.default=()=>n,i.d(s,a),s}})(),i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,n)=>(i.f[n](t,e),e)),[])),i.u=t=>"static/js/"+t+"."+{239:"71447a4c",732:"d9120a12",977:"9e564290"}[t]+".chunk.js",i.miniCssF=t=>{},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="trazabilityapp-front:";i.l=(n,r,s,a)=>{if(t[n])t[n].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==e+s){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",e+s),o.src=n),t[n]=[r];var d=(e,i)=>{o.onerror=o.onload=null,clearTimeout(f);var r=t[n];if(delete t[n],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((t=>t(i))),e)return e(i)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.p="/",(()=>{var t={792:0};i.f.j=(e,n)=>{var r=i.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var s=new Promise(((i,n)=>r=t[e]=[i,n]));n.push(r[2]=s);var a=i.p+i.u(e),o=new Error;i.l(a,(n=>{if(i.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+e+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}}),"chunk-"+e,e)}};var e=(e,n)=>{var r,s,a=n[0],o=n[1],l=n[2],c=0;if(a.some((e=>0!==t[e]))){for(r in o)i.o(o,r)&&(i.m[r]=o[r]);if(l)l(i)}for(e&&e(n);c<a.length;c++)s=a[c],i.o(t,s)&&t[s]&&t[s][0](),t[s]=0},n=self.webpackChunktrazabilityapp_front=self.webpackChunktrazabilityapp_front||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var n={};i.r(n),i.d(n,{hasBrowserEnv:()=>_e,hasStandardBrowserEnv:()=>Pe,hasStandardBrowserWebWorkerEnv:()=>Re,navigator:()=>ke,origin:()=>Ie});var r,s=i(43),a=i.t(s,2),o=i(391),l=i(950),c=i.t(l,2);function u(){return u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},u.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(r||(r={}));const h="popstate";function d(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function f(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(i){}}}function p(t,e){return{usr:t.state,key:t.key,idx:e}}function g(t,e,i,n){return void 0===i&&(i=null),u({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?v(e):e,{state:i,key:e&&e.key||n||Math.random().toString(36).substr(2,8)})}function m(t){let{pathname:e="/",search:i="",hash:n=""}=t;return i&&"?"!==i&&(e+="?"===i.charAt(0)?i:"?"+i),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function v(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substr(i),t=t.substr(0,i));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function y(t,e,i,n){void 0===n&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l=r.Pop,c=null,f=v();function v(){return(o.state||{idx:null}).idx}function y(){l=r.Pop;let t=v(),e=null==t?null:t-f;f=t,c&&c({action:l,location:S.location,delta:e})}function b(t){let e="null"!==s.location.origin?s.location.origin:s.location.href,i="string"===typeof t?t:m(t);return i=i.replace(/ $/,"%20"),d(e,"No window.location.(origin|href) available to create URL for href: "+i),new URL(i,e)}null==f&&(f=0,o.replaceState(u({},o.state,{idx:f}),""));let S={get action(){return l},get location(){return t(s,o)},listen(t){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(h,y),c=t,()=>{s.removeEventListener(h,y),c=null}},createHref:t=>e(s,t),createURL:b,encodeLocation(t){let e=b(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){l=r.Push;let n=g(S.location,t,e);i&&i(n,t),f=v()+1;let u=p(n,f),h=S.createHref(n);try{o.pushState(u,"",h)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;s.location.assign(h)}a&&c&&c({action:l,location:S.location,delta:1})},replace:function(t,e){l=r.Replace;let n=g(S.location,t,e);i&&i(n,t),f=v();let s=p(n,f),u=S.createHref(n);o.replaceState(s,"",u),a&&c&&c({action:l,location:S.location,delta:0})},go:t=>o.go(t)};return S}var b;!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(b||(b={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function S(t,e,i){return void 0===i&&(i="/"),w(t,e,i,!1)}function w(t,e,i,n){let r=O(("string"===typeof e?v(e):e).pathname||"/",i);if(null==r)return null;let s=x(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let i=t.length===e.length&&t.slice(0,-1).every(((t,i)=>t===e[i]));return i?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let t=N(r);a=C(s[o],t,n)}return a}function x(t,e,i,n){void 0===e&&(e=[]),void 0===i&&(i=[]),void 0===n&&(n="");let r=(t,r,s)=>{let a={relativePath:void 0===s?t.path||"":s,caseSensitive:!0===t.caseSensitive,childrenIndex:r,route:t};a.relativePath.startsWith("/")&&(d(a.relativePath.startsWith(n),'Absolute route path "'+a.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(n.length));let o=j([n,a.relativePath]),l=i.concat(a);t.children&&t.children.length>0&&(d(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),x(t.children,e,l,o)),(null!=t.path||t.index)&&e.push({path:o,score:I(o,t.index),routesMeta:l})};return t.forEach(((t,e)=>{var i;if(""!==t.path&&null!=(i=t.path)&&i.includes("?"))for(let n of E(t.path))r(t,e,n);else r(t,e)})),e}function E(t){let e=t.split("/");if(0===e.length)return[];let[i,...n]=e,r=i.endsWith("?"),s=i.replace(/\?$/,"");if(0===n.length)return r?[s,""]:[s];let a=E(n.join("/")),o=[];return o.push(...a.map((t=>""===t?s:[s,t].join("/")))),r&&o.push(...a),o.map((e=>t.startsWith("/")&&""===e?"/":e))}const L=/^:[\w-]+$/,T=3,A=2,_=1,k=10,P=-2,R=t=>"*"===t;function I(t,e){let i=t.split("/"),n=i.length;return i.some(R)&&(n+=P),e&&(n+=A),i.filter((t=>!R(t))).reduce(((t,e)=>t+(L.test(e)?T:""===e?_:k)),n)}function C(t,e,i){void 0===i&&(i=!1);let{routesMeta:n}=t,r={},s="/",a=[];for(let o=0;o<n.length;++o){let t=n[o],l=o===n.length-1,c="/"===s?e:e.slice(s.length)||"/",u=D({path:t.relativePath,caseSensitive:t.caseSensitive,end:l},c),h=t.route;if(!u&&l&&i&&!n[n.length-1].route.index&&(u=D({path:t.relativePath,caseSensitive:t.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:j([s,u.pathname]),pathnameBase:$(j([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=j([s,u.pathnameBase]))}return a}function D(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[i,n]=function(t,e,i){void 0===e&&(e=!1);void 0===i&&(i=!0);f("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let n=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((t,e,i)=>(n.push({paramName:e,isOptional:null!=i}),i?"/?([^\\/]+)?":"/([^\\/]+)")));t.endsWith("*")?(n.push({paramName:"*"}),r+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?r+="\\/*$":""!==t&&"/"!==t&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,e?void 0:"i");return[s,n]}(t.path,t.caseSensitive,t.end),r=e.match(i);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=n.reduce(((t,e,i)=>{let{paramName:n,isOptional:r}=e;if("*"===n){let t=o[i]||"";a=s.slice(0,s.length-t.length).replace(/(.)\/+$/,"$1")}const l=o[i];return t[n]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),t}),{});return{params:l,pathname:s,pathnameBase:a,pattern:t}}function N(t){try{return t.split("/").map((t=>decodeURIComponent(t).replace(/\//g,"%2F"))).join("/")}catch(e){return f(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function O(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,n=t.charAt(i);return n&&"/"!==n?null:t.slice(i)||"/"}function M(t,e,i,n){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+i+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function F(t){return t.filter(((t,e)=>0===e||t.route.path&&t.route.path.length>0))}function B(t,e){let i=F(t);return e?i.map(((t,e)=>e===i.length-1?t.pathname:t.pathnameBase)):i.map((t=>t.pathnameBase))}function U(t,e,i,n){let r;void 0===n&&(n=!1),"string"===typeof t?r=v(t):(r=u({},t),d(!r.pathname||!r.pathname.includes("?"),M("?","pathname","search",r)),d(!r.pathname||!r.pathname.includes("#"),M("#","pathname","hash",r)),d(!r.search||!r.search.includes("#"),M("#","search","hash",r)));let s,a=""===t||""===r.pathname,o=a?"/":r.pathname;if(null==o)s=i;else{let t=e.length-1;if(!n&&o.startsWith("..")){let e=o.split("/");for(;".."===e[0];)e.shift(),t-=1;r.pathname=e.join("/")}s=t>=0?e[t]:"/"}let l=function(t,e){void 0===e&&(e="/");let{pathname:i,search:n="",hash:r=""}="string"===typeof t?v(t):t,s=i?i.startsWith("/")?i:function(t,e){let i=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((t=>{".."===t?i.length>1&&i.pop():"."!==t&&i.push(t)})),i.length>1?i.join("/"):"/"}(i,e):e;return{pathname:s,search:z(n),hash:H(r)}}(r,s),c=o&&"/"!==o&&o.endsWith("/"),h=(a||"."===o)&&i.endsWith("/");return l.pathname.endsWith("/")||!c&&!h||(l.pathname+="/"),l}const j=t=>t.join("/").replace(/\/\/+/g,"/"),$=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),z=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",H=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";Error;function q(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}const G=["post","put","patch","delete"],V=(new Set(G),["get",...G]);new Set(V),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function W(){return W=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},W.apply(this,arguments)}const K=s.createContext(null);const Y=s.createContext(null);const X=s.createContext(null);const Q=s.createContext(null);const J=s.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=s.createContext(null);function tt(){return null!=s.useContext(Q)}function et(){return tt()||d(!1),s.useContext(Q).location}function it(t){s.useContext(X).static||s.useLayoutEffect(t)}function nt(){let{isDataRoute:t}=s.useContext(J);return t?function(){let{router:t}=dt(ut.UseNavigateStable),e=pt(ht.UseNavigateStable),i=s.useRef(!1);it((()=>{i.current=!0}));let n=s.useCallback((function(n,r){void 0===r&&(r={}),i.current&&("number"===typeof n?t.navigate(n):t.navigate(n,W({fromRouteId:e},r)))}),[t,e]);return n}():function(){tt()||d(!1);let t=s.useContext(K),{basename:e,future:i,navigator:n}=s.useContext(X),{matches:r}=s.useContext(J),{pathname:a}=et(),o=JSON.stringify(B(r,i.v7_relativeSplatPath)),l=s.useRef(!1);it((()=>{l.current=!0}));let c=s.useCallback((function(i,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof i)return void n.go(i);let s=U(i,JSON.parse(o),a,"path"===r.relative);null==t&&"/"!==e&&(s.pathname="/"===s.pathname?e:j([e,s.pathname])),(r.replace?n.replace:n.push)(s,r.state,r)}),[e,n,o,a,t]);return c}()}function rt(t,e,i,n){tt()||d(!1);let{navigator:a,static:o}=s.useContext(X),{matches:l}=s.useContext(J),c=l[l.length-1],u=c?c.params:{},h=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let f,p=et();if(e){var g;let t="string"===typeof e?v(e):e;"/"===h||(null==(g=t.pathname)?void 0:g.startsWith(h))||d(!1),f=t}else f=p;let m=f.pathname||"/",y=m;if("/"!==h){let t=h.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(t.length).join("/")}let b=!o&&i&&i.matches&&i.matches.length>0?i.matches:S(t,{pathname:y});let w=ct(b&&b.map((t=>Object.assign({},t,{params:Object.assign({},u,t.params),pathname:j([h,a.encodeLocation?a.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?h:j([h,a.encodeLocation?a.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),l,i,n);return e&&w?s.createElement(Q.Provider,{value:{location:W({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:r.Pop}},w):w}function st(){let t=function(){var t;let e=s.useContext(Z),i=ft(ht.UseRouteError),n=pt(ht.UseRouteError);if(void 0!==e)return e;return null==(t=i.errors)?void 0:t[n]}(),e=q(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},e),i?s.createElement("pre",{style:r},i):null,null)}const at=s.createElement(st,null);class ot extends s.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?s.createElement(J.Provider,{value:this.props.routeContext},s.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lt(t){let{routeContext:e,match:i,children:n}=t,r=s.useContext(K);return r&&r.static&&r.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=i.route.id),s.createElement(J.Provider,{value:e},n)}function ct(t,e,i,n){var r;if(void 0===e&&(e=[]),void 0===i&&(i=null),void 0===n&&(n=null),null==t){var a;if(!i)return null;if(i.errors)t=i.matches;else{if(!(null!=(a=n)&&a.v7_partialHydration&&0===e.length&&!i.initialized&&i.matches.length>0))return null;t=i.matches}}let o=t,l=null==(r=i)?void 0:r.errors;if(null!=l){let t=o.findIndex((t=>t.route.id&&void 0!==(null==l?void 0:l[t.route.id])));t>=0||d(!1),o=o.slice(0,Math.min(o.length,t+1))}let c=!1,u=-1;if(i&&n&&n.v7_partialHydration)for(let s=0;s<o.length;s++){let t=o[s];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(u=s),t.route.id){let{loaderData:e,errors:n}=i,r=t.route.loader&&void 0===e[t.route.id]&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight(((t,n,r)=>{let a,h=!1,d=null,f=null;var p;i&&(a=l&&n.route.id?l[n.route.id]:void 0,d=n.route.errorElement||at,c&&(u<0&&0===r?(p="route-fallback",!1||gt[p]||(gt[p]=!0),h=!0,f=null):u===r&&(h=!0,f=n.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,r+1)),m=()=>{let e;return e=a?d:h?f:n.route.Component?s.createElement(n.route.Component,null):n.route.element?n.route.element:t,s.createElement(lt,{match:n,routeContext:{outlet:t,matches:g,isDataRoute:null!=i},children:e})};return i&&(n.route.ErrorBoundary||n.route.errorElement||0===r)?s.createElement(ot,{location:i.location,revalidation:i.revalidation,component:d,error:a,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()}),null)}var ut=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(ut||{}),ht=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ht||{});function dt(t){let e=s.useContext(K);return e||d(!1),e}function ft(t){let e=s.useContext(Y);return e||d(!1),e}function pt(t){let e=function(){let t=s.useContext(J);return t||d(!1),t}(),i=e.matches[e.matches.length-1];return i.route.id||d(!1),i.route.id}const gt={};function mt(t,e){null==t||t.v7_startTransition,void 0===(null==t?void 0:t.v7_relativeSplatPath)&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}a.startTransition;function vt(t){d(!1)}function yt(t){let{basename:e="/",children:i=null,location:n,navigationType:a=r.Pop,navigator:o,static:l=!1,future:c}=t;tt()&&d(!1);let u=e.replace(/^\/*/,"/"),h=s.useMemo((()=>({basename:u,navigator:o,static:l,future:W({v7_relativeSplatPath:!1},c)})),[u,c,o,l]);"string"===typeof n&&(n=v(n));let{pathname:f="/",search:p="",hash:g="",state:m=null,key:y="default"}=n,b=s.useMemo((()=>{let t=O(f,u);return null==t?null:{location:{pathname:t,search:p,hash:g,state:m,key:y},navigationType:a}}),[u,f,p,g,m,y,a]);return null==b?null:s.createElement(X.Provider,{value:h},s.createElement(Q.Provider,{children:i,value:b}))}function bt(t){let{children:e,location:i}=t;return rt(St(e),i)}new Promise((()=>{}));s.Component;function St(t,e){void 0===e&&(e=[]);let i=[];return s.Children.forEach(t,((t,n)=>{if(!s.isValidElement(t))return;let r=[...e,n];if(t.type===s.Fragment)return void i.push.apply(i,St(t.props.children,r));t.type!==vt&&d(!1),t.props.index&&t.props.children&&d(!1);let a={id:t.props.id||r.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(a.children=St(t.props.children,r)),i.push(a)})),i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Bw){}new Map;const wt=a.startTransition;c.flushSync,a.useId;function xt(t){let{basename:e,children:i,future:n,window:r}=t,a=s.useRef();var o;null==a.current&&(a.current=(void 0===(o={window:r,v5Compat:!0})&&(o={}),y((function(t,e){let{pathname:i,search:n,hash:r}=t.location;return g("",{pathname:i,search:n,hash:r},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"===typeof e?e:m(e)}),null,o)));let l=a.current,[c,u]=s.useState({action:l.action,location:l.location}),{v7_startTransition:h}=n||{},d=s.useCallback((t=>{h&&wt?wt((()=>u(t))):u(t)}),[u,h]);return s.useLayoutEffect((()=>l.listen(d)),[l,d]),s.useEffect((()=>mt(n)),[n]),s.createElement(yt,{basename:e,children:i,location:c.location,navigationType:c.action,navigator:l,future:n})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Et,Lt;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Et||(Et={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(Lt||(Lt={}));function Tt(t,e){return function(){return t.apply(e,arguments)}}const{toString:At}=Object.prototype,{getPrototypeOf:_t}=Object,kt=(Pt=Object.create(null),t=>{const e=At.call(t);return Pt[e]||(Pt[e]=e.slice(8,-1).toLowerCase())});var Pt;const Rt=t=>(t=t.toLowerCase(),e=>kt(e)===t),It=t=>e=>typeof e===t,{isArray:Ct}=Array,Dt=It("undefined");const Nt=Rt("ArrayBuffer");const Ot=It("string"),Mt=It("function"),Ft=It("number"),Bt=t=>null!==t&&"object"===typeof t,Ut=t=>{if("object"!==kt(t))return!1;const e=_t(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},jt=Rt("Date"),$t=Rt("File"),zt=Rt("Blob"),Ht=Rt("FileList"),qt=Rt("URLSearchParams"),[Gt,Vt,Wt,Kt]=["ReadableStream","Request","Response","Headers"].map(Rt);function Yt(t,e){let i,n,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),Ct(t))for(i=0,n=t.length;i<n;i++)e.call(null,t[i],i,t);else{const n=r?Object.getOwnPropertyNames(t):Object.keys(t),s=n.length;let a;for(i=0;i<s;i++)a=n[i],e.call(null,t[a],a,t)}}function Xt(t,e){e=e.toLowerCase();const i=Object.keys(t);let n,r=i.length;for(;r-- >0;)if(n=i[r],e===n.toLowerCase())return n;return null}const Qt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Jt=t=>!Dt(t)&&t!==Qt;const Zt=(te="undefined"!==typeof Uint8Array&&_t(Uint8Array),t=>te&&t instanceof te);var te;const ee=Rt("HTMLFormElement"),ie=(t=>{let{hasOwnProperty:e}=t;return(t,i)=>e.call(t,i)})(Object.prototype),ne=Rt("RegExp"),re=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t),n={};Yt(i,((i,r)=>{let s;!1!==(s=e(i,r,t))&&(n[r]=s||i)})),Object.defineProperties(t,n)};const se=Rt("AsyncFunction"),ae=((t,e)=>{return t?setImmediate:e?(i=`axios@${Math.random()}`,n=[],Qt.addEventListener("message",(t=>{let{source:e,data:r}=t;e===Qt&&r===i&&n.length&&n.shift()()}),!1),t=>{n.push(t),Qt.postMessage(i,"*")}):t=>setTimeout(t);var i,n})("function"===typeof setImmediate,Mt(Qt.postMessage)),oe="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Qt):"undefined"!==typeof process&&process.nextTick||ae,le={isArray:Ct,isArrayBuffer:Nt,isBuffer:function(t){return null!==t&&!Dt(t)&&null!==t.constructor&&!Dt(t.constructor)&&Mt(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||Mt(t.append)&&("formdata"===(e=kt(t))||"object"===e&&Mt(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&Nt(t.buffer),e},isString:Ot,isNumber:Ft,isBoolean:t=>!0===t||!1===t,isObject:Bt,isPlainObject:Ut,isReadableStream:Gt,isRequest:Vt,isResponse:Wt,isHeaders:Kt,isUndefined:Dt,isDate:jt,isFile:$t,isBlob:zt,isRegExp:ne,isFunction:Mt,isStream:t=>Bt(t)&&Mt(t.pipe),isURLSearchParams:qt,isTypedArray:Zt,isFileList:Ht,forEach:Yt,merge:function t(){const{caseless:e}=Jt(this)&&this||{},i={},n=(n,r)=>{const s=e&&Xt(i,r)||r;Ut(i[s])&&Ut(n)?i[s]=t(i[s],n):Ut(n)?i[s]=t({},n):Ct(n)?i[s]=n.slice():i[s]=n};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Yt(arguments[r],n);return i},extend:function(t,e,i){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Yt(e,((e,n)=>{i&&Mt(e)?t[n]=Tt(e,i):t[n]=e}),{allOwnKeys:n}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,i,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),i&&Object.assign(t.prototype,i)},toFlatObject:(t,e,i,n)=>{let r,s,a;const o={};if(e=e||{},null==t)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)a=r[s],n&&!n(a,t,e)||o[a]||(e[a]=t[a],o[a]=!0);t=!1!==i&&_t(t)}while(t&&(!i||i(t,e))&&t!==Object.prototype);return e},kindOf:kt,kindOfTest:Rt,endsWith:(t,e,i)=>{t=String(t),(void 0===i||i>t.length)&&(i=t.length),i-=e.length;const n=t.indexOf(e,i);return-1!==n&&n===i},toArray:t=>{if(!t)return null;if(Ct(t))return t;let e=t.length;if(!Ft(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=t[e];return i},forEachEntry:(t,e)=>{const i=(t&&t[Symbol.iterator]).call(t);let n;for(;(n=i.next())&&!n.done;){const i=n.value;e.call(t,i[0],i[1])}},matchAll:(t,e)=>{let i;const n=[];for(;null!==(i=t.exec(e));)n.push(i);return n},isHTMLForm:ee,hasOwnProperty:ie,hasOwnProp:ie,reduceDescriptors:re,freezeMethods:t=>{re(t,((e,i)=>{if(Mt(t)&&-1!==["arguments","caller","callee"].indexOf(i))return!1;const n=t[i];Mt(n)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")}))}))},toObjectSet:(t,e)=>{const i={},n=t=>{t.forEach((t=>{i[t]=!0}))};return Ct(t)?n(t):n(String(t).split(e)),i},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,i){return e.toUpperCase()+i})),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:Xt,global:Qt,isContextDefined:Jt,isSpecCompliantForm:function(t){return!!(t&&Mt(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),i=(t,n)=>{if(Bt(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[n]=t;const r=Ct(t)?[]:{};return Yt(t,((t,e)=>{const s=i(t,n+1);!Dt(s)&&(r[e]=s)})),e[n]=void 0,r}}return t};return i(t,0)},isAsyncFn:se,isThenable:t=>t&&(Bt(t)||Mt(t))&&Mt(t.then)&&Mt(t.catch),setImmediate:ae,asap:oe};function ce(t,e,i,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}le.inherits(ce,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:le.toJSONObject(this.config),code:this.code,status:this.status}}});const ue=ce.prototype,he={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{he[t]={value:t}})),Object.defineProperties(ce,he),Object.defineProperty(ue,"isAxiosError",{value:!0}),ce.from=(t,e,i,n,r,s)=>{const a=Object.create(ue);return le.toFlatObject(t,a,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),ce.call(a,t.message,e,i,n,r),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const de=ce;function fe(t){return le.isPlainObject(t)||le.isArray(t)}function pe(t){return le.endsWith(t,"[]")?t.slice(0,-2):t}function ge(t,e,i){return t?t.concat(e).map((function(t,e){return t=pe(t),!i&&e?"["+t+"]":t})).join(i?".":""):e}const me=le.toFlatObject(le,{},null,(function(t){return/^is[A-Z]/.test(t)}));const ve=function(t,e,i){if(!le.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const n=(i=le.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!le.isUndefined(e[t])}))).metaTokens,r=i.visitor||c,s=i.dots,a=i.indexes,o=(i.Blob||"undefined"!==typeof Blob&&Blob)&&le.isSpecCompliantForm(e);if(!le.isFunction(r))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(le.isDate(t))return t.toISOString();if(!o&&le.isBlob(t))throw new de("Blob is not supported. Use a Buffer instead.");return le.isArrayBuffer(t)||le.isTypedArray(t)?o&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,i,r){let o=t;if(t&&!r&&"object"===typeof t)if(le.endsWith(i,"{}"))i=n?i:i.slice(0,-2),t=JSON.stringify(t);else if(le.isArray(t)&&function(t){return le.isArray(t)&&!t.some(fe)}(t)||(le.isFileList(t)||le.endsWith(i,"[]"))&&(o=le.toArray(t)))return i=pe(i),o.forEach((function(t,n){!le.isUndefined(t)&&null!==t&&e.append(!0===a?ge([i],n,s):null===a?i:i+"[]",l(t))})),!1;return!!fe(t)||(e.append(ge(r,i,s),l(t)),!1)}const u=[],h=Object.assign(me,{defaultVisitor:c,convertValue:l,isVisitable:fe});if(!le.isObject(t))throw new TypeError("data must be an object");return function t(i,n){if(!le.isUndefined(i)){if(-1!==u.indexOf(i))throw Error("Circular reference detected in "+n.join("."));u.push(i),le.forEach(i,(function(i,s){!0===(!(le.isUndefined(i)||null===i)&&r.call(e,i,le.isString(s)?s.trim():s,n,h))&&t(i,n?n.concat(s):[s])})),u.pop()}}(t),e};function ye(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function be(t,e){this._pairs=[],t&&ve(t,this,e)}const Se=be.prototype;Se.append=function(t,e){this._pairs.push([t,e])},Se.toString=function(t){const e=t?function(e){return t.call(this,e,ye)}:ye;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const we=be;function xe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ee(t,e,i){if(!e)return t;const n=i&&i.encode||xe;le.isFunction(i)&&(i={serialize:i});const r=i&&i.serialize;let s;if(s=r?r(e,i):le.isURLSearchParams(e)?e.toString():new we(e,i).toString(n),s){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}const Le=class{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){le.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},Te={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ae={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:we,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},_e="undefined"!==typeof window&&"undefined"!==typeof document,ke="object"===typeof navigator&&navigator||void 0,Pe=_e&&(!ke||["ReactNative","NativeScript","NS"].indexOf(ke.product)<0),Re="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Ie=_e&&window.location.href||"http://localhost",Ce={...n,...Ae};const De=function(t){function e(t,i,n,r){let s=t[r++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=r>=t.length;if(s=!s&&le.isArray(n)?n.length:s,o)return le.hasOwnProp(n,s)?n[s]=[n[s],i]:n[s]=i,!a;n[s]&&le.isObject(n[s])||(n[s]=[]);return e(t,i,n[s],r)&&le.isArray(n[s])&&(n[s]=function(t){const e={},i=Object.keys(t);let n;const r=i.length;let s;for(n=0;n<r;n++)s=i[n],e[s]=t[s];return e}(n[s])),!a}if(le.isFormData(t)&&le.isFunction(t.entries)){const i={};return le.forEachEntry(t,((t,n)=>{e(function(t){return le.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),n,i,0)})),i}return null};const Ne={transitional:Te,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",n=i.indexOf("application/json")>-1,r=le.isObject(t);r&&le.isHTMLForm(t)&&(t=new FormData(t));if(le.isFormData(t))return n?JSON.stringify(De(t)):t;if(le.isArrayBuffer(t)||le.isBuffer(t)||le.isStream(t)||le.isFile(t)||le.isBlob(t)||le.isReadableStream(t))return t;if(le.isArrayBufferView(t))return t.buffer;if(le.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(r){if(i.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return ve(t,new Ce.classes.URLSearchParams,Object.assign({visitor:function(t,e,i,n){return Ce.isNode&&le.isBuffer(t)?(this.append(e,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((s=le.isFileList(t))||i.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return ve(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return r||n?(e.setContentType("application/json",!1),function(t,e,i){if(le.isString(t))try{return(e||JSON.parse)(t),le.trim(t)}catch(Bw){if("SyntaxError"!==Bw.name)throw Bw}return(i||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||Ne.transitional,i=e&&e.forcedJSONParsing,n="json"===this.responseType;if(le.isResponse(t)||le.isReadableStream(t))return t;if(t&&le.isString(t)&&(i&&!this.responseType||n)){const i=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(Bw){if(i){if("SyntaxError"===Bw.name)throw de.from(Bw,de.ERR_BAD_RESPONSE,this,null,this.response);throw Bw}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ce.classes.FormData,Blob:Ce.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};le.forEach(["delete","get","head","post","put","patch"],(t=>{Ne.headers[t]={}}));const Oe=Ne,Me=le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Fe=Symbol("internals");function Be(t){return t&&String(t).trim().toLowerCase()}function Ue(t){return!1===t||null==t?t:le.isArray(t)?t.map(Ue):String(t)}function je(t,e,i,n,r){return le.isFunction(n)?n.call(this,e,i):(r&&(e=i),le.isString(e)?le.isString(n)?-1!==e.indexOf(n):le.isRegExp(n)?n.test(e):void 0:void 0)}class $e{constructor(t){t&&this.set(t)}set(t,e,i){const n=this;function r(t,e,i){const r=Be(e);if(!r)throw new Error("header name must be a non-empty string");const s=le.findKey(n,r);(!s||void 0===n[s]||!0===i||void 0===i&&!1!==n[s])&&(n[s||e]=Ue(t))}const s=(t,e)=>le.forEach(t,((t,i)=>r(t,i,e)));if(le.isPlainObject(t)||t instanceof this.constructor)s(t,e);else if(le.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))s((t=>{const e={};let i,n,r;return t&&t.split("\n").forEach((function(t){r=t.indexOf(":"),i=t.substring(0,r).trim().toLowerCase(),n=t.substring(r+1).trim(),!i||e[i]&&Me[i]||("set-cookie"===i?e[i]?e[i].push(n):e[i]=[n]:e[i]=e[i]?e[i]+", "+n:n)})),e})(t),e);else if(le.isHeaders(t))for(const[a,o]of t.entries())r(o,a,i);else null!=t&&r(e,t,i);return this}get(t,e){if(t=Be(t)){const i=le.findKey(this,t);if(i){const t=this[i];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=i.exec(t);)e[n[1]]=n[2];return e}(t);if(le.isFunction(e))return e.call(this,t,i);if(le.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Be(t)){const i=le.findKey(this,t);return!(!i||void 0===this[i]||e&&!je(0,this[i],i,e))}return!1}delete(t,e){const i=this;let n=!1;function r(t){if(t=Be(t)){const r=le.findKey(i,t);!r||e&&!je(0,i[r],r,e)||(delete i[r],n=!0)}}return le.isArray(t)?t.forEach(r):r(t),n}clear(t){const e=Object.keys(this);let i=e.length,n=!1;for(;i--;){const r=e[i];t&&!je(0,this[r],r,t,!0)||(delete this[r],n=!0)}return n}normalize(t){const e=this,i={};return le.forEach(this,((n,r)=>{const s=le.findKey(i,r);if(s)return e[s]=Ue(n),void delete e[r];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,i)=>e.toUpperCase()+i))}(r):String(r).trim();a!==r&&delete e[r],e[a]=Ue(n),i[a]=!0})),this}concat(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return le.forEach(this,((i,n)=>{null!=i&&!1!==i&&(e[n]=t&&le.isArray(i)?i.join(", "):i)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((t=>{let[e,i]=t;return e+": "+i})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return n.forEach((t=>e.set(t))),e}static accessor(t){const e=(this[Fe]=this[Fe]={accessors:{}}).accessors,i=this.prototype;function n(t){const n=Be(t);e[n]||(!function(t,e){const i=le.toCamelCase(" "+e);["get","set","has"].forEach((n=>{Object.defineProperty(t,n+i,{value:function(t,i,r){return this[n].call(this,e,t,i,r)},configurable:!0})}))}(i,t),e[n]=!0)}return le.isArray(t)?t.forEach(n):n(t),this}}$e.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),le.reduceDescriptors($e.prototype,((t,e)=>{let{value:i}=t,n=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(t){this[n]=t}}})),le.freezeMethods($e);const ze=$e;function He(t,e){const i=this||Oe,n=e||i,r=ze.from(n.headers);let s=n.data;return le.forEach(t,(function(t){s=t.call(i,s,r.normalize(),e?e.status:void 0)})),r.normalize(),s}function qe(t){return!(!t||!t.__CANCEL__)}function Ge(t,e,i){de.call(this,null==t?"canceled":t,de.ERR_CANCELED,e,i),this.name="CanceledError"}le.inherits(Ge,de,{__CANCEL__:!0});const Ve=Ge;function We(t,e,i){const n=i.config.validateStatus;i.status&&n&&!n(i.status)?e(new de("Request failed with status code "+i.status,[de.ERR_BAD_REQUEST,de.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):t(i)}const Ke=function(t,e){t=t||10;const i=new Array(t),n=new Array(t);let r,s=0,a=0;return e=void 0!==e?e:1e3,function(o){const l=Date.now(),c=n[a];r||(r=l),i[s]=o,n[s]=l;let u=a,h=0;for(;u!==s;)h+=i[u++],u%=t;if(s=(s+1)%t,s===a&&(a=(a+1)%t),l-r<e)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}};const Ye=function(t,e){let i,n,r=0,s=1e3/e;const a=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r=s,i=null,n&&(clearTimeout(n),n=null),t.apply(null,e)};return[function(){const t=Date.now(),e=t-r;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];e>=s?a(l,t):(i=l,n||(n=setTimeout((()=>{n=null,a(i)}),s-e)))},()=>i&&a(i)]},Xe=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=0;const r=Ke(50,250);return Ye((i=>{const s=i.loaded,a=i.lengthComputable?i.total:void 0,o=s-n,l=r(o);n=s;t({loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&s<=a?(a-s)/l:void 0,event:i,lengthComputable:null!=a,[e?"download":"upload"]:!0})}),i)},Qe=(t,e)=>{const i=null!=t;return[n=>e[0]({lengthComputable:i,total:t,loaded:n}),e[1]]},Je=t=>function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return le.asap((()=>t(...i)))},Ze=Ce.hasStandardBrowserEnv?((t,e)=>i=>(i=new URL(i,Ce.origin),t.protocol===i.protocol&&t.host===i.host&&(e||t.port===i.port)))(new URL(Ce.origin),Ce.navigator&&/(msie|trident)/i.test(Ce.navigator.userAgent)):()=>!0,ti=Ce.hasStandardBrowserEnv?{write(t,e,i,n,r,s){const a=[t+"="+encodeURIComponent(e)];le.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),le.isString(n)&&a.push("path="+n),le.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function ei(t,e,i){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(n||0==i)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const ii=t=>t instanceof ze?{...t}:t;function ni(t,e){e=e||{};const i={};function n(t,e,i,n){return le.isPlainObject(t)&&le.isPlainObject(e)?le.merge.call({caseless:n},t,e):le.isPlainObject(e)?le.merge({},e):le.isArray(e)?e.slice():e}function r(t,e,i,r){return le.isUndefined(e)?le.isUndefined(t)?void 0:n(void 0,t,0,r):n(t,e,0,r)}function s(t,e){if(!le.isUndefined(e))return n(void 0,e)}function a(t,e){return le.isUndefined(e)?le.isUndefined(t)?void 0:n(void 0,t):n(void 0,e)}function o(i,r,s){return s in e?n(i,r):s in t?n(void 0,i):void 0}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(t,e,i)=>r(ii(t),ii(e),0,!0)};return le.forEach(Object.keys(Object.assign({},t,e)),(function(n){const s=l[n]||r,a=s(t[n],e[n],n);le.isUndefined(a)&&s!==o||(i[n]=a)})),i}const ri=t=>{const e=ni({},t);let i,{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:l}=e;if(e.headers=o=ze.from(o),e.url=Ee(ei(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),le.isFormData(n))if(Ce.hasStandardBrowserEnv||Ce.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(i=o.getContentType())){const[t,...e]=i?i.split(";").map((t=>t.trim())).filter(Boolean):[];o.setContentType([t||"multipart/form-data",...e].join("; "))}if(Ce.hasStandardBrowserEnv&&(r&&le.isFunction(r)&&(r=r(e)),r||!1!==r&&Ze(e.url))){const t=s&&a&&ti.read(a);t&&o.set(s,t)}return e},si="undefined"!==typeof XMLHttpRequest&&function(t){return new Promise((function(e,i){const n=ri(t);let r=n.data;const s=ze.from(n.headers).normalize();let a,o,l,c,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=n;function p(){c&&c(),u&&u(),n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}let g=new XMLHttpRequest;function m(){if(!g)return;const n=ze.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());We((function(t){e(t),p()}),(function(t){i(t),p()}),{data:h&&"text"!==h&&"json"!==h?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:n,config:t,request:g}),g=null}g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(i(new de("Request aborted",de.ECONNABORTED,t,g)),g=null)},g.onerror=function(){i(new de("Network Error",de.ERR_NETWORK,t,g)),g=null},g.ontimeout=function(){let e=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const r=n.transitional||Te;n.timeoutErrorMessage&&(e=n.timeoutErrorMessage),i(new de(e,r.clarifyTimeoutError?de.ETIMEDOUT:de.ECONNABORTED,t,g)),g=null},void 0===r&&s.setContentType(null),"setRequestHeader"in g&&le.forEach(s.toJSON(),(function(t,e){g.setRequestHeader(e,t)})),le.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),h&&"json"!==h&&(g.responseType=n.responseType),f&&([l,u]=Xe(f,!0),g.addEventListener("progress",l)),d&&g.upload&&([o,c]=Xe(d),g.upload.addEventListener("progress",o),g.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(a=e=>{g&&(i(!e||e.type?new Ve(null,t,g):e),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const v=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(n.url);v&&-1===Ce.protocols.indexOf(v)?i(new de("Unsupported protocol "+v+":",de.ERR_BAD_REQUEST,t)):g.send(r||null)}))},ai=(t,e)=>{const{length:i}=t=t?t.filter(Boolean):[];if(e||i){let i,n=new AbortController;const r=function(t){if(!i){i=!0,a();const e=t instanceof Error?t:this.reason;n.abort(e instanceof de?e:new Ve(e instanceof Error?e.message:e))}};let s=e&&setTimeout((()=>{s=null,r(new de(`timeout ${e} of ms exceeded`,de.ETIMEDOUT))}),e);const a=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach((t=>{t.unsubscribe?t.unsubscribe(r):t.removeEventListener("abort",r)})),t=null)};t.forEach((t=>t.addEventListener("abort",r)));const{signal:o}=n;return o.unsubscribe=()=>le.asap(a),o}},oi=function*(t,e){let i=t.byteLength;if(!e||i<e)return void(yield t);let n,r=0;for(;r<i;)n=r+e,yield t.slice(r,n),r=n},li=async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},ci=(t,e,i,n)=>{const r=async function*(t,e){for await(const i of li(t))yield*oi(i,e)}(t,e);let s,a=0,o=t=>{s||(s=!0,n&&n(t))};return new ReadableStream({async pull(t){try{const{done:e,value:n}=await r.next();if(e)return o(),void t.close();let s=n.byteLength;if(i){let t=a+=s;i(t)}t.enqueue(new Uint8Array(n))}catch(ny){throw o(ny),ny}},cancel:t=>(o(t),r.return())},{highWaterMark:2})},ui="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,hi=ui&&"function"===typeof ReadableStream,di=ui&&("function"===typeof TextEncoder?(fi=new TextEncoder,t=>fi.encode(t)):async t=>new Uint8Array(await new Response(t).arrayBuffer()));var fi;const pi=function(t){try{for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return!!t(...i)}catch(Bw){return!1}},gi=hi&&pi((()=>{let t=!1;const e=new Request(Ce.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e})),mi=hi&&pi((()=>le.isReadableStream(new Response("").body))),vi={stream:mi&&(t=>t.body)};var yi;ui&&(yi=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!vi[t]&&(vi[t]=le.isFunction(yi[t])?e=>e[t]():(e,i)=>{throw new de(`Response type '${t}' is not supported`,de.ERR_NOT_SUPPORT,i)})})));const bi=async(t,e)=>{const i=le.toFiniteNumber(t.getContentLength());return null==i?(async t=>{if(null==t)return 0;if(le.isBlob(t))return t.size;if(le.isSpecCompliantForm(t)){const e=new Request(Ce.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return le.isArrayBufferView(t)||le.isArrayBuffer(t)?t.byteLength:(le.isURLSearchParams(t)&&(t+=""),le.isString(t)?(await di(t)).byteLength:void 0)})(e):i},Si=ui&&(async t=>{let{url:e,method:i,data:n,signal:r,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:d}=ri(t);c=c?(c+"").toLowerCase():"text";let f,p=ai([r,s&&s.toAbortSignal()],a);const g=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let m;try{if(l&&gi&&"get"!==i&&"head"!==i&&0!==(m=await bi(u,n))){let t,i=new Request(e,{method:"POST",body:n,duplex:"half"});if(le.isFormData(n)&&(t=i.headers.get("content-type"))&&u.setContentType(t),i.body){const[t,e]=Qe(m,Xe(Je(l)));n=ci(i.body,65536,t,e)}}le.isString(h)||(h=h?"include":"omit");const r="credentials"in Request.prototype;f=new Request(e,{...d,signal:p,method:i.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:r?h:void 0});let s=await fetch(f);const a=mi&&("stream"===c||"response"===c);if(mi&&(o||a&&g)){const t={};["status","statusText","headers"].forEach((e=>{t[e]=s[e]}));const e=le.toFiniteNumber(s.headers.get("content-length")),[i,n]=o&&Qe(e,Xe(Je(o),!0))||[];s=new Response(ci(s.body,65536,i,(()=>{n&&n(),g&&g()})),t)}c=c||"text";let v=await vi[le.findKey(vi,c)||"text"](s,t);return!a&&g&&g(),await new Promise(((e,i)=>{We(e,i,{data:v,headers:ze.from(s.headers),status:s.status,statusText:s.statusText,config:t,request:f})}))}catch(ny){if(g&&g(),ny&&"TypeError"===ny.name&&/fetch/i.test(ny.message))throw Object.assign(new de("Network Error",de.ERR_NETWORK,t,f),{cause:ny.cause||ny});throw de.from(ny,ny&&ny.code,t,f)}}),wi={http:null,xhr:si,fetch:Si};le.forEach(wi,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(Bw){}Object.defineProperty(t,"adapterName",{value:e})}}));const xi=t=>`- ${t}`,Ei=t=>le.isFunction(t)||null===t||!1===t,Li=t=>{t=le.isArray(t)?t:[t];const{length:e}=t;let i,n;const r={};for(let s=0;s<e;s++){let e;if(i=t[s],n=i,!Ei(i)&&(n=wi[(e=String(i)).toLowerCase()],void 0===n))throw new de(`Unknown adapter '${e}'`);if(n)break;r[e||"#"+s]=n}if(!n){const t=Object.entries(r).map((t=>{let[e,i]=t;return`adapter ${e} `+(!1===i?"is not supported by the environment":"is not available in the build")}));let i=e?t.length>1?"since :\n"+t.map(xi).join("\n"):" "+xi(t[0]):"as no adapter specified";throw new de("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n};function Ti(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ve(null,t)}function Ai(t){Ti(t),t.headers=ze.from(t.headers),t.data=He.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return Li(t.adapter||Oe.adapter)(t).then((function(e){return Ti(t),e.data=He.call(t,t.transformResponse,e),e.headers=ze.from(e.headers),e}),(function(e){return qe(e)||(Ti(t),e&&e.response&&(e.response.data=He.call(t,t.transformResponse,e.response),e.response.headers=ze.from(e.response.headers))),Promise.reject(e)}))}const _i="1.8.4",ki={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{ki[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}}));const Pi={};ki.transitional=function(t,e,i){function n(t,e){return"[Axios v1.8.4] Transitional option '"+t+"'"+e+(i?". "+i:"")}return(i,r,s)=>{if(!1===t)throw new de(n(r," has been removed"+(e?" in "+e:"")),de.ERR_DEPRECATED);return e&&!Pi[r]&&(Pi[r]=!0,console.warn(n(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(i,r,s)}},ki.spelling=function(t){return(e,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};const Ri={assertOptions:function(t,e,i){if("object"!==typeof t)throw new de("options must be an object",de.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let r=n.length;for(;r-- >0;){const s=n[r],a=e[s];if(a){const e=t[s],i=void 0===e||a(e,s,t);if(!0!==i)throw new de("option "+s+" must be "+i,de.ERR_BAD_OPTION_VALUE)}else if(!0!==i)throw new de("Unknown option "+s,de.ERR_BAD_OPTION)}},validators:ki},Ii=Ri.validators;class Ci{constructor(t){this.defaults=t,this.interceptors={request:new Le,response:new Le}}async request(t,e){try{return await this._request(t,e)}catch(ny){if(ny instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const i=e.stack?e.stack.replace(/^.+\n/,""):"";try{ny.stack?i&&!String(ny.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(ny.stack+="\n"+i):ny.stack=i}catch(Bw){}}throw ny}}_request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=ni(this.defaults,e);const{transitional:i,paramsSerializer:n,headers:r}=e;void 0!==i&&Ri.assertOptions(i,{silentJSONParsing:Ii.transitional(Ii.boolean),forcedJSONParsing:Ii.transitional(Ii.boolean),clarifyTimeoutError:Ii.transitional(Ii.boolean)},!1),null!=n&&(le.isFunction(n)?e.paramsSerializer={serialize:n}:Ri.assertOptions(n,{encode:Ii.function,serialize:Ii.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Ri.assertOptions(e,{baseUrl:Ii.spelling("baseURL"),withXsrfToken:Ii.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=r&&le.merge(r.common,r[e.method]);r&&le.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete r[t]})),e.headers=ze.concat(s,r);const a=[];let o=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,a.unshift(t.fulfilled,t.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)}));let u,h=0;if(!o){const t=[Ai.bind(this),void 0];for(t.unshift.apply(t,a),t.push.apply(t,l),u=t.length,c=Promise.resolve(e);h<u;)c=c.then(t[h++],t[h++]);return c}u=a.length;let d=e;for(h=0;h<u;){const t=a[h++],e=a[h++];try{d=t(d)}catch(f){e.call(this,f);break}}try{c=Ai.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(t){return Ee(ei((t=ni(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}}le.forEach(["delete","get","head","options"],(function(t){Ci.prototype[t]=function(e,i){return this.request(ni(i||{},{method:t,url:e,data:(i||{}).data}))}})),le.forEach(["post","put","patch"],(function(t){function e(e){return function(i,n,r){return this.request(ni(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:i,data:n}))}}Ci.prototype[t]=e(),Ci.prototype[t+"Form"]=e(!0)}));const Di=Ci;class Ni{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const i=this;this.promise.then((t=>{if(!i._listeners)return;let e=i._listeners.length;for(;e-- >0;)i._listeners[e](t);i._listeners=null})),this.promise.then=t=>{let e;const n=new Promise((t=>{i.subscribe(t),e=t})).then(t);return n.cancel=function(){i.unsubscribe(e)},n},t((function(t,n,r){i.reason||(i.reason=new Ve(t,n,r),e(i.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;const e=new Ni((function(e){t=e}));return{token:e,cancel:t}}}const Oi=Ni;const Mi={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Mi).forEach((t=>{let[e,i]=t;Mi[i]=e}));const Fi=Mi;const Bi=function t(e){const i=new Di(e),n=Tt(Di.prototype.request,i);return le.extend(n,Di.prototype,i,{allOwnKeys:!0}),le.extend(n,i,null,{allOwnKeys:!0}),n.create=function(i){return t(ni(e,i))},n}(Oe);Bi.Axios=Di,Bi.CanceledError=Ve,Bi.CancelToken=Oi,Bi.isCancel=qe,Bi.VERSION=_i,Bi.toFormData=ve,Bi.AxiosError=de,Bi.Cancel=Bi.CanceledError,Bi.all=function(t){return Promise.all(t)},Bi.spread=function(t){return function(e){return t.apply(null,e)}},Bi.isAxiosError=function(t){return le.isObject(t)&&!0===t.isAxiosError},Bi.mergeConfig=ni,Bi.AxiosHeaders=ze,Bi.formToJSON=t=>De(le.isHTMLForm(t)?new FormData(t):t),Bi.getAdapter=Li,Bi.HttpStatusCode=Fi,Bi.default=Bi;const Ui=Bi.create({baseURL:"http://localhost:3000"}),ji=Ui,$i=i.p+"static/media/logo.023bcc8beb5aeed733dd.jpeg";var zi=i(579);const Hi=()=>{const[t,e]=(0,s.useState)(""),[i,n]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(!1),c=nt();return(0,zi.jsxs)("div",{className:"login-page",children:[(0,zi.jsx)("img",{src:$i,alt:"Logo",className:"login-page-logo "+(o?"expand-logo":"")}),!o&&(0,zi.jsxs)("div",{className:"login-container",children:[(0,zi.jsx)("h2",{children:"Iniciar Sesi\xf3n"}),(0,zi.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),a("");try{const e=await ji.post("/api/auth/login",{username:t,password:i});localStorage.setItem("token",e.data.token),localStorage.setItem("user",JSON.stringify(e.data.user)),l(!0),setTimeout((()=>{c("/dashboard")}),1200)}catch(ny){console.error("Error en login:",ny),a("Credenciales inv\xe1lidas. Por favor, intenta de nuevo.")}},children:[(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"username",children:"Usuario"}),(0,zi.jsx)("input",{type:"text",id:"username",value:t,onChange:t=>e(t.target.value),placeholder:"Ingresa tu usuario",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a"}),(0,zi.jsx)("input",{type:"password",id:"password",value:i,onChange:t=>n(t.target.value),placeholder:"Ingresa tu contrase\xf1a",required:!0})]}),r&&(0,zi.jsx)("p",{className:"error",children:r}),(0,zi.jsx)("button",{type:"submit",children:"Entrar"})]}),(0,zi.jsxs)("p",{className:"redirect",children:["\xbfNo tienes cuenta? ",(0,zi.jsx)("span",{onClick:()=>c("/register"),children:"Reg\xedstrate"})]})]})]})},qi=()=>{const[t,e]=(0,s.useState)(""),[i,n]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,u]=(0,s.useState)(null),[h,d]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[g,m]=(0,s.useState)(""),[v,y]=(0,s.useState)("operator"),[b,S]=(0,s.useState)(""),w=nt();return(0,zi.jsxs)("div",{className:"register-container",children:[(0,zi.jsx)("h2",{children:"Registro de Usuario"}),(0,zi.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),S(""),f!==g)return void S("Las contrase\xf1as no coinciden");const n=new FormData;n.append("fullName",t),n.append("email",i),n.append("dni",r),n.append("phoneNumber",o),c&&n.append("photo",c),n.append("username",h),n.append("password",f),n.append("confirmPassword",g),n.append("role",v);try{await ji.post("/api/auth/register",n,{headers:{"Content-Type":"multipart/form-data"}});w("/login")}catch(ny){console.error("Error en registro:",ny),S("Error al registrar el usuario. Verifica los datos e intenta nuevamente.")}},encType:"multipart/form-data",children:[(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"fullName",children:"Nombre Completo"}),(0,zi.jsx)("input",{type:"text",id:"fullName",value:t,onChange:t=>e(t.target.value),placeholder:"Ingresa tu nombre completo",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"email",children:"Correo Electr\xf3nico"}),(0,zi.jsx)("input",{type:"email",id:"email",value:i,onChange:t=>n(t.target.value),placeholder:"Ingresa tu correo",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"dni",children:"N\xfamero de DNI"}),(0,zi.jsx)("input",{type:"text",id:"dni",value:r,onChange:t=>a(t.target.value),placeholder:"Ingresa tu DNI",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"phoneNumber",children:"N\xfamero de Celular"}),(0,zi.jsx)("input",{type:"tel",id:"phoneNumber",value:o,onChange:t=>l(t.target.value),placeholder:"Ingresa tu celular",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"photo",children:"Foto de Perfil"}),(0,zi.jsx)("input",{type:"file",id:"photo",accept:"image/*",onChange:t=>{u(t.target.files[0])},required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"username",children:"Nombre de Usuario"}),(0,zi.jsx)("input",{type:"text",id:"username",value:h,onChange:t=>d(t.target.value),placeholder:"Elige un nombre de usuario",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a"}),(0,zi.jsx)("input",{type:"password",id:"password",value:f,onChange:t=>p(t.target.value),placeholder:"Ingresa tu contrase\xf1a",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"confirmPassword",children:"Confirmar Contrase\xf1a"}),(0,zi.jsx)("input",{type:"password",id:"confirmPassword",value:g,onChange:t=>m(t.target.value),placeholder:"Confirma tu contrase\xf1a",required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{htmlFor:"role",children:"Rol"}),(0,zi.jsxs)("select",{id:"role",value:v,onChange:t=>y(t.target.value),children:[(0,zi.jsx)("option",{value:"operator",children:"Operador"}),(0,zi.jsx)("option",{value:"professional",children:"Profesional"}),(0,zi.jsx)("option",{value:"admin",children:"Administrador"}),(0,zi.jsx)("option",{value:"operador-termico",children:"Operador T\xe9rmico"})]})]}),b&&(0,zi.jsx)("p",{className:"error",children:b}),(0,zi.jsx)("button",{type:"submit",children:"Registrarse"})]}),(0,zi.jsxs)("p",{className:"redirect",children:["\xbfYa tienes una cuenta? ",(0,zi.jsx)("span",{onClick:()=>w("/login"),children:"Inicia sesi\xf3n"})]})]})},Gi=t=>{let{onDataRead:e}=t;const[i,n]=(0,s.useState)(null),[r,a]=(0,s.useState)(!1);return(0,zi.jsxs)("div",{children:[(0,zi.jsx)("button",{onClick:async()=>{if("NDEFReader"in window)try{const t=new NDEFReader;a(!0),await t.scan(),t.onreading=t=>{const{serialNumber:i,message:n}=t,r=[];for(const e of n.records)if("text"===e.recordType){const t=new TextDecoder(e.encoding).decode(e.data);r.push(t)}e&&e({serialNumber:i,records:r}),a(!1)},t.onreadingerror=t=>{n("Error al leer la etiqueta NFC."),a(!1)}}catch(ny){n(`Error al iniciar el escaneo: ${ny.message}`),a(!1)}else n("Web NFC no es compatible con este dispositivo o navegador.")},disabled:r,children:r?"Escaneando NFC...":"Acercar dispositivo al chip NFC"}),i&&(0,zi.jsx)("p",{style:{color:"red"},children:i})]})},Vi=()=>{const[t,e]=(0,s.useState)(""),[i,n]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[h,d]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[g,m]=(0,s.useState)("operator"),[v,y]=(0,s.useState)(null),[b,S]=(0,s.useState)(""),[w,x]=(0,s.useState)("");return(0,zi.jsxs)("div",{className:"register-container",children:[(0,zi.jsx)("h2",{children:"Crear Trabajador"}),(0,zi.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),x(""),S(""),h!==f)return void x("Las contrase\xf1as no coinciden");const m=new FormData;m.append("fullName",t),m.append("email",i),m.append("dni",r),m.append("phoneNumber",o),m.append("username",c),m.append("password",h),m.append("confirmPassword",f),m.append("role",g),v&&m.append("photo",v);try{const t=localStorage.getItem("token");await ji.post("/api/users/create",m,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${t}`}}),S("Trabajador creado con \xe9xito \u2705"),e(""),n(""),a(""),l(""),u(""),d(""),p(""),y(null)}catch(ny){console.error(ny),x("Error al crear el trabajador. Verifica los datos.")}},encType:"multipart/form-data",children:[(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Nombre completo"}),(0,zi.jsx)("input",{type:"text",value:t,onChange:t=>e(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Correo electr\xf3nico"}),(0,zi.jsx)("input",{type:"email",value:i,onChange:t=>n(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"DNI"}),(0,zi.jsx)("input",{type:"text",value:r,onChange:t=>a(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Tel\xe9fono"}),(0,zi.jsx)("input",{type:"tel",value:o,onChange:t=>l(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Nombre de usuario"}),(0,zi.jsx)("input",{type:"text",value:c,onChange:t=>u(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Contrase\xf1a"}),(0,zi.jsx)("input",{type:"password",value:h,onChange:t=>d(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Confirmar contrase\xf1a"}),(0,zi.jsx)("input",{type:"password",value:f,onChange:t=>p(t.target.value),required:!0})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Rol"}),(0,zi.jsxs)("select",{value:g,onChange:t=>m(t.target.value),children:[(0,zi.jsx)("option",{value:"operator",children:"Operario"}),(0,zi.jsx)("option",{value:"professional",children:"Profesional"}),(0,zi.jsx)("option",{value:"thermal_operator",children:"Operador T\xe9rmico"})]})]}),(0,zi.jsxs)("div",{className:"form-group",children:[(0,zi.jsx)("label",{children:"Foto"}),(0,zi.jsx)("input",{type:"file",accept:"image/*",onChange:t=>{y(t.target.files[0])},required:!0})]}),w&&(0,zi.jsx)("p",{className:"error",children:w}),b&&(0,zi.jsx)("p",{className:"success",style:{color:"green"},children:b}),(0,zi.jsx)("button",{type:"submit",children:"Crear Trabajador"})]})]})},Wi=()=>{const[t,e]=(0,s.useState)([]),[i,n]=(0,s.useState)(!0),[r,a]=(0,s.useState)("");return(0,s.useEffect)((()=>{(async()=>{try{const t=localStorage.getItem("token"),i=await ji.get("/api/users/my-workers",{headers:{Authorization:`Bearer ${t}`}});console.log("Trabajadores recibidos:",i.data),e(i.data)}catch(ny){console.error("Error al obtener trabajadores:",ny),a("No se pudieron cargar los trabajadores.")}finally{n(!1)}})()}),[]),(0,zi.jsxs)("div",{className:"my-workers-container",children:[(0,zi.jsx)("h2",{children:"Mis Trabajadores"}),i&&(0,zi.jsx)("p",{children:"Cargando trabajadores..."}),r&&(0,zi.jsx)("p",{className:"error",children:r}),(0,zi.jsxs)("div",{className:"workers-list",children:[t.map((t=>{var e;return(0,zi.jsxs)("div",{className:"worker-card",children:[(0,zi.jsx)("img",{src:null!==(e=t.photo)&&void 0!==e&&e.startsWith("http")?t.photo:`http://localhost:3000/${t.photo}`,alt:t.fullName,className:"worker-photo"}),(0,zi.jsxs)("div",{className:"worker-info",children:[(0,zi.jsx)("h4",{children:t.fullName}),(0,zi.jsxs)("p",{children:[(0,zi.jsx)("strong",{children:"Rol:"})," ",t.role]}),(0,zi.jsxs)("p",{children:[(0,zi.jsx)("strong",{children:"Email:"})," ",t.email]}),(0,zi.jsxs)("p",{children:[(0,zi.jsx)("strong",{children:"DNI:"})," ",t.dni]}),(0,zi.jsxs)("p",{children:[(0,zi.jsx)("strong",{children:"Tel\xe9fono:"})," ",t.phoneNumber]})]})]},t._id)})),!i&&0===t.length&&(0,zi.jsx)("p",{children:"No hay trabajadores registrados."})]})]})},Ki=()=>{const[t,e]=(0,s.useState)([]),[i,n]=(0,s.useState)(!0),r=nt();return(0,s.useEffect)((()=>{(async()=>{try{const t=localStorage.getItem("token"),i=await ji.get("/api/chips",{headers:{Authorization:`Bearer ${t}`}});e(i.data)}catch(t){console.error("Error al obtener chips:",t)}finally{n(!1)}})()}),[]),(0,zi.jsxs)("div",{className:"chip-list-container",children:[(0,zi.jsx)("h2",{children:"Chips Registrados"}),i?(0,zi.jsx)("p",{children:"Cargando chips..."}):0===t.length?(0,zi.jsx)("p",{children:"No hay chips registrados."}):(0,zi.jsx)("div",{className:"chip-grid",children:t.map((t=>(0,zi.jsxs)("div",{className:"chip-card",onClick:()=>r(`/historial/${t.uid}`),children:[(0,zi.jsx)("h4",{children:t.name||`Chip ${t.uid}`}),(0,zi.jsxs)("p",{children:["UID: ",t.uid]})]},t._id)))})]})},Yi=()=>{const[t,e]=(0,s.useState)(""),[i,n]=(0,s.useState)(!1),[r,a]=(0,s.useState)(null),[o,l]=(0,s.useState)(null),[c,u]=(0,s.useState)([]),[h,d]=(0,s.useState)("");(0,s.useEffect)((()=>{(async()=>{try{const t=localStorage.getItem("token"),e=await ji.get("/api/lotes/abiertos",{headers:{Authorization:`Bearer ${t}`}});u(e.data)}catch(ny){console.error("Error al cargar lotes:",ny),a("No se pudieron cargar los lotes disponibles.")}})()}),[]);return(0,zi.jsxs)("div",{className:"register-chip-container",children:[(0,zi.jsx)("h2",{children:"Registrar Chip NFC"}),(0,zi.jsxs)("div",{className:"scan-section",children:[(0,zi.jsx)("button",{onClick:async()=>{if("NDEFReader"in window)try{const t=new NDEFReader;n(!0),a(null),l(null),await t.scan(),t.onreading=t=>{const{serialNumber:i}=t;console.log("UID le\xeddo:",i),e(i),n(!1)},t.onreadingerror=()=>{a("Error al leer la etiqueta NFC."),n(!1)}}catch(ny){a(`Error iniciando escaneo: ${ny.message}`),n(!1)}else a("Web NFC no es compatible con este dispositivo.")},disabled:i,children:i?"Escaneando...":"Escanear Chip"}),i&&(0,zi.jsx)("div",{className:"scanning-animation",children:"\ud83d\udcf6 Buscando chip NFC..."}),t&&(0,zi.jsxs)("div",{className:"chip-info",children:[(0,zi.jsxs)("p",{children:[(0,zi.jsx)("strong",{children:"UID Detectado:"})," ",t]}),(0,zi.jsx)("label",{children:"Seleccion\xe1 un lote:"}),(0,zi.jsxs)("select",{value:h,onChange:t=>d(t.target.value),required:!0,children:[(0,zi.jsx)("option",{value:"",children:"-- Eleg\xed un lote --"}),c.map((t=>(0,zi.jsxs)("option",{value:t._id,children:[t.name," - ",t.mesDespacho," (",t.maxVacas," vacas)"]},t._id)))]}),(0,zi.jsx)("button",{onClick:async()=>{if(!t)return a("Debes escanear un chip primero.");if(!h)return a("Seleccion\xe1 un lote antes de registrar.");try{const i=localStorage.getItem("token"),n=await ji.post("/api/chips/register",{uid:t,loteId:h},{headers:{Authorization:`Bearer ${i}`}});l(`\u2705 ${n.data.name} registrado correctamente`),a(null),e(""),d("")}catch(ny){var i,n;a((null===(i=ny.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.error)||"Error al registrar el chip"),l(null)}},children:"Registrar Chip"})]}),!i&&!t&&(0,zi.jsx)("p",{className:"waiting-text",children:"Esperando escaneo..."}),r&&(0,zi.jsx)("p",{className:"error",children:r}),o&&(0,zi.jsx)("p",{className:"success",children:o})]})]})},Xi=()=>{const[t,e]=(0,s.useState)([]),[i,n]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(!1),[c,u]=(0,s.useState)(""),[h,d]=(0,s.useState)([]);return(0,zi.jsxs)("div",{className:"mass-scan-container",children:[(0,zi.jsx)("h3",{children:"Escaneo Masivo"}),(0,zi.jsx)("button",{onClick:async()=>{if(!("NDEFReader"in window))return alert("Web NFC no es compatible con este dispositivo.");try{const i=new NDEFReader;l(!0),await i.scan(),i.onreading=async i=>{const n=i.serialNumber;if(t.length>=5)return alert("M\xe1ximo de 5 chips alcanzado"),void l(!1);if(t.includes(n))return alert("Este chip ya fue escaneado"),void l(!1);try{const t=localStorage.getItem("token");await ji.post("/api/chips/validate",{uid:n},{headers:{Authorization:`Bearer ${t}`}});e((t=>[...t,n])),u(`\u2705 Chip ${n} registrado correctamente`)}catch(r){console.error("Chip no registrado:",n),d((t=>[...t,n])),u(`\u274c El chip ${n} no est\xe1 registrado`)}finally{l(!1)}},i.onreadingerror=()=>{alert("Error al leer el chip"),l(!1)}}catch(ny){console.error("Error NFC:",ny),alert("Error al iniciar escaneo"),l(!1)}},disabled:o||t.length>=5,children:o?"Escaneando...":"Escanear Chip"}),(0,zi.jsx)("ul",{children:t.map(((t,e)=>(0,zi.jsxs)("li",{children:["Chip ",e+1,": ",t,h.includes(t)&&(0,zi.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:" \u274c"})]},e)))}),(0,zi.jsx)("label",{children:"Tipo de Evento:"}),(0,zi.jsxs)("select",{value:i,onChange:t=>n(t.target.value),children:[(0,zi.jsx)("option",{value:"",children:"Selecciona..."}),(0,zi.jsx)("option",{value:"Entrada al feed lot",children:"Entrada al feed lot"}),(0,zi.jsx)("option",{value:"Salida del feed lot",children:"Salida del feed lot"}),(0,zi.jsx)("option",{value:"Pastura",children:"Pastura"}),(0,zi.jsx)("option",{value:"Orde\xf1ado",children:"Orde\xf1ado"}),(0,zi.jsx)("option",{value:"Fin del d\xeda",children:"Fin del d\xeda"})]}),(0,zi.jsx)("label",{children:"Descripci\xf3n (opcional):"}),(0,zi.jsx)("input",{type:"text",value:r,onChange:t=>a(t.target.value),placeholder:"Ej: Entrada grupal al mediod\xeda"}),(0,zi.jsx)("button",{onClick:async()=>{try{const s=localStorage.getItem("token"),o=await ji.post("/api/nft/mint-batch",{uids:t,eventType:i,description:r},{headers:{Authorization:`Bearer ${s}`}});u(`\u2705 ${o.data.message} (${o.data.count} chips)`),e([]),n(""),a(""),d([])}catch(ny){var s,o,l;console.error("Error al mintear lote:",ny),(null===(s=ny.response)||void 0===s||null===(o=s.data)||void 0===o||null===(l=o.unregistered)||void 0===l?void 0:l.length)>0?(d(ny.response.data.unregistered),u(`\u274c Chips no registrados: ${ny.response.data.unregistered.join(", ")}`)):u("\u274c Error general al mintear eventos")}},disabled:0===t.length||!i,children:"Mintear Evento en Lote"}),c&&(0,zi.jsx)("p",{style:{marginTop:"1rem",fontWeight:"bold"},children:c})]})},Qi=Number.isFinite||function(t){return"number"===typeof t&&isFinite(t)},Ji=Number.isSafeInteger||function(t){return"number"===typeof t&&Math.abs(t)<=Zi},Zi=Number.MAX_SAFE_INTEGER||9007199254740991;let tn=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),en=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",t.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",t.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.ASSET_LIST_LOAD_ERROR="assetListLoadError",t.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",t.ASSET_LIST_PARSING_ERROR="assetListParsingError",t.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.ATTACH_MEDIA_ERROR="attachMediaError",t.UNKNOWN="unknown",t}({}),nn=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.MEDIA_ENDED="hlsMediaEnded",t.STALL_RESOLVED="hlsStallResolved",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFERED_TO_END="hlsBufferedToEnd",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t.ASSET_LIST_LOADING="hlsAssetListLoading",t.ASSET_LIST_LOADED="hlsAssetListLoaded",t.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",t.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",t.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",t.INTERSTITIAL_STARTED="hlsInterstitialStarted",t.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",t.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",t.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",t.INTERSTITIAL_ENDED="hlsInterstitialEnded",t.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",t.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",t.EVENT_CUE_ENTER="hlsEventCueEnter",t}({});var rn="manifest",sn="level",an="audioTrack",on="subtitleTrack",ln="main",cn="audio",un="subtitle";class hn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class dn{constructor(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new hn(t),this.fast_=new hn(e),this.defaultTTFB_=n,this.ttfb_=new hn(t)}update(t,e){const{slow_:i,fast_:n,ttfb_:r}=this;i.halfLife!==t&&(this.slow_=new hn(t,i.getEstimate(),i.getTotalWeight())),n.halfLife!==e&&(this.fast_=new hn(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.ttfb_=new hn(t,r.getEstimate(),r.getTotalWeight()))}sample(t,e){const i=(t=Math.max(t,this.minDelayMs_))/1e3,n=8*e/i;this.fast_.sample(i,n),this.slow_.sample(i,n)}sampleTTFB(t){const e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function fn(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pn(){return pn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},pn.apply(null,arguments)}function gn(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function mn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?gn(Object(i),!0).forEach((function(e){fn(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):gn(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class vn{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${t}]:`;this.trace=yn,this.debug=e.debug.bind(null,i),this.log=e.log.bind(null,i),this.warn=e.warn.bind(null,i),this.info=e.info.bind(null,i),this.error=e.error.bind(null,i)}}const yn=function(){},bn={trace:yn,debug:yn,log:yn,warn:yn,info:yn,error:yn};function Sn(){return pn({},bn)}function wn(t,e,i){return e[t]?e[t].bind(e):function(t,e){const i=self.console[t];return i?i.bind(self.console,`${e?"["+e+"] ":""}[${t}] >`):yn}(t,i)}const xn=Sn();const En=xn;function Ln(){if("undefined"===typeof self)return;return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function Tn(t,e){const i=Object.keys(t),n=Object.keys(e),r=i.length,s=n.length;return!r||!s||r===s&&!i.some((t=>-1===n.indexOf(t)))}function An(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("undefined"!==typeof TextDecoder){const i=new TextDecoder("utf-8").decode(t);if(e){const t=i.indexOf("\0");return-1!==t?i.substring(0,t):i}return i.replace(/\0/g,"")}const i=t.length;let n,r,s,a="",o=0;for(;o<i;){if(n=t[o++],0===n&&e)return a;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(n);break;case 12:case 13:r=t[o++],a+=String.fromCharCode((31&n)<<6|63&r);break;case 14:r=t[o++],s=t[o++],a+=String.fromCharCode((15&n)<<12|(63&r)<<6|63&s)}}return a}const _n=function(t){let e="";for(let i=0;i<t.length;i++){let n=t[i].toString(16);n.length<2&&(n="0"+n),e+=n}return e};function kn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pn,Rn={exports:{}};var In=function(){return Pn||(Pn=1,t=Rn,function(){var e=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(t,e,n){if(n=n||{},t=t.trim(),!(e=e.trim())){if(!n.alwaysNormalize)return t;var r=s.parseURL(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):e;var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=i.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var c={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(c.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var u=o.path,h=u.substring(0,u.lastIndexOf("/")+1)+a.path;c.path=s.normalizePath(h)}else c.path=o.path,a.params||(c.params=o.params,a.query||(c.query=o.query));return null===c.path&&(c.path=n.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(c)},parseURL:function(t){var i=e.exec(t);return i?{scheme:i[1]||"",netLoc:i[2]||"",path:i[3]||"",params:i[4]||"",query:i[5]||"",fragment:i[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(n,"");t.length!==(t=t.replace(r,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=s}()),Rn.exports;var t}();class Cn{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Dn="audio",Nn="video",On="audiovideo";class Mn{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"===typeof t&&(t={url:t}),this.base=t,function(t,e){const i=jn(t,e);i&&(i.enumerable=!0,Object.defineProperty(t,e,i))}(this,"stats")}setByteRange(t,e){const i=t.split("@",2);let n;n=1===i.length?(null==e?void 0:e.byteRangeEndOffset)||0:parseInt(i[1]),this._byteRange=[n,parseInt(i[0])+n]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[Dn]:null,[Nn]:null,[On]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new Cn),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=In.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[Dn]=null,t[Nn]=null,t[On]=null}}function Fn(t){return"initSegment"!==t.sn}class Bn extends Mn{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange){const t=this.byteRange[0],e=this.byteRange[1];if(Qi(t)&&Qi(e))return e-t}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const t=Qi(this.duration)?this.duration:0;return this.programDateTime+1e3*t}get encrypted(){var t;if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),e=t.length;if(e>1||1===e&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){Qi(t)?this._programDateTime=t:this._programDateTime=this.rawProgramDateTime=null}get ref(){return Fn(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){if(this.levelkeys){const e=this.levelkeys[t];e&&!this._decryptdata&&(this._decryptdata=e.getDecryptData(this.sn))}}abortRequests(){var t,e;null==(t=this.loader)||t.abort(),null==(e=this.keyLoader)||e.abort()}setElementaryStreamInfo(t,e,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const{elementaryStreams:a}=this,o=a[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,i),o.startDTS=Math.min(o.startDTS,n),o.endDTS=Math.max(o.endDTS,r)):a[t]={startPTS:e,endPTS:i,startDTS:n,endDTS:r,partial:s}}}class Un extends Mn{constructor(t,e,i,n,r){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=n;const s=t.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function jn(t,e){const i=Object.getPrototypeOf(t);if(i){const t=Object.getOwnPropertyDescriptor(i,e);return t||jn(i,e)}}const $n=Math.pow(2,32)-1,zn=[].push,Hn={video:1,audio:2,id3:3,text:4};function qn(t){return String.fromCharCode.apply(null,t)}function Gn(t,e){const i=t[e]<<8|t[e+1];return i<0?65536+i:i}function Vn(t,e){const i=Kn(t,e);return i<0?4294967296+i:i}function Wn(t,e){let i=Vn(t,e);return i*=Math.pow(2,32),i+=Vn(t,e+4),i}function Kn(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function Yn(t,e,i){t[e]=i>>24,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i}function Xn(t,e){const i=[];if(!e.length)return i;const n=t.byteLength;for(let r=0;r<n;){const s=Vn(t,r),a=s>1?r+s:n;if(qn(t.subarray(r+4,r+8))===e[0])if(1===e.length)i.push(t.subarray(r+8,a));else{const n=Xn(t.subarray(r+8,a),e.slice(1));n.length&&zn.apply(i,n)}r=a}return i}function Qn(t){const e=[],i=t[0];let n=8;const r=Vn(t,n);n+=4;let s=0,a=0;0===i?(s=Vn(t,n),a=Vn(t,n+4),n+=8):(s=Wn(t,n),a=Wn(t,n+8),n+=16),n+=2;let o=t.length+a;const l=Gn(t,n);n+=2;for(let c=0;c<l;c++){let i=n;const s=Vn(t,i);i+=4;const a=2147483647&s;if(1===(2147483648&s)>>>31)return En.warn("SIDX has hierarchical references (not supported)"),null;const l=Vn(t,i);i+=4,e.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,i+=4,n=i}return{earliestPresentationTime:s,timescale:r,version:i,referencesCount:l,references:e}}function Jn(t){const e=[],i=Xn(t,["moov","trak"]);for(let n=0;n<i.length;n++){const t=i[n],r=Xn(t,["tkhd"])[0];if(r){let i=r[0];const n=Vn(r,0===i?12:20),s=Xn(t,["mdia","mdhd"])[0];if(s){i=s[0];const r=Vn(s,0===i?12:20),a=Xn(t,["mdia","hdlr"])[0];if(a){const i=qn(a.subarray(8,12)),s={soun:Dn,vide:Nn}[i],o=Zn(Xn(t,["mdia","minf","stbl","stsd"])[0]);s?(e[n]={timescale:r,type:s,stsd:o},e[s]=mn({timescale:r,id:n},o)):e[n]={timescale:r,type:i,stsd:o}}}}}return Xn(t,["moov","mvex","trex"]).forEach((t=>{const i=Vn(t,4),n=e[i];n&&(n.default={duration:Vn(t,12),flags:Vn(t,20)})})),e}function Zn(t){const e=t.subarray(8),i=e.subarray(86),n=qn(e.subarray(4,8));let r,s=n;const a="enca"===n||"encv"===n;if(a){const t=Xn(e,[n])[0];Xn(t.subarray("enca"===n?28:78),["sinf"]).forEach((t=>{const e=Xn(t,["schm"])[0];if(e){const i=qn(e.subarray(4,8));if("cbcs"===i||"cenc"===i){const e=Xn(t,["frma"])[0];e&&(s=qn(e))}}}))}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const t=Xn(i,["avcC"])[0];t&&t.length>3&&(s+="."+ir(t[1])+ir(t[2])+ir(t[3]),r=tr("avc1"===o?"dva1":"dvav",i));break}case"mp4a":{const t=Xn(e,[n])[0],i=Xn(t.subarray(28),["esds"])[0];if(i&&i.length>7){let t=4;if(3!==i[t++])break;t=er(i,t),t+=2;const e=i[t++];if(128&e&&(t+=2),64&e&&(t+=i[t++]),4!==i[t++])break;t=er(i,t);const n=i[t++];if(64!==n)break;if(s+="."+ir(n),t+=12,5!==i[t++])break;t=er(i,t);const r=i[t++];let a=(248&r)>>3;31===a&&(a+=1+((7&r)<<3)+((224&i[t])>>5)),s+="."+a}break}case"hvc1":case"hev1":{const t=Xn(i,["hvcC"])[0];if(t&&t.length>12){const e=t[1],i=["","A","B","C"][e>>6],n=31&e,r=Vn(t,2),a=(32&e)>>5?"H":"L",o=t[12],l=t.subarray(6,12);s+="."+i+n,s+="."+r.toString(16).toUpperCase(),s+="."+a+o;let c="";for(let t=l.length;t--;){const e=l[t];if(e||c){c="."+e.toString(16).toUpperCase()+c}}s+=c}r=tr("hev1"==o?"dvhe":"dvh1",i);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=tr(s,i)||s;break;case"vp09":{const t=Xn(i,["vpcC"])[0];if(t&&t.length>6){const e=t[4],i=t[5],n=t[6]>>4&15;s+="."+nr(e)+"."+nr(i)+"."+nr(n)}break}case"av01":{const t=Xn(i,["av1C"])[0];if(t&&t.length>2){const e=t[1]>>>5,n=31&t[1],a=t[2]>>>7?"H":"M",o=(64&t[2])>>6,l=(32&t[2])>>5,c=2===e&&o?l?12:10:o?10:8,u=(16&t[2])>>4,h=(8&t[2])>>3,d=(4&t[2])>>2,f=3&t[2],p=1,g=1,m=1,v=0;s+="."+e+"."+nr(n)+a+"."+nr(c)+"."+u+"."+h+d+f+"."+nr(p)+"."+nr(g)+"."+nr(m)+"."+v,r=tr("dav1",i)}break}}return{codec:s,encrypted:a,supplemental:r}}function tr(t,e){const i=Xn(e,["dvvC"]),n=i.length?i[0]:Xn(e,["dvcC"])[0];if(n){const e=n[2]>>1&127,i=n[2]<<5&32|n[3]>>3&31;return t+"."+nr(e)+"."+nr(i)}}function er(t,e){const i=e+5;for(;128&t[e++]&&e<i;);return e}function ir(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function nr(t){return(t<10?"0":"")+t}function rr(t){const e=Xn(t,["schm"])[0];if(e){const i=qn(e.subarray(4,8));if("cbcs"===i||"cenc"===i)return Xn(t,["schi","tenc"])[0]}return null}function sr(t){const e=Vn(t,0);let i=8;1&e&&(i+=4),4&e&&(i+=4);let n=0;const r=Vn(t,4);for(let s=0;s<r;s++){if(256&e){n+=Vn(t,i),i+=4}512&e&&(i+=4),1024&e&&(i+=4),2048&e&&(i+=4)}return n}function ar(t,e){const i=new Uint8Array(t.length+e.length);return i.set(t),i.set(e,t.length),i}function or(t,e){const i=[],n=e.samples,r=e.timescale,s=e.id;let a=!1;return Xn(n,["moof"]).map((o=>{const l=o.byteOffset-8;Xn(o,["traf"]).map((o=>{const c=Xn(o,["tfdt"]).map((t=>{const e=t[0];let i=Vn(t,4);return 1===e&&(i*=Math.pow(2,32),i+=Vn(t,8)),i/r}))[0];return void 0!==c&&(t=c),Xn(o,["tfhd"]).map((c=>{const u=Vn(c,4),h=16777215&Vn(c,0);let d=0;const f=0!==(16&h);let p=0;const g=0!==(32&h);let m=8;u===s&&(0!==(1&h)&&(m+=8),0!==(2&h)&&(m+=4),0!==(8&h)&&(d=Vn(c,m),m+=4),f&&(p=Vn(c,m),m+=4),g&&(m+=4),"video"===e.type&&(a=lr(e.codec)),Xn(o,["trun"]).map((s=>{const o=s[0],c=16777215&Vn(s,0),u=0!==(1&c);let h=0;const f=0!==(4&c),g=0!==(256&c);let m=0;const v=0!==(512&c);let y=0;const b=0!==(1024&c),S=0!==(2048&c);let w=0;const x=Vn(s,4);let E=8;u&&(h=Vn(s,E),E+=4),f&&(E+=4);let L=h+l;for(let l=0;l<x;l++){if(g?(m=Vn(s,E),E+=4):m=d,v?(y=Vn(s,E),E+=4):y=p,b&&(E+=4),S&&(w=0===o?Vn(s,E):Kn(s,E),E+=4),e.type===Nn){let e=0;for(;e<y;){const s=Vn(n,L);if(L+=4,cr(a,n[L])){ur(n.subarray(L,L+s),a?2:1,t+w/r,i)}L+=s,e+=s+4}}t+=m/r}})))}))}))})),i}function lr(t){if(!t)return!1;const e=t.substring(0,4);return"hvc1"===e||"hev1"===e||"dvh1"===e||"dvhe"===e}function cr(t,e){if(t){const t=e>>1&63;return 39===t||40===t}return 6===(31&e)}function ur(t,e,i,n){const r=hr(t);let s=0;s+=e;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);const t=r.length-s;let e=s;if(o<t)s+=o;else if(o>t){En.error(`Malformed SEI payload. ${o} is too small, only ${t} bytes left to parse.`);break}if(4===a){if(181===r[e++]){const t=Gn(r,e);if(e+=2,49===t){const t=Vn(r,e);if(e+=4,1195456820===t){const t=r[e++];if(3===t){const s=r[e++],o=64&s,l=o?2+3*(31&s):0,c=new Uint8Array(l);if(o){c[0]=s;for(let t=1;t<l;t++)c[t]=r[e++]}n.push({type:t,payloadType:a,pts:i,bytes:c})}}}}}else if(5===a&&o>16){const t=[];for(let i=0;i<16;i++){const n=r[e++].toString(16);t.push(1==n.length?"0"+n:n),3!==i&&5!==i&&7!==i&&9!==i||t.push("-")}const s=o-16,l=new Uint8Array(s);for(let i=0;i<s;i++)l[i]=r[e++];n.push({payloadType:a,pts:i,uuid:t.join(""),userData:An(l),userDataBytes:l})}}}function hr(t){const e=t.byteLength,i=[];let n=1;for(;n<e-2;)0===t[n]&&0===t[n+1]&&3===t[n+2]?(i.push(n+2),n+=2):n++;if(0===i.length)return t;const r=e-i.length,s=new Uint8Array(r);let a=0;for(n=0;n<r;a++,n++)a===i[0]&&(a++,i.shift()),s[n]=t[a];return s}function dr(t,e,i){if(16!==t.byteLength)throw new RangeError("Invalid system id");let n,r,s;n=0,r=new Uint8Array,s=new Uint8Array;const a=new Uint8Array(4);return i&&i.byteLength>0&&new DataView(a.buffer).setUint32(0,i.byteLength,!1),function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];const r=i.length;let s=8,a=r;for(;a--;)s+=i[a].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=255&s,o.set(t,4),a=0,s=8;a<r;a++)o.set(i[a],s),s+=i[a].byteLength;return o}([112,115,115,104],new Uint8Array([0,0,0,0]),t,s,r,a,i||new Uint8Array)}function fr(t){const e=t.getUint32(0),i=t.byteOffset,n=t.byteLength;if(n<e)return{offset:i,size:n};if(1886614376!==t.getUint32(4))return{offset:i,size:e};const r=t.getUint32(8)>>>24;if(0!==r&&1!==r)return{offset:i,size:e};const s=t.buffer,a=_n(new Uint8Array(s,i+12,16)),o=t.getUint32(28);let l=null,c=null;if(0===r){if(e-32<o||o<22)return{offset:i,size:e};c=new Uint8Array(s,i+32,o)}else if(1===r){if(!o||n<i+32+16*o+16)return{offset:i,size:e};l=[];for(let t=0;t<o;t++)l.push(new Uint8Array(s,i+32+16*t,16))}return{version:r,systemId:a,kids:l,data:c,offset:i,size:e}}const pr=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),gr={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function mr(t,e){const i=gr[e];return!!i&&!!i[t.slice(0,4)]}function vr(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!t.split(",").some((t=>!yr(t,e,i)))}function yr(t,e){var i;const n=Ln(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);return null!=(i=null==n?void 0:n.isTypeSupported(br(t,e)))&&i}function br(t,e){return`${e}/mp4;codecs=${t}`}function Sr(t){if(t){const e=t.substring(0,4);return gr.video[e]}return 2}function wr(t){const e=pr();return t.split(",").reduce(((t,i)=>{const n=e&&lr(i)?9:gr.video[i];return n?(2*n+t)/(t?3:2):(gr.audio[i]+t)/(t?2:1)}),0)}const xr={};const Er=/flac|opus|mp4a\.40\.34/i;function Lr(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.replace(Er,(t=>function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(xr[t])return xr[t];const i={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[t];for(let r=0;r<i.length;r++){var n;if(yr(i[r],"audio",e))return xr[t]=i[r],i[r];if("mp3"===i[r]&&null!=(n=Ln(e))&&n.isTypeSupported("audio/mpeg"))return""}return t}(t.toLowerCase(),e)))}function Tr(t,e){if(t&&(t.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(t)))return t;if(e){const i=e.split(",");if(i.length>1){if(t)for(let e=i.length;e--;)if(i[e].substring(0,4)===t.substring(0,4))return i[e];return i[0]}}return e||t}function Ar(t){if(t.startsWith("av01.")){const e=t.split("."),i=["0","111","01","01","01","0"];for(let t=e.length;t>4&&t<10;t++)e[t]=i[t-4];return e.join(".")}return t}function _r(t){const e=Ln(t)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function kr(t){return t.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const Pr={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function Rr(t,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:t}}const Ir={};function Cr(t,e,i,n,r,s){const a=t.audioCodec?t.audioGroups:null,o=null==s?void 0:s.audioCodec,l=null==s?void 0:s.channels,c=l?parseInt(l):o?1/0:2;let u=null;if(null!=a&&a.length)try{u=1===a.length&&a[0]?e.groups[a[0]].channels:a.reduce(((t,i)=>{if(i){const n=e.groups[i];if(!n)throw new Error(`Audio track group ${i} not found`);Object.keys(n.channels).forEach((e=>{t[e]=(t[e]||0)+n.channels[e]}))}return t}),{2:0})}catch(h){return!0}return void 0!==t.videoCodec&&(t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(n,30)||"SDR"!==t.videoRange&&t.videoRange!==i||t.bitrate>Math.max(r,8e6))||!!u&&Qi(c)&&Object.keys(u).some((t=>parseInt(t)>c))}function Dr(t,e,i){const n=t.videoCodec,r=t.audioCodec;if(!n&&!r||!i)return Promise.resolve(Pr);const s=[];if(n){const e={width:t.width,height:t.height,bitrate:Math.ceil(Math.max(.9*t.bitrate,t.averageBitrate)),framerate:t.frameRate||30},i=t.videoRange;"SDR"!==i&&(e.transferFunction=i.toLowerCase());const r=n.split(","),a=navigator.userAgent;if(r.some((t=>lr(t)))&&pr())return Promise.resolve(Rr(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${a})`),s));s.push.apply(s,r.map((t=>({type:"media-source",video:mn(mn({},e),{},{contentType:br(Ar(t),"video")})}))))}return r&&t.audioGroups&&t.audioGroups.forEach((t=>{var i;t&&(null==(i=e.groups[t])||i.tracks.forEach((e=>{if(e.groupId===t){const t=e.channels||"",i=parseFloat(t);Qi(i)&&i>2&&s.push.apply(s,r.split(",").map((t=>({type:"media-source",audio:{contentType:br(t,"audio"),channels:""+i}}))))}})))})),Promise.all(s.map((t=>{const e=function(t){const{audio:e,video:i}=t,n=i||e;if(n){const t=kr(n.contentType);if(i)return`r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${t}_${Math.ceil(i.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${t}`}return""}(t);return Ir[e]||(Ir[e]=i.decodingInfo(t))}))).then((t=>({supported:!t.some((t=>!t.supported)),configurations:s,decodingInfoResults:t}))).catch((t=>({supported:!1,configurations:s,decodingInfoResults:[],error:t})))}const Nr=["NONE","TYPE-0","TYPE-1",null];const Or=["SDR","PQ","HLG"];var Mr="",Fr="YES",Br="v2";function Ur(t){const{canSkipUntil:e,canSkipDateRanges:i,age:n}=t;return e&&n<e/2?i?Br:Fr:Mr}class jr{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return void 0!==this.msn&&e.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class $r{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter((t=>!!t)).map((t=>t.substring(0,4))).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const i=null==(e=t.supplemental)?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return zr(this._audioGroups,t)}hasSubtitleGroup(t){return zr(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e)if("audio"===t){let t=this._audioGroups;t||(t=this._audioGroups=[]),-1===t.indexOf(e)&&t.push(e)}else if("text"===t){let t=this._subtitleGroups;t||(t=this._subtitleGroups=[]),-1===t.indexOf(e)&&t.push(e)}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return null==(t=this.audioGroups)?void 0:t[0]}get textGroupId(){var t;return null==(t=this.subtitleGroups)?void 0:t[0]}addFallback(){}}function zr(t,e){return!(!e||!t)&&-1!==t.indexOf(e)}function Hr(t,e){let i=!1,n=[];if(t&&(i="SDR"!==t,n=[t]),e){n=e.allowedVideoRanges||Or.slice(0);const t="SDR"!==n.join("")&&!e.videoCodec;i=void 0!==e.preferHDR?e.preferHDR:t&&function(){if("function"===typeof matchMedia){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return!0===t.matches}return!1}(),i||(n=["SDR"])}return{preferHDR:i,allowedVideoRanges:n}}const qr=(t,e)=>JSON.stringify(t,(t=>{const e=new WeakSet;return(i,n)=>{if(t&&(n=t(i,n)),"object"===typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})(e));function Gr(t,e){En.log(`[abr] start candidates with "${t}" ignored because ${e}`)}function Vr(t){return t.reduce(((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);const n=e.channels||"2";return i.channels[n]=(i.channels[n]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Wr(t){if(!t)return t;const{lang:e,assocLang:i,characteristics:n,channels:r,audioCodec:s}=t;return{lang:e,assocLang:i,characteristics:n,channels:r,audioCodec:s}}function Kr(t,e,i){if("attrs"in t){const i=e.indexOf(t);if(-1!==i)return i}for(let n=0;n<e.length;n++){if(Yr(t,e[n],i))return n}return-1}function Yr(t,e,i){const{groupId:n,name:r,lang:s,assocLang:a,default:o}=t,l=t.forced;return(void 0===n||e.groupId===n)&&(void 0===r||e.name===r)&&(void 0===s||function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"--";if(t.length===e.length)return t===e;return t.startsWith(e)||e.startsWith(t)}(s,e.lang))&&(void 0===s||e.assocLang===a)&&(void 0===o||e.default===o)&&(void 0===l||e.forced===l)&&(!("characteristics"in t)||function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=t.split(","),n=e.split(",");return i.length===n.length&&!i.some((t=>-1===n.indexOf(t)))}(t.characteristics||"",e.characteristics))&&(void 0===i||i(t,e))}function Xr(t,e){const{audioCodec:i,channels:n}=t;return(void 0===i||(e.audioCodec||"").substring(0,4)===i.substring(0,4))&&(void 0===n||n===(e.channels||"2"))}function Qr(t,e,i){for(let n=e;n>-1;n--)if(i(t[n]))return n;for(let n=e+1;n<t.length;n++)if(i(t[n]))return n;return-1}function Jr(t,e){var i;return!!t&&t!==(null==(i=e.loadLevelObj)?void 0:i.uri)}const Zr=function(t,e){let i=0,n=t.length-1,r=null,s=null;for(;i<=n;){r=(i+n)/2|0,s=t[r];const a=e(s);if(a>0)i=r+1;else{if(!(a<0))return s;n=r-1}}return null};function ts(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.005,s=null;if(t){s=e[1+t.sn-e[0].sn]||null;const n=t.endDTS-i;n>0&&n<15e-7&&(i+=15e-7),s&&t.level!==s.level&&s.end<=t.end&&(s=e[2+t.sn-e[0].sn]||null)}else 0===i&&0===e[0].start&&(s=e[0]);if(s&&((!t||t.level===s.level)&&0===es(i,n,s)||function(t,e,i){if(e&&0===e.start&&e.level<t.level&&(e.endPTS||0)>0){const n=e.tagList.reduce(((t,e)=>("INF"===e[0]&&(t+=parseFloat(e[1])),t)),i);return t.start<=n}return!1}(s,t,Math.min(r,n))))return s;const a=Zr(e,es.bind(null,i,n));return!a||a===t&&s?s:a}function es(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(i.start<=t&&i.start+i.duration>t)return 0;const n=Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-n<=t?1:i.start-n>t&&i.start?-1:0}function is(t,e,i){const n=1e3*Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-n>t}function ns(t,e){return Zr(t,(t=>t.cc<e?1:t.cc>e?-1:0))}function rs(t){switch(t.details){case en.FRAG_LOAD_TIMEOUT:case en.KEY_LOAD_TIMEOUT:case en.LEVEL_LOAD_TIMEOUT:case en.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ss(t,e){const i=rs(e);return t.default[(i?"timeout":"error")+"Retry"]}function as(t,e){const i="linear"===t.backoff?1:Math.pow(2,e);return Math.min(i*t.retryDelayMs,t.maxRetryDelayMs)}function os(t){return mn(mn({},t),{errorRetry:null,timeoutRetry:null})}function ls(t,e,i,n){if(!t)return!1;const r=null==n?void 0:n.code,s=e<t.maxNumRetry&&(function(t){return 0===t&&!1===navigator.onLine||!!t&&(t<400||t>499)}(r)||!!i);return t.shouldRetry?t.shouldRetry(t,e,i,n,s):s}var cs=0,us=2,hs=3,ds=5,fs=0,ps=1,gs=2;function ms(t){const e={action:cs,flags:fs};return t&&(e.resolved=!0),e}var vs="NOT_LOADED",ys="APPENDING",bs="PARTIAL",Ss="OK";class ws{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.BUFFER_APPENDED,this.onBufferAppended,this),t.on(nn.FRAG_BUFFERED,this.onFragBuffered,this),t.on(nn.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.BUFFER_APPENDED,this.onBufferAppended,this),t.off(nn.FRAG_BUFFERED,this.onFragBuffered,this),t.off(nn.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const i=this.activePartLists[e];if(i)for(let n=i.length;n--;){const e=i[n];if(!e)break;const r=e.end;if(e.start<=t&&null!==r&&t<=r)return e}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,i){const{fragments:n}=this,r=Object.keys(n);for(let s=r.length;s--;){const a=n[r[s]];if((null==a?void 0:a.body.type)===e&&(!i||a.buffered)){const e=a.body;if(e.start<=t&&t<=e.end)return e}}return null}detectEvictedFragments(t,e,i,n,r){this.timeRanges&&(this.timeRanges[t]=e);const s=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((n=>{const a=this.fragments[n];if(!a)return;if(s>=a.body.sn)return;if(!a.buffered&&(!a.loaded||r))return void(a.body.type===i&&this.removeFragment(a.body));const o=a.range[t];o&&(0!==o.time.length?o.time.some((t=>{const i=!this.isTimeBuffered(t.startPTS,t.endPTS,e);return i&&this.removeFragment(a.body),i})):this.removeFragment(a.body))}))}detectPartialFragments(t){const e=this.timeRanges;if(!e||"initSegment"===t.frag.sn)return;const i=t.frag,n=Es(i),r=this.fragments[n];if(!r||r.buffered&&i.gap)return;const s=!i.relurl;if(Object.keys(e).forEach((n=>{const a=i.elementaryStreams[n];if(!a)return;const o=e[n],l=s||!0===a.partial;r.range[n]=this.getBufferedTimes(i,t.part,l,o)})),r.loaded=null,Object.keys(r.range).length){r.buffered=!0;(r.body.endList=i.endList||r.body.endList)&&(this.endListFragments[r.body.type]=r),xs(r)||this.removeParts(i.sn-1,i.type)}else this.removeFragment(r.body)}removeParts(t,e){const i=this.activePartLists[e];i&&(this.activePartLists[e]=Ls(i,(e=>e.fragment.sn>=t)))}fragBuffered(t,e){const i=Es(t);let n=this.fragments[i];!n&&e&&(n=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(t,e,i,n){const r={time:[],partial:i},s=t.start,a=t.end,o=t.minEndPTS||a,l=t.maxStartPTS||s;for(let c=0;c<n.length;c++){const t=n.start(c)-this.bufferPadding,e=n.end(c)+this.bufferPadding;if(l>=t&&o<=e){r.time.push({startPTS:Math.max(s,n.start(c)),endPTS:Math.min(a,n.end(c))});break}if(s<e&&a>t){const t=Math.max(s,n.start(c)),e=Math.min(a,n.end(c));e>t&&(r.partial=!0,r.time.push({startPTS:t,endPTS:e}))}else if(a<=t)break}return r}getPartialFragment(t){let e,i,n,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((l=>{const c=o[l];c&&xs(c)&&(i=c.body.start-a,n=c.body.end+a,t>=i&&t<=n&&(e=Math.min(t-i,n-t),s<=e&&(r=c.body,s=e)))})),r}isEndListAppended(t){const e=this.endListFragments[t];return void 0!==e&&(e.buffered||xs(e))}getState(t){const e=Es(t),i=this.fragments[e];return i?i.buffered?xs(i)?bs:Ss:ys:vs}isTimeBuffered(t,e,i){let n,r;for(let s=0;s<i.length;s++){if(n=i.start(s)-this.bufferPadding,r=i.end(s)+this.bufferPadding,t>=n&&e<=r)return!0;if(e<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if("initSegment"===e.frag.sn||e.frag.bitrateTest)return;const i=e.frag,n=e.part?null:e,r=Es(i);this.fragments[r]={body:i,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:n,timeRanges:r,type:s}=e;if("initSegment"===i.sn)return;const a=i.type;if(n){let t=this.activePartLists[a];t||(this.activePartLists[a]=t=[]),t.push(n)}this.timeRanges=r;const o=r[s];this.detectEvictedFragments(s,o,a,n)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=Es(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,i=Object.keys(e);if(!t)return i.length>0;for(let n=i.length;n--;){const r=e[i[n]];if((null==r?void 0:r.body.type)===t)return!0}return!1}hasParts(t){var e;return!(null==(e=this.activePartLists[t])||!e.length)}removeFragmentsInRange(t,e,i,n,r){n&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==i||n&&!o.gap||o.start<e&&o.end>t&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(t){const e=Es(t);t.clearElementaryStreamInfo();const i=this.activePartLists[t.type];if(i){const e=t.sn;this.activePartLists[t.type]=Ls(i,(t=>t.fragment.sn!==e))}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t,e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const i=null==(t=this.hls)||null==(e=t.latestLevelDetails)?void 0:e.partList;i&&i.forEach((t=>t.clearElementaryStreamInfo()))}}function xs(t){var e,i,n;return t.buffered&&(t.body.gap||(null==(e=t.range.video)?void 0:e.partial)||(null==(i=t.range.audio)?void 0:i.partial)||(null==(n=t.range.audiovideo)?void 0:n.partial))}function Es(t){return`${t.type}_${t.level}_${t.sn}`}function Ls(t,e){return t.filter((t=>{const i=e(t);return i||t.clearElementaryStreamInfo(),i}))}var Ts=0,As=1;class _s{constructor(t,e,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=i}decrypt(t,e){switch(this.aesMode){case Ts:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case As:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}class ks{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let n=0;n<4;n++)i[n]=e.getUint32(4*n);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,n=i[0],r=i[1],s=i[2],a=i[3],o=this.invSubMix,l=o[0],c=o[1],u=o[2],h=o[3],d=new Uint32Array(256);let f=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let i=p^p<<1^p<<2^p<<3^p<<4;i=i>>>8^255&i^99,t[f]=i,e[i]=f;const o=d[f],g=d[o],m=d[g];let v=257*d[i]^16843008*i;n[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,s[f]=v<<8|v>>>24,a[f]=v,v=16843009*m^65537*g^257*o^16843008*f,l[i]=v<<24|v>>>8,c[i]=v<<16|v>>>16,u[i]=v<<8|v>>>24,h[i]=v,f?(f=o^d[d[d[m^o]]],p^=d[d[p]]):f=p=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,n=0;for(;n<e.length&&i;)i=e[n]===this.key[n],n++;if(i)return;this.key=e;const r=this.keySize=e.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),u=this.sBox,h=this.rcon,d=this.invSubMix,f=d[0],p=d[1],g=d[2],m=d[3];let v,y;for(a=0;a<s;a++)a<r?v=l[a]=e[a]:(y=v,a%r===0?(y=y<<8|y>>>24,y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y],y^=h[a/r|0]<<24):r>6&&a%r===4&&(y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y]),l[a]=v=(l[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?l[a]:l[a-4],c[o]=o<4||a<=4?y:f[u[y>>>24]]^p[u[y>>>16&255]]^g[u[y>>>8&255]]^m[u[255&y]],c[o]=c[o]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,i){const n=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],c=a[2],u=a[3],h=this.uint8ArrayToUint32Array_(i);let d=h[0],f=h[1],p=h[2],g=h[3];const m=new Int32Array(t),v=new Int32Array(m.length);let y,b,S,w,x,E,L,T,A,_,k,P,R,I;const C=this.networkToHostOrderSwap;for(;e<m.length;){for(A=C(m[e]),_=C(m[e+1]),k=C(m[e+2]),P=C(m[e+3]),x=A^r[0],E=P^r[1],L=k^r[2],T=_^r[3],R=4,I=1;I<n;I++)y=o[x>>>24]^l[E>>16&255]^c[L>>8&255]^u[255&T]^r[R],b=o[E>>>24]^l[L>>16&255]^c[T>>8&255]^u[255&x]^r[R+1],S=o[L>>>24]^l[T>>16&255]^c[x>>8&255]^u[255&E]^r[R+2],w=o[T>>>24]^l[x>>16&255]^c[E>>8&255]^u[255&L]^r[R+3],x=y,E=b,L=S,T=w,R+=4;y=s[x>>>24]<<24^s[E>>16&255]<<16^s[L>>8&255]<<8^s[255&T]^r[R],b=s[E>>>24]<<24^s[L>>16&255]<<16^s[T>>8&255]<<8^s[255&x]^r[R+1],S=s[L>>>24]<<24^s[T>>16&255]<<16^s[x>>8&255]<<8^s[255&E]^r[R+2],w=s[T>>>24]<<24^s[x>>16&255]<<16^s[E>>8&255]<<8^s[255&L]^r[R+3],v[e]=C(y^d),v[e+1]=C(w^f),v[e+2]=C(S^p),v[e+3]=C(b^g),d=A,f=_,p=k,g=P,e+=4}return v.buffer}}class Ps{constructor(t,e,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=i}expandKey(){const t=function(t){switch(t){case Ts:return"AES-CBC";case As:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${t}`)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}class Rs{constructor(t){let{removePKCS7Padding:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const t=self.crypto;t&&(this.subtle=t.subtle||t.webkitSubtle)}catch(Bw){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?function(t){const e=t.byteLength,i=e&&new DataView(t.buffer).getUint8(e-1);return i?t.slice(0,e-i):t}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,n){return this.useSoftware?new Promise(((r,s)=>{const a=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(a,e,i,n);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(t),e,i,n)}softwareDecrypt(t,e,i,n){const{currentIV:r,currentResult:s,remainderData:a}=this;if(n!==Ts||16!==e.byteLength)return En.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(t=ar(a,t),this.remainderData=null);const o=this.getValidChunk(t);if(!o.length)return null;r&&(i=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new ks),l.expandKey(e);const c=s;return this.currentResult=l.decrypt(o.buffer,0,i),this.currentIV=o.slice(-16).buffer,c||null}webCryptoDecrypt(t,e,i,n){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,n));this.key=e,this.fastAesKey=new Ps(this.subtle,e,n)}return this.fastAesKey.expandKey().then((e=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new _s(this.subtle,new Uint8Array(i),n).decrypt(t.buffer,e)})).catch((r=>(En.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(t,e,i,n))))}onWebCryptoError(t,e,i,n){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,n);const r=this.flush();if(r)return r.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const i=t.length-t.length%16;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e}logOnce(t){this.logEnabled&&(En.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const Is=Math.pow(2,17);class Cs{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new Os({type:tn.NETWORK_ERROR,details:en.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();const n=this.config,r=n.fLoader,s=n.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),t.gap){if(t.tagList.some((t=>"GAP"===t[0])))return void o(Ns(t));t.gap=!1}const l=this.loader=r?new r(n):new s(n),c=Ds(t);t.loader=l;const u=os(n.fragLoadPolicy.default),h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===t.sn?1/0:Is};t.stats=l.stats;const d={onSuccess:(e,i,n,r)=>{this.resetLoader(t,l);let s=e.data;n.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:t,part:null,payload:s,networkDetails:r})},onError:(e,n,r,s)=>{this.resetLoader(t,l),o(new Os({type:tn.NETWORK_ERROR,details:en.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:mn({url:i,data:void 0},e),error:new Error(`HTTP Error ${e.code} ${e.text}`),networkDetails:r,stats:s}))},onAbort:(e,i,n)=>{this.resetLoader(t,l),o(new Os({type:tn.NETWORK_ERROR,details:en.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:n,stats:e}))},onTimeout:(e,i,n)=>{this.resetLoader(t,l),o(new Os({type:tn.NETWORK_ERROR,details:en.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:n,stats:e}))}};e&&(d.onProgress=(i,n,r,s)=>e({frag:t,part:null,payload:r,networkDetails:s})),l.load(c,h,d)}))}loadPart(t,e,i){this.abort();const n=this.config,r=n.fLoader,s=n.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap)return void o(Ns(t,e));const l=this.loader=r?new r(n):new s(n),c=Ds(t,e);t.loader=l;const u=os(n.fragLoadPolicy.default),h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Is};e.stats=l.stats,l.load(c,h,{onSuccess:(n,r,s,o)=>{this.resetLoader(t,l),this.updateStatsFromPart(t,e);const c={frag:t,part:e,payload:n.data,networkDetails:o};i(c),a(c)},onError:(i,n,r,s)=>{this.resetLoader(t,l),o(new Os({type:tn.NETWORK_ERROR,details:en.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:mn({url:c.url,data:void 0},i),error:new Error(`HTTP Error ${i.code} ${i.text}`),networkDetails:r,stats:s}))},onAbort:(i,n,r)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,l),o(new Os({type:tn.NETWORK_ERROR,details:en.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:r,stats:i}))},onTimeout:(i,n,r)=>{this.resetLoader(t,l),o(new Os({type:tn.NETWORK_ERROR,details:en.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:r,stats:i}))}})}))}updateStatsFromPart(t,e){const i=t.stats,n=e.stats,r=n.total;if(i.loaded+=n.loaded,r){const n=Math.round(t.duration/e.duration),s=Math.min(Math.round(i.loaded/r),n),a=(n-s)*Math.round(i.loaded/s);i.total=i.loaded+a}else i.total=Math.max(i.loaded,i.total);const s=i.loading,a=n.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function Ds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=e||t,n={frag:t,part:e,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},r=i.byteRangeStartOffset,s=i.byteRangeEndOffset;if(Qi(r)&&Qi(s)){var a;let e=r,i=s;if("initSegment"===t.sn&&("AES-128"===(o=null==(a=t.decryptdata)?void 0:a.method)||"AES-256"===o)){const t=s-r;t%16&&(i=s+(16-t%16)),0!==r&&(n.resetIV=!0,e=r-16)}n.rangeStart=e,n.rangeEnd=i}var o;return n}function Ns(t,e){const i=new Error(`GAP ${t.gap?"tag":"attribute"} found`),n={type:tn.MEDIA_ERROR,details:en.FRAG_GAP,fatal:!1,frag:t,error:i,networkDetails:null};return e&&(n.part=e),(e||t).stats.aborted=!0,new Os(n)}class Os extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class Ms extends vn{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Fs{constructor(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=i,this.size=n,this.part=r,this.partial=s}}const Bs={length:0,start:()=>0,end:()=>0};class Us{static isBuffered(t,e){if(t){const i=Us.getBuffered(t);for(let t=i.length;t--;)if(e>=i.start(t)&&e<=i.end(t))return!0}return!1}static bufferedRanges(t){if(t){const e=Us.getBuffered(t);return Us.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e}static bufferInfo(t,e,i){if(t){const n=Us.bufferedRanges(t);if(n.length)return Us.bufferedInfo(n,e,i)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.length>1&&t.sort(((t,e)=>t.start-e.start||e.end-t.end));let n=-1,r=[];if(i)for(let c=0;c<t.length;c++){e>=t[c].start&&e<=t[c].end&&(n=c);const s=r.length;if(s){const e=r[s-1].end;t[c].start-e<i?t[c].end>e&&(r[s-1].end=t[c].end):r.push(t[c])}else r.push(t[c])}else r=t;let s,a=0,o=e,l=e;for(let c=0;c<r.length;c++){const t=r[c].start,u=r[c].end;if(-1===n&&e>=t&&e<=u&&(n=c),e+i>=t&&e<u)o=t,l=u,a=l-e;else if(e+i<t){s=t;break}}return{len:a,start:o||0,end:l||0,nextStart:s,buffered:t,bufferedIndex:n}}static getBuffered(t){try{return t.buffered||Bs}catch(Bw){return En.log("failed to get media.buffered",Bw),Bs}}}const js=/\{\$([a-zA-Z0-9-_]+)\}/g;function $s(t){return js.test(t)}function zs(t,e){if(null!==t.variableList||t.hasVariableRefs){const i=t.variableList;return e.replace(js,(e=>{const n=e.substring(2,e.length-1),r=null==i?void 0:i[n];return void 0===r?(t.playlistParsingError||(t.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),e):r}))}return e}function Hs(t,e,i){let n,r,s=t.variableList;if(s||(t.variableList=s={}),"QUERYPARAM"in e){n=e.QUERYPARAM;try{const t=new self.URL(i).searchParams;if(!t.has(n))throw new Error(`"${n}" does not match any query parameter in URI: "${i}"`);r=t.get(n)}catch(a){t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else n=e.NAME,r=e.VALUE;n in s?t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):s[n]=r||""}function qs(t,e,i){const n=e.IMPORT;if(i&&n in i){let e=t.variableList;e||(t.variableList=e={}),e[n]=i[n]}else t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const Gs=/^(\d+)x(\d+)$/,Vs=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Ws{constructor(t,e){"string"===typeof t&&(t=Ws.parseAttrList(t,e)),pn(this,t)}get clientAttrs(){return Object.keys(this).filter((t=>"X-"===t.substring(0,2)))}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;const i=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)i[t]=parseInt(e.slice(2*t,2*t+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const i=this[t];return(i?i.split(/[ ,]+/):[]).reduce(((t,e)=>(t[e.toLowerCase()]=!0,t)),e)}bool(t){return"YES"===this[t]}decimalResolution(t){const e=Gs.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let i;const n={};for(Vs.lastIndex=0;null!==(i=Vs.exec(t));){const r=i[1].trim();let s=i[2];const a=0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1;let o=!1;if(a)s=s.slice(1,-1);else switch(r){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0}if(e&&(a||o))s=zs(e,s);else if(!o&&!a)switch(r){case"CLOSED-CAPTIONS":if("NONE"===s)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":En.warn(`${t}: attribute ${r} is missing quotes`)}n[r]=s}return n}}function Ks(t){return"SCTE35-OUT"===t||"SCTE35-IN"===t||"SCTE35-CMD"===t}class Ys{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==e?void 0:e.tagAnchor)||null,this.tagOrder=null!=(n=null==e?void 0:e.tagOrder)?n:i,e){const i=e.attr;for(const e in i)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e]!==i[e]){En.warn(`DATERANGE tag attribute: "${e}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=e;break}t=pn(new Ws({}),i,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const t=(null==e?void 0:e.endDate)||new Date(this.attr["END-DATE"]);Qi(t.getTime())&&(this._endDate=t)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return void 0===t?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return null===t||null===t.programDateTime?(En.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return null!==e?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(Qi(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&Qi(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class Xs{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t)return this.advanced=!0,void(this.updated=!0);const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||0===e&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1}get hasProgramDateTime(){return!!this.fragments.length&&Qi(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const t=this.driftEndTime-this.driftStartTime;if(t>0){return 1e3*(this.driftEnd-this.driftStart)/t}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return null!=(t=this.fragments)&&t.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var t;return null!=(t=this.fragments)&&t.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(-1!==e){for(let i=t.length;i--;)if(t[i].index>e)return t[i].index;return e}}return 0}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}}function Qs(t){return"AES-128"===t||"AES-256"===t||"AES-256-CTR"===t}function Js(t){switch(t){case"AES-128":case"AES-256":return Ts;case"AES-256-CTR":return As;default:throw new Error(`invalid full segment method ${t}`)}}function Zs(t){return Uint8Array.from(atob(t),(t=>t.charCodeAt(0)))}function ta(t){return Uint8Array.from(unescape(encodeURIComponent(t)),(t=>t.charCodeAt(0)))}function ea(t){const e=t.split(":");let i=null;if("data"===e[0]&&2===e.length){const t=e[1].split(";"),n=t[t.length-1].split(",");if(2===n.length){const e="base64"===n[0],r=n[1];e?(t.splice(-1,1),i=Zs(r)):i=function(t){const e=ta(t).subarray(0,16),i=new Uint8Array(16);return i.set(e,16-e.length),i}(r)}}return i}const ia="undefined"!==typeof self?self:void 0;var na={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ra="org.w3.clearkey",sa="com.apple.streamingkeydelivery",aa="com.microsoft.playready",oa="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function la(t){switch(t){case sa:return na.FAIRPLAY;case aa:return na.PLAYREADY;case oa:return na.WIDEVINE;case ra:return na.CLEARKEY}}var ca="1077efecc0b24d02ace33c1e52e2fb4b",ua="e2719d58a985b3c9781ab030af78d30e",ha="9a04f07998404286ab92e65be0885f95",da="edef8ba979d64acea3c827dcd51d21ed";function fa(t){return t===da?na.WIDEVINE:t===ha?na.PLAYREADY:t===ca||t===ua?na.CLEARKEY:void 0}function pa(t){switch(t){case na.FAIRPLAY:return sa;case na.PLAYREADY:return aa;case na.WIDEVINE:return oa;case na.CLEARKEY:return ra}}function ga(t){const{drmSystems:e,widevineLicenseUrl:i}=t,n=e?[na.FAIRPLAY,na.WIDEVINE,na.PLAYREADY,na.CLEARKEY].filter((t=>!!e[t])):[];return!n[na.WIDEVINE]&&i&&n.push(na.WIDEVINE),n}const ma=null!=ia&&null!=(va=ia.navigator)&&va.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var va;function ya(t){const e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),i=String.fromCharCode.apply(null,Array.from(e)),n=i.substring(i.indexOf("<"),i.length),r=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(r){const t=r.childNodes[0]?r.childNodes[0].nodeValue:r.getAttribute("VALUE");if(t){const e=Zs(t).subarray(0,16);return function(t){const e=function(t,e,i){const n=t[e];t[e]=t[i],t[i]=n};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}(e),e}}return null}let ba={};class Sa{static clearKeyUriToKeyIdMap(){ba={}}constructor(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=n,this.iv=r,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&!Qs(t)}isSupported(){if(this.method){if(Qs(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case sa:case oa:case aa:case ra:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(Qs(this.method)&&this.uri&&!this.iv){"number"!==typeof t&&(En.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const e=function(t){const e=new Uint8Array(16);for(let i=12;i<16;i++)e[i]=t>>8*(15-i)&255;return e}(t);return new Sa(this.method,this.uri,"identity",this.keyFormatVersions,e)}const e=ea(this.uri);if(e)switch(this.keyFormat){case oa:this.pssh=e,e.length>=22&&(this.keyId=e.subarray(e.length-22,e.length-6));break;case aa:{const t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=dr(t,0,e),this.keyId=ya(e);break}default:{let t=e.subarray(0,16);if(16!==t.length){const e=new Uint8Array(16);e.set(t,16-t.length),t=e}this.keyId=t;break}}if(!this.keyId||16!==this.keyId.byteLength){let t=ba[this.uri];if(!t){const e=Object.keys(ba).length%Number.MAX_SAFE_INTEGER;t=new Uint8Array(16);new DataView(t.buffer,12,4).setUint32(0,e),ba[this.uri]=t}this.keyId=t}return this}}const wa=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,xa=/#EXT-X-MEDIA:(.*)/g,Ea=/^#EXT(?:INF|-X-TARGETDURATION):/m,La=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Ta=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Aa{static findGroup(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n.id===e)return n}}static resolve(t,e){return In.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return Ea.test(t)}static parseMasterPlaylist(t,e){const i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:$s(t)},n=[];let r;for(wa.lastIndex=0;null!=(r=wa.exec(t));)if(r[1]){var s;const t=new Ws(r[1],i),a=zs(i,r[2]),o={attrs:t,bitrate:t.decimalInteger("BANDWIDTH")||t.decimalInteger("AVERAGE-BANDWIDTH"),name:t.NAME,url:Aa.resolve(a,e)},l=t.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),Ia(t.CODECS,o);const c=t["SUPPLEMENTAL-CODECS"];c&&(o.supplemental={},Ia(c,o.supplemental)),null!=(s=o.unknownCodecs)&&s.length||n.push(o),i.levels.push(o)}else if(r[3]){const t=r[3],n=r[4];switch(t){case"SESSION-DATA":{const t=new Ws(n,i),e=t["DATA-ID"];e&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[e]=t);break}case"SESSION-KEY":{const t=Pa(n,e,i);t.encrypted&&t.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(t)):En.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":Hs(i,new Ws(n,i),e);break;case"CONTENT-STEERING":{const t=new Ws(n,i);i.contentSteering={uri:Aa.resolve(t["SERVER-URI"],e),pathwayId:t["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=Ra(n)}}const a=n.length>0&&n.length<i.levels.length;return i.levels=a?n:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(t,e,i){let n;const r={},s=i.levels,a={AUDIO:s.map((t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec}))),SUBTITLES:s.map((t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;for(xa.lastIndex=0;null!==(n=xa.exec(t));){const t=new Ws(n[1],i),s=t.TYPE;if(s){const i=a[s],n=r[s]||[];r[s]=n;const l=t.LANGUAGE,c=t["ASSOC-LANGUAGE"],u=t.CHANNELS,h=t.CHARACTERISTICS,d=t["INSTREAM-ID"],f={attrs:t,bitrate:0,id:o++,groupId:t["GROUP-ID"]||"",name:t.NAME||l||"",type:s,default:t.bool("DEFAULT"),autoselect:t.bool("AUTOSELECT"),forced:t.bool("FORCED"),lang:l,url:t.URI?Aa.resolve(t.URI,e):""};if(c&&(f.assocLang=c),u&&(f.channels=u),h&&(f.characteristics=h),d&&(f.instreamId=d),null!=i&&i.length){const t=Aa.findGroup(i,f.groupId)||i[0];Ca(f,t,"audioCodec"),Ca(f,t,"textCodec")}n.push(f)}}return r}static parseLevelPlaylist(t,e,i,n,r,s){var a;const o={url:e},l=new Xs(e),c=l.fragments,u=[];let h,d,f,p,g=null,m=0,v=0,y=0,b=0,S=0,w=null,x=new Bn(n,o),E=-1,L=!1,T=null;if(La.lastIndex=0,l.m3u8=t,l.hasVariableRefs=$s(t),"#EXTM3U"!==(null==(a=La.exec(t))?void 0:a[0]))return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;for(;null!==(h=La.exec(t));){L&&(L=!1,x=new Bn(n,o),x.playlistOffset=y,x.start=y,x.sn=m,x.cc=b,S&&(x.bitrate=S),x.level=i,g&&(x.initSegment=g,g.rawProgramDateTime&&(x.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),T&&(x.setByteRange(T),T=null)));const t=h[1];if(t){x.duration=parseFloat(t);const e=(" "+h[2]).slice(1);x.title=e||null,x.tagList.push(e?["INF",t,e]:["INF",t])}else if(h[3]){if(Qi(x.duration)){x.playlistOffset=y,x.start=y,f&&Oa(x,f,l),x.sn=m,x.level=i,x.cc=b,c.push(x);const t=(" "+h[3]).slice(1);x.relurl=zs(l,t),Da(x,w,u),w=x,y+=x.duration,m++,v=0,L=!0}}else{if(h=h[0].match(Ta),!h){En.warn("No matches on slow regex match for level playlist!");continue}for(d=1;d<h.length&&void 0===h[d];d++);const t=(" "+h[d]).slice(1),r=(" "+h[d+1]).slice(1),a=h[d+2]?(" "+h[d+2]).slice(1):null;switch(t){case"BYTERANGE":w?x.setByteRange(r,w):x.setByteRange(r);break;case"PROGRAM-DATE-TIME":x.rawProgramDateTime=r,x.tagList.push(["PROGRAM-DATE-TIME",r]),-1===E&&(E=c.length);break;case"PLAYLIST-TYPE":l.type&&Ma(l,t,h),l.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":0!==l.startSN?Ma(l,t,h):c.length>0&&Fa(l,t,h),m=l.startSN=parseInt(r);break;case"SKIP":{l.skippedSegments&&Ma(l,t,h);const e=new Ws(r,l),i=e.decimalInteger("SKIPPED-SEGMENTS");if(Qi(i)){l.skippedSegments+=i;for(let t=i;t--;)c.push(null);m+=i}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(n.split("\t")));break}case"TARGETDURATION":0!==l.targetduration&&Ma(l,t,h),l.targetduration=Math.max(parseInt(r),1);break;case"VERSION":null!==l.version&&Ma(l,t,h),l.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||Ma(l,t,h),l.live=!1;break;case"#":(r||a)&&x.tagList.push(a?[r,a]:[r]);break;case"DISCONTINUITY":b++,x.tagList.push(["DIS"]);break;case"GAP":x.gap=!0,x.tagList.push([t]);break;case"BITRATE":x.tagList.push([t,r]),S=1e3*parseInt(r),Qi(S)?x.bitrate=S:S=0;break;case"DATERANGE":{const t=new Ws(r,l),e=new Ys(t,l.dateRanges[t.ID],l.dateRangeTagCount);l.dateRangeTagCount++,e.isValid||l.skippedSegments?l.dateRanges[e.id]=e:En.warn(`Ignoring invalid DATERANGE tag: "${r}"`),x.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const t=new Ws(r,l);"IMPORT"in t?qs(l,t,s):Hs(l,t,e)}break;case"DISCONTINUITY-SEQUENCE":0!==l.startCC?Ma(l,t,h):c.length>0&&Fa(l,t,h),l.startCC=b=parseInt(r);break;case"KEY":{const t=Pa(r,e,l);if(t.isSupported()){if("NONE"===t.method){f=void 0;break}f||(f={}),f[t.keyFormat]&&(f=pn({},f)),f[t.keyFormat]=t}else En.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":l.startTimeOffset=Ra(r);break;case"MAP":{const t=new Ws(r,l);if(x.duration){const e=new Bn(n,o);Na(e,t,i,f),g=e,x.initSegment=g,g.rawProgramDateTime&&!x.rawProgramDateTime&&(x.rawProgramDateTime=g.rawProgramDateTime)}else{const e=x.byteRangeEndOffset;if(e){const t=x.byteRangeStartOffset;T=`${e-t}@${t}`}else T=null;Na(x,t,i,f),g=x,L=!0}g.cc=b;break}case"SERVER-CONTROL":p&&Ma(l,t,h),p=new Ws(r),l.canBlockReload=p.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=p.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&p.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=p.optionalFloat("PART-HOLD-BACK",0),l.holdBack=p.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{l.partTarget&&Ma(l,t,h);const e=new Ws(r);l.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let t=l.partList;t||(t=l.partList=[]);const e=v>0?t[t.length-1]:void 0,i=v++,n=new Ws(r,l),s=new Un(n,x,o,i,e);t.push(s),x.duration+=s.duration;break}case"PRELOAD-HINT":{const t=new Ws(r,l);l.preloadHint=t;break}case"RENDITION-REPORT":{const t=new Ws(r,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(t);break}default:En.warn(`line parsed but not handled: ${h}`)}}}w&&!w.relurl?(c.pop(),y-=w.duration,l.partList&&(l.fragmentHint=w)):l.partList&&(Da(x,w,u),x.cc=b,l.fragmentHint=x,f&&Oa(x,f,l)),l.targetduration||(l.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const A=c.length,_=c[0],k=c[A-1];if(y+=l.skippedSegments*l.targetduration,y>0&&A&&k){l.averagetargetduration=y/A;const t=k.sn;l.endSN="initSegment"!==t?t:0,l.live||(k.endList=!0),_&&void 0===l.startCC&&(l.startCC=_.cc),E>0&&(!function(t,e){let i=t[e];for(let n=e;n--;){const e=t[n];if(!e)return;e.programDateTime=i.programDateTime-1e3*e.duration,i=e}}(c,E),_&&u.unshift(_))}else l.endSN=0,l.startCC=0;return l.fragmentHint&&(y+=l.fragmentHint.duration),l.totalduration=y,u.length&&l.dateRangeTagCount&&_&&_a(u,l),l.endCC=b,l}}function _a(t,e){const i=t.length,n=t[i-1],r=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let a=s.length;a--;){const o=e.dateRanges[s[a]],l=o.startDate.getTime();o.tagAnchor=n.ref;for(let n=i;n--;){const i=ka(e,l,t,n,r);if(-1!==i){o.tagAnchor=e.fragments[i].ref;break}}}}function ka(t,e,i,n,r){const s=i[n];if(s){const o=s.programDateTime;if(e>=o||0===n){var a;if(e<=o+1e3*(((null==(a=i[n+1])?void 0:a.start)||r)-s.start)){const r=i[n].sn-t.startSN,s=t.fragments;if(s.length>i.length){for(let a=(i[n+1]||s[s.length-1]).sn-t.startSN;a>r;a--){const t=s[a].programDateTime;if(e>=t&&e<t+1e3*s[a].duration)return a}}return r}}}return-1}function Pa(t,e,i){var n,r;const s=new Ws(t,i),a=null!=(n=s.METHOD)?n:"",o=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&En.error(`Invalid IV: ${s.IV}`);const h=o?Aa.resolve(o,e):"",d=(c||"1").split("/").map(Number).filter(Number.isFinite);return new Sa(a,h,u,d,l)}function Ra(t){const e=new Ws(t).decimalFloatingPoint("TIME-OFFSET");return Qi(e)?e:null}function Ia(t,e){let i=(t||"").split(/[ ,]+/).filter((t=>t));["video","audio","text"].forEach((t=>{const n=i.filter((e=>mr(e,t)));n.length&&(e[`${t}Codec`]=n.map((t=>t.split("/")[0])).join(","),i=i.filter((t=>-1===n.indexOf(t))))})),e.unknownCodecs=i}function Ca(t,e,i){const n=e[i];n&&(t[i]=n)}function Da(t,e,i){t.rawProgramDateTime?i.push(t):null!=e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime)}function Na(t,e,i,n){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=i,t.sn="initSegment",n&&(t.levelkeys=n),t.initSegment=null}function Oa(t,e,i){t.levelkeys=e;const{encryptedFragments:n}=i;n.length&&n[n.length-1].levelkeys===e||!Object.keys(e).some((t=>e[t].isCommonEncryption))||n.push(t)}function Ma(t,e,i){t.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${i[0]})`)}function Fa(t,e,i){t.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${i[0]})`)}function Ba(t,e){const i=e.startPTS;if(Qi(i)){let n,r=0;e.sn>t.sn?(r=i-t.start,n=t):(r=t.start-i,n=e),n.duration!==r&&n.setDuration(r)}else if(e.sn>t.sn){t.cc===e.cc&&t.minEndPTS?e.setStart(t.start+(t.minEndPTS-t.start)):e.setStart(t.start+t.duration)}else e.setStart(Math.max(t.start-e.duration,0))}function Ua(t,e,i,n,r,s){n-i<=0&&(En.warn("Fragment should have a positive duration",e),n=i+e.duration,s=r+e.duration);let a=i,o=n;const l=e.startPTS,c=e.endPTS;if(Qi(l)){const t=Math.abs(l-i);Qi(e.deltaPTS)?e.deltaPTS=Math.max(t,e.deltaPTS):e.deltaPTS=t,a=Math.max(i,l),i=Math.min(i,l),r=Math.min(r,e.startDTS),o=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const u=i-e.start;0!==e.start&&e.setStart(i),e.setDuration(n-e.start),e.startPTS=i,e.maxStartPTS=a,e.startDTS=r,e.endPTS=n,e.minEndPTS=o,e.endDTS=s;const h=e.sn;if(!t||h<t.startSN||h>t.endSN)return 0;let d;const f=h-t.startSN,p=t.fragments;for(p[f]=e,d=f;d>0;d--)Ba(p[d],p[d-1]);for(d=f;d<p.length-1;d++)Ba(p[d],p[d+1]);return t.fragmentHint&&Ba(p[p.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,u}function ja(t,e){if(t===e)return;let i=null;const n=t.fragments;for(let l=n.length-1;l>=0;l--){const t=n[l].initSegment;if(t){i=t;break}}let r;t.fragmentHint&&delete t.fragmentHint.endPTS,function(t,e,i){const n=e.skippedSegments,r=Math.max(t.startSN,e.startSN)-e.startSN,s=(t.fragmentHint?1:0)+(n?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,a=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let c=r;c<=s;c++){const r=l[a+c];let s=o[c];if(n&&!s&&r&&(s=e.fragments[c]=r),r&&s){if(i(r,s,c,o),r.url&&r.url!==s.url)return void(e.playlistParsingError=$a(`media sequence mismatch ${s.sn}:`,t,e,r,s));if(r.cc!==s.cc)return void(e.playlistParsingError=$a(`discontinuity sequence mismatch (${r.cc}!=${s.cc})`,t,e,r,s))}}}(t,e,((n,s,a,o)=>{if(!e.startCC&&s.cc!==n.cc){var l,c;const i=n.cc-s.cc;for(let t=a;t<o.length;t++)o[t].cc+=i;e.startCC=null!=(l=null==(c=Ga(t,e.startSN-1))?void 0:c.cc)?l:o[0].cc,e.endCC=o[o.length-1].cc}Qi(n.startPTS)&&Qi(n.endPTS)&&(s.setStart(s.startPTS=n.startPTS),s.startDTS=n.startDTS,s.maxStartPTS=n.maxStartPTS,s.endPTS=n.endPTS,s.endDTS=n.endDTS,s.minEndPTS=n.minEndPTS,s.setDuration(n.endPTS-n.startPTS),s.duration&&(r=s),e.PTSKnown=e.alignedSliding=!0),n.hasStreams&&(s.elementaryStreams=n.elementaryStreams),s.loader=n.loader,n.hasStats&&(s.stats=n.stats),n.initSegment&&(s.initSegment=n.initSegment,i=n.initSegment)}));const s=e.fragments,a=e.fragmentHint?s.concat(e.fragmentHint):s;if(i&&a.forEach((t=>{var e;!t||t.initSegment&&t.initSegment.relurl!==(null==(e=i)?void 0:e.relurl)||(t.initSegment=i)})),e.skippedSegments)if(e.deltaUpdateFailed=s.some((t=>!t)),e.deltaUpdateFailed){En.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=e.skippedSegments;t--;)s.shift();e.startSN=s[0].sn}else{e.endCC=s[s.length-1].cc,e.canSkipDateRanges&&(e.dateRanges=function(t,e){const{dateRanges:i,recentlyRemovedDateranges:n}=e,r=pn({},t);n&&n.forEach((t=>{delete r[t]}));const s=Object.keys(r).length;s&&Object.keys(i).forEach((t=>{const e=r[t],n=new Ys(i[t].attr,e);n.isValid?(r[t]=n,e||(n.tagOrder+=s)):En.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${qr(i[t].attr)}"`)}));return r}(t.dateRanges,e));const i=t.fragments.filter((t=>t.rawProgramDateTime));if(t.hasProgramDateTime&&!e.hasProgramDateTime)for(let t=1;t<a.length;t++)null===a[t].programDateTime&&Da(a[t],a[t-1],i);_a(i,e)}!function(t,e,i){if(t&&e){let n=0;for(let r=0,s=t.length;r<=s;r++){const s=t[r],a=e[r+n];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?i(s,a):n--}}}(t.partList,e.partList,((t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats})),r?Ua(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):za(t,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const t=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=t),e.driftEndTime=o,e.driftEnd=t}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime;-1===e.requestScheduled&&(e.requestScheduled=t.requestScheduled)}function $a(t,e,i,n,r){return new Error(`${t} ${r.url}\nPlaylist starting @${e.startSN}\n${e.m3u8}\n\nPlaylist starting @${i.startSN}\n${i.m3u8}`)}function za(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=e.startSN+e.skippedSegments-t.startSN,r=t.fragments,s=n>=0;let a=0;if(s&&n<r.length)a=r[n].start;else if(s&&e.startSN===t.endSN+1)a=t.fragmentEnd;else if(s&&i)a=t.fragmentStart+n*e.levelTargetDuration;else{if(e.skippedSegments||0!==e.fragmentStart)return;a=t.fragmentStart}Ha(e,a)}function Ha(t,e){if(e){const i=t.fragments;for(let n=t.skippedSegments;n<i.length;n++)i[n].addStart(e);t.fragmentHint&&t.fragmentHint.addStart(e)}}function qa(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=1e3*t.targetduration;if(t.updated){const n=t.fragments,r=4;if(n.length&&i*r>e){const t=1e3*n[n.length-1].duration;t<i&&(i=t)}}else i/=2;return Math.round(i)}function Ga(t,e,i){if(!t)return null;let n=t.fragments[e-t.startSN];return n||(n=t.fragmentHint,n&&n.sn===e?n:e<t.startSN&&i&&i.sn===e?i:null)}function Va(t,e,i){return t?Wa(t.partList,e,i):null}function Wa(t,e,i){if(t)for(let n=t.length;n--;){const r=t[n];if(r.index===i&&r.fragment.sn===e)return r}return null}function Ka(t){t.forEach(((t,e)=>{var i;null==(i=t.details)||i.fragments.forEach((t=>{t.level=e,t.initSegment&&(t.initSegment.level=e)}))}))}function Ya(t,e){for(let n=0,r=t.length;n<r;n++){var i;if((null==(i=t[n])?void 0:i.cc)===e)return t[n]}return null}function Xa(t,e){if(t){const i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}}function Qa(t,e){const i=e.fragments;for(let n=0,r=i.length;n<r;n++)Xa(i[n],t);e.fragmentHint&&Xa(e.fragmentHint,t),e.alignedSliding=!0}function Ja(t,e){if(!function(t,e){return!!(t&&e.startCC<t.endCC&&e.endCC>t.startCC)}(e,t))return;const i=Math.min(e.endCC,t.endCC),n=Ya(e.fragments,i),r=Ya(t.fragments,i);if(!n||!r)return;En.log(`Aligning playlist at start of dicontinuity sequence ${i}`);Qa(n.start-r.start,t)}function Za(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const i=t.fragments,n=e.fragments;if(!i.length||!n.length)return;let r,s;const a=Math.min(e.endCC,t.endCC);e.startCC<a&&t.startCC<a&&(r=Ya(n,a),s=Ya(i,a)),r&&s||(r=n[Math.floor(n.length/2)],s=Ya(i,r.cc)||i[Math.floor(i.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;Qa((l-o)/1e3-(s.start-r.start),t)}const to=function(t){let e="";const i=t.length;for(let n=0;n<i;n++)e+=`[${t.start(n).toFixed(3)}-${t.end(n).toFixed(3)}]`;return e},eo="STOPPED",io="IDLE",no="KEY_LOADING",ro="FRAG_LOADING",so="FRAG_LOADING_WAITING_RETRY",ao="WAITING_TRACK",oo="PARSING",lo="PARSED",co="ENDED",uo="ERROR",ho="WAITING_INIT_PTS",fo="WAITING_LEVEL";class po extends Ms{constructor(t,e,i,n,r){super(n,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=eo,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:t,fragCurrent:e,media:i,mediaBuffer:n,state:r}=this,s=i?i.currentTime:0,a=Us.bufferInfo(n||i,s,t.maxBufferHole);if(this.log(`media seeking to ${Qi(s)?s.toFixed(3):s}, state: ${r}`),this.state===co)this.resetLoadingState();else if(e){const i=t.maxFragLookUpTolerance,n=e.start-i,r=e.start+e.duration+i;if(!a.len||r<a.start||n>a.end){const t=s>r;(s<n||t)&&(t&&e.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(i){this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0);if(s>this.lastCurrentTime&&(this.lastCurrentTime=s),!this.loadingParts){const t=Math.max(a.end,s),e=this.shouldLoadParts(this.getLevelDetails(),t);e&&(this.log(`LL-Part loading ON after seeking to ${s.toFixed(2)} with buffer @${t.toFixed(2)}`),this.loadingParts=e)}}this.hls.hasEnoughToStart||a.len||(this.log(`setting startPosition to ${s} because of seek before start`),this.nextLoadPosition=this.startPosition=s),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=t,this.fragmentLoader=new Cs(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Rs(t.config)}registerListeners(){const{hls:t}=this;t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(nn.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(nn.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===eo)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=eo}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return-1===e&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const i=t.end||0,n=this.config.timelineOffset||0;if(i<=n)return!1;const r=t.nextStart;if(r&&r>n&&r<e.edge)return!1;if(this.media.currentTime<t.start)return!1;const s=e.partList;if(null!=s&&s.length){const t=s[s.length-1];return Us.isBuffered(this.media,t.start+t.duration/2)}const a=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)}getLevelDetails(){var t;if(this.levels&&null!==this.levelLastLoaded)return null==(t=this.levelLastLoaded)?void 0:t.details}get timelineOffset(){const t=this.config.timelineOffset;var e;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),i.addEventListener("seeking",this.onMediaSeeking),i.addEventListener("ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===eo&&this.startLoad(n.startPosition)}onMediaDetaching(t,e){const i=!!e.transferMedia,n=this.media;if(null!==n){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=eo,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this.startFragRequested=!0,this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){this._doFragLoad(t,e,i,(t=>{const e=t.frag;if(this.fragContextChanged(e))return this.warn(`${e.type} sn: ${e.sn}${t.part?" part: "+t.part.index:""} of ${this.fragInfo(e,!1,t.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const e=this.state,i=t.frag;this.fragContextChanged(i)?(e===ro||!this.fragCurrent&&e===oo)&&(this.fragmentTracker.removeFragment(i),this.state=io):("payload"in t&&(this.log(`Loaded ${i.type} sn: ${i.sn} of ${this.playlistLabel()} ${i.level}`),this.hls.trigger(nn.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((e=>{this.state!==eo&&this.state!==uo&&(this.warn(`Frag error: ${(null==e?void 0:e.message)||e}`),this.resetFragmentLoading(t))}))}clearTrackerIfNeeded(t){var e;const{fragmentTracker:i}=this;if(i.getState(t)===ys){const e=t.type,n=this.getFwdBufferInfo(this.mediaBuffer,e),r=Math.max(t.duration,n?n.len:this.config.maxBufferLength),s=this.backtrackFragment;(1===(s?t.sn-s.sn:0)||this.reduceMaxBufferLength(r,t.duration))&&i.removeFragment(t)}else 0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),i.getState(t)===bs&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return(null==e?void 0:e.live)&&"EVENT"!==e.type&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e){if(!(t-e))return;const i={startOffset:t,endOffset:e,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null};this.hls.trigger(nn.BUFFER_FLUSHING,i)}_loadInitSegment(t,e){this._doFragLoad(t,e).then((t=>{const e=null==t?void 0:t.frag;if(!e||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:e}=this,{frag:i,payload:n}=t,r=i.decryptdata;if(n&&n.byteLength>0&&null!=r&&r.key&&r.iv&&Qs(r.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer,Js(r.method)).catch((t=>{throw e.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:i}),t})).then((n=>{const r=self.performance.now();return e.trigger(nn.FRAG_DECRYPTED,{frag:i,payload:n,stats:{tstart:s,tdecrypt:r}}),t.payload=n,this.completeInitSegmentLoad(t)}))}return this.completeInitSegmentLoad(t)})).catch((e=>{this.state!==eo&&this.state!==uo&&(this.warn(e),this.resetFragmentLoading(t))}))}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const i=t.frag.stats;this.state!==eo&&(this.state=io),t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${i?to(Us.getBuffered(i)):"(detached)"})`),Fn(t)){var n;if(t.type!==un){const e=t.elementaryStreams;if(!Object.keys(e).some((t=>!!e[t])))return void(this.state=io)}const e=null==(n=this.levels)?void 0:n[t.level];null!=e&&e.fragmentError&&(this.log(`Resetting level fragment error count of ${e.fragmentError} on frag buffered`),e.fragmentError=0)}this.state=io}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:n,partsLoaded:r}=t,s=!r||0===r.length||r.some((t=>!t)),a=new Fs(i.level,i.sn,i.stats.chunkCount+1,0,n?n.index:-1,!s);e.flush(a)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;var r;this.fragCurrent=t;const s=null==e?void 0:e.details;if(!this.levels||!s)throw new Error(`frag load aborted, missing level${s?"":" detail"}s`);let a=null;!t.encrypted||null!=(r=t.decryptdata)&&r.key?!t.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(t,s.encryptedFragments):(this.log(`Loading key for ${t.sn} of [${s.startSN}-${s.endSN}], ${this.playlistLabel()} ${t.level}`),this.state=no,this.fragCurrent=t,a=this.keyLoader.load(t).then((t=>{if(!this.fragContextChanged(t.frag))return this.hls.trigger(nn.KEY_LOADED,t),this.state===no&&(this.state=io),t})),this.hls.trigger(nn.KEY_LOADING,{frag:t}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING"))));const o=this.fragPrevious;if(Fn(t)&&(!o||t.sn!==o.sn)){const i=this.shouldLoadParts(e.details,t.end);i!==this.loadingParts&&(this.log(`LL-Part loading ${i?"ON":"OFF"} loading sn ${null==o?void 0:o.sn}->${t.sn}`),this.loadingParts=i)}if(i=Math.max(t.start,i||0),this.loadingParts&&Fn(t)){const r=s.partList;if(r&&n){i>t.end&&s.fragmentHint&&(t=s.fragmentHint);const o=this.getNextPart(r,t,i);if(o>-1){const l=r[o];let c;return t=this.fragCurrent=l.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${l.index} (${o}/${r.length-1}) of ${this.fragInfo(t,!1,l)}) cc: ${t.cc} [${s.startSN}-${s.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=ro,c=a?a.then((i=>!i||this.fragContextChanged(i.frag)?null:this.doFragPartsLoad(t,l,e,n))).catch((t=>this.handleFragLoadError(t))):this.doFragPartsLoad(t,l,e,n).catch((t=>this.handleFragLoadError(t))),this.hls.trigger(nn.FRAG_LOADING,{frag:t,part:l,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!t.url||this.loadedEndOfParts(r,i))return Promise.resolve(null)}}if(Fn(t)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)}`),this.loadingParts=!1;else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${s?"["+s.startSN+"-"+s.endSN+"]":""}, target: ${parseFloat(i.toFixed(3))}`),Qi(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=ro;const l=this.config.progressive;let c;return c=l&&a?a.then((e=>!e||this.fragContextChanged(null==e?void 0:e.frag)?null:this.fragmentLoader.load(t,n))).catch((t=>this.handleFragLoadError(t))):Promise.all([this.fragmentLoader.load(t,l?n:void 0),a]).then((t=>{let[e]=t;return!l&&e&&n&&n(e),e})).catch((t=>this.handleFragLoadError(t))),this.hls.trigger(nn.FRAG_LOADING,{frag:t,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(t,e,i,n){return new Promise(((r,s)=>{var a;const o=[],l=null==(a=i.details)?void 0:a.partList,c=e=>{this.fragmentLoader.loadPart(t,e,n).then((n=>{o[e.index]=n;const s=n.part;this.hls.trigger(nn.FRAG_LOADED,n);const a=Va(i.details,t.sn,e.index+1)||Wa(l,t.sn,e.index+1);if(!a)return r({frag:t,part:s,partsLoaded:o});c(a)})).catch(s)};c(e)}))}handleFragLoadError(t){if("data"in t){const e=t.data;t.data&&e.details===en.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):this.hls.trigger(nn.ERROR,e)}else this.hls.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==oo)return void(this.fragCurrent||this.state===eo||this.state===uo||(this.state=io));const{frag:i,part:n,level:r}=e,s=self.performance.now();i.stats.parsing.end=s,n&&(n.stats.parsing.end=s);const a=this.getLevelDetails(),o=a&&i.sn>a.endSN||this.shouldLoadParts(a,i.end);o!==this.loadingParts&&(this.log(`LL-Part loading ${o?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=o),this.updateLevelTiming(i,n,r,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(null!=t&&t.partList){var i;const r=t.partList[0];if(e>=r.end+((null==(i=t.fragmentHint)?void 0:i.duration)||0)){var n;if((this.hls.hasEnoughToStart?(null==(n=this.media)?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:i}=this,{level:n,sn:r,part:s}=t;if(null==e||!e[n])return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const a=e[n],o=a.details,l=s>-1?Va(o,r,s):null,c=l?l.fragment:Ga(o,r,i);return c?(i&&i!==c&&(c.stats=i.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(t,e,i,n,r){var s;if(!t||this.state!==oo)return;const{data1:a,data2:o}=t;let l=a;if(a&&o&&(l=ar(a,o)),null==(s=l)||!s.length)return;const c={type:t.type,frag:e,part:i,chunkMeta:n,parent:e.type,data:l};if(this.hls.trigger(nn.BUFFER_APPENDING,c),t.dropped&&t.independent&&!i){if(r)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!Us.isBuffered(e,e.currentTime))return void this.flushMainBuffer(0,t.start);const i=e.currentTime,n=Us.bufferInfo(e,i,0),r=t.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(t.start-s,n.end-s),i+s);t.start-a>s&&this.flushMainBuffer(a,t.start)}getFwdBufferInfo(t,e){var i;const n=this.getLoadPosition();if(!Qi(n))return null;const r=this.lastCurrentTime>n||null!=(i=this.media)&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,n,e,r)}getFwdBufferInfoAtPos(t,e,i,n){const r=Us.bufferInfo(t,e,n);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(e,i);if(s&&(r.nextStart<=s.end||s.gap)){const i=Math.max(Math.min(r.nextStart,s.end)-e,n);return Us.bufferInfo(t,e,i)}}return r}getMaxBufferLength(t){const{config:e}=this;let i;return i=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const i=this.config,n=Math.max(Math.min(t-e,i.maxBufferLength),e),r=Math.max(t-3*e,i.maxMaxBufferLength/2,n);return r>=n&&(i.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0)}getAppendedFrag(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ln;var i;const n=null==(i=this.fragmentTracker)?void 0:i.getAppendedFrag(t,e);return n&&"fragment"in n?n.fragment:n}getNextFragment(t,e){const i=e.fragments,n=i.length;if(!n)return null;const{config:r}=this,s=i[0].start,a=r.lowLatencyMode&&!!e.partList;let o=null;if(e.live){const c=r.initialLiveManifestSize;if(n<c)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${c})`),null;if(!e.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||t<s){var l;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(e,i);const n=this.hls.startPosition,r=this.hls.liveSyncPosition,c=o?(-1!==n&&n>=s?n:r)||o.start:t;this.log(`Setting startPosition to ${c} to match start frag at live edge. mainStart: ${n} liveSyncPosition: ${r} frag.start: ${null==(l=o)?void 0:l.start}`),this.startPosition=this.nextLoadPosition=c}}else t<=s&&(o=i[0]);if(!o){const i=this.loadingParts?e.partEnd:e.fragmentEnd;o=this.getFragmentAtPosition(t,i,e)}let c=this.filterReplacedPrimary(o,e);if(!c&&o){const t=o.sn-e.startSN;c=this.filterReplacedPrimary(i[t+1]||null,e)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(t,e){const i=this.fragmentTracker.getState(t);return(i===Ss||i===bs&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,n,r){let s=null;if(t.gap&&(s=this.getNextFragment(this.nextLoadPosition,e),s&&!s.gap&&i.nextStart)){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,n,0);if(null!==t&&i.len+t.len>=r){const t=s.sn;return this.loopSn!==t&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${t}`),this.loopSn=t),null}}return this.loopSn=void 0,s}get primaryPrefetch(){if(go(this.hls.config)){var t,e;if(null==(t=this.hls.interstitialsManager)||null==(e=t.playingItem)?void 0:e.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if(go(this.hls.config)&&t.type!==un){const i=this.hls.interstitialsManager,n=null==i?void 0:i.bufferingItem;if(n){const i=n.event;if(i){if(i.appendInPlace||Math.abs(t.start-n.start)>1||0===n.start)return null}else{if(t.end<=n.start&&!1===(null==e?void 0:e.live))return null;if(t.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||t.start-n.end>1))return null}}const r=null==i?void 0:i.playerQueue;if(r)for(let e=r.length;e--;){const i=r[e].interstitial;if(i.appendInPlace&&t.start>=i.startTime&&t.end<=i.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||null!=t&&t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(t,e,i){let n=-1,r=!1,s=!0;for(let a=0,o=t.length;a<o;a++){const o=t[a];if(s=s&&!o.independent,n>-1&&i<o.start)break;const l=o.loaded;l?n=-1:(r||o.independent||s)&&o.fragment===e&&(n=a),r=l}return n}loadedEndOfParts(t,e){const i=t[t.length-1];return i&&e>i.start&&i.loaded}getInitialLiveFragment(t,e){const i=this.fragPrevious;let n=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),n=function(t,e,i){if(null===e||!Array.isArray(t)||!t.length||!Qi(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;i=i||0;for(let n=0;n<t.length;++n){const r=t[n];if(is(e,i,r))return r}return null}(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const r=i.sn+1;if(r>=t.startSN&&r<=t.endSN){const s=e[r-t.startSN];i.cc===s.cc&&(n=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=ns(e,i.cc),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const e=this.hls.liveSyncPosition;null!==e&&(n=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t))}return n}getFragmentAtPosition(t,e,i){const{config:n}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=i;const{fragmentHint:o}=i,{maxFragLookUpTolerance:l}=n,c=i.partList,u=!!(this.loadingParts&&null!=c&&c.length&&o);let h;if(u&&o&&!this.bitrateTest&&c[c.length-1].fragment.sn===o.sn&&(s=s.concat(o),a=o.sn),t<e){var d;h=ts(r,s,t,t<this.lastCurrentTime||t>e-l||null!=(d=this.media)&&d.paused||!this.startFragRequested?0:l)}else h=s[s.length-1];if(h){const t=h.sn-i.startSN,e=this.fragmentTracker.getState(h);if((e===Ss||e===bs&&h.gap)&&(r=h),r&&h.sn===r.sn&&(!u||c[0].fragment.sn>h.sn||!i.live&&!u)){if(r&&h.level===r.level){const e=s[t+1];h=h.sn<a&&this.fragmentTracker.getState(e)!==Ss?e:null}}}return h}alignPlaylists(t,e,i){const n=t.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const r=t.fragmentStart,s=!e,a=t.alignedSliding&&Qi(r);if(s||!a&&!r){!function(t,e){t&&(Ja(e,t),!e.alignedSliding&&t&&Za(e,t),e.alignedSliding||!t||e.skippedSegments||za(t,e,!1))}(i,t);const r=t.fragmentStart;return this.log(`Live playlist sliding: ${r.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${n}`),r}return r}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let i=this.startPosition;i<e&&(i=-1);const n=this.timelineOffset;if(-1===i){const r=null!==this.startTimeOffset,s=r?this.startTimeOffset:t.startTimeOffset;null!==s&&Qi(s)?(i=e+s,s<0&&(i+=t.edge),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${s} found in ${r?"multivariant":"media"} playlist`),this.startPosition=i):t.live?(i=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+n}this.nextLoadPosition=i+n}getLoadPosition(){var t;const{media:e}=this;let i=0;return null!=(t=this.hls)&&t.hasEnoughToStart&&e?i=e.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&Fn(t)&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&(this.fragContextChanged(t)||this.state===so)||(this.state=io)}onFragmentOrKeyLoadError(t,e){if(e.chunkMeta&&!e.frag){const t=this.getCurrentContext(e.chunkMeta);t&&(e.frag=t.frag)}const i=e.frag;if(!i||i.type!==t||!this.levels)return;var n;if(this.fragContextChanged(i))return void this.warn(`Frag load error must match current frag to retry ${i.url} > ${null==(n=this.fragCurrent)?void 0:n.url}`);const r=e.details===en.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(i,!0);const s=e.errorAction,{action:a,flags:o,retryCount:l=0,retryConfig:c}=s||{},u=!!s&&!!c,h=u&&a===ds,d=u&&!s.resolved&&o===ps;if(!h&&d&&Fn(i)&&!i.endList)this.resetFragmentErrors(t),this.treatAsGap(i),s.resolved=!0;else if((h||d)&&l<c.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const n=as(c,l);this.warn(`Fragment ${i.sn} of ${t} ${i.level} errored with ${e.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${n}ms`),s.resolved=!0,this.retryDate=self.performance.now()+n,this.state=so}else if(c&&s){if(this.resetFragmentErrors(t),!(l<c.maxNumRetry))return void this.warn(`${e.details} reached or exceeded max retry (${l})`);r||a===hs||(s.resolved=!0)}else this.state=a===us?fo:uo;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===oo||this.state===lo){const e=t.frag,i=t.parent,n=this.getFwdBufferInfo(this.mediaBuffer,i),r=n&&n.len>.5;r&&this.reduceMaxBufferLength(n.len,(null==e?void 0:e.duration)||10);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${i} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(t){t===cn&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==eo&&(this.state=io)}afterBufferFlushed(t,e,i){if(!t)return;const n=Us.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,n,i),this.state===co&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==eo&&(this.state=io)}resetStartWhenNotLoaded(t){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=t?t.details:null;null!=e&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.warn(`The loading context changed while buffering fragment ${t.sn} of ${this.playlistLabel()} ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,n){const r=i.details;if(!r)return void this.warn("level.details undefined");var s;if(!Object.keys(t.elementaryStreams).reduce(((e,s)=>{const a=t.elementaryStreams[s];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${t.sn} ${s} duration reliably (${o})`),e||!1;const l=n?0:Ua(r,t,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(nn.LEVEL_PTS_UPDATED,{details:r,level:i,drift:l,type:s,frag:t,start:a.startPTS,end:a.endPTS}),!0}return e}),!1)&&(0===i.fragmentError&&this.treatAsGap(t,i),null===(null==(s=this.transmuxer)?void 0:s.error))){const e=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(e.message),this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=lo,this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(nn.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===ln?"level":"track"}fragInfo(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;var n,r;return`${this.playlistLabel()} ${t.level} (${i?"part":"frag"}:[${(null!=(n=e&&!i?t.startPTS:(i||t).start)?n:NaN).toFixed(3)}-${(null!=(r=e&&!i?t.endPTS:(i||t).end)?r:NaN).toFixed(3)}]${i&&"main"===t.type?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;null==(t=this.transmuxer)||t.reset()}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}function go(t){return!!t.interstitialsController&&!1!==t.enableInterstitialPlayback}class mo{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;return t.length?(i=1===t.length?t[0]:function(t,e){const i=new Uint8Array(e);let n=0;for(let r=0;r<t.length;r++){const e=t[r];i.set(e,n),n+=e.length}return i}(t,e),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var vo,yo={exports:{}};var bo=(vo||(vo=1,function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,n,s,a){if("function"!==typeof n)throw new TypeError("The listener must be a function");var o=new r(n,s||t,a),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new n:delete t._events[e]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,n,r=[];if(0===this._eventsCount)return r;for(n in t=this._events)e.call(t,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},o.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,s=n.length,a=new Array(s);r<s;r++)a[r]=n[r].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},o.prototype.emit=function(t,e,n,r,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var l,c,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,r),!0;case 5:return u.fn.call(u.context,e,n,r,s),!0;case 6:return u.fn.call(u.context,e,n,r,s,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,n);break;case 4:u[c].fn.call(u[c].context,e,n,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,n,r){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||r&&!o.once||n&&o.context!==n||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==e||r&&!o[l].once||n&&o[l].context!==n)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o}(yo)),yo.exports),So=kn(bo);const wo="1.6.2",xo={};function Eo(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function Lo(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function To(t,e){let i=0;return i=(127&t[e])<<21,i|=(127&t[e+1])<<14,i|=(127&t[e+2])<<7,i|=127&t[e+3],i}function Ao(t,e){const i=e;let n=0;for(;Lo(t,e);){n+=10;n+=To(t,e+6),Eo(t,e+10)&&(n+=10),e+=n}if(n>0)return t.subarray(i,i+n)}function _o(t,e){return 255===t[e]&&240===(246&t[e+1])}function ko(t,e){return 1&t[e+1]?7:9}function Po(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function Ro(t,e){return e+1<t.length&&_o(t,e)}function Io(t,e){if(Ro(t,e)){const i=ko(t,e);if(e+i>=t.length)return!1;const n=Po(t,e);if(n<=i)return!1;const r=e+n;return r===t.length||Ro(t,r)}return!1}function Co(t,e,i,n,r){if(!t.samplerate){const s=function(t,e,i,n){const r=e[i+2],s=r>>2&15;if(s>12){const e=new Error(`invalid ADTS sampling index:${s}`);return void t.emit(nn.ERROR,nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_PARSING_ERROR,fatal:!0,error:e,reason:e.message})}const a=1+(r>>6&3),o=e[i+3]>>6&3|(1&r)<<2,l="mp4a.40."+a,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][s];let u=s;5!==a&&29!==a||(u-=3);const h=[a<<3|(14&u)>>1,(1&u)<<7|o<<3];return En.log(`manifest codec:${n}, parsed codec:${l}, channels:${o}, rate:${c} (ADTS object type:${a} sampling index:${s})`),{config:h,samplerate:c,channelCount:o,codec:l,parsedCodec:l,manifestCodec:n}}(e,i,n,r);if(!s)return;pn(t,s)}}function Do(t){return 9216e4/t}function No(t,e,i,n,r){const s=n+r*Do(t.samplerate),a=function(t,e){const i=ko(t,e);if(e+i<=t.length){const n=Po(t,e)-i;if(n>0)return{headerLength:i,frameLength:n}}}(e,i);let o;if(a){const{frameLength:n,headerLength:r}=a,l=r+n,c=Math.max(0,i+l-e.length);c?(o=new Uint8Array(l-r),o.set(e.subarray(i+r,e.length),0)):o=e.subarray(i+r,i+l);const u={unit:o,pts:s};return c||t.samples.push(u),{sample:u,length:l,missing:c}}const l=e.length-i;o=new Uint8Array(l),o.set(e.subarray(i,e.length),0);return{sample:{unit:o,pts:s},length:l,missing:-1}}function Oo(t,e){return Lo(t,e)&&To(t,e+6)+10<=t.length-e}function Mo(t,e){if(t<0)return-Mo(-t,e);const i=Math.pow(10,e);if(Math.abs(t*i%1-.5)<Number.EPSILON){const e=Math.floor(t*i);return(e%2===0?e:e+1)/i}return Math.round(t*i)/i}function Fo(t){return function(t,e,i,n){const r=function(t){return t instanceof ArrayBuffer?t:t.buffer}(t);let s=1;"BYTES_PER_ELEMENT"in n&&(s=n.BYTES_PER_ELEMENT);const a=(h=t,h&&h.buffer instanceof ArrayBuffer&&void 0!==h.byteLength&&void 0!==h.byteOffset?t.byteOffset:0),o=(a+t.byteLength)/s,l=(a+e)/s,c=Math.floor(Math.max(0,Math.min(l,o))),u=Math.floor(Math.min(c+Math.max(i,0),o));var h;return new n(r,c,u-c)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,Uint8Array)}function Bo(t){const e={key:t.type,description:"",data:"",mimeType:null,pictureType:null};if(t.size<2)return;if(3!==t.data[0])return void console.log("Ignore frame with unrecognized character encoding");const i=t.data.subarray(1).indexOf(0);if(-1===i)return;const n=An(Fo(t.data,1,i)),r=t.data[2+i],s=t.data.subarray(3+i).indexOf(0);if(-1===s)return;const a=An(Fo(t.data,3+i,s));let o;return o="--\x3e"===n?An(Fo(t.data,4+i+s)):function(t){return t instanceof ArrayBuffer?t:0==t.byteOffset&&t.byteLength==t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer}(t.data.subarray(4+i+s)),e.mimeType=n,e.pictureType=r,e.description=a,e.data=o,e}function Uo(t){return"PRIV"===t.type?function(t){if(t.size<2)return;const e=An(t.data,!0),i=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:i.buffer}}(t):"W"===t.type[0]?function(t){if("WXXX"===t.type){if(t.size<2)return;let e=1;const i=An(t.data.subarray(e),!0);e+=i.length+1;const n=An(t.data.subarray(e));return{key:t.type,info:i,data:n}}const e=An(t.data);return{key:t.type,info:"",data:e}}(t):"APIC"===t.type?Bo(t):function(t){if(t.size<2)return;if("TXXX"===t.type){let e=1;const i=An(t.data.subarray(e),!0);e+=i.length+1;const n=An(t.data.subarray(e));return{key:t.type,info:i,data:n}}const e=An(t.data.subarray(1));return{key:t.type,info:"",data:e}}(t)}function jo(t){const e=String.fromCharCode(t[0],t[1],t[2],t[3]),i=To(t,4);return{type:e,size:i,data:t.subarray(10,10+i)}}function $o(t){let e=0;const i=[];for(;Lo(t,e);){const n=To(t,e+6);t[e+5]>>6&1&&(e+=10),e+=10;const r=e+n;for(;e+10<r;){const n=jo(t.subarray(e)),r=Uo(n);r&&i.push(r),e+=n.size+10}Eo(t,e)&&(e+=10)}return i}function zo(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info}function Ho(t){if(8===t.data.byteLength){const e=new Uint8Array(t.data),i=1&e[3];let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}}function qo(t){const e=$o(t);for(let i=0;i<e.length;i++){const t=e[i];if(zo(t))return Ho(t)}}let Go=function(t){return t.audioId3="org.id3",t.dateRange="com.apple.quicktime.HLS",t.emsg="https://aomedia.org/emsg/ID3",t.misbklv="urn:misb:KLV:bin:1910.1",t}({});function Vo(){return{type:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",id:-1,pid:-1,inputTimeScale:arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,sequenceNumber:-1,samples:[],dropped:0}}class Wo{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=ar(this.cachedData,t),this.cachedData=null);let i,n=Ao(t,0),r=n?n.length:0;const s=this._audioTrack,a=this._id3Track,o=n?qo(n):void 0,l=t.length;for((null===this.basePTS||0===this.frameIndex&&Qi(o))&&(this.basePTS=Ko(o,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Go.audioId3,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(t,r)){const e=this.appendFrame(s,t,r);e?(this.frameIndex++,this.lastPTS=e.sample.pts,r+=e.length,i=r):r=l}else Oo(t,r)?(n=Ao(t,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Go.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,i=r):r++;if(r===l&&i!==l){const e=t.slice(i);this.cachedData?this.cachedData=ar(this.cachedData,e):this.cachedData=e}}return{audioTrack:s,videoTrack:Vo(),id3Track:a,textTrack:Vo()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Vo(),id3Track:this._id3Track,textTrack:Vo()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const Ko=(t,e,i)=>{if(Qi(t))return 90*t;return 9e4*e+(i?9e4*i.baseTime/i.timescale:0)};let Yo=null;const Xo=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Qo=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Jo=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Zo=[0,1,1,4];function tl(t,e,i,n,r){if(i+24>e.length)return;const s=el(e,i);if(s&&i+s.frameLength<=e.length){const a=n+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:e.subarray(i,i+s.frameLength),pts:a,dts:a};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function el(t,e){const i=t[e+1]>>3&3,n=t[e+1]>>1&3,r=t[e+2]>>4&15,s=t[e+2]>>2&3;if(1!==i&&0!==r&&15!==r&&3!==s){const a=t[e+2]>>1&1,o=t[e+3]>>6,l=1e3*Xo[14*(3===i?3-n:3===n?3:4)+r-1],c=Qo[3*(3===i?0:2===i?1:2)+s],u=3===o?1:2,h=Jo[i][n],d=Zo[n],f=8*h*d,p=Math.floor(h*l/c+a)*d;if(null===Yo){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Yo=t?parseInt(t[1]):0}return!!Yo&&Yo<=87&&2===n&&l>=224e3&&0===o&&(t[e+3]=128|t[e+3]),{sampleRate:c,channelCount:u,frameLength:p,samplesPerFrame:f}}}function il(t,e){return 255===t[e]&&224===(224&t[e+1])&&0!==(6&t[e+1])}function nl(t,e){return e+1<t.length&&il(t,e)}function rl(t,e){if(e+1<t.length&&il(t,e)){const i=4,n=el(t,e);let r=i;null!=n&&n.frameLength&&(r=n.frameLength);const s=e+r;return s===t.length||nl(t,s)}return!1}const sl=(t,e)=>{let i=0,n=5;e+=n;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;n>0;){a[0]=t[e];const o=Math.min(n,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,i=i?i<<o|r[0]:r[0],e+=1,n-=o}return i};class al extends Wo{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,n){super.resetInitSegment(t,e,i,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){const n=ol(t,e,i,this.basePTS,this.frameIndex);if(-1!==n){return{sample:t.samples[t.samples.length-1],length:n,missing:0}}}static probe(t){if(!t)return!1;const e=Ao(t,0);if(!e)return!1;const i=e.length;return 11===t[i]&&119===t[i+1]&&void 0!==qo(e)&&sl(t,i)<16}}function ol(t,e,i,n,r){if(i+8>e.length)return-1;if(11!==e[i]||119!==e[i+1])return-1;const s=e[i+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],o=63&e[i+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+s];if(i+l>e.length)return-1;const c=e[i+6]>>5;let u=0;2===c?u+=2:(1&c&&1!==c&&(u+=2),4&c&&(u+=2));const h=(e[i+6]<<8|e[i+7])>>12-u&1,d=[2,1,2,3,3,4,4,5][c]+h,f=e[i+5]>>3,p=7&e[i+5],g=new Uint8Array([s<<6|f<<1|p>>2,(3&p)<<6|c<<3|h<<2|o>>4,o<<4&224]),m=n+r*(1536/a*9e4),v=e.subarray(i,i+l);return t.config=g,t.channelCount=d,t.samplerate=a,t.samples.push({unit:v,pts:m}),l}const ll=/\/emsg[-/]ID3/i;function cl(t,e){return Qi(t.presentationTime)?t.presentationTime/t.timeScale:e+t.presentationTimeDelta/t.timeScale}class ul{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Rs(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,Ts)}decryptAacSample(t,e,i){const n=t[e].unit;if(n.length<=16)return;const r=n.subarray(16,n.length-n.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then((r=>{const s=new Uint8Array(r);n.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)}))}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length)return void i();if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e);let n=0;for(let r=32;r<t.length-16;r+=160,n+=16)i.set(t.subarray(r,r+16),n);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let n=0;for(let r=32;r<t.length-16;r+=160,n+=16)t.set(i.subarray(n,n+16),r);return t}decryptAvcSample(t,e,i,n,r){const s=hr(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,n)}))}decryptAvcSamples(t,e,i,n){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length)return void n();const r=t[e].units;for(;!(i>=r.length);i++){const s=r[i];if(!(s.data.length<=48||1!==s.type&&5!==s.type)&&(this.decryptAvcSample(t,e,i,n,s),!this.decrypter.isSync()))return}}}}class hl{constructor(){this.VideoSample=null}createVideoSample(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}}getLastNalUnit(t){var e;let i,n=this.VideoSample;if(n&&0!==n.units.length||(n=t[t.length-1]),null!=(e=n)&&e.units){const t=n.units;i=t[t.length-1]}return i}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){const i=e.samples,n=i.length;if(!n)return void e.dropped++;{const e=i[n-1];t.pts=e.pts,t.dts=e.dts}}e.samples.push(t)}}parseNALu(t,e,i){const n=e.byteLength;let r=t.naluState||0;const s=r,a=[];let o,l,c,u=0,h=-1,d=0;for(-1===r&&(h=0,d=this.getNALuType(e,0),r=0,u=1);u<n;)if(o=e[u++],r)if(1!==r)if(o)if(1===o){if(l=u-r-1,h>=0){const t={data:e.subarray(h,l),type:d};a.push(t)}else{const i=this.getLastNalUnit(t.samples);i&&(s&&u<=4-s&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-s)),l>0&&(i.data=ar(i.data,e.subarray(0,l)),i.state=0))}u<n?(c=this.getNALuType(e,u),h=u,d=c,r=0):r=-1}else r=0;else r=3;else r=o?0:2;else r=o?0:1;if(h>=0&&r>=0){const t={data:e.subarray(h,n),type:d,state:r};a.push(t)}if(0===a.length){const i=this.getLastNalUnit(t.samples);i&&(i.data=ar(i.data,e))}return t.naluState=r,a}}class dl{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,n=new Uint8Array(4),r=Math.min(4,e);if(0===r)throw new Error("no bytes available");n.set(t.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(t){let e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(e=(t-=this.bitsAvailable)>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;if(t>32&&En.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(0!==(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class fl extends hl{parsePES(t,e,i,n){const r=this.parseNALu(t,i.data,n);let s,a=this.VideoSample,o=!1;i.data=null,a&&r.length&&!t.audFound&&(this.pushAccessUnit(a,t),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),r.forEach((n=>{var r,l;switch(n.type){case 1:{let e=!1;s=!0;const r=n.data;if(o&&r.length>4){const t=this.readSliceType(r);2!==t&&4!==t&&7!==t&&9!==t||(e=!0)}var c;if(e)null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.frame=!0,a.key=e;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 6:s=!0,ur(n.data,1,i.pts,e.samples);break;case 7:{var u,h;s=!0,o=!0;const e=n.data,i=this.readSPS(e);if(!t.sps||t.width!==i.width||t.height!==i.height||(null==(u=t.pixelRatio)?void 0:u[0])!==i.pixelRatio[0]||(null==(h=t.pixelRatio)?void 0:h[1])!==i.pixelRatio[1]){t.width=i.width,t.height=i.height,t.pixelRatio=i.pixelRatio,t.sps=[e];const n=e.subarray(1,4);let r="avc1.";for(let t=0;t<3;t++){let e=n[t].toString(16);e.length<2&&(e="0"+e),r+=e}t.codec=r}break}case 8:s=!0,t.pps=[n.data];break;case 9:s=!0,t.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,t),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:s=!0;break;default:s=!1}if(a&&s){a.units.push(n)}})),n&&a&&(this.pushAccessUnit(a,t),this.VideoSample=null)}getNALuType(t,e){return 31&t[e]}readSliceType(t){const e=new dl(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let i,n=8,r=8;for(let s=0;s<t;s++)0!==r&&(i=e.readEG(),r=(n+i+256)%256),n=0===r?n:r}readSPS(t){const e=new dl(t);let i,n,r,s=0,a=0,o=0,l=0;const c=e.readUByte.bind(e),u=e.readBits.bind(e),h=e.readUEG.bind(e),d=e.readBoolean.bind(e),f=e.skipBits.bind(e),p=e.skipEG.bind(e),g=e.skipUEG.bind(e),m=this.skipScalingList.bind(this);c();const v=c();if(u(5),f(3),c(),g(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const t=h();if(3===t&&f(1),g(),g(),f(1),d())for(n=3!==t?8:12,r=0;r<n;r++)d()&&m(r<6?16:64,e)}g();const y=h();if(0===y)h();else if(1===y)for(f(1),p(),p(),i=h(),r=0;r<i;r++)p();g(),f(1);const b=h(),S=h(),w=u(1);0===w&&f(1),f(1),d()&&(s=h(),a=h(),o=h(),l=h());let x=[1,1];if(d()&&d()){switch(c()){case 1:x=[1,1];break;case 2:x=[12,11];break;case 3:x=[10,11];break;case 4:x=[16,11];break;case 5:x=[40,33];break;case 6:x=[24,11];break;case 7:x=[20,11];break;case 8:x=[32,11];break;case 9:x=[80,33];break;case 10:x=[18,11];break;case 11:x=[15,11];break;case 12:x=[64,33];break;case 13:x=[160,99];break;case 14:x=[4,3];break;case 15:x=[3,2];break;case 16:x=[2,1];break;case 255:x=[c()<<8|c(),c()<<8|c()]}}return{width:Math.ceil(16*(b+1)-2*s-2*a),height:(2-w)*(S+1)*16-(w?2:4)*(o+l),pixelRatio:x}}}class pl extends hl{constructor(){super(...arguments),this.initVPS=null}parsePES(t,e,i,n){const r=this.parseNALu(t,i.data,n);let s,a=this.VideoSample,o=!1;i.data=null,a&&r.length&&!t.audFound&&(this.pushAccessUnit(a,t),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),r.forEach((n=>{var r,l;switch(n.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var c;if(s=!0,o)null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 39:s=!0,ur(n.data,2,i.pts,e.samples);break;case 32:s=!0,t.vps||("object"!==typeof t.params&&(t.params={}),t.params=pn(t.params,this.readVPS(n.data)),this.initVPS=n.data),t.vps=[n.data];break;case 33:if(s=!0,o=!0,void 0===t.vps||t.vps[0]===this.initVPS||void 0===t.sps||this.matchSPS(t.sps[0],n.data)||(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const e=this.readSPS(n.data);t.width=e.width,t.height=e.height,t.pixelRatio=e.pixelRatio,t.codec=e.codecString,t.sps=[],"object"!==typeof t.params&&(t.params={});for(const i in e.params)t.params[i]=e.params[i]}this.pushParameterSet(t.sps,n.data,t.vps),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0;break;case 34:if(s=!0,"object"===typeof t.params){if(!t.pps){t.pps=[];const e=this.readPPS(n.data);for(const i in e)t.params[i]=e[i]}this.pushParameterSet(t.pps,n.data,t.vps)}break;case 35:s=!0,t.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,t),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:s=!1}if(a&&s){a.units.push(n)}})),n&&a&&(this.pushAccessUnit(a,t),this.VideoSample=null)}pushParameterSet(t,e,i){(i&&i[0]===this.initVPS||!i&&!t.length)&&t.push(e)}getNALuType(t,e){return(126&t[e])>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let i=0;for(let n=0;n<t.byteLength;n++)n>=2&&3===t[n]&&0===t[n-1]&&0===t[n-2]||(e[i]=t[n],i++);return new Uint8Array(e.buffer,0,i)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new dl(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);return{numTemporalLayers:e.readBits(3)+1,temporalIdNested:e.readBoolean()}}readSPS(t){const e=new dl(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const i=e.readBits(3);e.readBoolean();const n=e.readBits(2),r=e.readBoolean(),s=e.readBits(5),a=e.readUByte(),o=e.readUByte(),l=e.readUByte(),c=e.readUByte(),u=e.readUByte(),h=e.readUByte(),d=e.readUByte(),f=e.readUByte(),p=e.readUByte(),g=e.readUByte(),m=e.readUByte(),v=[],y=[];for(let G=0;G<i;G++)v.push(e.readBoolean()),y.push(e.readBoolean());if(i>0)for(let G=i;G<8;G++)e.readBits(2);for(let G=0;G<i;G++)v[G]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),y[G]&&e.readUByte();e.readUEG();const b=e.readUEG();3==b&&e.skipBits(1);const S=e.readUEG(),w=e.readUEG(),x=e.readBoolean();let E=0,L=0,T=0,A=0;x&&(E+=e.readUEG(),L+=e.readUEG(),T+=e.readUEG(),A+=e.readUEG());const _=e.readUEG(),k=e.readUEG(),P=e.readUEG();for(let G=e.readBoolean()?0:i;G<=i;G++)e.skipUEG(),e.skipUEG(),e.skipUEG();e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.readBoolean()){if(e.readBoolean())for(let t=0;t<4;t++)for(let i=0;i<(3===t?2:6);i++){if(e.readBoolean()){const i=Math.min(64,1<<4+(t<<1));t>1&&e.readEG();for(let t=0;t<i;t++)e.readEG()}else e.readUEG()}}e.readBoolean(),e.readBoolean();e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const R=e.readUEG();let I=0;for(let G=0;G<R;G++){let t=!1;if(0!==G&&(t=e.readBoolean()),t){G===R&&e.readUEG(),e.readBoolean(),e.readUEG();let t=0;for(let i=0;i<=I;i++){const i=e.readBoolean();let n=!1;i||(n=e.readBoolean()),(i||n)&&t++}I=t}else{const t=e.readUEG(),i=e.readUEG();I=t+i;for(let n=0;n<t;n++)e.readUEG(),e.readBoolean();for(let n=0;n<i;n++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const t=e.readUEG();for(let i=0;i<t;i++){for(let t=0;t<P+4;t++)e.readBits(1);e.readBits(1)}}let C=0,D=1,N=1,O=!0,M=1,F=0;e.readBoolean(),e.readBoolean();let B=!1;if(e.readBoolean()){if(e.readBoolean()){const t=e.readUByte();t>0&&t<16?(D=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][t-1],N=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][t-1]):255===t&&(D=e.readBits(16),N=e.readBits(16))}e.readBoolean()&&e.readBoolean();if(e.readBoolean()){e.readBits(3),e.readBoolean();e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())}e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),B=e.readBoolean(),B&&(E+=e.readUEG(),L+=e.readUEG(),T+=e.readUEG(),A+=e.readUEG());if(e.readBoolean()){M=e.readBits(32),F=e.readBits(32);e.readBoolean()&&e.readUEG();if(e.readBoolean()){const t=e.readBoolean(),n=e.readBoolean();let r=!1;(t||n)&&(r=e.readBoolean(),r&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),r&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let s=0;s<=i;s++){O=e.readBoolean();let i=!1;O||e.readBoolean()?e.readEG():i=e.readBoolean();const s=i?1:e.readUEG()+1;if(t)for(let t=0;t<s;t++)e.readUEG(),e.readUEG(),r&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(n)for(let t=0;t<s;t++)e.readUEG(),e.readUEG(),r&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),C=e.readUEG())}let U=S,j=w;if(x||B){let t=1,e=1;1===b?t=e=2:2==b&&(t=2),U=S-t*L-t*E,j=w-e*A-e*T}const $=n?["A","B","C"][n]:"",z=a<<24|o<<16|l<<8|c;let H=0;for(let G=0;G<32;G++)H=(H|(z>>G&1)<<31-G)>>>0;let q=H.toString(16);1===s&&"2"===q&&(q="6");return{codecString:`hvc1.${$}${s}.${q}.${r?"H":"L"}${m}.B0`,params:{general_tier_flag:r,general_profile_idc:s,general_profile_space:n,general_profile_compatibility_flags:[a,o,l,c],general_constraint_indicator_flags:[u,h,d,f,p,g],general_level_idc:m,bit_depth:_+8,bit_depth_luma_minus8:_,bit_depth_chroma_minus8:k,min_spatial_segmentation_idc:C,chroma_format_idc:b,frame_rate:{fixed:O,fps:F/M}},width:U,height:j,pixelRatio:[D,N]}}readPPS(t){const e=new dl(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2);e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const i=e.readBoolean(),n=e.readBoolean();let r=1;return n&&i?r=0:n?r=3:i&&(r=2),{parallelismType:r}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const gl=188;class ml{constructor(t,e,i,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=n,this.videoParser=null}static probe(t,e){const i=ml.syncOffset(t);return i>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),-1!==i}static syncOffset(t){const e=t.length;let i=Math.min(940,e-gl)+1,n=0;for(;n<i;){let r=!1,s=-1,a=0;for(let o=n;o<e;o+=gl){if(71!==t[o]||e-o!==gl&&71!==t[o+gl]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(i=Math.min(s+18612,t.length-gl)+1)),r||(r=0===vl(t,o)),r&&a>1&&(0===s&&a>2||o+gl>i))return s}n++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:Hn[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,i,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ml.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=ml.createTrack("audio",n),this._id3Track=ml.createTrack("id3"),this._txtTrack=ml.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e){let i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let c=s.pid,u=s.pesData,h=a.pid,d=o.pid,f=a.pesData,p=o.pesData,g=null,m=this.pmtParsed,v=this._pmtId,y=t.length;if(this.remainderData&&(y=(t=ar(this.remainderData,t)).length,this.remainderData=null),y<gl&&!r)return this.remainderData=t,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const b=Math.max(0,ml.syncOffset(t));y-=(y-b)%gl,y<t.byteLength&&!r&&(this.remainderData=new Uint8Array(t.buffer,y,t.buffer.byteLength-y));let S=0;for(let x=b;x<y;x+=gl)if(71===t[x]){const e=!!(64&t[x+1]),r=vl(t,x);let y;if((48&t[x+3])>>4>1){if(y=x+5+t[x+4],y===x+gl)continue}else y=x+4;switch(r){case c:if(e){if(u&&(i=xl(u,this.logger))){if(null===this.videoParser)switch(s.segmentCodec){case"avc":this.videoParser=new fl;break;case"hevc":this.videoParser=new pl}null!==this.videoParser&&this.videoParser.parsePES(s,l,i,!1)}u={data:[],size:0}}u&&(u.data.push(t.subarray(y,x+gl)),u.size+=x+gl-y);break;case h:if(e){if(f&&(i=xl(f,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,i);break;case"mp3":this.parseMPEGPES(a,i);break;case"ac3":this.parseAC3PES(a,i)}f={data:[],size:0}}f&&(f.data.push(t.subarray(y,x+gl)),f.size+=x+gl-y);break;case d:e&&(p&&(i=xl(p,this.logger))&&this.parseID3PES(o,i),p={data:[],size:0}),p&&(p.data.push(t.subarray(y,x+gl)),p.size+=x+gl-y);break;case 0:e&&(y+=t[y]+1),v=this._pmtId=yl(t,y);break;case v:{e&&(y+=t[y]+1);const i=bl(t,y,this.typeSupported,n,this.observer,this.logger);c=i.videoPid,c>0&&(s.pid=c,s.segmentCodec=i.segmentVideoCodec),h=i.audioPid,h>0&&(a.pid=h,a.segmentCodec=i.segmentAudioCodec),d=i.id3Pid,d>0&&(o.pid=d),null===g||m||(this.logger.warn(`MPEG-TS PMT found at ${x} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,x=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=r}}else S++;S>0&&Sl(this.observer,new Error(`Found ${S} TS packet/s that do not start with 0x47`),void 0,this.logger),s.pesData=u,a.pesData=f,o.pesData=p;const w={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return r&&this.extractRemainingSamples(w),w}flush(){const{remainderData:t}=this;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:i,id3Track:n,textTrack:r}=t,s=i.pesData,a=e.pesData,o=n.pesData;let l;if(s&&(l=xl(s,this.logger))){if(null===this.videoParser)switch(i.segmentCodec){case"avc":this.videoParser=new fl;break;case"hevc":this.videoParser=new pl}null!==this.videoParser&&(this.videoParser.parsePES(i,r,l,!0),i.pesData=null)}else i.pesData=s;if(a&&(l=xl(a,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,l);break;case"mp3":this.parseMPEGPES(e,l);break;case"ac3":this.parseAC3PES(e,l)}e.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=a;o&&(l=xl(o,this.logger))?(this.parseID3PES(n,l),n.pesData=null):n.pesData=o}demuxSampleAes(t,e,i){const n=this.demux(t,i,!0,!this.config.progressive),r=this.sampleAes=new ul(this.observer,this.config,e);return this.decrypt(n,r)}decrypt(t,e){return new Promise((i=>{const{audioTrack:n,videoTrack:r}=t;n.samples&&"aac"===n.segmentCodec?e.decryptAacSamples(n.samples,0,(()=>{r.samples?e.decryptAvcSamples(r.samples,0,0,(()=>{i(t)})):i(t)})):r.samples&&e.decryptAvcSamples(r.samples,0,0,(()=>{i(t)}))}))}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let i=0;const n=this.aacOverFlow;let r,s,a,o=e.data;if(n){this.aacOverFlow=null;const e=n.missing,r=n.sample.unit.byteLength;if(-1===e)o=ar(n.sample.unit,o);else{const s=r-e;n.sample.unit.set(o.subarray(0,e),s),t.samples.push(n.sample),i=n.missing}}for(r=i,s=o.length;r<s-1&&!Ro(o,r);r++);if(r!==i){let t;const e=r<s-1;if(t=e?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",Sl(this.observer,new Error(t),e,this.logger),!e)return}if(Co(t,this.observer,o,r,this.audioCodec),void 0!==e.pts)a=e.pts;else{if(!n)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const e=Do(t.samplerate);a=n.sample.pts+e}}let l,c=0;for(;r<s;){if(l=No(t,o,r,a,c),r+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;r<s-1&&!Ro(o,r);r++);}}parseMPEGPES(t,e){const i=e.data,n=i.length;let r=0,s=0;const a=e.pts;if(void 0!==a)for(;s<n;)if(nl(i,s)){const e=tl(t,i,s,a,r);if(!e)break;s+=e.length,r++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(t,e){{const i=e.data,n=e.pts;if(void 0===n)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=i.length;let s,a=0,o=0;for(;o<r&&(s=ol(t,i,o,n,a++))>0;)o+=s}}parseID3PES(t,e){if(void 0===e.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const i=pn({},e,{type:this._videoTrack?Go.emsg:Go.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}}function vl(t,e){return((31&t[e+1])<<8)+t[e+2]}function yl(t,e){return(31&t[e+10])<<8|t[e+11]}function bl(t,e,i,n,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<o;){const o=vl(t,e),l=(15&t[e+3])<<8|t[e+4];switch(t[e]){case 207:if(!n){wl("ADTS AAC",s);break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!n){wl("H.264",s);break}case 27:-1===a.videoPid&&(a.videoPid=o);break;case 3:case 4:i.mpeg||i.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!n){wl("AC-3",s);break}case 129:i.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&l>0){let n=e+5,r=l;for(;r>2;){if(106===t[n])!0!==i.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3");const e=t[n+1]+2;n+=e,r-=e}}break;case 194:case 135:return Sl(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"))}e+=l+5}return a}function Sl(t,e,i,n){n.warn(`parsing error: ${e.message}`),t.emit(nn.ERROR,nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_PARSING_ERROR,fatal:!1,levelRetry:i,error:e,reason:e.message})}function wl(t,e){e.log(`${t} with AES-128-CBC encryption found in unencrypted stream`)}function xl(t,e){let i,n,r,s,a,o=0;const l=t.data;if(!t||0===t.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=ar(l[0],l[1]),l.splice(1,1);i=l[0];if(1===(i[0]<<16)+(i[1]<<8)+i[2]){if(n=(i[4]<<8)+i[5],n&&n>t.size-6)return null;const c=i[7];192&c&&(s=536870912*(14&i[9])+4194304*(255&i[10])+16384*(254&i[11])+128*(255&i[12])+(254&i[13])/2,64&c?(a=536870912*(14&i[14])+4194304*(255&i[15])+16384*(254&i[16])+128*(255&i[17])+(254&i[18])/2,s-a>54e5&&(e.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),r=i[8];let u=r+9;if(t.size<=u)return null;t.size-=u;const h=new Uint8Array(t.size);for(let t=0,e=l.length;t<e;t++){i=l[t];let e=i.byteLength;if(u){if(u>e){u-=e;continue}i=i.subarray(u),e-=u,u=0}h.set(i,o),o+=e}return n&&(n-=r+3),{data:h,pts:s,dts:a,len:n}}return null}class El{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const Ll=Math.pow(2,32)-1;class Tl{static init(){let t;for(t in Tl.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Tl.types)Tl.types.hasOwnProperty(t)&&(Tl.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Tl.HDLR_TYPES={video:e,audio:i};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Tl.STTS=Tl.STSC=Tl.STCO=r,Tl.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Tl.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Tl.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Tl.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Tl.FTYP=Tl.box(Tl.types.ftyp,s,o,s,a),Tl.DINF=Tl.box(Tl.types.dinf,Tl.box(Tl.types.dref,n))}static box(t){let e=8;for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];let s=n.length;const a=s;for(;s--;)e+=n[s].byteLength;const o=new Uint8Array(e);for(o[0]=e>>24&255,o[1]=e>>16&255,o[2]=e>>8&255,o[3]=255&e,o.set(t,4),s=0,e=8;s<a;s++)o.set(n[s],e),e+=n[s].byteLength;return o}static hdlr(t){return Tl.box(Tl.types.hdlr,Tl.HDLR_TYPES[t])}static mdat(t){return Tl.box(Tl.types.mdat,t)}static mdhd(t,e){e*=t;const i=Math.floor(e/(Ll+1)),n=Math.floor(e%(Ll+1));return Tl.box(Tl.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}static mdia(t){return Tl.box(Tl.types.mdia,Tl.mdhd(t.timescale||0,t.duration||0),Tl.hdlr(t.type),Tl.minf(t))}static mfhd(t){return Tl.box(Tl.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?Tl.box(Tl.types.minf,Tl.box(Tl.types.smhd,Tl.SMHD),Tl.DINF,Tl.stbl(t)):Tl.box(Tl.types.minf,Tl.box(Tl.types.vmhd,Tl.VMHD),Tl.DINF,Tl.stbl(t))}static moof(t,e,i){return Tl.box(Tl.types.moof,Tl.mfhd(t),Tl.traf(i,e))}static moov(t){let e=t.length;const i=[];for(;e--;)i[e]=Tl.trak(t[e]);return Tl.box.apply(null,[Tl.types.moov,Tl.mvhd(t[0].timescale||0,t[0].duration||0)].concat(i).concat(Tl.mvex(t)))}static mvex(t){let e=t.length;const i=[];for(;e--;)i[e]=Tl.trex(t[e]);return Tl.box.apply(null,[Tl.types.mvex,...i])}static mvhd(t,e){e*=t;const i=Math.floor(e/(Ll+1)),n=Math.floor(e%(Ll+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Tl.box(Tl.types.mvhd,r)}static sdtp(t){const e=t.samples||[],i=new Uint8Array(4+e.length);let n,r;for(n=0;n<e.length;n++)r=e[n].flags,i[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Tl.box(Tl.types.sdtp,i)}static stbl(t){return Tl.box(Tl.types.stbl,Tl.stsd(t),Tl.box(Tl.types.stts,Tl.STTS),Tl.box(Tl.types.stsc,Tl.STSC),Tl.box(Tl.types.stsz,Tl.STSZ),Tl.box(Tl.types.stco,Tl.STCO))}static avc1(t){let e,i,n,r=[],s=[];for(e=0;e<t.sps.length;e++)i=t.sps[e],n=i.byteLength,r.push(n>>>8&255),r.push(255&n),r=r.concat(Array.prototype.slice.call(i));for(e=0;e<t.pps.length;e++)i=t.pps[e],n=i.byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(i));const a=Tl.box(Tl.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(s))),o=t.width,l=t.height,c=t.pixelRatio[0],u=t.pixelRatio[1];return Tl.box(Tl.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Tl.box(Tl.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Tl.box(Tl.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))}static esds(t){const e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){const e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,255&e,0,0])}static mp4a(t){return Tl.box(Tl.types.mp4a,Tl.audioStsd(t),Tl.box(Tl.types.esds,Tl.esds(t)))}static mp3(t){return Tl.box(Tl.types[".mp3"],Tl.audioStsd(t))}static ac3(t){return Tl.box(Tl.types["ac-3"],Tl.audioStsd(t),Tl.box(Tl.types.dac3,t.config))}static stsd(t){const{segmentCodec:e}=t;if("audio"===t.type){if("aac"===e)return Tl.box(Tl.types.stsd,Tl.STSD,Tl.mp4a(t));if("ac3"===e&&t.config)return Tl.box(Tl.types.stsd,Tl.STSD,Tl.ac3(t));if("mp3"===e&&"mp3"===t.codec)return Tl.box(Tl.types.stsd,Tl.STSD,Tl.mp3(t))}else{if(!t.pps||!t.sps)throw new Error("video track missing pps or sps");if("avc"===e)return Tl.box(Tl.types.stsd,Tl.STSD,Tl.avc1(t));if("hevc"===e&&t.vps)return Tl.box(Tl.types.stsd,Tl.STSD,Tl.hvc1(t))}throw new Error(`unsupported ${t.type} segment codec (${e}/${t.codec})`)}static tkhd(t){const e=t.id,i=(t.duration||0)*(t.timescale||0),n=t.width||0,r=t.height||0,s=Math.floor(i/(Ll+1)),a=Math.floor(i%(Ll+1));return Tl.box(Tl.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,r>>8&255,255&r,0,0]))}static traf(t,e){const i=Tl.sdtp(t),n=t.id,r=Math.floor(e/(Ll+1)),s=Math.floor(e%(Ll+1));return Tl.box(Tl.types.traf,Tl.box(Tl.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),Tl.box(Tl.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),Tl.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,Tl.box(Tl.types.trak,Tl.tkhd(t),Tl.mdia(t))}static trex(t){const e=t.id;return Tl.box(Tl.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const i=t.samples||[],n=i.length,r=12+16*n,s=new Uint8Array(r);let a,o,l,c,u,h;for(e+=8+r,s.set(["video"===t.type?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0),a=0;a<n;a++)o=i[a],l=o.duration,c=o.size,u=o.flags,h=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,61440&u.degradPrio,15&u.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a);return Tl.box(Tl.types.trun,s)}static initSegment(t){Tl.types||Tl.init();const e=Tl.moov(t);return ar(Tl.FTYP,e)}static hvc1(t){const e=t.params,i=[t.vps,t.sps,t.pps],n=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),3|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),i.length]);let r=n.length;for(let d=0;d<i.length;d+=1){r+=3;for(let t=0;t<i[d].length;t+=1)r+=2+i[d][t].length}const s=new Uint8Array(r);s.set(n,0),r=n.length;const a=i.length-1;for(let d=0;d<i.length;d+=1){s.set(new Uint8Array([32+d|(d===a?128:0),0,i[d].length]),r),r+=3;for(let t=0;t<i[d].length;t+=1)s.set(new Uint8Array([i[d][t].length>>8,255&i[d][t].length]),r),r+=2,s.set(i[d][t],r),r+=i[d][t].length}const o=Tl.box(Tl.types.hvcC,s),l=t.width,c=t.height,u=t.pixelRatio[0],h=t.pixelRatio[1];return Tl.box(Tl.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Tl.box(Tl.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Tl.box(Tl.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))}}Tl.types=void 0,Tl.HDLR_TYPES=void 0,Tl.STTS=void 0,Tl.STSC=void 0,Tl.STCO=void 0,Tl.STSZ=void 0,Tl.VMHD=void 0,Tl.SMHD=void 0,Tl.STSD=void 0,Tl.FTYP=void 0,Tl.DINF=void 0;function Al(t,e){const i=t*e*(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1);return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?Math.round(i):i}function _l(t){return Al(t,1e3,1/9e4,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}let kl,Pl=null,Rl=null;function Il(t,e,i,n){return{duration:e,size:i,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class Cl{constructor(t,e,i,n){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=n,this.ISGenerated=!1,null===Pl){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Pl=t?parseInt(t[1]):0}if(null===Rl){const t=navigator.userAgent.match(/Safari\/(\d+)/i);Rl=t?parseInt(t[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const i=t[0].pts,n=t.reduce(((t,n)=>{let r=n.pts,s=r-t;return s<-4294967296&&(e=!0,r=Dl(r,i),s=r-t),s>0?t:r}),i);return e&&this.logger.debug("PTS rollover detected"),n}remux(t,e,i,n,r,s,a,o){let l,c,u,h,d,f,p=r,g=r;const m=t.pid>-1,v=e.pid>-1,y=e.samples.length,b=t.samples.length>0,S=a&&y>0||y>1;if((!m||b)&&(!v||S)||this.ISGenerated||a){if(this.ISGenerated){var w,x,E,L;const t=this.videoTrackConfig;(t&&(e.width!==t.width||e.height!==t.height||(null==(w=e.pixelRatio)?void 0:w[0])!==(null==(x=t.pixelRatio)?void 0:x[0])||(null==(E=e.pixelRatio)?void 0:E[1])!==(null==(L=t.pixelRatio)?void 0:L[1]))||!t&&S||null===this.nextAudioPts&&b)&&this.resetInitSegment()}this.ISGenerated||(u=this.generateIS(t,e,r,s));const i=this.isVideoContiguous;let n,a=-1;if(S&&(a=function(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}(e.samples),!i&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,a>0){this.logger.warn(`[mp4-remuxer]: Dropped ${a} out of ${y} video samples due to a missing keyframe`);const t=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(a),e.dropped+=a,g+=(e.samples[0].pts-t)/e.inputTimeScale,n=g}else-1===a&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),f=!1);if(this.ISGenerated){if(b&&S){const i=this.getVideoStartPts(e.samples),n=(Dl(t.samples[0].pts,i)-i)/e.inputTimeScale;p+=Math.max(0,n),g+=Math.max(0,-n)}if(b){if(t.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),u=this.generateIS(t,e,r,s)),c=this.remuxAudio(t,p,this.isAudioContiguous,s,v||S||o===cn?g:void 0),S){const n=c?c.endPTS-c.startPTS:0;e.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),u=this.generateIS(t,e,r,s)),l=this.remuxVideo(e,g,i,n)}}else S&&(l=this.remuxVideo(e,g,i,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=n)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(d=Nl(i,r,this._initPTS,this._initDTS)),n.samples.length&&(h=Ol(n,r,this._initPTS))),{audio:c,video:l,initSegment:u,independent:f,text:h,id3:d}}generateIS(t,e,i,n){const r=t.samples,s=e.samples,a=this.typeSupported,o={},l=this._initPTS;let c,u,h,d=!l||n,f="audio/mp4";if(d&&(c=u=1/0),t.config&&r.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",t.codec=""):a.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3"}o.audio={id:"audio",container:f,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&a.mpeg?new Uint8Array(0):Tl.initSegment([t]),metadata:{channelCount:t.channelCount}},d&&(h=t.inputTimeScale,l&&h===l.timescale?d=!1:c=u=r[0].pts-Math.round(h*i))}if(e.sps&&e.pps&&s.length){if(e.timescale=e.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:Tl.initSegment([e]),metadata:{width:e.width,height:e.height}},d)if(h=e.inputTimeScale,l&&h===l.timescale)d=!1;else{const t=this.getVideoStartPts(s),e=Math.round(h*i);u=Math.min(u,Dl(s[0].dts,t)-e),c=Math.min(c,t-e)}this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,d?(this._initPTS={baseTime:c,timescale:h},this._initDTS={baseTime:u,timescale:h}):c=h=void 0,{tracks:o,initPTS:c,timescale:h}}remuxVideo(t,e,i,n){const r=t.inputTimeScale,s=t.samples,a=[],o=s.length,l=this._initPTS;let c,u,h=this.nextAvcDts,d=8,f=this.videoSampleDuration,p=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=!1;if(!i||null===h){const t=e*r,n=s[0].pts-Dl(s[0].dts,s[0].pts);Pl&&null!==h&&Math.abs(t-n-h)<15e3?i=!0:h=t-n}const v=l.baseTime*r/l.timescale;for(let C=0;C<o;C++){const t=s[C];t.pts=Dl(t.pts-v,h),t.dts=Dl(t.dts-v,h),t.dts<s[C>0?C-1:C].dts&&(m=!0)}m&&s.sort((function(t,e){const i=t.dts-e.dts,n=t.pts-e.pts;return i||n})),c=s[0].dts,u=s[s.length-1].dts;const y=u-c,b=y?Math.round(y/(o-1)):f||t.inputTimeScale/30;if(i){const i=c-h,n=i>b,r=i<-1;if((n||r)&&(n?this.logger.warn(`${(t.segmentCodec||"").toUpperCase()}: ${_l(i,!0)} ms (${i}dts) hole between fragments detected at ${e.toFixed(3)}`):this.logger.warn(`${(t.segmentCodec||"").toUpperCase()}: ${_l(-i,!0)} ms (${i}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!r||h>=s[0].pts||Pl)){c=h;const t=s[0].pts-i;if(n)s[0].dts=c,s[0].pts=t;else{let e=!0;for(let n=0;n<s.length&&!(s[n].dts>t&&e);n++){const t=s[n].pts;if(s[n].dts-=i,s[n].pts-=i,n<s.length-1){const i=s[n+1].pts;e=i<=s[n].pts==i<=t}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${_l(t,!0)}/${_l(c,!0)}, delta: ${_l(i,!0)} ms`)}}c=Math.max(0,c);let S=0,w=0,x=c;for(let C=0;C<o;C++){const t=s[C],e=t.units,i=e.length;let n=0;for(let r=0;r<i;r++)n+=e[r].data.length;w+=n,S+=i,t.length=n,t.dts<x?(t.dts=x,x+=b/4|0||1):x=t.dts,p=Math.min(t.pts,p),g=Math.max(t.pts,g)}u=s[o-1].dts;const E=w+4*S+8;let L;try{L=new Uint8Array(E)}catch(ny){return void this.observer.emit(nn.ERROR,nn.ERROR,{type:tn.MUX_ERROR,details:en.REMUX_ALLOC_ERROR,fatal:!1,error:ny,bytes:E,reason:`fail allocating video mdat ${E}`})}const T=new DataView(L.buffer);T.setUint32(0,E),L.set(Tl.types.mdat,4);let A=!1,_=Number.POSITIVE_INFINITY,k=Number.POSITIVE_INFINITY,P=Number.NEGATIVE_INFINITY,R=Number.NEGATIVE_INFINITY;for(let C=0;C<o;C++){const t=s[C],e=t.units;let i,l=0;for(let n=0,r=e.length;n<r;n++){const t=e[n],i=t.data,r=t.data.byteLength;T.setUint32(d,r),d+=4,L.set(i,d),d+=r,l+=4+r}if(C<o-1)f=s[C+1].dts-t.dts,i=s[C+1].pts-t.pts;else{const e=this.config,a=C>0?t.dts-s[C-1].dts:b;if(i=C>0?t.pts-s[C-1].pts:b,e.stretchShortVideoTrack&&null!==this.nextAudioPts){const i=Math.floor(e.maxBufferHole*r),s=(n?p+n*r:this.nextAudioPts)-t.pts;s>i?(f=s-a,f<0?f=a:A=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=a}else f=a}const c=Math.round(t.pts-t.dts);_=Math.min(_,f),P=Math.max(P,f),k=Math.min(k,i),R=Math.max(R,i),a.push(Il(t.key,f,l,c))}if(a.length)if(Pl){if(Pl<70){const t=a[0].flags;t.dependsOn=2,t.isNonSync=0}}else if(Rl&&R-k<P-_&&b/P<.025&&0===a[0].cts){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let t=c;for(let e=0,i=a.length;e<i;e++){const n=t+a[e].duration,r=t+a[e].cts;if(e<i-1){const t=n+a[e+1].cts;a[e].duration=t-r}else a[e].duration=e?a[e-1].duration:b;a[e].cts=0,t=n}}f=A||!f?b:f,this.nextAvcDts=h=u+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const I={data1:Tl.moof(t.sequenceNumber++,c,pn(t,{samples:a})),data2:L,startPTS:p/r,endPTS:(g+f)/r,startDTS:c/r,endDTS:h/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:t.dropped};return t.samples=[],t.dropped=0,I}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(t,e,i,n,r){const s=t.inputTimeScale,a=s/(t.samplerate?t.samplerate:s),o=this.getSamplesPerFrame(t),l=o*a,c=this._initPTS,u="mp3"===t.segmentCodec&&this.typeSupported.mpeg,h=[],d=void 0!==r;let f=t.samples,p=u?0:8,g=this.nextAudioPts||-1;const m=e*s,v=c.baseTime*s/c.timescale;if(this.isAudioContiguous=i=i||f.length&&g>0&&(n&&Math.abs(m-g)<9e3||Math.abs(Dl(f[0].pts-v,m)-g)<20*l),f.forEach((function(t){t.pts=Dl(t.pts-v,m)})),!i||g<0){if(f=f.filter((t=>t.pts>=0)),!f.length)return;g=0===r?0:n&&!d?Math.max(0,m):f[0].pts}if("aac"===t.segmentCodec){const e=this.config.maxAudioFramesDrift;for(let i=0,n=g;i<f.length;i++){const r=f[i],a=r.pts,o=a-n,c=Math.abs(1e3*o/s);if(o<=-e*l&&d)0===i&&(this.logger.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=g=n=a);else if(o>=e*l&&c<1e4&&d){let e=Math.round(o/l);n=a-e*l,n<0&&(e--,n+=l),0===i&&(this.nextAudioPts=g=n),this.logger.warn(`[mp4-remuxer]: Injecting ${e} audio frame @ ${(n/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<e;s++){const e=Math.max(n,0);let s=El.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);s||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=r.unit.subarray()),f.splice(i,0,{unit:s,pts:e}),n+=l,i++}}r.pts=n,n+=l}}let y,b=null,S=null,w=0,x=f.length;for(;x--;)w+=f[x].unit.byteLength;for(let P=0,R=f.length;P<R;P++){const e=f[P],n=e.unit;let r=e.pts;if(null!==S){h[P-1].duration=Math.round((r-S)/a)}else{if(i&&"aac"===t.segmentCodec&&(r=g),b=r,!(w>0))return;w+=p;try{y=new Uint8Array(w)}catch(ny){return void this.observer.emit(nn.ERROR,nn.ERROR,{type:tn.MUX_ERROR,details:en.REMUX_ALLOC_ERROR,fatal:!1,error:ny,bytes:w,reason:`fail allocating audio mdat ${w}`})}if(!u){new DataView(y.buffer).setUint32(0,w),y.set(Tl.types.mdat,4)}}y.set(n,p);const s=n.byteLength;p+=s,h.push(Il(!0,o,s,0)),S=r}const E=h.length;if(!E)return;const L=h[h.length-1];this.nextAudioPts=g=S+a*L.duration;const T=u?new Uint8Array(0):Tl.moof(t.sequenceNumber++,b/a,pn({},t,{samples:h}));t.samples=[];const A=b/s,_=g/s,k={data1:T,data2:y,startPTS:A,endPTS:_,startDTS:A,endDTS:_,type:"audio",hasAudio:!0,hasVideo:!1,nb:E};return this.isAudioContiguous=!0,k}}function Dl(t,e){let i;if(null===e)return t;for(i=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=i;return t}function Nl(t,e,i,n){const r=t.samples.length;if(!r)return;const s=t.inputTimeScale;for(let o=0;o<r;o++){const r=t.samples[o];r.pts=Dl(r.pts-i.baseTime*s/i.timescale,e*s)/s,r.dts=Dl(r.dts-n.baseTime*s/n.timescale,e*s)/s}const a=t.samples;return t.samples=[],{samples:a}}function Ol(t,e,i){const n=t.samples.length;if(!n)return;const r=t.inputTimeScale;for(let a=0;a<n;a++){const n=t.samples[a];n.pts=Dl(n.pts-i.baseTime*r/i.timescale,e*r)/r}t.samples.sort(((t,e)=>t.pts-e.pts));const s=t.samples;return t.samples=[],{samples:s}}function Ml(t,e){const i=null==t?void 0:t.codec;if(i&&i.length>4)return i;if(e===Dn){if("ec-3"===i||"ac-3"===i||"alac"===i)return i;if("fLaC"===i||"Opus"===i){return Lr(i,!1)}return En.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"}return En.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1"}try{kl=self.performance.now.bind(self.performance)}catch(ny){kl=Date.now}const Fl=[{demux:class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,n){const r=this.videoTrack=Vo("video",1),s=this.audioTrack=Vo("audio",1),a=this.txtTrack=Vo("text",1);if(this.id3Track=Vo("id3",1),this.timeOffset=0,null==t||!t.byteLength)return;const o=Jn(t);if(o.video){const{id:t,timescale:e,codec:i,supplemental:n}=o.video;r.id=t,r.timescale=a.timescale=e,r.codec=i,r.supplemental=n}if(o.audio){const{id:t,timescale:e,codec:i}=o.audio;s.id=t,s.timescale=e,s.codec=i}a.id=Hn.text,r.sampleDuration=0,r.duration=s.duration=n}resetContiguity(){this.remainderData=null}static probe(t){return function(t){const e=t.byteLength;for(let i=0;i<e;){const n=Vn(t,i);if(n>8&&109===t[i+4]&&111===t[i+5]&&111===t[i+6]&&102===t[i+7])return!0;i=n>1?i+n:e}return!1}(t)}demux(t,e){this.timeOffset=e;let i=t;const n=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=ar(this.remainderData,t));const e=function(t){const e={valid:null,remainder:null},i=Xn(t,["moof"]);if(i.length<2)return e.remainder=t,e;const n=i[i.length-1];return e.valid=t.slice(0,n.byteOffset-8),e.remainder=t.slice(n.byteOffset-8),e}(i);this.remainderData=e.remainder,n.samples=e.valid||new Uint8Array}else n.samples=i;const s=this.extractID3Track(n,e);return r.samples=or(e,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(e,this.timeOffset);return i.samples=or(t,e),{videoTrack:e,audioTrack:Vo(),id3Track:n,textTrack:Vo()}}extractID3Track(t,e){const i=this.id3Track;if(t.samples.length){const n=Xn(t.samples,["emsg"]);n&&n.forEach((t=>{const n=function(t){const e=t[0];let i="",n="",r=0,s=0,a=0,o=0,l=0,c=0;if(0===e){for(;"\0"!==qn(t.subarray(c,c+1));)i+=qn(t.subarray(c,c+1)),c+=1;for(i+=qn(t.subarray(c,c+1)),c+=1;"\0"!==qn(t.subarray(c,c+1));)n+=qn(t.subarray(c,c+1)),c+=1;n+=qn(t.subarray(c,c+1)),c+=1,r=Vn(t,12),s=Vn(t,16),o=Vn(t,20),l=Vn(t,24),c=28}else if(1===e){c+=4,r=Vn(t,c),c+=4;const e=Vn(t,c);c+=4;const s=Vn(t,c);for(c+=4,a=2**32*e+s,Ji(a)||(a=Number.MAX_SAFE_INTEGER,En.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Vn(t,c),c+=4,l=Vn(t,c),c+=4;"\0"!==qn(t.subarray(c,c+1));)i+=qn(t.subarray(c,c+1)),c+=1;for(i+=qn(t.subarray(c,c+1)),c+=1;"\0"!==qn(t.subarray(c,c+1));)n+=qn(t.subarray(c,c+1)),c+=1;n+=qn(t.subarray(c,c+1)),c+=1}return{schemeIdUri:i,value:n,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:t.subarray(c,t.byteLength)}}(t);if(ll.test(n.schemeIdUri)){const t=cl(n,e);let r=4294967295===n.eventDuration?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=n.payload;i.samples.push({data:s,len:s.byteLength,dts:t,pts:t,type:Go.emsg,duration:r})}else if(this.config.enableEmsgKLVMetadata&&n.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const t=cl(n,e);i.samples.push({data:n.payload,len:n.payload.byteLength,dts:t,pts:t,type:Go.misbklv,duration:Number.POSITIVE_INFINITY})}}))}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class{constructor(t,e,i,n){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.logger=n}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,e,i,n){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(function(t,e){if(!t||!e)return t;const i=e.keyId;i&&e.isCommonEncryption&&Xn(t,["moov","trak"]).forEach((t=>{const e=Xn(t,["mdia","minf","stbl","stsd"])[0].subarray(8);let n=Xn(e,["enca"]);const r=n.length>0;r||(n=Xn(e,["encv"])),n.forEach((t=>{Xn(r?t.subarray(28):t.subarray(78),["sinf"]).forEach((t=>{const e=rr(t);if(e){const t=e.subarray(8,24);t.some((t=>0!==t))||(En.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${_n(t)} -> ${_n(i)}`),e.set(i,8))}}))}))}));return t}(t,n)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:e,videoCodec:i}=this;if(null==t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const n=this.initData=Jn(t);n.audio&&(e=Ml(n.audio,Dn)),n.video&&(i=Ml(n.video,Nn));const r={};n.audio&&n.video?r.audiovideo={container:"video/mp4",codec:e+","+i,supplemental:n.video.supplemental,initSegment:t,id:"main"}:n.audio?r.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:n.video?r.video={container:"video/mp4",codec:i,supplemental:n.video.supplemental,initSegment:t,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(t,e,i,n,r,s){var a,o;let{initPTS:l,lastEndTime:c}=this;const u={audio:void 0,video:void 0,text:n,id3:i,initSegment:void 0};Qi(c)||(c=this.lastEndTime=r||0);const h=e.samples;if(null==h||!h.length)return u;const d={initPTS:void 0,timescale:1};let f=this.initData;if(null!=(a=f)&&a.length||(this.generateInitSegment(h),f=this.initData),null==(o=f)||!o.length)return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),u;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);const p=function(t,e){let i=0,n=0,r=0;const s=Xn(t,["moof","traf"]);for(let a=0;a<s.length;a++){const t=s[a],o=Xn(t,["tfhd"])[0],l=e[Vn(o,4)];if(!l)continue;const c=l.default,u=Vn(o,0)|(null==c?void 0:c.flags);let h=null==c?void 0:c.duration;8&u&&(h=Vn(o,2&u?12:8));const d=l.timescale||9e4,f=Xn(t,["trun"]);for(let e=0;e<f.length;e++)i=sr(f[e]),!i&&h&&(i=h*Vn(f[e],4)),l.type===Nn?n+=i/d:l.type===Dn&&(r+=i/d)}if(0===n&&0===r){let e=1/0,i=0,n=0;const r=Xn(t,["sidx"]);for(let t=0;t<r.length;t++){const s=Qn(r[t]);if(null!=s&&s.references){e=Math.min(e,s.earliestPresentationTime/s.timescale);const t=s.references.reduce(((t,e)=>t+e.info.duration||0),0);i=Math.max(i,t+s.earliestPresentationTime/s.timescale),n=i-e}}if(n&&Qi(n))return n}return n||r}(h,f),g=function(t,e){return Xn(e,["moof","traf"]).reduce(((e,i)=>{const n=Xn(i,["tfdt"])[0],r=n[0],s=Xn(i,["tfhd"]).reduce(((e,i)=>{const s=Vn(i,4),a=t[s];if(a){let t=Vn(n,4);if(1===r){if(t===$n)return En.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),e;t*=$n+1,t+=Vn(n,8)}const i=t/(a.timescale||9e4);if(Qi(i)&&(null===e||i<e))return i}return e}),null);return null!==s&&Qi(s)&&(null===e||s<e)?s:e}),null)}(f,h),m=null===g?r:g;!s&&l||!function(t,e,i,n){if(null===t)return!0;const r=Math.max(n,1),s=e-t.baseTime/t.timescale;return Math.abs(s-i)>r}(l,m,r,p)&&d.timescale===l.timescale||(d.initPTS=m-r,l&&1===l.timescale&&this.logger.warn(`Adjusting initPTS @${r} from ${l.baseTime/l.timescale} to ${d.initPTS}`),this.initPTS=l={baseTime:d.initPTS,timescale:1});const v=t?m-l.baseTime/l.timescale:c,y=v+p;!function(t,e,i){Xn(e,["moof","traf"]).forEach((e=>{Xn(e,["tfhd"]).forEach((n=>{const r=Vn(n,4),s=t[r];if(!s)return;const a=s.timescale||9e4;Xn(e,["tfdt"]).forEach((t=>{const e=t[0],n=i*a;if(n){let i=Vn(t,4);if(0===e)i-=n,i=Math.max(i,0),Yn(t,4,i);else{i*=Math.pow(2,32),i+=Vn(t,8),i-=n,i=Math.max(i,0);const e=Math.floor(i/($n+1)),r=Math.floor(i%($n+1));Yn(t,4,e),Yn(t,8,r)}}}))}))}))}(f,h,l.baseTime/l.timescale),p>0?this.lastEndTime=y:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!f.audio,S=!!f.video;let w="";b&&(w+="audio"),S&&(w+="video");const x={data1:h,startPTS:v,startDTS:v,endPTS:y,endDTS:y,type:w,hasAudio:b,hasVideo:S,nb:1,dropped:0};return u.audio="audio"===x.type?x:void 0,u.video="audio"!==x.type?x:void 0,u.initSegment=d,u.id3=Nl(i,r,l,l),n.samples.length&&(u.text=Ol(n,r,l)),u}}},{demux:ml,remux:Cl},{demux:class extends Wo{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,n){super.resetInitSegment(t,e,i,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const i=Ao(t,0);let n=(null==i?void 0:i.length)||0;if(rl(t,n))return!1;for(let r=t.length;n<r;n++)if(Io(t,n))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return function(t,e){return e+5<t.length}(t,e)&&_o(t,e)&&Po(t,e)<=t.length-e}(t,e)}appendFrame(t,e,i){Co(t,this.observer,e,i,t.manifestCodec);const n=No(t,e,i,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n}},remux:Cl},{demux:class extends Wo{resetInitSegment(t,e,i,n){super.resetInitSegment(t,e,i,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=Ao(t,0);let i=(null==e?void 0:e.length)||0;if(e&&11===t[i]&&119===t[i+1]&&void 0!==qo(e)&&sl(t,i)<=16)return!1;for(let n=t.length;i<n;i++)if(rl(t,i))return En.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return il(t,e)&&4<=t.length-e}(t,e)}appendFrame(t,e,i){if(null!==this.basePTS)return tl(t,e,i,this.basePTS,this.frameIndex)}},remux:Cl}];Fl.splice(2,0,{demux:al,remux:Cl});class Bl{constructor(t,e,i,n,r,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=r,this.logger=s}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,n){const r=i.transmuxing;r.executeStart=kl();let s=new Uint8Array(t);const{currentTransmuxState:a,transmuxConfig:o}=this;n&&(this.currentTransmuxState=n);const{contiguous:l,discontinuity:c,trackSwitch:u,accurateTimeOffset:h,timeOffset:d,initSegmentChange:f}=n||a,{audioCodec:p,videoCodec:g,defaultInitPts:m,duration:v,initSegmentData:y}=o,b=function(t,e){let i=null;t.byteLength>0&&null!=(null==e?void 0:e.key)&&null!==e.iv&&null!=e.method&&(i=e);return i}(s,e);if(b&&Qs(b.method)){const t=this.getDecrypter(),e=Js(b.method);if(!t.isSync())return this.asyncResult=!0,this.decryptionPromise=t.webCryptoDecrypt(s,b.key.buffer,b.iv.buffer,e).then((t=>{const e=this.push(t,null,i);return this.decryptionPromise=null,e})),this.decryptionPromise;{let n=t.softwareDecrypt(s,b.key.buffer,b.iv.buffer,e);if(i.part>-1){const e=t.flush();n=e?e.buffer:e}if(!n)return r.executeEnd=kl(),Ul(i);s=new Uint8Array(n)}}const S=this.needsProbing(c,u);if(S){const t=this.configureTransmuxer(s);if(t)return this.logger.warn(`[transmuxer] ${t.message}`),this.observer.emit(nn.ERROR,nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_PARSING_ERROR,fatal:!1,error:t,reason:t.message}),r.executeEnd=kl(),Ul(i)}(c||u||f||S)&&this.resetInitSegment(y,p,g,v,e),(c||f||S)&&this.resetInitialTimestamp(m),l||this.resetContiguity();const w=this.transmux(s,b,d,h,i);this.asyncResult=jl(w);const x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,r.executeEnd=kl(),w}flush(t){const e=t.transmuxing;e.executeStart=kl();const{decrypter:i,currentTransmuxState:n,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then((()=>this.flush(t)));const s=[],{timeOffset:a}=n;if(i){const e=i.flush();e&&s.push(this.push(e.buffer,null,t))}const{demuxer:o,remuxer:l}=this;if(!o||!l){e.executeEnd=kl();const i=[Ul(t)];return this.asyncResult?Promise.resolve(i):i}const c=o.flush(a);return jl(c)?(this.asyncResult=!0,c.then((e=>(this.flushRemux(s,e,t),s)))):(this.flushRemux(s,c,t),this.asyncResult?Promise.resolve(s):s)}flushRemux(t,e,i){const{audioTrack:n,videoTrack:r,id3Track:s,textTrack:a}=e,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===ln?"level":"track"} ${i.level}`);const c=this.remuxer.remux(n,r,s,a,l,o,!0,this.id);t.push({remuxResult:c,chunkMeta:i}),i.transmuxing.executeEnd=kl()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;e&&i&&(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,n,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(t,e,i,n),a.resetInitSegment(t,e,i,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,n,r){let s;return s=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,i,n,r):this.transmuxUnencrypted(t,i,n,r),s}transmuxUnencrypted(t,e,i,n){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,e,i,!1,this.id),chunkMeta:n}}transmuxSampleAes(t,e,i,n,r){return this.demuxer.demuxSampleAes(t,e,i).then((t=>({remuxResult:this.remuxer.remux(t.audioTrack,t.videoTrack,t.id3Track,t.textTrack,i,n,!1,this.id),chunkMeta:r})))}configureTransmuxer(t){const{config:e,observer:i,typeSupported:n}=this;let r;for(let u=0,h=Fl.length;u<h;u++){var s;if(null!=(s=Fl[u].demux)&&s.probe(t,this.logger)){r=Fl[u];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,l=r.remux,c=r.demux;o&&o instanceof l||(this.remuxer=new l(i,e,n,this.logger)),a&&a instanceof c||(this.demuxer=new c(i,e,n,this.logger),this.probe=c.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Rs(this.config)),t}}const Ul=t=>({remuxResult:{},chunkMeta:t});function jl(t){return"then"in t&&t.then instanceof Function}class $l{constructor(t,e,i,n,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=n,this.defaultInitPts=r||null}}class zl{constructor(t,e,i,n,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=n,this.timeOffset=r,this.initSegmentChange=s}}let Hl=0;class ql{constructor(t,e,i,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Hl++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=t=>{const e=t.data,i=this.hls;if(i&&null!=e&&e.event&&e.instanceNo===this.instanceNo)switch(e.event){case"init":{var n;const t=null==(n=this.workerContext)?void 0:n.objectURL;t&&self.URL.revokeObjectURL(t);break}case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;case"workerLog":i.logger[e.data.logType]&&i.logger[e.data.logType](e.data.message);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.part=this.part,e.data.id=this.id,i.trigger(e.event,e.data)}},this.onWorkerError=t=>{if(!this.hls)return;const e=new Error(`${t.message}  (${t.filename}:${t.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:e})};const r=t.config;this.hls=t,this.id=e,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=i,this.onFlush=n;const s=(t,e)=>{(e=e||{}).frag=this.frag||void 0,t===nn.ERROR&&(e.parent=this.id,e.part=this.part,this.error=e.error),this.hls.trigger(t,e)};this.observer=new So,this.observer.on(nn.FRAG_DECRYPTED,s),this.observer.on(nn.ERROR,s);const a=_r(r.preferManagedMediaSource);if(this.useWorker&&"undefined"!==typeof Worker){const i=this.hls.logger;if(r.workerPath||"function"===typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(i.log(`loading Web Worker ${r.workerPath} for "${e}"`),this.workerContext=function(t){const e=xo[t];if(e)return e.clientCount++,e;const i=new self.URL(t,self.location.href).href,n={worker:new self.Worker(i),scriptURL:i,clientCount:1};return xo[t]=n,n}(r.workerPath)):(i.log(`injecting Web Worker for "${e}"`),this.workerContext=function(){const t=xo[wo];if(t)return t.clientCount++,t;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),i=self.URL.createObjectURL(e),n={worker:new self.Worker(i),objectURL:i,clientCount:1};return xo[wo]=n,n}());const{worker:t}=this.workerContext;t.addEventListener("message",this.onWorkerMessage),t.addEventListener("error",this.onWorkerError),t.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:e,config:qr(r)})}catch(ny){i.warn(`Error setting up "${e}" Web Worker, fallback to inline`,ny),this.terminateWorker(),this.error=null,this.transmuxer=new Bl(this.observer,a,r,"",e,t.logger)}return}}this.transmuxer=new Bl(this.observer,a,r,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=Hl++;const e=this.hls.config,i=_r(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:qr(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),function(t){const e=xo[t||wo];if(e&&1===e.clientCount--){const{worker:i,objectURL:n}=e;delete xo[t||wo],n&&self.URL.revokeObjectURL(n),i.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,i,n,r,s,a,o,l,c){var u,h;l.transmuxing.start=self.performance.now();const{instanceNo:d,transmuxer:f}=this,p=s?s.start:r.start,g=r.decryptdata,m=this.frag,v=!(m&&r.cc===m.cc),y=!(m&&l.level===m.level),b=m?l.sn-m.sn:-1,S=this.part?l.part-this.part.index:-1,w=0===b&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),x=!y&&(1===b||0===b&&(1===S||w&&S<=0)),E=self.performance.now();(y||b||0===r.stats.parsing.start)&&(r.stats.parsing.start=E),!s||!S&&x||(s.stats.parsing.start=E);const L=!(m&&(null==(u=r.initSegment)?void 0:u.url)===(null==(h=m.initSegment)?void 0:h.url)),T=new zl(v,x,o,y,p,L);if(!x||v||L){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${l.sn}${l.part>-1?" part: "+l.part:""} ${this.id===ln?"level":"track"}: ${l.level} id: ${l.id}\n        discontinuity: ${v}\n        trackSwitch: ${y}\n        contiguous: ${x}\n        accurateTimeOffset: ${o}\n        timeOffset: ${p}\n        initSegmentChange: ${L}`);const t=new $l(i,n,e,a,c);this.configureTransmuxer(t)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:d,cmd:"demux",data:t,decryptdata:g,chunkMeta:l,state:T},t instanceof ArrayBuffer?[t]:[]);else if(f){const e=f.push(t,g,l,T);jl(e)?e.then((t=>{this.handleTransmuxComplete(t)})).catch((t=>{this.transmuxerError(t,l,"transmuxer-interface push error")})):this.handleTransmuxComplete(e)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(i){const e=i.flush(t);jl(e)?e.then((e=>{this.handleFlushResult(e,t)})).catch((e=>{this.transmuxerError(e,t,"transmuxer-interface flush error")})):this.handleFlushResult(e,t)}}transmuxerError(t,e,i){this.hls&&(this.error=t,this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach((t=>{this.handleTransmuxComplete(t)})),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}class Gl extends vn{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){const n=null==e?void 0:e.renditionReports;if(n){let s=-1;for(let i=0;i<n.length;i++){const a=n[i];let o;try{o=new self.URL(a.URI,e.url).href}catch(r){this.warn(`Could not construct new URL for Rendition Report: ${r}`),o=a.URI||""}if(o===t){s=i;break}o===t.substring(0,o.length)&&(s=i)}if(-1!==s){const t=n[s],r=parseInt(t["LAST-MSN"])||(null==e?void 0:e.lastPartSn);let a=parseInt(t["LAST-PART"])||(null==e?void 0:e.lastPartIndex);if(this.hls.config.lowLatencyMode){const t=Math.min(e.age-e.partTarget,e.targetduration);a>=0&&t>e.partTarget&&(a+=1)}const o=i&&Ur(i);return new jr(r,a>=0?a:void 0,o)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return t}playlistLoaded(t,e,i){const{details:n,stats:r}=e,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;n.advancedDateTime=Date.now()-a;const o=this.hls.config.timelineOffset;if(o!==n.appliedTimelineOffset){const t=Math.max(o||0,0);n.appliedTimelineOffset=t,n.fragments.forEach((e=>{e.start=e.playlistOffset+t}))}if(n.live||null!=i&&i.live){const o="levelInfo"in e?e.levelInfo:e.track;if(n.reloaded(i),i&&n.fragments.length>0){ja(i,n);const t=n.playlistParsingError;if(t){this.warn(t);const i=this.hls;if(!i.config.ignorePlaylistParsingErrors){var l;const{networkDetails:s}=e;return void i.trigger(nn.ERROR,{type:tn.NETWORK_ERROR,details:en.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:t,reason:t.message,level:e.level||void 0,parent:null==(l=n.fragments[0])?void 0:l.type,networkDetails:s,stats:r})}n.playlistParsingError=null}}-1===n.requestScheduled&&(n.requestScheduled=r.loading.start);const c=this.hls.mainForwardBufferInfo,u=c?c.end-c.len:0,h=qa(n,1e3*(n.edge-u));if(n.requestScheduled+h<s?n.requestScheduled=s:n.requestScheduled+=h,this.log(`live playlist ${t} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let d,f,p;if(n.canBlockReload&&n.endSN&&n.advanced){const t=this.hls.config.lowLatencyMode,r=n.lastPartSn,a=n.endSN,l=n.lastPartIndex,c=r===a;-1!==l?c?(f=a+1,p=t?0:l):(f=r,p=t?l+1:n.maxPartIndex):f=a+1;const u=n.age,h=u+n.ageHeader;let g=Math.min(h-n.partTarget,1.5*n.targetduration);if(g>0){if(h>3*n.targetduration)this.log(`Playlist last advanced ${u.toFixed(2)}s ago. Omitting segment and part directives.`),f=void 0,p=void 0;else if(null!=i&&i.tuneInGoal&&h-n.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${g} with playlist age: ${n.age}`),g=0;else{const t=Math.floor(g/n.targetduration);if(f+=t,void 0!==p){p+=Math.round(g%n.targetduration/n.partTarget)}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${u.toFixed(2)}s goal: ${g} skip sn ${t} to part ${p}`)}n.tuneInGoal=g}if(d=this.getDeliveryDirectives(n,e.deliveryDirectives,f,p),t||!c)return n.requestScheduled=s,void this.loadingPlaylist(o,d)}else(n.canBlockReload||n.canSkipUntil)&&(d=this.getDeliveryDirectives(n,e.deliveryDirectives,f,p));d&&void 0!==f&&n.canBlockReload&&(n.requestScheduled=r.loading.first+Math.max(h-2*a,h/2)),this.scheduleLoading(o,d,n)}else this.clearTimer()}scheduleLoading(t,e,i){const n=i||t.details;if(!n)return void this.loadingPlaylist(t,e);const r=self.performance.now(),s=n.requestScheduled;if(r>=s)return void this.loadingPlaylist(t,e);const a=s-r;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout((()=>this.loadingPlaylist(t,e)),a)}getDeliveryDirectives(t,e,i,n){let r=Ur(t);return null!=e&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,n=e.part,r=Mr),new jr(i,n,r)}checkRetry(t){const e=t.details,i=rs(t),n=t.errorAction,{action:r,retryCount:s=0,retryConfig:a}=n||{},o=!!n&&!!a&&(r===ds||!n.resolved&&r===us);if(o){var l;if(s>=a.maxNumRetry)return!1;if(i&&null!=(l=t.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const t=as(a,s);this.clearTimer(),this.timer=self.setTimeout((()=>this.loadPlaylist()),t),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${e}" in ${t}ms`)}t.levelRetry=!0,n.resolved=!0}return o}}function Vl(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Wl(t[i].attrs,e[i].attrs))return!1;return!0}function Wl(t,e,i){const n=t["STABLE-RENDITION-ID"];return n&&!i?n===e["STABLE-RENDITION-ID"]:!(i||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((i=>t[i]!==e[i]))}function Kl(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}class Yl{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,i){if(null===this.queues||null===this.tracks)return;const n=this.queues[e];n.push(t),1!==n.length||i||this.executeNext(e)}appendBlocker(t){return new Promise((e=>{const i={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,t)}))}prependBlocker(t){return new Promise((e=>{if(this.queues){const i={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(i)}}))}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((t=>{var e;const i=null==(e=t[0])?void 0:e.label;"async-blocker"!==i&&"async-blocker-prepend"!==i||(t[0].execute(),t.splice(0,1))}))}unblockAudio(t){if(null===this.queues)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(null===this.queues||null===this.tracks)return;const e=this.queues[t];if(e.length){const r=e[0];try{r.execute()}catch(n){var i;if(r.onError(n),null===this.queues||null===this.tracks)return;const e=null==(i=this.tracks[t])?void 0:i.buffer;null!=e&&e.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){null!==this.queues&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return(null==(e=this.queues)?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return null===t||null===e?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(t){var e,i;return null!=(e=this.queues)&&e[t]||null!=(i=this.tracks)&&i[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;const i=null==(e=this.tracks)?void 0:e[t],n=null==i?void 0:i.buffer;return n?`SourceBuffer${n.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(t){var e;return(null==(e=this.queues)?void 0:e[t].map((t=>t.label)).join(", "))||""}}const Xl=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Ql="HlsJsTrackRemovedError";class Jl extends Error{constructor(t){super(t),this.name=Ql}}function Zl(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach((e=>{t.removeChild(e)}))}function tc(t){return"audio"===t?1:0}class ec{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(nn.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.on(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(nn.BUFFER_CODECS,this.onBufferCodecs,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(nn.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.off(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(nn.BUFFER_CODECS,this.onBufferCodecs,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&Qi(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const t=this.hls.levels;if(t.length){const e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter(((e,i)=>this.isLevelAllowed(e)&&i<=t));return this.clientRect=null,ec.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,e.width||e.height||(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(Bw){}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some((e=>t.bitrate===e.bitrate&&t.width===e.width&&t.height===e.height))}static getMaxLevelByMediaSize(t,e,i){if(null==t||!t.length)return-1;let n=t.length-1;const r=Math.max(e,i);for(let o=0;o<t.length;o+=1){const e=t[o];if((e.width>=r||e.height>=r)&&(s=e,!(a=t[o+1])||s.width!==a.width||s.height!==a.height)){n=o;break}}var s,a;return n}}const ic={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},nc={HLS:"h"},rc="CMCD-Object",sc="CMCD-Request",ac="CMCD-Session",oc="CMCD-Status",lc={[rc]:["br","d","ot","tb"],[sc]:["bl","dl","mtp","nor","nrr","su"],[ac]:["cid","pr","sf","sid","st","v"],[oc]:["bs","rtp"]};class cc{constructor(t,e){Array.isArray(t)&&(t=t.map((t=>t instanceof cc?t:new cc(t)))),this.value=t,this.params=e}}function uc(t,e,i,n){return new Error(`failed to ${t} "${r=e,Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"===typeof r?JSON.stringify(r):String(r)}" as ${i}`,{cause:n});var r}function hc(t,e,i){return uc("serialize",t,e,i)}class dc{constructor(t){this.description=t}}const fc="Bare Item";function pc(t){if(!1===ArrayBuffer.isView(t))throw hc(t,"Byte Sequence");return`:${e=t,btoa(String.fromCharCode(...e))}:`;var e}function gc(t){if(function(t){return t<-999999999999999||999999999999999<t}(t))throw hc(t,"Integer");return t.toString()}function mc(t){const e=Mo(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw hc(t,"Decimal");const i=e.toString();return i.includes(".")?i:`${i}.0`}const vc=/[\x00-\x1f\x7f]+/;function yc(t){const e=(i=t).description||i.toString().slice(7,-1);var i;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e))throw hc(e,"Token");return e}function bc(t){switch(typeof t){case"number":if(!Qi(t))throw hc(t,fc);return Number.isInteger(t)?gc(t):mc(t);case"string":return function(t){if(vc.test(t))throw hc(t,"String");return`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(t);case"symbol":return yc(t);case"boolean":return function(t){if("boolean"!==typeof t)throw hc(t,"Boolean");return t?"?1":"?0"}(t);case"object":if(t instanceof Date)return function(t){return`@${gc(t.getTime()/1e3)}`}(t);if(t instanceof Uint8Array)return pc(t);if(t instanceof dc)return yc(t);default:throw hc(t,fc)}}function Sc(t){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(t))throw hc(t,"Key");return t}function wc(t){return null==t?"":Object.entries(t).map((t=>{let[e,i]=t;return!0===i?`;${Sc(e)}`:`;${Sc(e)}=${bc(i)}`})).join("")}function xc(t){return t instanceof cc?`${bc(t.value)}${wc(t.params)}`:bc(t)}function Ec(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{whitespace:!0};if("object"!==typeof t)throw hc(t,"Dict");const i=t instanceof Map?t.entries():Object.entries(t),n=(null===e||void 0===e?void 0:e.whitespace)?" ":"";return Array.from(i).map((t=>{let[e,i]=t;i instanceof cc===!1&&(i=new cc(i));let n=Sc(e);var r;return!0===i.value?n+=wc(i.params):(n+="=",Array.isArray(i.value)?n+=`(${(r=i).value.map(xc).join(" ")})${wc(r.params)}`:n+=xc(i)),n})).join(`,${n}`)}const Lc=t=>Math.round(t),Tc=t=>100*Lc(t/100),Ac={br:Lc,d:Lc,bl:Tc,dl:Tc,mtp:Tc,nor:(t,e)=>((null===e||void 0===e?void 0:e.baseUrl)&&(t=function(t,e){const i=new URL(t),n=new URL(e);if(i.origin!==n.origin)return t;const r=i.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}(t,e.baseUrl)),encodeURIComponent(t)),rtp:Tc,tb:Lc};function _c(t,e){const i={};if(null==t||"object"!==typeof t)return i;const n=Object.keys(t).sort(),r=pn({},Ac,null===e||void 0===e?void 0:e.formatters),s=null===e||void 0===e?void 0:e.filter;return n.forEach((n=>{if(null===s||void 0===s?void 0:s(n))return;let a=t[n];const o=r[n];o&&(a=o(a,e)),"v"===n&&1===a||"pr"==n&&1===a||function(t){return"number"===typeof t?Qi(t):null!=t&&""!==t&&!1!==t}(a)&&(function(t){return"ot"===t||"sf"===t||"st"===t}(n)&&"string"===typeof a&&(a=new dc(a)),i[n]=a)})),i}function kc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?function(t,e){return Ec(t,e)}(_c(t,e),pn({whitespace:!1},e)):""}function Pc(t,e,i){return pn(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};if(!t)return i;const n=Object.entries(t),r=Object.entries(lc).concat(Object.entries((null===e||void 0===e?void 0:e.customHeaderMap)||{})),s=n.reduce(((t,e)=>{var i,n;const[s,a]=e,o=(null===(i=r.find((t=>t[1].includes(s))))||void 0===i?void 0:i[0])||sc;return null!==(n=t[o])&&void 0!==n||(t[o]={}),t[o][s]=a,t}),{});return Object.entries(s).reduce(((t,i)=>{let[n,r]=i;return t[n]=kc(r,e),t}),i)}(e,i))}const Rc=/CMCD=[^&#]+/;function Ic(t,e,i){const n=function(t){if(!t)return"";const e=kc(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return`CMCD=${encodeURIComponent(e)}`}(e,i);if(!n)return t;if(Rc.test(t))return t.replace(Rc,n);const r=t.includes("?")?"&":"?";return`${t}${r}${n}`}function Cc(t,e,i,n){t&&Object.keys(e).forEach((r=>{const s=t.filter((t=>t.groupId===r)).map((t=>{const s=pn({},t);return s.details=void 0,s.attrs=new Ws(s.attrs),s.url=s.attrs.URI=Dc(t.url,t.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),s.groupId=s.attrs["GROUP-ID"]=e[r],s.attrs["PATHWAY-ID"]=n,s}));t.push(...s)}))}function Dc(t,e,i,n){const{HOST:r,PARAMS:s,[i]:a}=n;let o;e&&(o=null==a?void 0:a[e],o&&(t=o));const l=new self.URL(t);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach((t=>{t&&l.searchParams.set(t,s[t])})),l.href}class Nc extends vn{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Nc.CDMCleanupPromise?[Nc.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:e,initData:i}=t,n=`"${t.type}" event: init data type: "${e}"`;if(this.debug(n),null!==i){if(!this.keyFormatPromise){let t=Object.keys(this.keySystemAccessPromises);t.length||(t=ga(this.config));const e=t.map(pa).filter((t=>!!t));this.keyFormatPromise=this.getKeyFormatPromise(e)}this.keyFormatPromise.then((r=>{const s=la(r);let a,o;if("sinf"===e){if(s!==na.FAIRPLAY)return void this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${e}" for selected key-system ${s}`);const r=qn(new Uint8Array(i));try{const t=rr(Zs(JSON.parse(r).sinf));if(!t)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=new Uint8Array(t.subarray(8,24)),o=na.FAIRPLAY}catch(d){return void this.warn(`${n} Failed to parse sinf: ${d}`)}}else{if(s!==na.WIDEVINE&&s!==na.PLAYREADY)return void this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${e}" for selected key-system ${s}`);const r=function(t){const e=[];if(t instanceof ArrayBuffer){const i=t.byteLength;let n=0;for(;n+32<i;){const i=fr(new DataView(t,n));e.push(i),n+=i.size}}return e}(i),l=r.filter((t=>!!t.systemId&&fa(t.systemId)===s));l.length>1&&this.warn(`${n} Using first of ${l.length} pssh found for selected key-system ${s}`);const c=l[0];if(!c)return void(0===r.length||r.some((t=>!t.systemId))?this.warn(`${n} contains incomplete or invalid pssh data`):this.log(`ignoring ${n} for ${r.map((t=>fa(t.systemId))).join(",")} pssh data in favor of playlist keys`));if(o=fa(c.systemId),0===c.version&&c.data)if(o===na.WIDEVINE){const t=c.data.length-22;a=new Uint8Array(c.data.subarray(t,t+16))}else o===na.PLAYREADY&&(a=ya(c.data))}if(!o||!a)return;const l=_n(a),{keyIdToKeySessionPromise:c,mediaKeySessions:u}=this;let h=c[l];for(let t=0;t<u.length;t++){const n=u[t],r=n.decryptdata;if(!r.keyId)continue;const s=_n(r.keyId);if(l===s||-1!==r.uri.replace(/-/g,"").indexOf(l)){if(h=c[s],r.pssh)break;delete c[s],r.pssh=new Uint8Array(i),r.keyId=a,h=c[l]=h.then((()=>this.generateRequestWithPreferredKeySession(n,e,i,"encrypted-event-key-match"))),h.catch((t=>this.handleError(t)));break}}if(!h){if(o!==s)return void this.log(`Ignoring "${t.type}" event with ${o} init data for selected key-system ${s}`);h=c[l]=this.getKeySystemSelectionPromise([o]).then((t=>{let{keySystem:n,mediaKeys:r}=t;var s;this.throwIfDestroyed();const o=new Sa("ISO-23001-7",l,null!=(s=pa(n))?s:"");return o.pssh=new Uint8Array(i),o.keyId=a,this.attemptSetMediaKeys(n,r).then((()=>{this.throwIfDestroyed();const t=this.createMediaKeySessionContext({decryptdata:o,keySystem:n,mediaKeys:r});return this.generateRequestWithPreferredKeySession(t,e,i,"encrypted-event-no-match")}))})),h.catch((t=>this.handleError(t)))}}))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){const t=this.media;this.unregisterListeners(),this.onMediaDetached(),this._clear(t);const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(nn.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(nn.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(nn.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(nn.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:i}=this.config,n=e[t];return n?n.licenseUrl:t===na.WIDEVINE&&i?i:void 0}getLicenseServerUrlOrThrow(t){const e=this.getLicenseServerUrl(t);if(void 0===e)throw new Error(`no license server URL configured for key-system "${t}"`);return e}getServerCertificateUrl(t){const{drmSystems:e}=this.config,i=e[t];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const e=this.hls.levels,i=(t,e,i)=>!!t&&i.indexOf(t)===e,n=e.map((t=>t.audioCodec)).filter(i),r=e.map((t=>t.videoCodec)).filter(i);return n.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((e,i)=>{const s=t=>{const a=t.shift();this.getMediaKeysPromise(a,n,r).then((t=>e({keySystem:a,mediaKeys:t}))).catch((e=>{t.length?s(t):i(e instanceof Oc?e:new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_NO_ACCESS,error:e,fatal:!0},e.message))}))};s(t)}))}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:i}=this.config;if("function"!==typeof i){let t=`Configured requestMediaKeySystemAccess is not a function ${i}`;return null===ma&&"http:"===self.location.protocol&&(t=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(t))}return i(t,e)}getMediaKeysPromise(t,e,i){const n=function(t,e,i,n){let r;switch(t){case na.FAIRPLAY:r=["cenc","sinf"];break;case na.WIDEVINE:case na.PLAYREADY:r=["cenc"];break;case na.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${t}`)}return function(t,e,i,n){return[{initDataTypes:t,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map((t=>({contentType:`audio/mp4; codecs=${t}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}))),videoCapabilities:i.map((t=>({contentType:`video/mp4; codecs=${t}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null})))}]}(r,e,i,n)}(t,e,i,this.config.drmSystemOptions),r=this.keySystemAccessPromises[t];let s=null==r?void 0:r.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${t}" key-system access with config: ${qr(n)}`),s=this.requestMediaKeySystemAccess(t,n);const e=this.keySystemAccessPromises[t]={keySystemAccess:s};return s.catch((e=>{this.log(`Failed to obtain access to key-system "${t}": ${e}`)})),s.then((i=>{this.log(`Access for key-system "${i.keySystem}" obtained`);const n=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),e.mediaKeys=i.createMediaKeys().then((e=>(this.log(`Media-keys created for "${t}"`),n.then((i=>i?this.setMediaKeysServerCertificate(e,t,i):e))))),e.mediaKeys.catch((e=>{this.error(`Failed to create media-keys for "${t}"}: ${e}`)})),e.mediaKeys}))}return s.then((()=>r.mediaKeys))}createMediaKeySessionContext(t){let{decryptdata:e,keySystem:i,mediaKeys:n}=t;this.log(`Creating key-system session "${i}" keyId: ${_n(e.keyId||[])}`);const r=n.createSession(),s={decryptdata:e,keySystem:i,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const i=this.createMediaKeySessionContext(t),n=this.getKeyIdString(e),r="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(i,r,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return _n(t.keyId)}updateKeySession(t,e){var i;const n=t.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${_n((null==(i=t.decryptdata)?void 0:i.keyId)||[])}\n      } (data length: ${e?e.byteLength:e})`),n.update(e)}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise(((e,i)=>{const n=ga(this.config),r=t.map(la).filter((t=>!!t&&-1!==n.indexOf(t)));return this.getKeySystemSelectionPromise(r).then((t=>{let{keySystem:n}=t;const r=pa(n);r?e(r):i(new Error(`Unable to find format for key-system "${n}"`))})).catch(i)}))}loadKey(t){const e=t.keyInfo.decryptdata,i=this.getKeyIdString(e),n=`(keyId: ${i} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${n}`);let r=this.keyIdToKeySessionPromise[i];if(!r){r=this.getKeySystemForKeyPromise(e).then((i=>{let{keySystem:r,mediaKeys:s}=i;return this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${n}`),this.attemptSetMediaKeys(r,s).then((()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:r,mediaKeys:s,decryptdata:e}))))}));const s=this.keyIdToKeySessionPromise[i]=r.then((t=>{const i=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(t,"cenc",i,"playlist-key")}));s.catch((t=>this.handleError(t)))}return r}throwIfDestroyed(){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),t instanceof Oc?this.hls.trigger(nn.ERROR,t.data):this.hls.trigger(nn.ERROR,{type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const e=this.getKeyIdString(t),i=this.keyIdToKeySessionPromise[e];if(!i){const e=la(t.keyFormat),i=e?[e]:ga(this.config);return this.attemptKeySystemAccess(i)}return i}getKeySystemSelectionPromise(t){if(t.length||(t=ga(this.config)),0===t.length)throw new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${qr({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const n=Promise.all(i).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(e)}));return this.setMediaKeysQueue.push(n),n.then((()=>{this.log(`Media-keys set for "${t}"`),i.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((t=>-1===i.indexOf(t)))}))}generateRequestWithPreferredKeySession(t,e,i,n){var r,s;const a=null==(r=this.config.drmSystems)||null==(s=r[t.keySystem])?void 0:s.generateRequest;if(a)try{const n=a.call(this.hls,e,i,t);if(!n)throw new Error("Invalid response from configured generateRequest filter");e=n.initDataType,i=n.initData?n.initData:null,t.decryptdata.pssh=i?new Uint8Array(i):null}catch(f){var o;if(this.warn(f.message),null!=(o=this.hls)&&o.config.debug)throw f}if(null===i)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(t);const l=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${n}": ${l} (init data type: ${e} length: ${i?i.byteLength:null})`);const c=new So,u=t._onmessage=e=>{const i=t.mediaKeysSession;if(!i)return void c.emit("error",new Error("invalid state"));const{messageType:n,message:r}=e;this.log(`"${n}" message event for session "${i.sessionId}" message size: ${r.byteLength}`),"license-request"===n||"license-renewal"===n?this.renewLicense(t,r).catch((t=>{c.eventNames().length?c.emit("error",t):this.handleError(t)})):"license-release"===n?t.keySystem===na.FAIRPLAY&&(this.updateKeySession(t,ta("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${n}"`)},h=t._onkeystatuseschange=e=>{if(!t.mediaKeysSession)return void c.emit("error",new Error("invalid state"));this.onKeyStatusChange(t);const i=t.keyStatus;c.emit("keyStatus",i),"expired"===i&&(this.warn(`${t.keySystem} expired for key ${l}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",u),t.mediaKeysSession.addEventListener("keystatuseschange",h);const d=new Promise(((t,e)=>{c.on("error",e),c.on("keyStatus",(i=>{i.startsWith("usable")?t():"output-restricted"===i?e(new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===i?e(new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${i}"`)):"expired"===i?e(new Error("key expired while generating request")):this.warn(`unhandled key status change "${i}"`)}))}));return t.mediaKeysSession.generateRequest(e,i).then((()=>{var e;this.log(`Request generated for key-session "${null==(e=t.mediaKeysSession)?void 0:e.sessionId}" keyId: ${l}`)})).catch((t=>{throw new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_NO_SESSION,error:t,fatal:!1},`Error generating key-session request: ${t}`)})).then((()=>d)).catch((e=>{throw c.removeAllListeners(),this.removeSession(t),e})).then((()=>(c.removeAllListeners(),t)))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach(((e,i)=>{if("string"===typeof i&&"object"===typeof e){const t=i;i=e,e=t}this.log(`key status change "${e}" for keyStatuses keyId: ${_n("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${_n(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=e}))}fetchServerCertificate(t){const e=this.config,i=new(0,e.loader)(e),n=this.getServerCertificateUrl(t);return n?(this.log(`Fetching server certificate for "${t}"`),new Promise(((r,s)=>{const a={responseType:"arraybuffer",url:n},o=e.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(t,e,i,n)=>{r(t.data)},onError:(e,i,r,o)=>{s(new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:mn({url:a.url,data:void 0},e)},`"${t}" certificate request failed (${n}). Status: ${e.code} (${e.text})`))},onTimeout:(e,i,r)=>{s(new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${t}" certificate request timed out (${n})`))},onAbort:(t,e,i)=>{s(new Error("aborted"))}};i.load(a,l,c)}))):Promise.resolve()}setMediaKeysServerCertificate(t,e,i){return new Promise(((n,r)=>{t.setServerCertificate(i).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==i?void 0:i.byteLength}) on "${e}"`),n(t)})).catch((t=>{r(new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:t,fatal:!0},t.message))}))}))}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then((e=>this.updateKeySession(t,new Uint8Array(e)).catch((t=>{throw new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:t,fatal:!0},t.message)}))))}unpackPlayReadyKeyMessage(t,e){const i=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!i.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const n=(new DOMParser).parseFromString(i,"application/xml"),r=n.querySelectorAll("HttpHeader");if(r.length>0){let e;for(let i=0,n=r.length;i<n;i++){var s,a;e=r[i];const n=null==(s=e.querySelector("name"))?void 0:s.textContent,o=null==(a=e.querySelector("value"))?void 0:a.textContent;n&&o&&t.setRequestHeader(n,o)}}const o=n.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return ta(atob(l))}setupLicenseXHR(t,e,i,n){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!i.decryptdata)throw new Error("Key removed");return r.call(this.hls,t,e,i,n)})).catch((s=>{if(!i.decryptdata)throw s;return t.open("POST",e,!0),r.call(this.hls,t,e,i,n)})).then((i=>{t.readyState||t.open("POST",e,!0);return{xhr:t,licenseChallenge:i||n}})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:n}))}requestLicense(t,e){const i=this.config.keyLoadPolicy.default;return new Promise(((n,r)=>{const s=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${s}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let e=a.response;this.log(`License received ${e instanceof ArrayBuffer?e.byteLength:e}`);const i=this.config.licenseResponseCallback;if(i)try{e=i.call(this.hls,a,s,t)}catch(o){this.error(o)}n(e)}else{const o=i.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new Oc({type:tn.KEY_SYSTEM_ERROR,details:en.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${s}). Status: ${a.status} (${a.statusText})`));else{const i=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${i} attempts left`),this.requestLicense(t,e).then(n,r)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=a,this.setupLicenseXHR(a,s,t,e).then((e=>{let{xhr:i,licenseChallenge:n}=e;t.keySystem==na.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(i,n)),i.send(n)}))}))}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const i=e.media;this.media=i,i.removeEventListener("encrypted",this.onMediaEncrypted),i.removeEventListener("waitingforkey",this.onWaitingForKey),i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null)}_clear(t){var e;const i=this.mediaKeySessions;this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Sa.clearKeyUriToKeyIdMap();const n=i.length;Nc.CDMCleanupPromise=Promise.all(i.map((t=>this.removeSession(t))).concat(null==t||null==(e=t.setMediaKeys(null))?void 0:e.catch((t=>{var e;this.log(`Could not clear media keys: ${t}`),null==(e=this.hls)||e.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${t}`)})})))).then((()=>{n&&(this.log("finished closing key sessions and clearing media keys"),i.length=0)})).catch((t=>{var e;this.log(`Could not close sessions and clear media keys: ${t}`),null==(e=this.hls)||e.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${t}`)})}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,e){let{sessionKeys:i}=e;if(i&&this.config.emeEnabled&&!this.keyFormatPromise){const t=i.reduce(((t,e)=>(-1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t)),[]);this.log(`Selecting key-system from session-keys ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:i}=t;if(e){this.log(`Remove licenses and keys and close session ${e.sessionId}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(t);n>-1&&this.mediaKeySessions.splice(n,1);const{drmSystemOptions:r}=this.config,s=function(t){var e;return"persistent-license"===t.sessionType||!(null==(e=t.sessionTypes)||!e.some((t=>"persistent-license"===t)))}(r)?new Promise(((t,i)=>{self.setTimeout((()=>i(new Error("MediaKeySession.remove() timeout"))),8e3),e.remove().then(t)})):Promise.resolve();return s.catch((t=>{var e;this.log(`Could not remove session: ${t}`),null==(e=this.hls)||e.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${t}`)})})).then((()=>e.close())).catch((t=>{var e;this.log(`Could not close session: ${t}`),null==(e=this.hls)||e.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${t}`)})}))}}}Nc.CDMCleanupPromise=void 0;class Oc extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function Mc(t,e){let i;try{i=new Event("addtrack")}catch(ny){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=t,e.dispatchEvent(i)}function Fc(t,e){const i=t.mode;if("disabled"===i&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(ny){En.debug(`[texttrack-utils]: ${ny}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,t.addCue(i)}catch(n){En.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}"disabled"===i&&(t.mode=i)}function Bc(t,e){const i=t.mode;if("disabled"===i&&(t.mode="hidden"),t.cues)for(let n=t.cues.length;n--;)e&&t.cues[n].removeEventListener("enter",e),t.removeCue(t.cues[n]);"disabled"===i&&(t.mode=i)}function Uc(t,e,i,n){const r=t.mode;if("disabled"===r&&(t.mode="hidden"),t.cues&&t.cues.length>0){const r=function(t,e,i){const n=[],r=function(t,e){if(e<=t[0].startTime)return 0;const i=t.length-1;if(e>t[i].endTime)return-1;let n,r=0,s=i;for(;r<=s;)if(n=Math.floor((s+r)/2),e<t[n].startTime)s=n-1;else{if(!(e>t[n].startTime&&r<i))return n;r=n+1}return t[r].startTime-e<e-t[s].startTime?r:s}(t,e);if(r>-1)for(let s=r,a=t.length;s<a;s++){const r=t[s];if(r.startTime>=e&&r.endTime<=i)n.push(r);else if(r.startTime>i)return n}return n}(t.cues,e,i);for(let e=0;e<r.length;e++)n&&!n(r[e])||t.removeCue(r[e])}"disabled"===r&&(t.mode=r)}function jc(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||e.push(t[i])}return e}function $c(t){let e=5381,i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return(e>>>0).toString()}const zc=.025;let Hc=function(t){return t[t.Point=0]="Point",t[t.Range=1]="Range",t}({});function qc(t,e,i){return`${t.identifier}-${i+1}-${$c(e)}`}class Gc{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,null==(t=this.assetListLoader)||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){if(t>=this.assetList.length)return!0;const e=this.playoutLimit;if(t<=0||isNaN(e))return!1;return this.assetList[t].startOffset>e}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return Vc(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime;return e-Vc(e,t)<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=Qi(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return Vc(t,e)}return t}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<zc))}set appendInPlace(t){this.appendInPlaceStarted?this.resetOnResume=!t:this.appendInPlaceDisabled=!t}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?Hc.Range:Hc.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return`["${(t=this).identifier}" ${t.cue.pre?"<pre>":t.cue.post?"<post>":""}${t.timelineStart.toFixed(2)}-${t.resumeTime.toFixed(2)}]`;var t}}function Vc(t,e){return t-e.start<e.duration/2&&!(Math.abs(t-(e.start+e.duration))<zc)?e.start:e.start+e.duration}function Wc(t,e,i){const n=new self.URL(t,i);return"data:"!==n.protocol&&n.searchParams.set("_HLS_primary_id",e),n}function Kc(t){const e=t.timelineStart,i=t.duration||0;return`["${t.identifier}" ${e.toFixed(2)}-${(e+i).toFixed(2)}]`}class Yc{constructor(t,e,i,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{const t=this.interstitial.playoutLimit,e=this.currentTime;this.startOffset+e>=t&&this.hls.trigger(nn.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new t(e);this.interstitial=i,this.assetItem=n;let s=n.uri;try{s=Wc(s,r.sessionId).href}catch(o){}r.loadSource(s);const a=()=>{this.hasDetails=!0};r.once(nn.LEVEL_LOADED,a),r.once(nn.AUDIO_TRACK_LOADED,a),r.once(nn.SUBTITLE_TRACK_LOADED,a),r.on(nn.MEDIA_ATTACHING,((t,e)=>{let{media:i}=e;this.removeMediaListeners(),this.mediaAttached=i;this.interstitial.playoutLimit&&i.addEventListener("timeupdate",this.checkPlayout)}))}bufferedInPlaceToEnd(t){var e;if(!this.interstitial.appendInPlace)return!1;if(null!=(e=this.hls)&&e.bufferedToEnd)return!0;if(!t||!this._bufferedEosTime)return!1;const i=this.timelineOffset,n=Us.bufferInfo(t,i,0);return this.getAssetTime(n.end)>=this._bufferedEosTime-.02}get destroyed(){var t;return!(null!=(t=this.hls)&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return(null==(t=this.hls)?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=Us.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;return t||0}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return(null==(t=this.hls)?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e){const i=t-e;if(Math.abs(i)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){const e=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,t-e),i)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var t;this.mediaAttached&&(null!=(t=this.hls)&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){this.hls.attachMedia(t)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}on(t,e,i){this.hls.on(t,e)}once(t,e,i){this.hls.once(t,e)}off(t,e,i){this.hls.off(t,e)}toString(){var t,e;return`HlsAssetPlayer: ${Kc(this.assetItem)} ${null==(t=this.hls)?void 0:t.sessionId} ${null!=(e=this.interstitial)&&e.appendInPlace?"append-in-place":""}`}}class Xc extends vn{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach((t=>t.reset())),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce(((i,n)=>t<=n.startOffset&&e>n.startOffset?(delete n.error,i+1):i),0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let i=-1;t.nextEvent?i=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(i=this.findEventIndex(t.previousEvent.identifier)+1);const n=this.items;if(n)for(n[i]||(void 0===e&&(e=t.start),i=this.findItemIndexAtTime(e));i>=0&&null!=(r=n[i])&&r.event;){var r;i--}return i}findItemIndexAtTime(t,e){const i=this.items;if(i)for(let n=0;n<i.length;n++){let r=i[n];if(e&&"primary"!==e&&(r=r[e]),t===r.start||t>r.start&&t<r.end)return n}return-1}findJumpRestrictedIndex(t,e){const i=this.items;if(i)for(let n=t;n<=e&&i[n];n++){const t=i[n].event;if(null!=t&&t.restrictions.jump&&!t.appendInPlace)return n}return-1}findEventIndex(t){const e=this.items;if(e)for(let n=e.length;n--;){var i;if((null==(i=e[n].event)?void 0:i.identifier)===t)return n}return-1}findAssetIndex(t,e){const i=t.assetList,n=i.length;if(n>1)for(let r=0;r<n;r++){const t=i[r];if(!t.error){const i=t.timelineStart;if(e===i||e>i&&e<i+(t.duration||0))return r}}return 0}get assetIdAtEnd(){var t,e;const i=null==(t=this.items)||null==(e=t[this.length-1])?void 0:e.event;if(i){const t=i.assetList,e=t[t.length-1];if(e)return e.identifier}return null}parseInterstitialDateRanges(t,e){const i=t.main.details,{dateRanges:n}=i,r=this.events,s=this.parseDateRanges(n,{url:i.url},e),a=Object.keys(n),o=r?r.filter((t=>!a.includes(t.identifier))):[];s.length&&s.sort(((t,e)=>{const i=t.cue.pre,n=t.cue.post,r=e.cue.pre,s=e.cue.post;if(i&&!r)return-1;if(r&&!i)return 1;if(n&&!s)return 1;if(s&&!n)return-1;if(!i&&!r&&!n&&!s){const i=t.startTime,n=e.startTime;if(i!==n)return i-n}return t.dateRange.tagOrder-e.dateRange.tagOrder})),this.events=s,o.forEach((t=>{this.removeEvent(t)})),this.updateSchedule(t,o)}updateSchedule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=this.events||[];if(i.length||e.length||this.length<2){const n=this.items,r=this.parseSchedule(i,t),s=e.length||(null==n?void 0:n.length)!==r.length||r.some(((t,e)=>Math.abs(t.playout.start-n[e].playout.start)>.005||Math.abs(t.playout.end-n[e].playout.end)>.005));s&&(this.items=r,this.onScheduleUpdate(e,n))}}parseDateRanges(t,e,i){const n=[],r=Object.keys(t);for(let s=0;s<r.length;s++){const a=r[s],o=t[a];if(o.isInterstitial){let t=this.eventMap[a];t?t.setDateRange(o):(t=new Gc(o,e),this.eventMap[a]=t,!1===i&&(t.appendInPlace=i)),n.push(t)}}return n}parseSchedule(t,e){const i=[],n=e.main.details,r=n.live?1/0:n.edge;let s=0;if((t=t.filter((t=>!t.error&&!(t.cue.once&&t.hasPlayed)))).length){this.resolveOffsets(t,e);let n=0,o=0;if(t.forEach(((e,a)=>{const l=e.cue.pre,c=e.cue.post,u=t[a-1]||null,h=e.appendInPlace,d=c?r:e.startOffset,f=e.duration,p=e.timelineOccupancy===Hc.Range?f:0,g=e.resumptionOffset,m=(null==u?void 0:u.startTime)===d,v=d+e.cumulativeDuration;let y=h?v+f:d+g;if(l||!c&&d<=0){const t=o;o+=p,e.timelineStart=v;const n=s;s+=f,i.push({event:e,start:v,end:y,playout:{start:n,end:s},integrated:{start:t,end:o}})}else{if(!(d<=r))return;{if(!m){const r=d-n;if(r>.033){const l=n,c=o;o+=r;const u=s;s+=r;const h={previousEvent:t[a-1]||null,nextEvent:e,start:l,end:l+r,playout:{start:u,end:s},integrated:{start:c,end:o}};i.push(h)}else r>0&&u&&(u.cumulativeDuration+=r,i[i.length-1].end=d)}c&&(y=v),e.timelineStart=v;const r=o;o+=p;const l=s;s+=f,i.push({event:e,start:v,end:y,playout:{start:l,end:s},integrated:{start:r,end:o}})}}const b=e.resumeTime;n=c||b>r?r:b})),n<r){var a;const t=n,e=o,l=r-n;o+=l;const c=s;s+=l,i.push({previousEvent:(null==(a=i[i.length-1])?void 0:a.event)||null,nextEvent:null,start:n,end:t+l,playout:{start:c,end:s},integrated:{start:e,end:o}})}this.setDurations(r,s,o)}else{const t=0;i.push({previousEvent:null,nextEvent:null,start:t,end:r,playout:{start:t,end:r},integrated:{start:t,end:r}}),this.setDurations(r,r,r)}return i}setDurations(t,e,i){this.durations={primary:t,playout:e,integrated:i}}resolveOffsets(t,e){const i=e.main.details,n=i.live?1/0:i.edge;let r=0,s=-1;t.forEach(((a,o)=>{const l=a.cue.pre,c=a.cue.post,u=l?0:c?n:a.startTime;this.updateAssetDurations(a);if(s===u?a.cumulativeDuration=r:(r=0,s=u),!c&&a.snapOptions.in&&(a.resumeAnchor=ts(null,i.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted){this.primaryCanResumeInPlaceAt(a,e)||(a.appendInPlace=!1)}if(!a.appendInPlace&&o+1<t.length){t[o+1].startTime-t[o].resumeTime<.033&&(t[o+1].appendInPlace=!1,t[o+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`))}const h=Qi(a.resumeOffset)?a.resumeOffset:a.duration;r+=h}))}primaryCanResumeInPlaceAt(t,e){const i=t.resumeTime,n=t.startTime+t.resumptionOffset;if(Math.abs(i-n)>zc)return this.log(`"${t.identifier}" resumption ${i} not aligned with estimated timeline end ${n}`),!1;if(!e)return this.log(`"${t.identifier}" resumption ${i} can not be aligned with media (none selected)`),!1;return!Object.keys(e).some((n=>{const r=e[n].details,s=r.edge;if(i>=s)return this.log(`"${t.identifier}" resumption ${i} past ${n} playlist end ${s}`),!1;const a=ts(null,r.fragments,i);if(!a)return this.log(`"${t.identifier}" resumption ${i} does not align with any fragments in ${n} playlist (${r.fragStart}-${r.fragmentEnd})`),!0;const o="audio"===n?.175:0;return!(Math.abs(a.start-i)<zc+o||Math.abs(a.end-i)<zc+o)&&(this.log(`"${t.identifier}" resumption ${i} not aligned with ${n} fragment bounds (${a.start}-${a.end} sn: ${a.sn} cc: ${a.cc})`),!0)}))}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let i=0,n=!1,r=!1;t.assetList.forEach(((t,s)=>{const a=e+i;t.startOffset=i,t.timelineStart=a,n||(n=null===t.duration),r||(r=!!t.error);const o=t.error?0:t.duration||0;i+=o})),t.duration=n&&!r?Math.max(i,t.duration):i}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function Qc(t){return`[${t.event?'"'+t.event.identifier+'"':"primary"}: ${t.start.toFixed(2)}-${t.end.toFixed(2)}]`}class Jc{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const i=t.assetListUrl;let n;try{n=Wc(i,this.hls.sessionId,t.baseUrl)}catch(u){const e=this.assignAssetListError(t,en.ASSET_LIST_LOAD_ERROR,u,i);return void this.hls.trigger(nn.ERROR,e)}e&&"data:"!==n.protocol&&n.searchParams.set("_HLS_start_offset",""+e);const r=this.hls.config,s=new(0,r.loader)(r),a={responseType:"json",url:n.href},o=r.interstitialAssetListLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,i,n,r)=>{const s=e.data,a=null==s?void 0:s.ASSETS;if(Array.isArray(a))t.assetListResponse=s,this.hls.trigger(nn.ASSET_LIST_LOADED,{event:t,assetListResponse:s,networkDetails:r});else{const e=this.assignAssetListError(t,en.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),n.url,i,r);this.hls.trigger(nn.ERROR,e)}},onError:(e,i,n,r)=>{const s=this.assignAssetListError(t,en.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${e.code} ${e.text} (${i.url})`),i.url,r,n);this.hls.trigger(nn.ERROR,s)},onTimeout:(e,i,n)=>{const r=this.assignAssetListError(t,en.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${i.url})`),i.url,e,n);this.hls.trigger(nn.ERROR,r)}};return s.load(a,l,c),this.hls.trigger(nn.ASSET_LIST_LOADING,{event:t}),s}assignAssetListError(t,e,i,n,r,s){return t.error=i,{type:tn.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:n,error:i,networkDetails:s,stats:r}}}function Zc(t,e,i){tu(t,e,i),t.addEventListener(e,i)}function tu(t,e,i){t.removeEventListener(e,i)}function eu(t){null==t||t.play().catch((()=>{}))}class iu{constructor(t){this.buffered=void 0;const e=(e,i,n)=>{if((i>>>=0)>n-1)throw new DOMException(`Failed to execute '${e}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${n})`);return t[i][e]};this.buffered={get length(){return t.length},end:i=>e("end",i,t.length),start:i=>e("start",i,t.length)}}}const nu={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ru=t=>String.fromCharCode(nu[t]||t),su=15,au=100,ou={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},lu={17:2,18:4,21:6,22:8,23:10,19:13,20:15},cu={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},uu={25:2,26:4,29:6,30:8,31:10,27:13,28:15},hu=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class du{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const i="function"===typeof e?e():e;En.log(`${this.time} [${t}] ${i}`)}}}const fu=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e};class pu{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){const n=e[i];t.hasOwnProperty(n)&&(this[n]=t[n])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class gu{constructor(){this.uchar=" ",this.penState=new pu}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class mu{constructor(t){this.chars=[],this.pos=0,this.currPenState=new pu,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<au;e++)this.chars.push(new gu);this.logger=t}equals(t){for(let e=0;e<au;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<au;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<au;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>au&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=au)}moveCursor(t){const e=this.pos+t;if(t>1)for(let i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=ru(t);this.pos>=au?this.logger.log(0,(()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<au;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let i=0;i<au;i++){const n=this.chars[i].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t);this.chars[this.pos].setPenState(this.currPenState)}}class vu{constructor(t){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<su;e++)this.rows.push(new mu(t));this.logger=t}reset(){for(let t=0;t<su;t++)this.rows[t].clear();this.currRow=14}equals(t){let e=!0;for(let i=0;i<su;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<su;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<su;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t);this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,(()=>"pacData = "+qr(t)));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let e=0;e<su;e++)this.rows[e].clear();const t=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){const n=i.rows[t].cueStartTime,r=this.logger.time;if(null!==n&&null!==r&&n<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[e-this.nrRollUpRows+s+1].copy(i.rows[t+s])}}this.currRow=e;const i=this.rows[this.currRow];if(null!==t.indent){const e=t.indent,n=Math.max(e-1,0);i.setCursor(t.indent),t.color=i.chars[n].penState.foreground}const n={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(t){this.logger.log(2,(()=>"bkgData = "+qr(t))),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let i="",n=-1;for(let r=0;r<su;r++){const i=this.rows[r].getTextString();i&&(n=r+1,t?e.push("Row "+n+": '"+i+"'"):e.push(i.trim()))}return e.length>0&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i}getTextAndFormat(){return this.rows}}class yu{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new vu(i),this.nonDisplayedMemory=new vu(i),this.lastOutputScreen=new vu(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,(()=>"MODE="+t)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let i=0;i<t.length;i++)this.writeScreen.insertChar(t[i]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>e+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{const i=Math.floor(t/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=n[i]}this.logger.log(2,"MIDROW: "+qr(e)),this.writeScreen.setPen(e)}outputDataUpdate(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class bu{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const n=this.logger=new du;this.channels=[null,new yu(t,e,n),new yu(t+1,i,n)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let i=0;i<e.length;i+=2){const t=127&e[i],n=127&e[i+1];let r=!1,s=null;if(0===t&&0===n)continue;this.logger.log(3,(()=>"["+fu([e[i],e[i+1]])+"] -> ("+fu([t,n])+")"));const a=this.cmdHistory;if(t>=16&&t<=31){if(wu(t,n,a)){Su(null,null,a),this.logger.log(3,(()=>"Repeated command ("+fu([t,n])+") is dropped"));continue}Su(t,n,this.cmdHistory),r=this.parseCmd(t,n),r||(r=this.parseMidrow(t,n)),r||(r=this.parsePAC(t,n)),r||(r=this.parseBackgroundAttributes(t,n))}else Su(null,null,a);if(!r&&(s=this.parseChars(t,n),s)){const t=this.currentChannel;if(t&&t>0){this.channels[t].insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,(()=>"Couldn't parse cleaned data "+fu([t,n])+" orig: "+fu([e[i],e[i+1]])))}}parseCmd(t,e){if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;const i=20===t||21===t||23===t?1:2,n=this.channels[i];return 20===t||21===t||28===t||29===t?32===e?n.ccRCL():33===e?n.ccBS():34===e?n.ccAOF():35===e?n.ccAON():36===e?n.ccDER():37===e?n.ccRU(2):38===e?n.ccRU(3):39===e?n.ccRU(4):40===e?n.ccFON():41===e?n.ccRDC():42===e?n.ccTR():43===e?n.ccRTD():44===e?n.ccEDM():45===e?n.ccCR():46===e?n.ccENM():47===e&&n.ccEOC():n.ccTO(e-32),this.currentChannel=i,!0}parseMidrow(t,e){let i=0;if((17===t||25===t)&&e>=32&&e<=47){if(i=17===t?1:2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[i];return!!n&&(n.ccMIDROW(e),this.logger.log(3,(()=>"MIDROW ("+fu([t,e])+")")),!0)}return!1}parsePAC(t,e){let i;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;const n=t<=23?1:2;i=e>=64&&e<=95?1===n?ou[t]:cu[t]:1===n?lu[t]:uu[t];const r=this.channels[n];return!!r&&(r.setPAC(this.interpretPAC(i,e)),this.currentChannel=n,!0)}interpretPAC(t,e){let i;const n={color:null,italics:!1,indent:null,underline:!1,row:t};return i=e>95?e-96:e-64,n.underline=1===(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n}parseChars(t,e){let i,n=null,r=null;if(t>=25?(i=2,r=t-8):(i=1,r=t),r>=17&&r<=19){let t;t=17===r?e+80:18===r?e+112:e+144,this.logger.log(2,(()=>"Special char '"+ru(t)+"' in channel "+i)),n=[t]}else t>=32&&t<=127&&(n=0===e?[t]:[t,e]);return n&&this.logger.log(3,(()=>"Char codes =  "+fu(n).join(","))),n}parseBackgroundAttributes(t,e){if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;let i;const n={};16===t||24===t?(i=Math.floor((e-32)/2),n.background=hu[i],e%2===1&&(n.background=n.background+"_semi")):45===e?n.background="transparent":(n.foreground="black",47===e&&(n.underline=!0));const r=t<=23?1:2;return this.channels[r].setBkgData(n),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}Su(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const i=this.channels[e];i&&i.cueSplitAtTime(t)}}}function Su(t,e,i){i.a=t,i.b=e}function wu(t,e,i){return i.a===t&&i.b===e}var xu=function(){if(null!=ia&&ia.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function i(t,e){if("string"!==typeof e)return!1;if(!Array.isArray(t))return!1;const i=e.toLowerCase();return!!~t.indexOf(i)&&i}function n(t){return i(e,t)}function r(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];let r=1;for(;r<arguments.length;r++){const e=arguments[r];for(const i in e)t[i]=e[i]}return t}function s(e,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let c="",u=!1,h=e,d=s,f=a,p=null,g="",m=!0,v="auto",y="start",b=50,S="middle",w=50,x="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(t){c=""+t}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return u},set:function(t){u=!!t}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return h},set:function(t){if("number"!==typeof t)throw new TypeError("Start time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return d},set:function(t){if("number"!==typeof t)throw new TypeError("End time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return p},set:function(t){p=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return g},set:function(e){const n=function(e){return i(t,e)}(e);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");g=n,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return m},set:function(t){m=!!t,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return v},set:function(t){if("number"!==typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return y},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return S},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return w},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");w=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return x},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");x=e,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class Eu{decode(t,e){if(!t)return"";if("string"!==typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Lu(t){function e(t,e,i,n){return 3600*(0|t)+60*(0|e)+(0|i)+parseFloat(n||0)}const i=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?e(i[2],i[3],0,i[4]):e(i[1],i[2],i[3],i[4]):null}class Tu{constructor(){this.values=Object.create(null)}set(t,e){this.get(t)||""===e||(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}}function Au(t,e,i,n){const r=n?t.split(n):[t];for(const s in r){if("string"!==typeof r[s])continue;const t=r[s].split(i);if(2!==t.length)continue;e(t[0],t[1])}}const _u=new xu(0,0,""),ku="middle"===_u.align?"middle":"center";function Pu(t,e,i){const n=t;function r(){const e=Lu(t);if(null===e)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=r(),s(),"--\x3e"!==t.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.slice(3),s(),e.endTime=r(),s(),function(t,e){const n=new Tu;Au(t,(function(t,e){let r;switch(t){case"region":for(let r=i.length-1;r>=0;r--)if(i[r].id===e){n.set(t,i[r].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":r=e.split(","),n.integer(t,r[0]),n.percent(t,r[0])&&n.set("snapToLines",!1),n.alt(t,r[0],["auto"]),2===r.length&&n.alt("lineAlign",r[1],["start",ku,"end"]);break;case"position":r=e.split(","),n.percent(t,r[0]),2===r.length&&n.alt("positionAlign",r[1],["start",ku,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",ku,"end","left","right"])}}),/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");let r=n.get("line","auto");"auto"===r&&-1===_u.line&&(r=-1),e.line=r,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",ku);let s=n.get("position","auto");"auto"===s&&50===_u.position&&(s="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=s}(t,e)}function Ru(t){return t.replace(/<br(?: \/)?>/gi,"\n")}class Iu{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Eu,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;function i(){let t=e.buffer,i=0;for(t=Ru(t);i<t.length&&"\r"!==t[i]&&"\n"!==t[i];)++i;const n=t.slice(0,i);return"\r"===t[i]&&++i,"\n"===t[i]&&++i,e.buffer=t.slice(i),n}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{let t="";if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;t=i();const n=t.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==n||!n[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let n=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(n?n=!1:t=i(),e.state){case"HEADER":/:/.test(t)?Au(t,(function(t,e){}),/:/):t||(e.state="ID");continue;case"NOTE":t||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){e.state="NOTE";break}if(!t)continue;if(e.cue=new xu(0,0,""),e.state="CUE",-1===t.indexOf("--\x3e")){e.cue.id=t;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{Pu(t,e.cue,e.regionList)}catch(Bw){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const i=-1!==t.indexOf("--\x3e");if(!t||i&&(n=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(null===e.cue)continue;e.cue.text&&(e.cue.text+="\n"),e.cue.text+=t}continue;case"BADCUE":t||(e.state="ID")}}}catch(Bw){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state||"BADWEBVTT"===t.state)throw new Error("Malformed WebVTT signature.")}catch(Bw){t.onparsingerror&&t.onparsingerror(Bw)}return t.onflush&&t.onflush(),this}}const Cu=/\r\n|\n\r|\n|\r/g,Du=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.slice(i,i+e.length)===e};function Nu(t,e,i){return $c(t.toString())+$c(e.toString())+$c(i)}function Ou(t,e,i,n,r,s,a){const o=new Iu,l=An(new Uint8Array(t)).trim().replace(Cu,"\n").split("\n"),c=[],u=e?function(t){return Al(t,9e4,1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1))}(e.baseTime,e.timescale):0;let h,d="00:00.000",f=0,p=0,g=!0;o.oncue=function(t){const s=i[n];let a=i.ccOffset;const o=(f-u)/9e4;if(null!=s&&s.new&&(void 0!==p?a=i.ccOffset=s.start:function(t,e,i){let n=t[e],r=t[n.prevCC];if(!r||!r.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;null!=(s=r)&&s.new;){var s;t.ccOffset+=n.start-r.start,n.new=!1,n=r,r=t[n.prevCC]}t.presentationOffset=i}(i,n,o)),o){if(!e)return void(h=new Error("Missing initPTS for VTT MPEGTS"));a=o-i.presentationOffset}const l=t.endTime-t.startTime,d=Dl(9e4*(t.startTime+a-p),9e4*r)/9e4;t.startTime=Math.max(d,0),t.endTime=Math.max(d+l,0);const g=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(g)),t.id||(t.id=Nu(t.startTime,t.endTime,g)),t.endTime>0&&c.push(t)},o.onparsingerror=function(t){h=t},o.onflush=function(){h?a(h):s(c)},l.forEach((t=>{if(g){if(Du(t,"X-TIMESTAMP-MAP=")){g=!1,t.slice(16).split(",").forEach((t=>{Du(t,"LOCAL:")?d=t.slice(6):Du(t,"MPEGTS:")&&(f=parseInt(t.slice(7)))}));try{p=function(t){let e=parseInt(t.slice(-3));const i=parseInt(t.slice(-6,-4)),n=parseInt(t.slice(-9,-7)),r=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!Qi(e)||!Qi(i)||!Qi(n)||!Qi(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=6e4*n,e+=36e5*r,e}(d)/1e3}catch(e){h=e}return}""===t&&(g=!1)}o.parse(t+"\n")})),o.flush()}const Mu="stpp.ttml.im1t",Fu=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Bu=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Uu={left:"start",center:"center",right:"end",start:"start",end:"end"};function ju(t,e,i,n){const r=Xn(new Uint8Array(t),["mdat"]);if(0===r.length)return void n(new Error("Could not parse IMSC1 mdat"));const s=r.map((t=>An(t))),a=function(t,e){return Al(t,e,1/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(e.baseTime,1,e.timescale);try{s.forEach((t=>i(function(t,e){const i=(new DOMParser).parseFromString(t,"text/xml"),n=i.getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(r).reduce(((t,e)=>(t[e]=n.getAttribute(`ttp:${e}`)||r[e],t)),{}),a="preserve"!==n.getAttribute("xml:space"),o=zu($u(n,"styling","style")),l=zu($u(n,"layout","region")),c=$u(n,"body","[begin]");return[].map.call(c,(t=>{const i=Hu(t,a);if(!i||!t.hasAttribute("begin"))return null;const n=Vu(t.getAttribute("begin"),s),r=Vu(t.getAttribute("dur"),s);let c=Vu(t.getAttribute("end"),s);if(null===n)throw Gu(t);if(null===c){if(null===r)throw Gu(t);c=n+r}const u=new xu(n-e,c-e,i);u.id=Nu(u.startTime,u.endTime,u.text);const h=function(t,e,i){const n="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=t&&t.hasAttribute("style")?t.getAttribute("style"):null;a&&i.hasOwnProperty(a)&&(r=i[a]);return s.reduce(((i,s)=>{const a=qu(e,n,s)||qu(t,n,s)||qu(r,n,s);return a&&(i[s]=a),i}),{})}(l[t.getAttribute("region")],o[t.getAttribute("style")],o),{textAlign:d}=h;if(d){const t=Uu[d];t&&(u.lineAlign=t),u.align=d}return pn(u,h),u})).filter((t=>null!==t))}(t,a))))}catch(o){n(o)}}function $u(t,e,i){const n=t.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(i)):[]}function zu(t){return t.reduce(((t,e)=>{const i=e.getAttribute("xml:id");return i&&(t[i]=e),t}),{})}function Hu(t,e){return[].slice.call(t.childNodes).reduce(((t,i,n)=>{var r;return"br"===i.nodeName&&n?t+"\n":null!=(r=i.childNodes)&&r.length?Hu(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent}),"")}function qu(t,e,i){return t&&t.hasAttributeNS(e,i)?t.getAttributeNS(e,i):null}function Gu(t){return new Error(`Could not parse ttml timestamp ${t}`)}function Vu(t,e){if(!t)return null;let i=Lu(t);return null===i&&(Fu.test(t)?i=function(t,e){const i=Fu.exec(t),n=(0|i[4])+(0|i[5])/e.subFrameRate;return 3600*(0|i[1])+60*(0|i[2])+(0|i[3])+n/e.frameRate}(t,e):Bu.test(t)&&(i=function(t,e){const i=Bu.exec(t),n=Number(i[1]);switch(i[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}(t,e))),i}class Wu{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function Ku(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles"}function Yu(t,e){return!!t&&t.kind===Ku(e)&&Kl(e,t)}const Xu=/\s/,Qu={newCue(t,e,i,n){const r=[];let s,a,o,l,c;const u=self.VTTCue||self.TextTrackCue;for(let d=0;d<n.rows.length;d++)if(s=n.rows[d],o=!0,l=0,c="",!s.isEmpty()){var h;for(let t=0;t<s.chars.length;t++)Xu.test(s.chars[t].uchar)&&o?l++:(c+=s.chars[t].uchar,o=!1);s.cueStartTime=e,e===i&&(i+=1e-4),l>=16?l--:l++;const n=Ru(c.trim()),f=Nu(e,i,n);null!=t&&null!=(h=t.cues)&&h.getCueById(f)||(a=new u(e,i,n),a.id=f,a.line=d+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return t&&r.length&&(r.sort(((t,e)=>"auto"===t.line||"auto"===e.line?0:t.line>8&&e.line>8?e.line-t.line:t.line-e.line)),r.forEach((e=>Fc(t,e)))),r}};const Ju=/(\d+)-(\d+)\/(\d+)/;class Zu{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||th,this.controller=new self.AbortController,this.stats=new Cn}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const r=function(t,e){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(pn({},t.headers))};t.rangeEnd&&i.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1));return i}(t,this.controller.signal),s="arraybuffer"===t.responseType,a=s?"byteLength":"length",{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,r),self.clearTimeout(this.requestTimeout),e.timeout=o&&Qi(o)?o:l,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,t,this.response))}),e.timeout);(jl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then((i=>{var r;this.response=this.loader=i;const a=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=l,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,t,this.response))}),l-(a-n.loading.start)),!i.ok){const{status:t,statusText:e}=i;throw new eh(e||"fetch, bad network response",t,i)}n.loading.first=a,n.total=function(t){const e=t.get("Content-Range");if(e){const t=function(t){const e=Ju.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}(e);if(Qi(t))return t}const i=t.get("Content-Length");if(i)return parseInt(i)}(i.headers)||n.total;const o=null==(r=this.callbacks)?void 0:r.onProgress;return o&&Qi(e.highWaterMark)?this.loadProgressively(i,n,t,e.highWaterMark,o):s?i.arrayBuffer():"json"===t.responseType?i.json():i.text()})).then((i=>{var r,s;const o=this.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=i[a];l&&(n.loaded=n.total=l);const c={url:o.url,data:i,code:o.status},u=null==(r=this.callbacks)?void 0:r.onProgress;u&&!Qi(e.highWaterMark)&&u(n,t,i,o),null==(s=this.callbacks)||s.onSuccess(c,n,t,o)})).catch((e=>{var i;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const r=e&&e.code||0,s=e?e.message:null;null==(i=this.callbacks)||i.onError({code:r,text:s},t,e?e.details:null,n)}))}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;const s=new mo,a=t.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return s.dataLength&&r(e,i,s.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const l=a.value,c=l.length;return e.loaded+=c,c<n||s.dataLength?(s.push(l),s.dataLength>=n&&r(e,i,s.flush().buffer,t)):r(e,i,l.buffer,t),o()})).catch((()=>Promise.reject()));return o()}}function th(t,e){return new self.Request(t.url,e)}class eh extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}}const ih=/^age:\s*[\d.]+\s*$/im;class nh{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Cn,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const i=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(this.loader===i&&!this.stats.aborted)return r(i,e.url)})).catch((t=>{if(this.loader===i&&!this.stats.aborted)return i.open("GET",e.url,!0),r(i,e.url)})).then((()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,e,t)})).catch((t=>{var r;null==(r=this.callbacks)||r.onError({code:i.status,text:t.message},e,i,n)})):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);const n=e.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=i.loadPolicy;if(n)for(const a in n)t.setRequestHeader(a,n[a]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=r&&Qi(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const n=e.readyState,r=this.config;if(!i.aborted&&n>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const n=e.status,l="text"===e.responseType?e.responseText:null;if(n>=200&&n<300){const r=null!=l?l:e.response;if(null!=r){var s,a;i.loading.end=Math.max(self.performance.now(),i.loading.first);const o="arraybuffer"===e.responseType?r.byteLength:r.length;i.loaded=i.total=o,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first);const l=null==(s=this.callbacks)?void 0:s.onProgress;l&&l(i,t,r,e);const c={url:e.responseURL,data:r,code:n};return void(null==(a=this.callbacks)||a.onSuccess(c,i,t,e))}}const c=r.loadPolicy.errorRetry;var o;if(ls(c,i.retry,!1,{url:t.url,data:void 0,code:n}))this.retry(c);else En.error(`${n} while loading ${t.url}`),null==(o=this.callbacks)||o.onError({code:n,text:e.statusText},t,e,i)}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry;if(ls(t,this.stats.retry,!0))this.retry(t);else{var e;En.warn(`timeout while loading ${null==(e=this.context)?void 0:e.url}`);const t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:i}=this;this.retryDelay=as(t,i.retry),i.retry++,En.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==e?void 0:e.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&ih.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const rh=mn(mn({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:nh,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class extends vn{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var e;const{fragCurrent:i,partCurrent:n,hls:r}=this,{autoLevelEnabled:s,media:a}=r;if(!i||!a)return;const o=performance.now(),l=n?n.stats:i.stats,c=n?n.duration:i.duration,u=o-l.loading.start,h=r.minAutoLevel,d=i.level,f=this._nextAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||d<=h)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!s)return;const p=f>-1&&f!==d,g=!!t||p;if(!g&&(a.paused||!a.playbackRate||!a.readyState))return;const m=r.mainForwardBufferInfo;if(!g&&null===m)return;const v=this.bwEstimator.getEstimateTTFB(),y=Math.abs(a.playbackRate);if(u<=Math.max(v,c/(2*y)*1e3))return;const b=m?m.len/y:0,S=l.loading.first?l.loading.first-l.loading.start:-1,w=l.loaded&&S>-1,x=this.getBwEstimate(),E=r.levels,L=E[d],T=Math.max(l.loaded,Math.round(c*(i.bitrate||L.averageBitrate)/8));let A=w?u-S:u;A<1&&w&&(A=Math.min(u,8*l.loaded/x));const _=w?1e3*l.loaded/A:0,k=v/1e3,P=_?(T-l.loaded)/_:8*T/x+k;if(P<=b)return;const R=_?8*_:x,I=!0===(null==(e=(null==t?void 0:t.details)||this.hls.latestLevelDetails)?void 0:e.live),C=this.hls.config.abrBandWidthUpFactor;let D,N=Number.POSITIVE_INFINITY;for(D=d-1;D>h;D--){const t=E[D].maxBitrate,e=!E[D].details||I;if(N=this.getTimeToLoadFrag(k,R,c*t,e),N<Math.min(b,c+k))break}if(N>=P)return;if(N>10*c)return;w?this.bwEstimator.sample(u-Math.min(v,S),l.loaded):this.bwEstimator.sampleTTFB(u);const O=E[D].maxBitrate;this.getBwEstimate()*C>O&&this.resetEstimator(O);const M=this.findBestLevel(O,h,D,0,b,1,1);M>-1&&(D=M),this.warn(`Fragment ${i.sn}${n?" part "+n.index:""} of level ${d} is loading too slowly;\n      Fragment duration: ${i.duration.toFixed(3)}\n      Time to underbuffer: ${b.toFixed(3)} s\n      Estimated load time for current fragment: ${P.toFixed(3)} s\n      Estimated load time for down switch fragment: ${N.toFixed(3)} s\n      TTFB estimate: ${0|S} ms\n      Current BW estimate: ${Qi(x)?0|x:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${D} @ ${0|O} bps`),r.nextLoadLevel=r.nextAutoLevel=D,this.clearTimer();const F=()=>{if(this.clearTimer(),this.fragCurrent===i&&this.hls.loadLevel===D&&D>0){const t=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${D>0?"and switching down":""}\n      Fragment duration: ${i.duration.toFixed(3)} s\n      Time to underbuffer: ${t.toFixed(3)} s`),i.abortRequests(),this.fragCurrent=this.partCurrent=null,D>h){let e=this.findBestLevel(this.hls.levels[h].bitrate,h,D,0,t,1,1);-1===e&&(e=h),this.hls.nextLoadLevel=this.hls.nextAutoLevel=e,this.resetEstimator(this.hls.levels[e].bitrate)}}};p||P>2*N?F():this.timer=self.setInterval(F,1e3*N),r.trigger(nn.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:n,stats:l})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new dn(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.FRAG_LOADING,this.onFragLoading,this),t.on(nn.FRAG_LOADED,this.onFragLoaded,this),t.on(nn.FRAG_BUFFERED,this.onFragBuffered,this),t.on(nn.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.on(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(nn.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(nn.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.FRAG_LOADING,this.onFragLoading,this),t.off(nn.FRAG_LOADED,this.onFragLoaded,this),t.off(nn.FRAG_BUFFERED,this.onFragBuffered,this),t.off(nn.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.off(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(nn.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(nn.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const i=e.frag;if(!this.ignoreFragment(i)){var n;if(!i.bitrateTest)this.fragCurrent=i,this.partCurrent=null!=(n=e.part)?n:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case en.BUFFER_ADD_CODEC_ERROR:case en.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case en.FRAG_LOAD_TIMEOUT:{const t=e.frag,{fragCurrent:i,partCurrent:n}=this;if(t&&i&&t.sn===i.sn&&t.level===i.level){const e=performance.now(),i=n?n.stats:t.stats,r=e-i.loading.start,s=i.loading.first?i.loading.first-i.loading.start:-1;if(i.loaded&&s>-1){const t=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(t,s),i.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(t,e,i,n){return t+i/e+(n?t+this.lastLevelLoadSec:0)}onLevelLoaded(t,e){const i=this.hls.config,{loading:n}=e.stats,r=n.end-n.first;Qi(r)&&(this.lastLevelLoadSec=r/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,e){let{frag:i,part:n}=e;const r=n?n.stats:i.stats;if(i.type===ln&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(i)){if(this.clearTimer(),i.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const t=n?n.duration:i.duration,e=this.hls.levels[i.level],s=(e.loaded?e.loaded.bytes:0)+r.loaded,a=(e.loaded?e.loaded.duration:0)+t;e.loaded={bytes:s,duration:a},e.realBitrate=Math.round(8*s/a)}if(i.bitrateTest){const t={stats:r,frag:i,part:n,id:i.type};this.onFragBuffered(nn.FRAG_BUFFERED,t),i.bitrateTest=!1}else this.lastLoadedFragLevel=i.level}}onFragBuffered(t,e){const{frag:i,part:n}=e,r=null!=n&&n.stats.loaded?n.stats:i.stats;if(r.aborted)return;if(this.ignoreFragment(i))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==ln||"initSegment"===t.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,r=this.findBestLevel(i,e,t,0,n,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,e=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(-1!==t&&(!e||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const n=e&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==t){const e=this.hls.levels;if(e.length>Math.max(t,n)&&e[t].loadError<=e[n].loadError)return t}return this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:n,config:r,minAutoLevel:s}=i,a=e?e.duration:t?t.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let c=r.abrBandWidthFactor,u=r.abrBandWidthUpFactor;if(l){const t=this.findBestLevel(o,s,n,l,0,c,u);if(t>=0)return this.rebufferNotice=-1,t}let h=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const t=this.bitrateTestDelay;if(t){h=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-t,this.info(`bitrate test took ${Math.round(1e3*t)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),c=u=1}}const d=this.findBestLevel(o,s,n,l,h,c,u);if(this.rebufferNotice!==d&&(this.rebufferNotice=d,this.info(`${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${d}`)),d>-1)return d;const f=i.levels[s],p=i.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:i.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const i=e&&0!==e.playbackRate?Math.abs(e.playbackRate):1,n=t.mainForwardBufferInfo;return(n?n.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,n,r,s,a){var o;const l=n+r,c=this.lastLoadedFragLevel,u=-1===c?this.hls.firstLevel:c,{fragCurrent:h,partCurrent:d}=this,{levels:f,allAudioTracks:p,loadLevel:g,config:m}=this.hls;if(1===f.length)return 0;const v=f[u],y=!(null==(o=this.hls.latestLevelDetails)||!o.live),b=-1===g||-1===c;let S,w="SDR",x=(null==v?void 0:v.frameRate)||0;const{audioPreference:E,videoPreference:L}=m,T=this.audioTracksByGroup||(this.audioTracksByGroup=Vr(p));let A=-1;if(b){if(-1!==this.firstSelection)return this.firstSelection;const n=this.codecTiers||(this.codecTiers=function(t,e,i,n){return t.slice(i,n+1).reduce(((t,i,n)=>{if(!i.codecSet)return t;const r=i.audioGroups;let s=t[i.codecSet];s||(t[i.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:n,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,i.bitrate);const a=Math.min(i.height,i.width);return s.minHeight=Math.min(s.minHeight,a),s.minFramerate=Math.min(s.minFramerate,i.frameRate),s.minIndex=Math.min(s.minIndex,n),s.maxScore=Math.max(s.maxScore,i.score),s.fragmentError+=i.fragmentError,s.videoRanges[i.videoRange]=(s.videoRanges[i.videoRange]||0)+1,r&&r.forEach((t=>{if(!t)return;const i=e.groups[t];i&&(s.hasDefaultAudio=s.hasDefaultAudio||e.hasDefaultAudio?i.hasDefault:i.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(i.channels).forEach((t=>{s.channels[t]=(s.channels[t]||0)+i.channels[t]})))})),t}),{})}(f,T,e,i)),r=function(t,e,i,n,r){const s=Object.keys(t),a=null==n?void 0:n.channels,o=null==n?void 0:n.audioCodec,l=null==r?void 0:r.videoCodec,c=a&&2===parseInt(a);let u=!1,h=!1,d=1/0,f=1/0,p=1/0,g=1/0,m=0,v=[];const{preferHDR:y,allowedVideoRanges:b}=Hr(e,r);for(let E=s.length;E--;){const e=t[s[E]];u||(u=e.channels[2]>0),d=Math.min(d,e.minHeight),f=Math.min(f,e.minFramerate),p=Math.min(p,e.minBitrate),b.filter((t=>e.videoRanges[t]>0)).length>0&&(h=!0)}d=Qi(d)?d:0,f=Qi(f)?f:0;const S=Math.max(1080,d),w=Math.max(30,f);p=Qi(p)?p:i,i=Math.max(p,i),h||(e=void 0);const x=s.length>1;return{codecSet:s.reduce(((e,n)=>{const r=t[n];if(n===e)return e;if(v=h?b.filter((t=>r.videoRanges[t]>0)):[],x){if(r.minBitrate>i)return Gr(n,`min bitrate of ${r.minBitrate} > current estimate of ${i}`),e;if(!r.hasDefaultAudio)return Gr(n,"no renditions with default or auto-select sound found"),e;if(o&&n.indexOf(o.substring(0,4))%5!==0)return Gr(n,`audio codec preference "${o}" not found`),e;if(a&&!c){if(!r.channels[a])return Gr(n,`no renditions with ${a} channel sound found (channels options: ${Object.keys(r.channels)})`),e}else if((!o||c)&&u&&0===r.channels[2])return Gr(n,"no renditions with stereo sound found"),e;if(r.minHeight>S)return Gr(n,`min resolution of ${r.minHeight} > maximum of ${S}`),e;if(r.minFramerate>w)return Gr(n,`min framerate of ${r.minFramerate} > maximum of ${w}`),e;if(!v.some((t=>r.videoRanges[t]>0)))return Gr(n,`no variants with VIDEO-RANGE of ${qr(v)} found`),e;if(l&&n.indexOf(l.substring(0,4))%5!==0)return Gr(n,`video codec preference "${l}" not found`),e;if(r.maxScore<m)return Gr(n,`max score of ${r.maxScore} < selected max of ${m}`),e}return e&&(wr(n)>=wr(e)||r.fragmentError>t[e].fragmentError)?e:(g=r.minIndex,m=r.maxScore,n)}),void 0),videoRanges:v,preferHDR:y,minFramerate:f,minBitrate:p,minIndex:g}}(n,w,t,E,L),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:l,minIndex:c,preferHDR:u}=r;A=c,S=s,w=u?a[a.length-1]:a[0],x=o,t=Math.max(t,l),this.log(`picked start tier ${qr(r)}`)}else S=null==v?void 0:v.codecSet,w=null==v?void 0:v.videoRange;const _=d?d.duration:h?h.duration:0,k=this.bwEstimator.getEstimateTTFB()/1e3,P=[];for(let I=i;I>=e;I--){var R;const e=f[I],o=I>u;if(!e)continue;if(m.useMediaCapabilities&&!e.supportedResult&&!e.supportedPromise){const i=navigator.mediaCapabilities;"function"===typeof(null==i?void 0:i.decodingInfo)&&(Cr(e,T,w,x,t,E)||lr(e.videoCodec))?(e.supportedPromise=Dr(e,T,i),e.supportedPromise.then((t=>{if(!this.hls)return;e.supportedResult=t;const i=this.hls.levels,n=i.indexOf(e);t.error?this.warn(`MediaCapabilities decodingInfo error: "${t.error}" for level ${n} ${qr(t)}`):t.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${n} ${qr(t)}`),n>-1&&i.length>1&&(this.log(`Removing unsupported level ${n}`),this.hls.removeLevel(n),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}))):e.supportedResult=Pr}if((S&&e.codecSet!==S||w&&e.videoRange!==w||o&&x>e.frameRate||!o&&x>0&&x<e.frameRate||e.supportedResult&&(null==(R=e.supportedResult.decodingInfoResults)||!R[0].smooth))&&(!b||I!==A)){P.push(I);continue}const h=e.details,p=(d?null==h?void 0:h.partTarget:null==h?void 0:h.averagetargetduration)||_;let v;v=o?a*t:s*t;const L=_&&n>=2*_&&0===r?e.averageBitrate:e.maxBitrate,C=this.getTimeToLoadFrag(k,v,L*p,void 0===h);if(v>=L&&(I===c||0===e.loadError&&0===e.fragmentError)&&(C<=k||!Qi(C)||y&&!this.bitrateTestDelay||C<l)){const t=this.forcedAutoLevel;return I===g||-1!==t&&t===g||(P.length&&this.trace(`Skipped level(s) ${P.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${f[P[0]].codecs}" ${f[P[0]].videoRange}; not compatible with "${S}" ${w}`),this.info(`switch candidate:${u}->${I} adjustedbw(${Math.round(v)})-bitrate=${Math.round(v-L)} ttfb:${k.toFixed(1)} avgDuration:${p.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${C.toFixed(1)} firstSelection:${b} codecSet:${e.codecSet} videoRange:${e.videoRange} hls.loadLevel:${g}`)),b&&(this.firstSelection=I),I}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:i}=this.hls;return Math.min(Math.max(t,i),e)}},bufferController:class extends vn{constructor(t,e){var i;super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=t=>{var e;this.hls&&"open"===(null==(e=this.mediaSource)?void 0:e.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=t=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=t=>{const{media:e,mediaSource:i}=this;t&&this.log("Media source opened"),e&&i&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(nn.MEDIA_ATTACHED,{media:e,mediaSource:i}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:t,_objectUrl:e}=this;t!==e&&this.error(`Media element src was set while attaching MediaSource (${e} > ${t})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=(i=Ln(t.config.preferManagedMediaSource),"undefined"!==typeof self&&i===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.on(nn.BUFFER_RESET,this.onBufferReset,this),t.on(nn.BUFFER_APPENDING,this.onBufferAppending,this),t.on(nn.BUFFER_CODECS,this.onBufferCodecs,this),t.on(nn.BUFFER_EOS,this.onBufferEos,this),t.on(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(nn.FRAG_PARSED,this.onFragParsed,this),t.on(nn.FRAG_CHANGED,this.onFragChanged,this),t.on(nn.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.off(nn.BUFFER_RESET,this.onBufferReset,this),t.off(nn.BUFFER_APPENDING,this.onBufferAppending,this),t.off(nn.BUFFER_CODECS,this.onBufferCodecs,this),t.off(nn.BUFFER_EOS,this.onBufferEos,this),t.off(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(nn.FRAG_PARSED,this.onFragParsed,this),t.off(nn.FRAG_CHANGED,this.onFragChanged,this),t.off(nn.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const i={};if(this.operationQueue){const t=this.isUpdating();t||this.operationQueue.removeBlockers();const e=this.isQueued();(t||e)&&this.warn(`Transfering MediaSource with${e?" operations in queue":""}${t?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===e?pn(i,n.tracks):this.sourceBuffers.forEach((t=>{const[e]=t;e&&(i[e]=pn({},this.tracks[e]),this.removeBuffer(e)),t[0]=t[1]=null})),{media:t,mediaSource:e,tracks:i}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var i;let n=2;(e.audio&&!e.video||!e.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),null!=(i=this.transferData)&&i.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(t,e){const i=this.media=e.media,n=Ln(this.appendSource);if(this.transferData=this.overrides=void 0,i&&n){const t=!!e.mediaSource;(t||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const s=this.mediaSource=e.mediaSource||new n;if(this.assignMediaSource(s),t)this._objectUrl=i.src,this.attachTransferred();else{const t=this._objectUrl=self.URL.createObjectURL(s);if(this.appendSource)try{i.removeAttribute("src");const e=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||e&&s instanceof e,Zl(i),function(t,e){const i=self.document.createElement("source");i.type="video/mp4",i.src=e,t.appendChild(i)}(i,t),i.load()}catch(r){i.src=t}else i.src=t}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,i;this.log(`${(null==(e=this.transferData)?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${null==(i=t.constructor)?void 0:i.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const i=this.tracks,n=e.tracks,r=n?Object.keys(n):null,s=r?r.length:0,a=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(n&&r&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${qr(i,((t,e)=>"initSegment"===t?void 0:e))};\ntransfer tracks: ${qr(n,((t,e)=>"initSegment"===t?void 0:e))}}`),!Tn(n,i)){e.mediaSource=null,e.tracks=void 0;const r=t.currentTime,s=this.details,a=Math.max(r,(null==s?void 0:s.fragments[0].start)||0);return a-r>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${r} -> ${a}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(i)}") start time: ${a} currentTime: ${r}`),this.onMediaDetaching(nn.MEDIA_DETACHING,{}),this.onMediaAttaching(nn.MEDIA_ATTACHING,e),void(t.currentTime=a))}this.transferData=void 0,r.forEach((t=>{const e=t,i=n[e];if(i){const t=i.buffer;if(t){const n=this.fragmentTracker,r=i.id;if(n.hasFragments(r)||n.hasParts(r)){const i=Us.getBuffered(t);n.detectEvictedFragments(e,i,r,null,!0)}const s=tc(e),a=[e,t];this.sourceBuffers[s]=a,t.updating&&this.operationQueue&&this.operationQueue.prependBlocker(e),this.trackSourceBuffer(e,i)}}})),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var t;const e=null==(t=this.mediaSource)?void 0:t.readyState;return"open"===e||"ended"===e}onMediaDetaching(t,e){const i=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:r,_objectUrl:s}=this;if(r){if(this.log("media source "+(i?"transferring":"detaching")),i)this.sourceBuffers.forEach((t=>{let[e]=t;e&&this.removeBuffer(e)})),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const t="open"===r.readyState;try{const e=r.sourceBuffers;for(let i=e.length;i--;)t&&e[i].abort(),r.removeSourceBuffer(e[i]);t&&r.endOfStream()}catch(ny){this.warn(`onMediaDetaching: ${ny.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),i||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(n.removeAttribute("src"),this.appendSource&&Zl(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(nn.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach((t=>{let[e]=t;e&&this.resetBuffer(e)})),this.initTracks()}resetBuffer(t){var e;const i=null==(e=this.tracks[t])?void 0:e.buffer;if(this.removeBuffer(t),i)try{var n;null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(ny){this.warn(`onBufferReset ${t}`,ny)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[tc(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Yl(this.tracks)}onBufferCodecs(t,e){const i=this.tracks,n=Object.keys(e);this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);const r="audiovideo"in e&&(i.audio||i.video)||i.audiovideo&&("audio"in e||"video"in e),s=!r&&this.sourceBufferCount&&this.media&&n.some((t=>!i[t]));r||s?this.warn(`Unsupported transition between "${Object.keys(i)}" and "${n}" SourceBuffers`):(n.forEach((t=>{var n,r,s;const a=e[t],{id:o,codec:l,levelCodec:c,container:u,metadata:h,supplemental:d}=a;let f=i[t];const p=null==(n=this.transferData)||null==(r=n.tracks)?void 0:r[t],g=null!=p&&p.buffer?p:f,m=(null==g?void 0:g.pendingCodec)||(null==g?void 0:g.codec),v=null==g?void 0:g.levelCodec;f||(f=i[t]={buffer:void 0,listeners:[],codec:l,supplemental:d,container:u,levelCodec:c,metadata:h,id:o});const y=Tr(m,v),b=null==y?void 0:y.replace(Xl,"$1");let S=Tr(l,c);const w=null==(s=S)?void 0:s.replace(Xl,"$1");S&&y&&b!==w&&("audio"===t.slice(0,5)&&(S=Lr(S,this.appendSource)),this.log(`switching codec ${m} to ${S}`),S!==(f.pendingCodec||f.codec)&&(f.pendingCodec=S),f.container=u,this.appendChangeType(t,u,S))})),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce(((t,e)=>{const i=this.tracks[e];return t[e]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t}),{})}appendChangeType(t,e,i){const n=`${e};codecs=${i}`,r={label:`change-type=${n}`,execute:()=>{const r=this.tracks[t];if(r){const s=r.buffer;null!=s&&s.changeType&&(this.log(`changing ${t} sourceBuffer type to ${n}`),s.changeType(n),r.codec=i,r.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn(`Failed to change ${t} SourceBuffer type`,e)}};this.append(r,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const i=t.start,n=i+.05*t.duration;if(!0===(null==(e=this.fragmentTracker.getAppendedFrag(i,ln))?void 0:e.gap))return;const r={label:"block-audio",execute:()=>{var t;const e=this.tracks.video;(this.lastVideoAppendEnd>n||null!=e&&e.buffer&&Us.isBuffered(e.buffer,n)||!0===(null==(t=this.fragmentTracker.getAppendedFrag(n,ln))?void 0:t.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn("Error executing block-audio operation",t)}};this.blockedAudioAppend={op:r,frag:t},this.append(r,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:i}=this,{data:n,type:r,parent:s,frag:a,part:o,chunkMeta:l}=e,c=l.buffering[r],u=a.sn,h=self.performance.now();c.start=h;const d=a.stats.buffering,f=o?o.stats.buffering:null;0===d.start&&(d.start=h),f&&0===f.start&&(f.start=h);const p=i.audio;let g=!1;"audio"===r&&"audio/mpeg"===(null==p?void 0:p.container)&&(g=!this.lastMpegAudioChunk||1===l.id||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);const m=this.tracks.video,v=null==m?void 0:m.buffer;if(v&&"initSegment"!==u){const t=o||a,e=this.blockedAudioAppend;if("audio"!==r||"main"===s||this.blockedAudioAppend){if("video"===r){const i=t.end;if(e){const t=e.frag.start;(i>t||i<this.lastVideoAppendEnd||Us.isBuffered(v,t))&&this.unblockAudio()}this.lastVideoAppendEnd=i}}else{const e=t.start+.05*t.duration,i=v.buffered,n=this.currentOp("video");i.length||n?!n&&!Us.isBuffered(v,e)&&this.lastVideoAppendEnd<e&&this.blockAudio(t):this.blockAudio(t)}}const y=(o||a).start,b={label:`append-${r}`,execute:()=>{if(c.executeStart=self.performance.now(),g){const t=this.tracks[r];if(t){const e=t.buffer;if(e){const t=y-e.timestampOffset;Math.abs(t)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${y} (delta: ${t}) sn: ${u})`),e.timestampOffset=y)}}}this.appendExecutor(n,r)},onStart:()=>{},onComplete:()=>{const t=self.performance.now();c.executeEnd=c.end=t,0===d.first&&(d.first=t),f&&0===f.first&&(f.first=t);const e={};this.sourceBuffers.forEach((t=>{let[i,n]=t;i&&(e[i]=Us.getBuffered(n))})),this.appendErrors[r]=0,"audio"===r||"video"===r?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(nn.BUFFER_APPENDED,{type:r,frag:a,part:o,chunkMeta:l,parent:a.type,timeRanges:e})},onError:t=>{var e;const i={type:tn.MEDIA_ERROR,parent:a.type,details:en.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:a,part:o,chunkMeta:l,error:t,err:t,fatal:!1},n=null==(e=this.media)?void 0:e.error;if(t.code===DOMException.QUOTA_EXCEEDED_ERR)i.details=en.BUFFER_FULL_ERROR;else if(t.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!n)i.errorAction=ms(!0);else if(t.name===Ql&&0===this.sourceBufferCount)i.errorAction=ms(!0);else{const t=++this.appendErrors[r];this.warn(`Failed ${t}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${n||"no media error"})`),(t>=this.hls.config.appendErrorMaxRetry||n)&&(i.fatal=!0)}this.hls.trigger(nn.ERROR,i)}};this.append(b,r,this.isPending(this.tracks[r]))}getFlushOp(t,e,i){return this.log(`queuing "${t}" remove ${e}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(nn.BUFFER_FLUSHED,{type:t})},onError:n=>{this.warn(`Failed to remove ${e}-${i} from "${t}" SourceBuffer`,n)}}}onBufferFlushing(t,e){const{type:i,startOffset:n,endOffset:r}=e;i?this.append(this.getFlushOp(i,n,r),i):this.sourceBuffers.forEach((t=>{let[e]=t;e&&this.append(this.getFlushOp(e,n,r),e)}))}onFragParsed(t,e){const{frag:i,part:n}=e,r=[],s=n?n.elementaryStreams:i.elementaryStreams;s[On]?r.push("audiovideo"):(s[Dn]&&r.push("audio"),s[Nn]&&r.push("video"));0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers((()=>{const t=self.performance.now();i.stats.buffering.end=t,n&&(n.stats.buffering.end=t);const e=n?n.stats:i.stats;this.hls.trigger(nn.FRAG_BUFFERED,{frag:i,part:n,stats:e,id:i.type})}),r).catch((t=>{this.warn(`Fragment buffered callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)}))}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some((t=>{let[e]=t;var i,n;return e&&(!(null!=(i=this.tracks[e])&&i.ended)||(null==(n=this.tracks[e])?void 0:n.ending))}))}onBufferEos(t,e){var i;this.sourceBuffers.forEach((t=>{let[i]=t;if(i){const t=this.tracks[i];e.type&&e.type!==i||(t.ending=!0,t.ended||(t.ended=!0,this.log(`${i} buffer reached EOS`)))}}));const n=!1!==(null==(i=this.overrides)?void 0:i.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some((t=>{let[e]=t;var i;return e&&!(null!=(i=this.tracks[e])&&i.ended)}))&&(n?(this.log("Queueing EOS"),this.blockUntilOpen((()=>{this.tracksEnded();const{mediaSource:t}=this;t&&"open"===t.readyState?(this.log("Calling mediaSource.endOfStream()"),t.endOfStream(),this.hls.trigger(nn.BUFFERED_TO_END,void 0)):t&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${t.readyState}`)}))):(this.tracksEnded(),this.hls.trigger(nn.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach((t=>{let[e]=t;if(null!==e){const t=this.tracks[e];t&&(t.ending=!1)}}))}onLevelUpdated(t,e){let{details:i}=e;i.fragments.length&&(this.details=i,this.updateDuration())}updateDuration(){const t=this.getDurationAndRange();t&&this.blockUntilOpen((()=>this.updateMediaSource(t)))}onError(t,e){if(e.details===en.BUFFER_APPEND_ERROR&&e.frag){var i;const t=null==(i=e.errorAction)?void 0:i.nextAutoLevel;Qi(t)&&t!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:i}=this;if(!i||null===e)return;if(!this.sourceBufferCount)return;const n=t.config,r=i.currentTime,s=e.levelTargetDuration,a=e.live&&null!==n.liveBackBufferLength?n.liveBackBufferLength:n.backBufferLength;if(Qi(a)&&a>=0){const t=Math.max(a,s),e=Math.floor(r/s)*s-t;this.flushBackBuffer(r,s,e)}if(Qi(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){const t=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold),e=Math.max(t,s),i=Math.floor(r/s)*s+e;this.flushFrontBuffer(r,s,i)}}flushBackBuffer(t,e,i){this.sourceBuffers.forEach((t=>{let[e,n]=t;if(n){const t=Us.getBuffered(n);if(t.length>0&&i>t.start(0)){var r;this.hls.trigger(nn.BACK_BUFFER_REACHED,{bufferEnd:i});const t=this.tracks[e];if(null!=(r=this.details)&&r.live)this.hls.trigger(nn.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(null!=t&&t.ended)return void this.log(`Cannot flush ${e} back buffer while SourceBuffer is in ended state`);this.hls.trigger(nn.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:e})}}}))}flushFrontBuffer(t,e,i){this.sourceBuffers.forEach((e=>{let[n,r]=e;if(r){const e=Us.getBuffered(r),s=e.length;if(s<2)return;const a=e.start(s-1),o=e.end(s-1);if(i>a||t>=a&&t<=o)return;this.hls.trigger(nn.BUFFER_FLUSHING,{startOffset:a,endOffset:1/0,type:n})}}))}getDurationAndRange(){var t;const{details:e,mediaSource:i}=this;if(!e||!this.media||"open"!==(null==i?void 0:i.readyState))return null;const n=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&e.live&&i.setLiveSeekableRange){const t=Math.max(0,e.fragmentStart);return{duration:1/0,start:t,end:Math.max(t,n)}}return{duration:1/0}}const r=null==(t=this.overrides)?void 0:t.duration;if(r)return Qi(r)?{duration:r}:null;const s=this.media.duration;return n>(Qi(i.duration)?i.duration:0)&&n>s||!Qi(s)?{duration:n}:null}updateMediaSource(t){let{duration:e,start:i,end:n}=t;const r=this.mediaSource;this.media&&r&&"open"===r.readyState&&(r.duration!==e&&(Qi(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),void 0!==i&&void 0!==n&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${i}-${n}.`),r.setLiveSeekableRange(i,n)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${qr(i)}`),this.tracksReady){var n;const t=null==(n=this.transferData)?void 0:n.tracks;t&&Object.keys(t).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach((e=>{let[i,n]=e;if(i){const e=this.tracks[i];t[i]={buffer:n,container:e.container,codec:e.codec,supplemental:e.supplemental,levelCodec:e.levelCodec,id:e.id,metadata:e.metadata}}})),this.hls.trigger(nn.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach((t=>{let[e]=t;this.executeNext(e)}))}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in t){const a=s,o=t[a];if(this.isPending(o)){const t=this.getTrackCodec(o,a),s=`${o.container};codecs=${t}`;o.codec=t,this.log(`creating sourceBuffer(${s})${this.currentOp(a)?" Queued":""} ${qr(o)}`);try{const t=i.addSourceBuffer(s),n=tc(a),r=[a,t];e[n]=r,o.buffer=t}catch(r){var n;return this.error(`error while trying to add sourceBuffer: ${r.message}`),this.shiftAndExecuteNext(a),null==(n=this.operationQueue)||n.removeBlockers(),delete this.tracks[a],void this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:r,sourceBufferName:a,mimeType:s,parent:o.id})}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(t,e){const i=t.supplemental;let n=t.codec;i&&("video"===e||"audiovideo"===e)&&vr(i,"video")&&(n=function(t,e){const i=[];if(t){const e=t.split(",");for(let t=0;t<e.length;t++)mr(e[t],"video")||i.push(e[t])}return e&&i.push(e),i.join(",")}(n,i));const r=Tr(n,t.levelCodec);return r?"audio"===e.slice(0,5)?Lr(r,this.appendSource):r:""}trackSourceBuffer(t,e){const i=e.buffer;if(!i)return;const n=this.getTrackCodec(e,t);this.tracks[t]={buffer:i,codec:n,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",((t,e)=>{const i=e.removedRanges;null!=i&&i.length&&this.hls.trigger(nn.BUFFER_FLUSHED,{type:t})}))}get mediaSrc(){var t,e;const i=(null==(t=this.media)||null==(e=t.querySelector)?void 0:e.call(t,"source"))||this.media;return null==i?void 0:i.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if("closed"===(null==(e=this.mediaSource)?void 0:e.readyState))return void this.resetBuffer(t);const i=this.currentOp(t);i&&(i.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var i;const n=new Error(`${t} SourceBuffer error. MediaSource readyState: ${null==(i=this.mediaSource)?void 0:i.readyState}`);this.error(`${n}`,e),this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:n,fatal:!1});const r=this.currentOp(t);r&&r.onError(n)}removeExecutor(t,e,i){const{media:n,mediaSource:r}=this,s=this.tracks[t],a=null==s?void 0:s.buffer;if(!n||!r||!a)return this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(t);const o=Qi(n.duration)?n.duration:1/0,l=Qi(r.duration)?r.duration:1/0,c=Math.max(0,e),u=Math.min(i,o,l);u>c&&(!s.ending||s.ended)?(s.ended=!1,this.log(`Removing [${c},${u}] from the ${t} SourceBuffer`),a.remove(c,u)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const i=this.tracks[e],n=null==i?void 0:i.buffer;if(!n)throw new Jl(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,n.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch((t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)}));else try{t()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some((t=>{let[e,i]=t;return e&&i.updating}))}isQueued(){return this.sourceBuffers.some((t=>{let[e]=t;return e&&!!this.currentOp(e)}))}isPending(t){return!!t&&!t.buffer}blockBuffers(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sourceBufferTypes;if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:i}=this,n=e.map((t=>this.appendBlocker(t)));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then((e=>{i===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))}))}stepOperationQueue(t){t.forEach((t=>{var e;const i=null==(e=this.tracks[t])?void 0:e.buffer;i&&!i.updating&&this.shiftAndExecuteNext(t)}))}append(t,e,i){this.operationQueue&&this.operationQueue.append(t,e,i)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce(((t,e)=>t+(this.isPending(this.tracks[e])?1:0)),0)}get sourceBufferCount(){return this.sourceBuffers.reduce(((t,e)=>{let[i]=e;return t+(i?1:0)}),0)}get sourceBufferTypes(){return this.sourceBuffers.map((t=>{let[e]=t;return e})).filter((t=>!!t))}addBufferListener(t,e,i){const n=this.tracks[t];if(!n)return;const r=n.buffer;if(!r)return;const s=i.bind(this,t);n.listeners.push({event:e,listener:s}),r.addEventListener(e,s)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const i=e.buffer;i&&(e.listeners.forEach((t=>{i.removeEventListener(t.event,t.listener)})),e.listeners.length=0)}},capLevelController:ec,errorController:class extends vn{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(nn.ERROR,this.onError,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(nn.ERROR,this.onError,this),t.off(nn.ERROR,this.onErrorOut,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(null==t?void 0:t.type)===ln?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,e){var i;if(e.fatal)return;const n=this.hls,r=e.context;switch(e.details){case en.FRAG_LOAD_ERROR:case en.FRAG_LOAD_TIMEOUT:case en.KEY_LOAD_ERROR:case en.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case en.FRAG_PARSING_ERROR:if(null!=(i=e.frag)&&i.gap)return void(e.errorAction=ms());case en.FRAG_GAP:case en.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=us);case en.LEVEL_EMPTY_ERROR:case en.LEVEL_PARSING_ERROR:{var s,a;const t=e.parent===ln?e.level:n.loadLevel;e.details===en.LEVEL_EMPTY_ERROR&&null!=(s=e.context)&&null!=(a=s.levelDetails)&&a.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,t):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t))}return;case en.LEVEL_LOAD_ERROR:case en.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==r?void 0:r.level)&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,r.level)));case en.AUDIO_TRACK_LOAD_ERROR:case en.AUDIO_TRACK_LOAD_TIMEOUT:case en.SUBTITLE_LOAD_ERROR:case en.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const t=n.loadLevelObj;if(t&&(r.type===an&&t.hasAudioGroup(r.groupId)||r.type===on&&t.hasSubtitleGroup(r.groupId)))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,n.loadLevel),e.errorAction.action=us,void(e.errorAction.flags=ps)}return;case en.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const t=n.loadLevelObj,i=null==t?void 0:t.attrs["HDCP-LEVEL"];i?e.errorAction={action:us,flags:gs,hdcpLevel:i}:this.keySystemError(e)}return;case en.BUFFER_ADD_CODEC_ERROR:case en.REMUX_ALLOC_ERROR:case en.BUFFER_APPEND_ERROR:var o;if(!e.errorAction)e.errorAction=this.getLevelSwitchAction(e,null!=(o=e.level)?o:n.loadLevel);return;case en.INTERNAL_EXCEPTION:case en.BUFFER_APPENDING_ERROR:case en.BUFFER_FULL_ERROR:case en.LEVEL_SWITCH_ERROR:case en.BUFFER_STALLED_ERROR:case en.BUFFER_SEEK_OVER_HOLE:case en.BUFFER_NUDGE_ON_STALL:return void(e.errorAction=ms())}e.type===tn.KEY_SYSTEM_ERROR&&this.keySystemError(e)}keySystemError(t){const e=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e)}getPlaylistRetryOrSwitchAction(t,e){const i=ss(this.hls.config.playlistLoadPolicy,t),n=this.playlistError++;if(ls(i,n,rs(t),t.response))return{action:ds,flags:fs,retryConfig:i,retryCount:n};const r=this.getLevelSwitchAction(t,e);return i&&(r.retryConfig=i,r.retryCount=n),r}getFragRetryOrSwitchAction(t){const e=this.hls,i=this.getVariantLevelIndex(t.frag),n=e.levels[i],{fragLoadPolicy:r,keyLoadPolicy:s}=e.config,a=ss(t.details.startsWith("key")?s:r,t),o=e.levels.reduce(((t,e)=>t+e.fragmentError),0);if(n){t.details!==en.FRAG_GAP&&n.fragmentError++;if(ls(a,o,rs(t),t.response))return{action:ds,flags:fs,retryConfig:a,retryCount:o}}const l=this.getLevelSwitchAction(t,i);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(t,e){const i=this.hls;null!==e&&void 0!==e||(e=i.loadLevel);const n=this.hls.levels[e];if(n){var r,s;const e=t.details;n.loadError++,e===en.BUFFER_APPEND_ERROR&&n.fragmentError++;let l=-1;const{levels:c,loadLevel:u,minAutoLevel:h,maxAutoLevel:d}=i;i.autoLevelEnabled||(i.loadLevel=-1);const f=null==(r=t.frag)?void 0:r.type,p=(f===cn&&e===en.FRAG_PARSING_ERROR||"audio"===t.sourceBufferName&&(e===en.BUFFER_ADD_CODEC_ERROR||e===en.BUFFER_APPEND_ERROR))&&c.some((t=>{let{audioCodec:e}=t;return n.audioCodec!==e})),g="video"===t.sourceBufferName&&(e===en.BUFFER_ADD_CODEC_ERROR||e===en.BUFFER_APPEND_ERROR)&&c.some((t=>{let{codecSet:e,audioCodec:i}=t;return n.codecSet!==e&&n.audioCodec===i})),{type:m,groupId:v}=null!=(s=t.context)?s:{};for(let i=c.length;i--;){const r=(i+u)%c.length;if(r!==u&&r>=h&&r<=d&&0===c[r].loadError){var a,o;const i=c[r];if(e===en.FRAG_GAP&&f===ln&&t.frag){const e=c[r].details;if(e){const i=ts(t.frag,e.fragments,t.frag.start);if(null!=i&&i.gap)continue}}else{if(m===an&&i.hasAudioGroup(v)||m===on&&i.hasSubtitleGroup(v))continue;if(f===cn&&null!=(a=n.audioGroups)&&a.some((t=>i.hasAudioGroup(t)))||f===un&&null!=(o=n.subtitleGroups)&&o.some((t=>i.hasSubtitleGroup(t)))||p&&n.audioCodec===i.audioCodec||!p&&n.audioCodec!==i.audioCodec||g&&n.codecSet===i.codecSet)continue}l=r;break}}if(l>-1&&i.loadLevel!==l)return t.levelRetry=!0,this.playlistError=0,{action:us,flags:fs,nextAutoLevel:l}}return{action:us,flags:ps}}onErrorOut(t,e){var i;switch(null==(i=e.errorAction)?void 0:i.action){case cs:break;case us:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===en.FRAG_GAP?/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):e.fatal=!0}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){const e=this.hls,i=t.errorAction;if(!i)return;const{flags:n,hdcpLevel:r,nextAutoLevel:s}=i;switch(n){case fs:this.switchLevel(t,s);break;case gs:r&&(e.maxHdcpLevel=Nr[Nr.indexOf(r)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`)}i.resolved||this.switchLevel(t,s)}switchLevel(t,e){if(void 0!==e&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===en.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&"audiovideo"!==t.sourceBufferName)){const e=kr(t.mimeType),i=this.hls.levels;for(let n=i.length;n--;)i[n][`${t.sourceBufferName}Codec`]===e&&this.hls.removeLevel(n)}}},fpsController:class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const t=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=t,t&&"function"===typeof t.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,i){const n=performance.now();if(e){if(this.lastTime){const t=n-this.lastTime,r=i-this.lastDroppedFrames,s=e-this.lastDecodedFrames,a=1e3*r/t,o=this.hls;if(o.trigger(nn.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:i}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let t=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+t),t>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=t)&&(t-=1,o.trigger(nn.FPS_DROP_LEVEL_CAPPING,{level:t,droppedLevel:o.currentLevel}),o.autoLevelCapping=t,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ma,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Qu,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends po{constructor(t,e,i){super(t,e,i,"subtitle-stream-controller",un),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.on(nn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(nn.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(nn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(nn.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(nn.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.off(nn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(nn.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(nn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(nn.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(nn.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=io,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:i,success:n}=e;if(Fn(i)&&(this.fragPrevious=i),this.state=io,!n)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=i.start;for(let l=0;l<r.length;l++)if(a>=r[l].start&&a<=r[l].end){s=r[l];break}const o=i.start+i.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:i,endOffset:n}=e;if(0===i&&n!==Number.POSITIVE_INFINITY){const t=n-1;if(t<=0)return;e.endOffsetSubtitles=Math.max(0,t),this.tracksBuffered.forEach((e=>{for(let i=0;i<e.length;)if(e[i].end<=t)e.shift();else{if(!(e[i].start<t))break;e[i].start=t,i++}})),this.fragmentTracker.removeFragmentsInRange(i,t,un)}}onError(t,e){const i=e.frag;(null==i?void 0:i.type)===un&&(e.details===en.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==eo&&(this.state=io))}onSubtitleTracksUpdated(t,e){let{subtitleTracks:i}=e;this.levels&&Vl(this.levels,i)?this.levels=i.map((t=>new $r(t))):(this.tracksBuffered=[],this.levels=i.map((t=>{const e=new $r(t);return this.tracksBuffered[e.id]=[],e})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,un),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,null==(i=this.levels)||!i.length||-1===this.currentTrackId)return void this.clearInterval();const n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==eo&&this.setInterval(500)}onSubtitleTrackLoaded(t,e){var i;const{currentTrackId:n,levels:r}=this,{details:s,id:a}=e;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[a];if(a>=r.length||!o)return;this.log(`Subtitle track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(i=o.details)&&i.live){const t=this.mainDetails;if(s.deltaUpdateFailed||!t)return;const e=t.fragments[0];var c;if(o.details)l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&e&&(l=e.start,Ha(s,l));else s.hasProgramDateTime&&t.hasProgramDateTime?(Za(s,t),l=s.fragmentStart):e&&(l=e.start,Ha(s,l))}if(o.details=s,this.levelLastLoaded=o,a===n&&(this.hls.trigger(nn.SUBTITLE_TRACK_UPDATED,{details:s,id:a,groupId:e.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===io)){ts(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(t){const{frag:e,payload:i}=t,n=e.decryptdata,r=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&null!=n&&n.key&&n.iv&&Qs(n.method)){const t=performance.now();this.decrypter.decrypt(new Uint8Array(i),n.key.buffer,n.iv.buffer,Js(n.method)).catch((t=>{throw r.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((i=>{const n=performance.now();r.trigger(nn.FRAG_DECRYPTED,{frag:e,payload:i,stats:{tstart:t,tdecrypt:n}})})).catch((t=>{this.warn(`${t.name}: ${t.message}`),this.state=io}))}}doTick(){if(this.media){if(this.state===io){const{currentTrackId:t,levels:e}=this,i=null==e?void 0:e[t];if(!i||!e.length||!i.details)return;if(this.waitForLive(i))return;const{config:n}=this,r=this.getLoadPosition(),s=Us.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,n.maxBufferHole),{end:a,len:o}=s,l=i.details;if(o>this.hls.maxBufferLength+l.levelTargetDuration)return;const c=l.fragments,u=c.length,h=l.edge;let d=null;const f=this.fragPrevious;if(a<h){const t=n.maxFragLookUpTolerance,e=a>h-t?0:t;d=ts(f,c,Math.max(c[0].start,a),e),!d&&f&&f.start<c[0].start&&(d=c[0])}else d=c[u-1];if(d=this.filterReplacedPrimary(d,i.details),!d)return;const p=c[d.sn-l.startSN-1];if(p&&p.cc===d.cc&&this.fragmentTracker.getState(p)===vs&&(d=p),this.fragmentTracker.getState(d)===vs){const t=this.mapToInitFragWhenRequired(d);t&&this.loadFragment(t,i,a)}}}else this.state=io}loadFragment(t,e,i){Fn(t)?super.loadFragment(t,e,i):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new iu(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Gl{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const e=jc(this.media.textTracks);for(let n=0;n<e.length;n++)if("hidden"===e[n].mode)t=e[n];else if("showing"===e[n].mode){t=e[n];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.on(nn.LEVEL_LOADING,this.onLevelLoading,this),t.on(nn.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(nn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(nn.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.off(nn.LEVEL_LOADING,this.onLevelLoading,this),t.off(nn.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(nn.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(nn.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const i=this.media;if(!i)return;const n=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;jc(i.textTracks).forEach((t=>{Bc(t)}))}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:i,groupId:n,details:r}=e,s=this.tracksInGroup[i];if(!s||s.groupId!==n)return void this.warn(`Subtitle track with id:${i} and group:${n} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=e.details,this.log(`Subtitle track ${i} "${s.name}" lang:${s.lang} group:${n} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.subtitleGroups||null,n=this.groupIds;let r=this.currentTrack;if(!i||(null==n?void 0:n.length)!==(null==i?void 0:i.length)||null!=i&&i.some((t=>-1===(null==n?void 0:n.indexOf(t))))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter((t=>!i||-1!==i.indexOf(t.groupId)));if(t.length)this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),t.forEach(((t,e)=>{t.id=e}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.subtitlePreference;if(!r&&e){this.selectDefaultTrack=!1;const i=Kr(e,t);if(i>-1)r=t[i];else{const t=Kr(e,this.tracks);r=this.tracks[t]}}let n=this.findTrackId(r);-1===n&&r&&(n=this.findTrackId(null));const s={subtitleTracks:t};this.log(`Updating subtitle tracks, ${t.length} track(s) found in "${null==i?void 0:i.join(",")}" group-id`),this.hls.trigger(nn.SUBTITLE_TRACKS_UPDATED,s),-1!==n&&-1===this.trackId&&this.setSubtitleTrack(n)}}findTrackId(t){const e=this.tracksInGroup,i=this.selectDefaultTrack;for(let n=0;n<e.length;n++){const r=e[n];if((!i||r.default)&&(i||t)&&(!t||Yr(r,t)))return n}if(t){for(let i=0;i<e.length;i++){const n=e[i];if(Wl(t.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<e.length;i++){const n=e[i];if(Wl(t.attrs,n.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){if(Kl(e[i],t))return i}}return-1}onError(t,e){!e.fatal&&e.context&&(e.context.type!==on||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(-1===t.id)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const i=this.currentTrack;if(i&&Yr(t,i))return i;const n=Kr(t,this.tracksInGroup);if(n>-1){const t=this.tracksInGroup[n];return this.setSubtitleTrack(n),t}if(i)return null;{const i=Kr(t,e);if(i>-1)return e[i]}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,n=t.groupId,r=this.getUrlWithDirectives(t.url,e),s=t.details,a=null==s?void 0:s.age;this.log(`Loading subtitle ${i} "${t.name}" lang:${t.lang} group:${n}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(nn.SUBTITLE_TRACK_LOADING,{url:r,id:i,groupId:n,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=jc(t.textTracks),i=this.currentTrack;let n;if(i&&(n=e.filter((t=>Kl(i,t)))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach((t=>{"disabled"!==t.mode&&t!==n&&(t.mode="disabled")})),n){const t=this.subtitleDisplay?"showing":"hidden";n.mode!==t&&(n.mode=t)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=t);if(t<-1||t>=e.length||!Qi(t))return void this.warn(`Invalid subtitle track id: ${t}`);this.selectDefaultTrack=!1;const i=this.currentTrack,n=e[t]||null;if(this.trackId=t,this.currentTrack=n,this.toggleTrackModes(),!n)return void this.hls.trigger(nn.SUBTITLE_TRACK_SWITCH,{id:t});const r=!!n.details&&!n.details.live;if(t===this.trackId&&n===i&&r)return;this.log(`Switching to subtitle-track ${t}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:s,groupId:a="",name:o,type:l,url:c}=n;this.hls.trigger(nn.SUBTITLE_TRACK_SWITCH,{id:s,groupId:a,name:o,type:l,url:c});const u=this.switchParams(n.url,null==i?void 0:i.details,n.details);this.loadPlaylist(u)}},timelineController:class{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(nn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(nn.FRAG_LOADING,this.onFragLoading,this),t.on(nn.FRAG_LOADED,this.onFragLoaded,this),t.on(nn.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(nn.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(nn.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(nn.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(nn.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(nn.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(nn.FRAG_LOADING,this.onFragLoading,this),t.off(nn.FRAG_LOADED,this.onFragLoaded,this),t.off(nn.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(nn.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(nn.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(nn.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new Wu(this,"textTrack1"),e=new Wu(this,"textTrack2"),i=new Wu(this,"textTrack3"),n=new Wu(this,"textTrack4");this.cea608Parser1=new bu(1,t,e),this.cea608Parser2=new bu(3,i,n)}addCues(t,e,i,n,r){let s=!1;for(let u=r.length;u--;){const t=r[u],n=(a=t[0],o=t[1],l=e,c=i,Math.min(o,c)-Math.max(a,l));if(n>=0&&(t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],i),s=!0,n/(i-e)>.5))return}var a,o,l,c;if(s||r.push([e,i]),this.config.renderTextTracksNatively){const r=this.captionsTracks[t];this.Cues.newCue(r,e,i,n)}else{const r=this.Cues.newCue(null,e,i,n);this.hls.trigger(nn.CUES_PARSED,{type:"captions",cues:r,track:t})}}onInitPtsFound(t,e){let{frag:i,id:n,initPTS:r,timescale:s}=e;const{unparsedVttFrags:a}=this;n===ln&&(this.initPTS[i.cc]={baseTime:r,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach((t=>{this.onFragLoaded(nn.FRAG_LOADED,t)})))}getExistingTrack(t,e){const{media:i}=this;if(i)for(let n=0;n<i.textTracks.length;n++){const r=i.textTracks[n];if(Yu(r,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:i,media:n}=this,{label:r,languageCode:s}=e[t],a=this.getExistingTrack(r,s);if(a)i[t]=a,Bc(i[t]),Mc(i[t],n);else{const e=this.createTextTrack("captions",r,s);e&&(e[t]=!0,i[t]=e)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const i={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=i,this.hls.trigger(nn.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(t,e,i){const n=this.media;if(n)return n.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const i=!!e.transferMedia;if(this.media=null,i)return;const{captionsTracks:n}=this;Object.keys(n).forEach((t=>{Bc(n[t]),delete n[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let i=0;i<e.length;i++)Bc(e[i])}onSubtitleTracksUpdated(t,e){const i=e.subtitleTracks||[],n=i.some((t=>t.textCodec===Mu));if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(Vl(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const t=this.media,e=t?jc(t.textTracks):null;if(this.tracks.forEach(((t,i)=>{let n;if(e){let i=null;for(let n=0;n<e.length;n++)if(e[n]&&Yu(e[n],t)){i=e[n],e[n]=null;break}i&&(n=i)}if(n)Bc(n);else{const e=Ku(t);n=this.createTextTrack(e,t.name,t.lang),n&&(n.mode="disabled")}n&&this.textTracks.push(n)})),null!=e&&e.length){const t=e.filter((t=>null!==t)).map((t=>t.label));t.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${t.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const t=this.tracks.map((t=>({label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t})));this.hls.trigger(nn.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:t})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((t=>{const e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(!e)return;const i=`textTrack${e[1]}`,n=this.captionsProperties[i];n&&(n.label=t.name,t.lang&&(n.languageCode=t.lang),n.media=t)}))}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return null==e?void 0:e.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===ln){var i,n;const{cea608Parser1:t,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=e.frag,l=null!=(i=null==(n=e.part)?void 0:n.index)?i:-1;t&&r&&(o!==s+1||o===s&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(t.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=l}}onFragLoaded(t,e){const{frag:i,payload:n}=e;if(i.type===un)if(n.byteLength){const t=i.decryptdata,r="stats"in e;if(null==t||!t.encrypted||r){const t=this.tracks[i.level],r=this.vttCCs;r[i.cc]||(r[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),t&&t.textCodec===Mu?this._parseIMSC1(i,n):this._parseVTTs(e)}}else this.hls.trigger(nn.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const i=this.hls;ju(e,this.initPTS[t.cc],(e=>{this._appendCues(e,t.level),i.trigger(nn.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}),(e=>{i.logger.log(`Failed to parse IMSC1: ${e}`),i.trigger(nn.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})}))}_parseVTTs(t){var e;const{frag:i,payload:n}=t,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[i.cc]&&-1===a)return void s.push(t);const o=this.hls;Ou(null!=(e=i.initSegment)&&e.data?ar(i.initSegment.data,new Uint8Array(n)).buffer:n,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,(t=>{this._appendCues(t,i.level),o.trigger(nn.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})}),(e=>{const r="Missing initPTS for VTT MPEGTS"===e.message;r?s.push(t):this._fallbackToIMSC1(i,n),o.logger.log(`Failed to parse VTT cue: ${e}`),r&&a>i.cc||o.trigger(nn.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:e})}))}_fallbackToIMSC1(t,e){const i=this.tracks[t.level];i.textCodec||ju(e,this.initPTS[t.cc],(()=>{i.textCodec=Mu,this._parseIMSC1(t,e)}),(()=>{i.textCodec="wvtt"}))}_appendCues(t,e){const i=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[e];if(!i||"disabled"===i.mode)return;t.forEach((t=>Fc(i,t)))}else{const n=this.tracks[e];if(!n)return;const r=n.default?"default":"subtitles"+e;i.trigger(nn.CUES_PARSED,{type:"subtitles",cues:t,track:r})}}onFragDecrypted(t,e){const{frag:i}=e;i.type===un&&this.onFragLoaded(nn.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:n}=e;if(i.type!==ln||"NONE"!==this.closedCaptionsForLevel(i))for(let r=0;r<n.length;r++){const t=n[r].bytes;if(t){this.cea608Parser1||this.initCea608Parsers();const e=this.extractCea608Data(t);this.cea608Parser1.addData(n[r].pts,e[0]),this.cea608Parser2.addData(n[r].pts,e[1])}}}onBufferFlushing(t,e){let{startOffset:i,endOffset:n,endOffsetSubtitles:r,type:s}=e;const{media:a}=this;if(a&&!(a.currentTime<n)){if(!s||"video"===s){const{captionsTracks:t}=this;Object.keys(t).forEach((e=>Uc(t[e],i,n)))}if(this.config.renderTextTracksNatively&&0===i&&void 0!==r){const{textTracks:t}=this;Object.keys(t).forEach((e=>Uc(t[e],i,r)))}}}extractCea608Data(t){const e=[[],[]],i=31&t[0];let n=2;for(let r=0;r<i;r++){const i=t[n++],r=127&t[n++],s=127&t[n++];if(0===r&&0===s)continue;if(0!==(4&i)){const t=3&i;0!==t&&1!==t||(e[t].push(r),e[t].push(s))}}return e}},audioStreamController:class extends po{constructor(t,e,i){super(t,e,i,"audio-stream-controller",cn),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.on(nn.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(nn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(nn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(nn.BUFFER_RESET,this.onBufferReset,this),t.on(nn.BUFFER_CREATED,this.onBufferCreated,this),t.on(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(nn.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(nn.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(nn.FRAG_LOADING,this.onFragLoading,this),t.on(nn.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.off(nn.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(nn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(nn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(nn.BUFFER_RESET,this.onBufferReset,this),t.off(nn.BUFFER_CREATED,this.onBufferCreated,this),t.off(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(nn.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(nn.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(nn.FRAG_LOADING,this.onFragLoading,this),t.off(nn.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,e){let{frag:i,id:n,initPTS:r,timescale:s}=e;if(n===ln){const t=i.cc,e=this.fragCurrent;if(this.initPTS[t]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${t} found from main: ${r}/${s}`),this.mainAnchor=i,this.state===ho){const e=this.waitingData;(!e&&!this.loadingParts||e&&e.frag.cc!==t)&&(this.nextLoadPosition=this.findSyncFrag(i).start),this.tick()}else!this.hls.hasEnoughToStart&&e&&e.cc!==t?(this.startFragRequested=!1,this.nextLoadPosition=this.findSyncFrag(i).start,e.abortRequests(),this.resetLoadingState()):this.state===io&&this.tick()}}findSyncFrag(t){const e=this.getLevelDetails(),i=t.cc;return function(t,e,i){if(t&&t.startCC<=e&&t.endCC>=e){const n=i.start,r=i.end;let s=t.fragments;if(!i.relurl){const{fragmentHint:e}=t;e&&(s=s.concat(e))}return Zr(s,(t=>t.cc<e||t.end<=n?1:t.cc>e||t.start>=r?-1:0))}return null}(e,i,t)||e&&ns(e.fragments,i)||t}startLoad(t,e){if(!this.levels)return this.startPosition=t,void(this.state=eo);const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),i>0&&-1===t?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state=io):this.state=ao,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case io:this.doTickIdle();break;case ao:{const{levels:t,trackId:e}=this,i=null==t?void 0:t[e],n=null==i?void 0:i.details;if(n&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(n))break;this.state=ho}break}case so:{var t;const e=performance.now(),i=this.retryDate;if(!i||e>=i||null!=(t=this.media)&&t.seeking){const{levels:t,trackId:e}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==t?void 0:t[e])||null),this.state=io}break}case ho:{const t=this.waitingData;if(t){const{frag:e,part:i,cache:n,complete:r}=t,s=this.mainAnchor;if(void 0!==this.initPTS[e.cc]){this.waitingData=null,this.state=ro;const t={frag:e,part:i,payload:n.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(t),r&&super._handleFragmentLoadComplete(t)}else s&&s.cc!==t.frag.cc&&(this.log(`Waiting fragment cc (${e.cc}) cancelled because video is at cc ${s.cc}`),this.nextLoadPosition=this.findSyncFrag(s).start,this.clearWaitingFragment())}else this.state=io}}this.onTickEnd()}clearWaitingFragment(){const t=this.waitingData;t&&(this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.state!==eo&&(this.state=io))}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:t}=this;null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:i,media:n,trackId:r}=this,s=e.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==i||!i[r])return;const a=i[r],o=a.details;if(!o||this.waitForLive(a)||this.waitForCdnTuneIn(o))return this.state=ao,void(this.startFragRequested=!1);const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,Dn,cn));const c=this.getFwdBufferInfo(l,cn);if(null===c)return;if(!this.switchingTrack&&this._streamEnded(c,o))return e.trigger(nn.BUFFER_EOS,{type:"audio"}),void(this.state=co);const u=c.len,h=e.maxBufferLength,d=o.fragments,f=d[0].start,p=this.getLoadPosition(),g=this.flushing?p:c.end;if(this.switchingTrack&&n){const t=p;o.PTSKnown&&t<f&&(c.end>f||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=f+.05)}if(u>=h&&!this.switchingTrack&&g<d[d.length-1].start)return;let m=this.getNextFragment(g,o);if(m&&this.isLoopLoading(m,g)&&(m=this.getNextFragmentLoopLoading(m,o,c,ln,h)),!m)return void(this.bufferFlushed=!0);let v=(null==(t=this.mainFragLoading)?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&v&&Fn(m)&&!m.endList&&(!o.live||!this.loadingParts&&g<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(v)===Ss&&(this.mainFragLoading=v=null),v&&Fn(v))){if(m.start>v.end){const t=this.fragmentTracker.getFragAtPos(g,ln);t&&t.end>v.end&&(v=t,this.mainFragLoading={frag:t,targetBufferTime:null})}if(m.start>v.end)return}this.loadFragment(m,a,g)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,e){let{audioTracks:i}=e;this.resetTransmuxer(),this.levels=i.map((t=>new $r(t)))}onAudioTrackSwitching(t,e){const i=!!e.url;this.trackId=e.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),i?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==eo&&(this.setInterval(100),this.state=io,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(nn.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(t,e){var i;const{levels:n}=this,{details:r,id:s,groupId:a,track:o}=e;if(!n)return void this.warn(`Audio tracks reset while loading track ${s} "${o.name}" of "${a}"`);const l=this.mainDetails;if(!l||r.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=e,void(this.state!==eo&&(this.state=ao));this.cachedTrackLoadedData=null,this.log(`Audio track ${s} "${o.name}" of "${a}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const c=n[s];let u=0;if(r.live||null!=(i=c.details)&&i.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;var h;if(c.details)u=this.alignPlaylists(r,c.details,null==(h=this.levelLastLoaded)?void 0:h.details);r.alignedSliding||(Ja(r,l),r.alignedSliding||Za(r,l),u=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(l,u),this.hls.trigger(nn.AUDIO_TRACK_UPDATED,{details:r,id:s,groupId:e.groupId}),this.state!==ao||this.waitForCdnTuneIn(r)||(this.state=io),this.tick()}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:n,payload:r}=t,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(i.start);const u=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new ql(this.hls,cn,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const d=this.initPTS[i.cc],f=null==(e=i.initSegment)?void 0:e.data;if(void 0!==d){const t=!1,e=n?n.index:-1,s=-1!==e,a=new Fs(i.level,i.sn,i.stats.chunkCount,r.byteLength,e,s);h.push(r,f,u,"",i,n,c.totalduration,t,a,d)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:t}=this.waitingData=this.waitingData||{frag:i,part:n,cache:new mo,complete:!1};t.push(new Uint8Array(r)),this.state!==eo&&(this.state=ho)}}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===ln&&Fn(e.frag)&&(this.mainFragLoading=e,this.state===io&&this.tick())}onFragBuffered(t,e){const{frag:i,part:n}=e;if(i.type===cn)if(this.fragContextChanged(i))this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if(Fn(i)){this.fragPrevious=i;const t=this.switchingTrack;t&&(this.bufferedTrack=t,this.switchingTrack=null,this.hls.trigger(nn.AUDIO_TRACK_SWITCHED,mn({},t)))}this.fragBufferedComplete(i,n),this.media&&this.tick()}else this.audioOnly||i.type!==ln||i.elementaryStreams.video||i.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(t,e){var i;if(e.fatal)this.state=uo;else switch(e.details){case en.FRAG_GAP:case en.FRAG_PARSING_ERROR:case en.FRAG_DECRYPT_ERROR:case en.FRAG_LOAD_ERROR:case en.FRAG_LOAD_TIMEOUT:case en.KEY_LOAD_ERROR:case en.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(cn,e);break;case en.AUDIO_TRACK_LOAD_ERROR:case en.AUDIO_TRACK_LOAD_TIMEOUT:case en.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==ao||(null==(i=e.context)?void 0:i.type)!==an||(this.state=io);break;case en.BUFFER_ADD_CODEC_ERROR:case en.BUFFER_APPEND_ERROR:if("audio"!==e.parent)return;this.resetLoadingState();break;case en.BUFFER_FULL_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case en.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushing(t,e){let{type:i}=e;i!==Nn&&(this.flushing=!0)}onBufferFlushed(t,e){let{type:i}=e;if(i!==Nn){this.flushing=!1,this.bufferFlushed=!0,this.state===co&&(this.state=io);const t=this.mediaBuffer||this.media;t&&(this.afterBufferFlushed(t,i,cn),this.tick())}}_handleTransmuxComplete(t){var e;const i="audio",{hls:n}=this,{remuxResult:r,chunkMeta:s}=t,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:u}=c,{audio:h,text:d,id3:f,initSegment:p}=r;if(!this.fragContextChanged(o)&&u){if(this.state=oo,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){const t=o.initSegment||o;this._bufferInitSegment(c,p.tracks,t,s),n.trigger(nn.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:i,tracks:p.tracks})}if(h){const{startPTS:t,endPTS:e,startDTS:i,endDTS:n}=h;l&&(l.elementaryStreams[Dn]={startPTS:t,endPTS:e,startDTS:i,endDTS:n}),o.setElementaryStreamInfo(Dn,t,e,i,n),this.bufferFragmentData(h,o,l,s)}if(null!=f&&null!=(e=f.samples)&&e.length){const t=pn({id:i,frag:o,details:u},f);n.trigger(nn.FRAG_PARSING_METADATA,t)}if(d){const t=pn({id:i,frag:o,details:u},d);n.trigger(nn.FRAG_PARSING_USERDATA,t)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(t,e,i,n){if(this.state!==oo)return;if(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio)return;const r=e.audio;r.id=cn;const s=t.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${s}/${r.codec}]`),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(nn.BUFFER_CODECS,e);const a=r.initSegment;if(null!=a&&a.byteLength){const t={type:"audio",frag:i,part:null,chunkMeta:n,parent:i.type,data:a};this.hls.trigger(nn.BUFFER_APPENDING,t)}this.tickImmediate()}loadFragment(t,e,i){const n=this.fragmentTracker.getState(t);var r;if(this.switchingTrack||n===vs||n===bs)if(Fn(t))if(null!=(r=e.details)&&r.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=ho;const i=this.mainDetails;i&&i.fragmentStart!==e.details.fragmentStart&&Za(e.details,i)}else super.loadFragment(t,e,i);else this._loadInitSegment(t,e);else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:i,assocLang:n,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;Yr({name:e,lang:i,assocLang:n,characteristics:r,audioCodec:s,channels:a},t,Xr)||(Jr(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(nn.AUDIO_TRACK_SWITCHED,mn({},t))}},audioTrackController:class extends Gl{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.on(nn.LEVEL_LOADING,this.onLevelLoading,this),t.on(nn.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(nn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(nn.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.off(nn.LEVEL_LOADING,this.onLevelLoading,this),t.off(nn.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(nn.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(nn.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:i,groupId:n,details:r}=e,s=this.tracksInGroup[i];if(!s||s.groupId!==n)return void this.warn(`Audio track with id:${i} and group:${n} not found in active group ${null==s?void 0:s.groupId}`);const a=s.details;s.details=e.details,this.log(`Audio track ${i} "${s.name}" lang:${s.lang} group:${n} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.audioGroups||null,n=this.groupIds;let r=this.currentTrack;if(!i||(null==n?void 0:n.length)!==(null==i?void 0:i.length)||null!=i&&i.some((t=>-1===(null==n?void 0:n.indexOf(t))))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter((t=>!i||-1!==i.indexOf(t.groupId)));if(t.length)this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),t.forEach(((t,e)=>{t.id=e}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.audioPreference;if(!r&&e){const i=Kr(e,t,Xr);if(i>-1)r=t[i];else{const t=Kr(e,this.tracks);r=this.tracks[t]}}let n=this.findTrackId(r);-1===n&&r&&(n=this.findTrackId(null));const a={audioTracks:t};this.log(`Updating audio tracks, ${t.length} track(s) found in group(s): ${null==i?void 0:i.join(",")}`),this.hls.trigger(nn.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==n&&-1===o)this.setAudioTrack(n);else if(t.length&&-1===o){var s;const e=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${t.length}`);this.warn(e.message),this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:e})}}}onError(t,e){!e.fatal&&e.context&&(e.context.type!==an||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const n=this.currentTrack;if(n&&Yr(t,n,Xr))return n;const r=Kr(t,this.tracksInGroup,Xr);if(r>-1){const t=this.tracksInGroup[r];return this.setAudioTrack(r),t}if(n){let n=e.loadLevel;-1===n&&(n=e.firstAutoLevel);const r=function(t,e,i,n,r){const s=e[n],a=e.reduce(((t,e,i)=>{const n=e.uri;return(t[n]||(t[n]=[])).push(i),t}),{}),o=a[s.uri];o.length>1&&(n=Math.max.apply(Math,o));const l=s.videoRange,c=s.frameRate,u=s.codecSet.substring(0,4),h=Qr(e,n,(e=>{if(e.videoRange!==l||e.frameRate!==c||e.codecSet.substring(0,4)!==u)return!1;const n=e.audioGroups,s=i.filter((t=>!n||-1!==n.indexOf(t.groupId)));return Kr(t,s,r)>-1}));return h>-1?h:Qr(e,n,(e=>{const n=e.audioGroups,s=i.filter((t=>!n||-1!==n.indexOf(t.groupId)));return Kr(t,s,r)>-1}))}(t,e.levels,i,n,Xr);if(-1===r)return null;e.nextLoadLevel=r}if(t.channels||t.audioCodec){const e=Kr(t,i);if(e>-1)return i[e]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length)return void this.warn(`Invalid audio track id: ${t}`);this.selectDefaultTrack=!1;const i=this.currentTrack,n=e[t],r=n.details&&!n.details.live;if(t===this.trackId&&n===i&&r)return;if(this.log(`Switching to audio-track ${t} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=t,this.currentTrack=n,this.hls.trigger(nn.AUDIO_TRACK_SWITCHING,mn({},n)),r)return;const s=this.switchParams(n.url,null==i?void 0:i.details,n.details);this.loadPlaylist(s)}findTrackId(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const n=e[i];if((!this.selectDefaultTrack||n.default)&&(!t||Yr(t,n,Xr)))return i}if(t){const{name:i,lang:n,assocLang:r,characteristics:s,audioCodec:a,channels:o}=t;for(let t=0;t<e.length;t++){if(Yr({name:i,lang:n,assocLang:r,characteristics:s,audioCodec:a,channels:o},e[t],Xr))return t}for(let l=0;l<e.length;l++){const i=e[l];if(Wl(t.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<e.length;l++){const i=e[l];if(Wl(t.attrs,i.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&Jr(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=t.id,n=t.groupId,r=this.getUrlWithDirectives(t.url,e),s=t.details,a=null==s?void 0:s.age;this.log(`Loading audio-track ${i} "${t.name}" lang:${t.lang} group:${n}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(nn.AUDIO_TRACK_LOADING,{url:r,id:i,groupId:n,deliveryDirectives:e||null,track:t})}},emeController:Nc,cmcdController:class{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=t=>{try{this.apply(t,{ot:ic.MANIFEST,su:!this.initialized})}catch(e){this.hls.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=t=>{try{const{frag:e,part:i}=t,n=this.hls.levels[e.level],r=this.getObjectType(e),s={d:1e3*(i||e).duration,ot:r};r!==ic.VIDEO&&r!==ic.AUDIO&&r!=ic.MUXED||(s.br=n.bitrate/1e3,s.tb=this.getTopBandwidth(r)/1e3,s.bl=this.getBufferLength(r));const a=i?this.getNextPart(i):this.getNextFrag(e);null!=a&&a.url&&a.url!==e.url&&(s.nor=a.url),this.apply(t,s)}catch(e){this.hls.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=t;const e=this.config=t.config,{cmcd:i}=e;null!=i&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHED,this.onMediaDetached,this),t.on(nn.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHED,this.onMediaDetached,this),t.off(nn.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,n;this.audioBuffer=null==(i=e.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(n=e.tracks.video)?void 0:n.buffer}createData(){var t;return{v:1,sf:nc.HLS,sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};pn(e,this.createData());const i=e.ot===ic.INIT||e.ot===ic.VIDEO||e.ot===ic.MUXED;this.starved&&i&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering);const{includeKeys:n}=this;n&&(e=Object.keys(e).reduce(((t,i)=>(n.includes(i)&&(t[i]=e[i]),t)),{}));const r={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),Pc(t.headers,e,r)):t.url=Ic(t.url,e,r)}getNextFrag(t){var e;const i=null==(e=this.hls.levels[t.level])?void 0:e.details;if(i){const e=t.sn-i.startSN;return i.fragments[e+1]}}getNextPart(t){var e,i;const{index:n,fragment:r}=t,s=null==(e=this.hls.levels[r.level])||null==(i=e.details)?void 0:i.partList;if(s){const{sn:t}=r;for(let e=s.length-1;e>=0;e--){const i=s[e];if(i.index===n&&i.fragment.sn===t)return s[e+1]}}}getObjectType(t){const{type:e}=t;return"subtitle"===e?ic.TIMED_TEXT:"initSegment"===t.sn?ic.INIT:"audio"===e?ic.AUDIO:"main"===e?this.hls.audioTracks.length?ic.VIDEO:ic.MUXED:void 0}getTopBandwidth(t){let e,i=0;const n=this.hls;if(t===ic.AUDIO)e=n.audioTracks;else{const t=n.maxAutoLevel,i=t>-1?t+1:n.levels.length;e=n.levels.slice(0,i)}for(const r of e)r.bitrate>i&&(i=r.bitrate);return i>0?i:NaN}getBufferLength(t){const e=this.media,i=t===ic.AUDIO?this.audioBuffer:this.videoBuffer;if(!i||!e)return NaN;return 1e3*Us.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new i(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,i,n){e(t),this.loader.load(t,i,n)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new i(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,i,n){e(t),this.loader.load(t,i,n)}}}},contentSteeringController:class extends vn{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.on(nn.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.off(nn.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce(((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t)),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=1e3*this.timeToLoad-(performance.now()-this.updated);if(t>0)return void this.scheduleRefresh(this.uri,t)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter((e=>e!==t)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:i}=e;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:i}=e;if((null==i?void 0:i.action)===us&&i.flags===ps){const t=this.levels;let n=this._pathwayPriority,r=this.pathwayId;if(e.context){const{groupId:i,pathwayId:n,type:s}=e.context;i&&t?r=this.getPathwayForGroupId(i,s,r):n&&(r=n)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!n&&t&&(n=this.pathways()),n&&n.length>1&&(this.updatePathwayPriority(n),i.resolved=this.pathwayId!==r),i.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${r} levels: ${t?t.length:t} priorities: ${qr(n)} penalized: ${qr(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(0===e.length){const i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return null===this.levels?[]:this.levels.filter((e=>t===e.pathwayId))}updatePathwayPriority(t){let e;this._pathwayPriority=t;const i=this.penalizedPathways,n=performance.now();Object.keys(i).forEach((t=>{n-i[t]>3e5&&delete i[t]}));for(let r=0;r<t.length;r++){const n=t[r];if(n in i)continue;if(n===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(e=this.getLevelsForPathway(n),e.length>0){this.log(`Setting Pathway to "${n}"`),this.pathwayId=n,Ka(e),this.hls.trigger(nn.LEVELS_UPDATED,{levels:e});const t=this.hls.levels[s];a&&t&&this.levels&&(t.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&t.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${t.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(t,e,i){const n=this.getLevelsForPathway(i).concat(this.levels||[]);for(let r=0;r<n.length;r++)if(e===an&&n[r].hasAudioGroup(t)||e===on&&n[r].hasSubtitleGroup(t))return n[r].pathwayId;return i}clonePathways(t){const e=this.levels;if(!e)return;const i={},n={};t.forEach((t=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=t;if(e.some((t=>t.pathwayId===r)))return;const o=this.getLevelsForPathway(s).map((t=>{const e=new Ws(t.attrs);e["PATHWAY-ID"]=r;const s=e.AUDIO&&`${e.AUDIO}_clone_${r}`,o=e.SUBTITLES&&`${e.SUBTITLES}_clone_${r}`;s&&(i[e.AUDIO]=s,e.AUDIO=s),o&&(n[e.SUBTITLES]=o,e.SUBTITLES=o);const l=Dc(t.uri,e["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),c=new $r({attrs:e,audioCodec:t.audioCodec,bitrate:t.bitrate,height:t.height,name:t.name,url:l,videoCodec:t.videoCodec,width:t.width});if(t.audioGroups)for(let i=1;i<t.audioGroups.length;i++)c.addGroupId("audio",`${t.audioGroups[i]}_clone_${r}`);if(t.subtitleGroups)for(let i=1;i<t.subtitleGroups.length;i++)c.addGroupId("text",`${t.subtitleGroups[i]}_clone_${r}`);return c}));e.push(...o),Cc(this.audioTracks,i,a,r),Cc(this.subtitleTracks,n,a,r)}))}loadSteeringManifest(t){const e=this.hls.config,i=e.loader;let n;this.loader&&this.loader.destroy(),this.loader=new i(e);try{n=new self.URL(t)}catch(c){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${t}`)}if("data:"!==n.protocol){const t=0|(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate);n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+t)}const r={responseType:"json",url:n.href},s=e.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(t,e,i,r)=>{this.log(`Loaded steering manifest: "${n}"`);const s=t.data;if(1!==(null==s?void 0:s.VERSION))return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,n).href}catch(c){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||i.url),o&&this.clonePathways(o);const u={steeringManifest:s,url:n.toString()};this.hls.trigger(nn.STEERING_MANIFEST_LOADED,u),l&&this.updatePathwayPriority(l)},onError:(t,e,i,n)=>{if(this.log(`Error loading steering manifest: ${t.code} ${t.text} (${e.url})`),this.stopLoad(),410===t.code)return this.enabled=!1,void this.log(`Steering manifest ${e.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==t.code)this.scheduleRefresh(this.uri||e.url,r);else{const t=this.loader;if("function"===typeof(null==t?void 0:t.getResponseHeader)){const e=t.getResponseHeader("Retry-After");e&&(r=1e3*parseFloat(e))}this.log(`Steering manifest ${e.url} rate limited`)}},onTimeout:(t,e,i)=>{this.log(`Timeout loading steering manifest (${e.url})`),this.scheduleRefresh(this.uri||e.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(r,o,l)}scheduleRefresh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3*this.timeToLoad;this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var e;const i=null==(e=this.hls)?void 0:e.media;!i||i.ended?this.scheduleRefresh(t,1e3*this.timeToLoad):this.loadSteeringManifest(t)}),e)}},interstitialsController:class extends vn{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const t=this.currentTime;if(void 0===t||this.playbackDisabled)return;const e=t-this.timelinePos;if(Math.abs(e)<1/7056e5)return;const i=e<=-.01;this.timelinePos=t,this.bufferedPos=t;const n=this.playingItem;if(!n)return void this.checkBuffer();if(i){this.schedule.resetErrorsInRange(t,t-e)&&this.updateSchedule()}if(this.checkBuffer(),i&&t<n.start||t>=n.end){var r;const t=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(n)&&null!=(r=this.media)&&r.paused&&(this.shouldPlay=!1),!i){const e=this.findItemIndex(n);if(t>e){const i=this.schedule.findJumpRestrictedIndex(e+1,t);if(i>e)return void this.setSchedulePosition(i)}}return void this.setSchedulePosition(t)}const s=this.playingAsset;if(!s){if(this.playingLastItem&&this.isInterstitial(n)){const e=n.event.assetList[0];e&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(t,e))}return}const a=s.timelineStart,o=s.duration||0;(i&&t<a||t>=a+o)&&this.setScheduleToAssetAtTime(t,s)},this.onTimeupdate=()=>{const t=this.currentTime;if(void 0===t||this.playbackDisabled)return;if(!(t>this.timelinePos))return;this.timelinePos=t,t>this.bufferedPos&&this.checkBuffer();const e=this.playingItem;if(!e||this.playingLastItem)return;if(t>=e.end){this.timelinePos=e.end;const t=this.findItemIndex(e);this.setSchedulePosition(t+1)}const i=this.playingAsset;if(!i)return;t>=i.timelineStart+(i.duration||0)&&this.setScheduleToAssetAtTime(t,i)},this.onScheduleUpdate=(t,e)=>{const i=this.schedule,n=this.playingItem,r=i.events||[],s=i.items||[],a=i.durations,o=t.map((t=>t.identifier)),l=!(!r.length&&!o.length);if(l&&this.log(`INTERSTITIALS_UPDATED (${r.length}): ${r}\nSchedule: ${s.map((t=>Qc(t)))}`),o.length&&this.log(`Removed events ${o}`),this.playerQueue.forEach((t=>{if(t.interstitial.appendInPlace){const e=t.assetItem.timelineStart,i=t.timelineOffset-e;if(i)try{t.timelineOffset=e}catch(Bw){Math.abs(i)>zc&&this.warn(`${Bw} ("${t.assetId}" ${t.timelineOffset}->${e})`)}}})),n){const t=this.updateItem(n,this.timelinePos);this.itemsMatch(n,t)&&(this.playingItem=t,this.waitingItem=this.endedItem=null)}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const c=this.bufferingItem;if(c){const t=this.updateItem(c,this.bufferedPos);this.itemsMatch(c,t)?this.bufferingItem=t:c.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(c.event,null))}if(t.forEach((t=>{t.assetList.forEach((t=>{this.clearAssetPlayer(t.identifier,null)}))})),l||e){if(this.hls.trigger(nn.INTERSTITIALS_UPDATED,{events:r.slice(0),schedule:s.slice(0),durations:a,removedIds:o}),this.isInterstitial(n)&&o.includes(n.event.identifier))return this.warn(`Interstitial "${n.event.identifier}" removed while playing`),void this.primaryFallback(n.event);this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new Jc(t),this.schedule=new Xc(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t.on(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(nn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(nn.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(nn.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(nn.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(nn.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(nn.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(nn.BUFFER_APPENDED,this.onBufferAppended,this),t.on(nn.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(nn.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(nn.MEDIA_ENDED,this.onMediaEnded,this),t.on(nn.ERROR,this.onError,this),t.on(nn.DESTROYING,this.onDestroying,this)}unregisterListeners(){const t=this.hls;t&&(t.off(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(nn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(nn.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(nn.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(nn.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(nn.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(nn.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(nn.BUFFER_CODECS,this.onBufferCodecs,this),t.off(nn.BUFFER_APPENDED,this.onBufferAppended,this),t.off(nn.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(nn.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(nn.MEDIA_ENDED,this.onMediaEnded,this),t.off(nn.ERROR,this.onError,this),t.off(nn.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;null==(t=this.getBufferingPlayer())||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.getBufferingPlayer())||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){tu(t,"play",this.onPlay),tu(t,"pause",this.onPause),tu(t,"seeking",this.onSeeking),tu(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const i=this.media=e.media;Zc(i,"seeking",this.onSeeking),Zc(i,"timeupdate",this.onTimeupdate),Zc(i,"play",this.onPlay),Zc(i,"pause",this.onPause)}onMediaAttached(t,e){const i=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,null===i)this.checkStart();else if(!n){this.clearScheduleState();const t=this.findItemIndex(i);this.setSchedulePosition(t)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const i=!!e.transferMedia,n=this.media;if(this.media=null,!i&&(n&&this.removeMediaListeners(n),this.detachedData)){const t=this.getBufferingPlayer();t&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,t.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const t=this,e=()=>t.bufferingItem||t.waitingItem,i=e=>e?t.getAssetPlayer(e.identifier):e,n=(e,n,r,a,o)=>{if(e){let l=e[n].start;const c=e.event;if(c){if("playout"===n||c.timelineOccupancy!==Hc.Point){const t=i(r);(null==t?void 0:t.interstitial)===c&&(l+=t.assetItem.startOffset+t[o])}}else{l+=("bufferedPos"===a?s():t[a])-e.start}return l}return 0},r=(e,i)=>{if(0!==e&&"primary"!==i&&t.schedule.length){var n;const r=t.schedule.findItemIndexAtTime(e),s=null==(n=t.schedule.items)?void 0:n[r];if(s){return e+(s[i].start-s.start)}}return e},s=()=>{const e=t.bufferedPos;return e===Number.MAX_VALUE?a("primary"):Math.max(e,0)},a=e=>{var i;return null!=(i=t.primaryDetails)&&i.live?t.primaryDetails.edge:t.schedule.durations[e]},o=(e,r)=>{var s,a;const o=t.effectivePlayingItem;if(null!=o&&null!=(s=o.event)&&s.restrictions.skip)return;t.log(`seek to ${e} "${r}"`);const l=t.effectivePlayingItem,c=t.schedule.findItemIndexAtTime(e,r),u=null==(a=t.schedule.items)?void 0:a[c],h=t.getBufferingPlayer(),d=null==h?void 0:h.interstitial,f=null==d?void 0:d.appendInPlace,p=l&&t.itemsMatch(l,u);if(l&&(f||p)){const s=i(t.playingAsset),a=(null==s?void 0:s.media)||t.primaryMedia;if(a){const i="primary"===r?a.currentTime:n(l,r,t.playingAsset,"timelinePos","currentTime"),o=e-i,c=(f?i:a.currentTime)+o;if(c>=0&&(!s||f||c<=s.duration))return void(a.currentTime=c)}}if(u){let i=e;if("primary"!==r){const t=e-u[r].start;i=u.start+t}const n=!t.isInterstitial(u);if(t.isInterstitial(l)&&!l.event.appendInPlace||!n&&!u.event.appendInPlace){if(l){const s=t.findItemIndex(l);if(c>s){const e=t.schedule.findJumpRestrictedIndex(s+1,c);if(e>s)return void t.setSchedulePosition(e)}let a=0;if(n)t.timelinePos=i,t.checkBuffer();else{var g;const t=null==u||null==(g=u.event)?void 0:g.assetList;if(t){const i=e-(u[r]||u).start;for(let e=t.length;e--;){const n=t[e];if(n.duration&&i>=n.startOffset&&i<n.startOffset+n.duration){a=e;break}}}}t.setSchedulePosition(c,a)}}else{const e=t.media||(f?null==h?void 0:h.media:null);e&&(e.currentTime=i)}}},l=()=>{const i=t.effectivePlayingItem;if(t.isInterstitial(i))return i;const n=e();return t.isInterstitial(n)?n:null},c={get currentTime(){const e=l(),i=t.effectivePlayingItem;return i&&i===e?n(i,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-i.playout.start:0},set currentTime(e){const i=l(),n=t.effectivePlayingItem;n&&n===i&&o(e+n.playout.start,"playout")},get duration(){const t=l();return t?t.playout.end-t.playout.start:0},get assetPlayers(){var e;const i=null==(e=l())?void 0:e.event.assetList;return i?i.map((e=>t.getAssetPlayer(e.identifier))):[]},get playingIndex(){var e;const i=null==(e=l())?void 0:e.event;return i&&t.effectivePlayingAsset?i.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return l()}};this.manager={get events(){var e,i;return(null==(e=t.schedule)||null==(i=e.events)?void 0:i.slice(0))||[]},get schedule(){var e,i;return(null==(e=t.schedule)||null==(i=e.items)?void 0:i.slice(0))||[]},get interstitialPlayer(){return l()?c:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const i=e();return t.findItemIndex(i)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){const e=t.effectivePlayingItem;return t.findItemIndex(e)},primary:{get bufferedEnd(){return s()},get currentTime(){const e=t.timelinePos;return e>0?e:0},set currentTime(t){o(t,"primary")},get duration(){return a("primary")},get seekableStart(){var e;return(null==(e=t.primaryDetails)?void 0:e.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(t){o(t,"integrated")},get duration(){return a("integrated")},get seekableStart(){var e;return r((null==(e=t.primaryDetails)?void 0:e.fragmentStart)||0,"integrated")}},skip:()=>{const e=t.effectivePlayingItem,i=null==e?void 0:e.event;if(i&&!i.restrictions.skip){const n=t.findItemIndex(e);if(i.appendInPlace){const t=e.playout.start+e.event.duration;o(t+.001,"playout")}else t.advanceAfterAssetEnded(i,n,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,i=null==(t=this.schedule)?void 0:t.items;return!!(this.playbackStarted&&e&&i)&&this.findItemIndex(e)===i.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var t,e,i;if(null===this.mediaSelection)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let r=this.media;!r&&null!=(t=this.bufferingItem)&&null!=(e=t.event)&&e.appendInPlace&&(r=this.primaryMedia);const s=null==(i=r)?void 0:i.currentTime;return void 0!==s&&Qi(s)?s:void 0}get primaryMedia(){var t;return this.media||(null==(t=this.detachedData)?void 0:t.media)||null}isInterstitial(t){return!(null==t||!t.event)}retreiveMediaSource(t,e){const i=this.getAssetPlayer(t);i&&this.transferMediaFromPlayer(i,e)}transferMediaFromPlayer(t,e){const i=t.interstitial.appendInPlace,n=t.media;if(i&&n===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&n)return void(this.detachedData={media:n});const i=t.transferMedia();this.log(`transfer MediaSource from ${t} ${qr(i)}`),this.detachedData=i}else e&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(t,e){var i,n;if(t.media===e)return;let r=null;const s=this.hls,a=t!==s,o=a&&t.interstitial.appendInPlace,l=null==(i=this.detachedData)?void 0:i.mediaSource;let c;if(s.media)o&&(r=s.transferMedia(),this.detachedData=r),c="Primary";else if(l){const t=this.getBufferingPlayer();t?(r=t.transferMedia(),c=`${t}`):c="detached MediaSource"}else c="detached media";if(!r)if(l)r=this.detachedData,this.log(`using detachedData: MediaSource ${qr(r)}`);else if(!this.detachedData||s.media===e){const t=this.playerQueue;t.length>1&&t.forEach((t=>{if(a&&t.interstitial.appendInPlace!==o){const e=t.interstitial;this.clearInterstitial(t.interstitial,null),e.appendInPlace=!1,e.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${e}`)}})),this.hls.detachMedia(),this.detachedData={media:e}}const u=r&&"mediaSource"in r&&"closed"!==(null==(n=r.mediaSource)?void 0:n.readyState),h=u&&r?r:e;if(this.log(`${u?"transfering MediaSource":"attaching media"} to ${a?t:"Primary"} from ${c}`),h===r){const e=a&&t.assetId===this.schedule.assetIdAtEnd;h.overrides={duration:this.schedule.duration,endOfStream:!a||e,cueRemoval:!a}}t.attachMedia(h)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=t.events;if(!e||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const i=this.timelinePos,n=this.effectivePlayingItem;if(-1===i){const i=this.hls.startPosition;if(this.timelinePos=i,e.length&&e[0].cue.pre){const i=t.findEventIndex(e[0].identifier);this.setSchedulePosition(i)}else if(i>=0||!this.primaryLive){const e=this.timelinePos=i>0?i:0,n=t.findItemIndexAtTime(e);this.setSchedulePosition(n)}}else if(n&&!this.playingItem){const e=t.findItemIndex(n);this.setSchedulePosition(e)}}advanceAfterAssetEnded(t,e,i){const n=i+1;if(t.isAssetPastPlayoutLimit(n)||t.assetList[n].error){const i=this.schedule.items;if(i){const n=e+1;if(n>=i.length)return void this.setSchedulePosition(-1);const r=t.resumeTime;this.timelinePos<r&&(this.timelinePos=r,this.checkBuffer()),this.setSchedulePosition(n)}}else this.setSchedulePosition(e,n)}setScheduleToAssetAtTime(t,e){const i=this.schedule,n=e.parentIdentifier,r=i.getEvent(n);if(r){const e=i.findEventIndex(n),s=i.findAssetIndex(r,t);this.setSchedulePosition(e,s)}}setSchedulePosition(t,e){const i=this.schedule.items;if(!i||this.playbackDisabled)return;this.log(`setSchedulePosition ${t}, ${e}`);const n=t>=0?i[t]:null,r=this.playingItem,s=this.playingLastItem;if(this.isInterstitial(r)){var a;const l=r.event,c=this.playingAsset,u=null==c?void 0:c.identifier,h=u?this.getAssetPlayer(u):null;if(h&&u&&(!this.eventItemsMatch(r,n)||void 0!==e&&u!==(null==(a=l.assetList)?void 0:a[e].identifier))){var o;const e=l.findAssetIndex(c);this.log(`INTERSTITIAL_ASSET_ENDED ${e+1}/${l.assetList.length} ${Kc(c)}`),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(nn.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:e,event:l,schedule:i.slice(0),scheduleIndex:t,player:h}),this.retreiveMediaSource(u,n),!h.media||null!=(o=this.detachedData)&&o.mediaSource||h.detachMedia()}if(!this.eventItemsMatch(r,n)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${l} ${Qc(r)}`),l.hasPlayed=!0,this.hls.trigger(nn.INTERSTITIAL_ENDED,{event:l,schedule:i.slice(0),scheduleIndex:t}),l.cue.once)){this.updateSchedule();const t=this.schedule.items;if(n&&t){const i=this.schedule.findItemIndex(n);this.advanceSchedule(i,t,e,r,s)}return}}this.advanceSchedule(t,i,e,r,s)}advanceSchedule(t,e,i,n,r){const s=t>=0?e[t]:null,a=this.primaryMedia,o=this.playerQueue;if(o.length&&o.forEach((e=>{const i=e.interstitial,n=this.schedule.findEventIndex(i.identifier);(n<t||n>t+1)&&this.clearInterstitial(i,s)})),this.isInterstitial(s)){this.timelinePos=Math.min(Math.max(this.timelinePos,s.start),s.end);const r=s.event;void 0===i&&(i=this.schedule.findAssetIndex(r,this.timelinePos));const o=this.waitingItem;this.assetsBuffered(s,a)||this.setBufferingItem(s);let l=this.preloadAssets(r,i);if(this.eventItemsMatch(s,o||n)||(this.waitingItem=s,this.log(`INTERSTITIAL_STARTED ${Qc(s)} ${r.appendInPlace?"append in place":""}`),this.hls.trigger(nn.INTERSTITIAL_STARTED,{event:r,schedule:e.slice(0),scheduleIndex:t})),!r.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${r}`);if(r.assetListLoader&&(r.assetListLoader.destroy(),r.assetListLoader=void 0),!a)return void this.log(`Waiting for attachMedia to start Interstitial ${r}`);this.waitingItem=this.endedItem=null,this.playingItem=s;const c=r.assetList[i];if(!c){const n=e[t+1],s=this.media;return n&&s&&!this.isInterstitial(n)&&s.currentTime<n.start&&(s.currentTime=this.timelinePos=n.start),void this.advanceAfterAssetEnded(r,t,i||0)}if(l||(l=this.getAssetPlayer(c.identifier)),null===l||l.destroyed){const t=r.assetList.length;this.warn(`asset ${i+1}/${t} player destroyed ${r}`),l=this.createAssetPlayer(r,c,i)}if(!this.eventItemsMatch(s,this.bufferingItem)&&r.appendInPlace&&this.isAssetBuffered(c))return;this.startAssetPlayer(l,i,e,t,a),this.shouldPlay&&eu(l.media)}else null!==s?(this.resumePrimary(s,t,n),this.shouldPlay&&eu(this.hls.media)):r&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var t,e;return null==(t=this.mediaSelection)||null==(e=t.main)?void 0:e.details}get primaryLive(){var t;return!(null==(t=this.primaryDetails)||!t.live)}resumePrimary(t,e,i){var n;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${Qc(t)}`),null==(n=this.detachedData)||!n.mediaSource){let i=this.timelinePos;(i<t.start||i>=t.end)&&(i=this.getPrimaryResumption(t,e),this.timelinePos=i),this.attachPrimary(i,t)}if(!i)return;const r=this.schedule.items;r&&(this.log(`resumed ${Qc(t)}`),this.hls.trigger(nn.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const i=t.start;if(this.primaryLive){const t=this.primaryDetails;if(0===e)return this.hls.startPosition;if(t&&(i<t.fragmentStart||i>t.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);if(null!=e&&e.hls)return e.hls.bufferedToEnd;return Us.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,i){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,n),i&&this.startLoadingPrimaryAt(t,i)),i||(this.timelinePos=t,this.startLoadingPrimaryAt(t,i))}startLoadingPrimaryAt(t,e){var i;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs(((null==(i=n.mainForwardBufferInfo)?void 0:i.start)||n.media.currentTime)-t)>.5?n.startLoad(t,e):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(nn.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(nn.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(-1===e.level)return;const i=this.hls.levels[e.level],n=mn(mn({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const i=this.hls.audioTracks[e.id],n=this.mediaSelection;if(!n)return void(this.altSelection=mn(mn({},this.altSelection),{},{audio:i}));const r=mn(mn({},n),{},{audio:i});this.mediaSelection=r}onSubtitleTrackUpdated(t,e){const i=this.hls.subtitleTracks[e.id],n=this.mediaSelection;if(!n)return void(this.altSelection=mn(mn({},this.altSelection),{},{subtitles:i}));const r=mn(mn({},n),{},{subtitles:i});this.mediaSelection=r}onAudioTrackSwitching(t,e){const i=Wr(e);this.playerQueue.forEach((t=>t.hls.setAudioOption(e)||t.hls.setAudioOption(i)))}onSubtitleTrackSwitch(t,e){const i=Wr(e);this.playerQueue.forEach((t=>t.hls.setSubtitleOption(e)||-1!==e.id&&t.hls.setSubtitleOption(i)))}onBufferCodecs(t,e){const i=e.tracks;i&&(this.requiredTracks=i)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const t=this.timelinePos;this.bufferedPos=t,this.checkBuffer()}}onBufferedToEnd(t){const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let t=0;t<e.length;t++){const n=e[t];if(n.cue.post){var i;const t=this.schedule.findEventIndex(n.identifier),e=null==(i=this.schedule.items)?void 0:i[t];this.isInterstitial(e)&&this.eventItemsMatch(e,this.bufferingItem)&&this.bufferedToItem(e,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const t=this.findItemIndex(e);this.setSchedulePosition(t+1)}else this.shouldPlay=!1}updateItem(t,e){const i=this.schedule.items;if(t&&i){return i[this.findItemIndex(t,e)]||null}return null}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var i;return!!e&&(t===e||t.event.identifier===(null==(i=e.event)?void 0:i.identifier))}findItemIndex(t,e){return t?this.schedule.findItemIndex(t,e):-1}updateSchedule(){const t=this.mediaSelection;t&&this.schedule.updateSchedule(t,[])}checkBuffer(t){const e=this.schedule.items;if(!e)return;const i=Us.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=i.len<1),this.updateBufferedPos(i.end,e,t)}updateBufferedPos(t,e,i){const n=this.schedule,r=this.bufferingItem;if(this.bufferedPos>t)return;if(1===e.length&&this.itemsMatch(e[0],r))return void(this.bufferedPos=t);const s=this.playingItem,a=this.findItemIndex(s);let o=n.findItemIndexAtTime(t);if(this.bufferedPos<t){var l,c;const i=this.findItemIndex(r),n=Math.min(i+1,e.length-1),s=e[n];if((-1===o&&r&&t>=r.end||null!=(l=s.event)&&l.appendInPlace&&t+.01>=s.start)&&(o=n),n-a>1&&!1===(null==r||null==(c=r.event)?void 0:c.appendInPlace))return;if(this.bufferedPos=t,o>i&&o>a)this.bufferedToItem(s);else{const e=this.primaryDetails;this.primaryLive&&e&&t>e.edge-e.targetduration&&s.start<e.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else i&&s&&!this.itemsMatch(s,r)&&(o===a?this.bufferedToItem(s):o===a+1&&this.bufferedToItem(e[o]))}assetsBuffered(t,e){return 0!==t.event.assetList.length&&!t.event.assetList.some((t=>{const i=this.getAssetPlayer(t.identifier);return!(null!=i&&i.bufferedInPlaceToEnd(e))}))}setBufferingItem(t){const e=this.bufferingItem,i=this.schedule;if(this.itemsMatch(t,e))this.bufferingItem!==t&&(this.bufferingItem=t);else{const{items:n,events:r}=i;if(!n||!r)return e;const s=this.isInterstitial(t),a=this.getBufferingPlayer();if(this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos)),!this.playbackDisabled){const i=a?a.remaining:e?e.end-this.timelinePos:0;this.log(`buffered to boundary ${Qc(t)}`+(e?` (${i.toFixed(2)} remaining)`:"")),s?t.event.assetList.forEach((t=>{const e=this.getAssetPlayer(t.identifier);e&&e.resumeBuffering()})):(this.hls.resumeBuffering(),this.playerQueue.forEach((t=>t.pauseBuffering())))}this.hls.trigger(nn.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}return e}bufferedToItem(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this.setBufferingItem(t);if(!this.playbackDisabled)if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(null!==i){this.bufferingAsset=null;const e=this.detachedData;if(e)if(e.mediaSource){const e=!0;this.attachPrimary(t.start,t,e)}else this.preloadPrimary(t);else this.preloadPrimary(t)}}preloadPrimary(t){const e=this.findItemIndex(t),i=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(i)}bufferedToEvent(t,e){const i=t.event,n=0===i.assetList.length&&!i.assetListLoader,r=i.cue.once;if(n||!r){const t=this.preloadAssets(i,e);if(null!=t&&t.interstitial.appendInPlace){const n=i.assetList[e],r=this.primaryMedia;n&&r&&this.bufferAssetPlayer(t,r)}}}preloadAssets(t,e){const i=t.assetUrl,n=t.assetList.length,r=0===n&&!t.assetListLoader,s=t.cue.once;if(r){const r=t.timelineStart;if(t.appendInPlace){var a;const e=this.playingItem;this.isInterstitial(e)||(null==e||null==(a=e.nextEvent)?void 0:a.identifier)!==t.identifier||this.flushFrontBuffer(r+.25)}let s,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!t.cue.pre&&!t.cue.post){const t=o-r;t>0&&(s=Math.round(1e3*t)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${i?1:n} ${t}${s?` live-start: ${o} start-offset: ${s}`:""}`),i)return this.createAsset(t,0,0,r,t.duration,i);const l=this.assetListLoader.loadAssetList(t,s);l&&(t.assetListLoader=l)}else if(!s&&n){for(let i=e;i<n;i++){const e=t.assetList[i],n=this.getAssetPlayerQueueIndex(e.identifier);-1!==n&&!this.playerQueue[n].destroyed||e.error||this.createAssetPlayer(t,e,i)}return this.getAssetPlayer(t.assetList[e].identifier)}return null}flushFrontBuffer(t){const e=this.requiredTracks;if(!e)return;this.log(`Removing front buffer starting at ${t}`);Object.keys(e).forEach((e=>{this.hls.trigger(nn.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:e})}))}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let i=0;i<e.length;i++)if(t===e[i].assetId)return i;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e)for(let i=0;i<t.length;i++)if(t[i].media===e)return t[i];return null}createAsset(t,e,i,n,r,s){const a={parentIdentifier:t.identifier,identifier:qc(t,s,e),duration:r,startOffset:i,timelineStart:n,uri:s};return this.createAssetPlayer(t,a,e)}createAssetPlayer(t,e,i){this.log(`create HLSAssetPlayer for ${Kc(e)}`);const n=this.hls,r=n.userConfig;let s=r.videoPreference;const a=n.loadLevelObj||n.levels[n.currentLevel];(s||a)&&(s=pn({},s),a.videoCodec&&(s.videoCodec=a.videoCodec),a.videoRange&&(s.allowedVideoRanges=[a.videoRange]));const o=n.audioTracks[n.audioTrack],l=n.subtitleTracks[n.subtitleTrack];let c=0;if(this.primaryLive||t.appendInPlace){const t=this.timelinePos-e.timelineStart;if(t>1){const i=e.duration;i&&t<i&&(c=t)}}const u=e.identifier,h=mn(mn({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:u,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:o||r.audioPreference,subtitlePreference:l||r.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(h.timelineOffset=e.timelineStart));const d=h.cmcd;null!=d&&d.sessionId&&d.contentId&&(h.cmcd=pn({},d,{contentId:$c(e.uri)})),this.getAssetPlayer(u)&&this.warn(`Duplicate date range identifier ${t} and asset ${u}`);const f=new Yc(this.HlsPlayerClass,h,t,e);this.playerQueue.push(f),t.assetList[i]=e;const p=n=>{if(n.live){const e=new Error(`Interstitials MUST be VOD assets ${t}`),n={fatal:!0,type:tn.OTHER_ERROR,details:en.INTERSTITIAL_ASSET_ITEM_ERROR,error:e};return void this.handleAssetItemError(n,t,this.schedule.findEventIndex(t.identifier),i,e.message)}const r=n.edge-n.fragmentStart,s=e.duration;(null===s||r>s)&&(this.log(`Interstitial asset "${u}" duration change ${s} > ${r}`),e.duration=r,this.updateSchedule())};f.on(nn.LEVEL_UPDATED,((t,e)=>{let{details:i}=e;return p(i)})),f.on(nn.LEVEL_PTS_UPDATED,((t,e)=>{let{details:i}=e;return p(i)}));const g=(t,e)=>{const i=this.getAssetPlayer(u);if(i&&e.tracks){i.off(nn.BUFFER_CODECS,g),i.tracks=e.tracks;const t=this.primaryMedia;this.bufferingAsset===i.assetItem&&t&&!i.media&&this.bufferAssetPlayer(i,t)}};f.on(nn.BUFFER_CODECS,g);const m=()=>{var i;const n=this.getAssetPlayer(u);if(this.log(`buffered to end of asset ${n}`),!n)return;const r=this.schedule.findEventIndex(t.identifier),s=t.findAssetIndex(e),a=s+1,o=null==(i=this.schedule.items)?void 0:i[r];if(this.isInterstitial(o))if(-1===s||t.isAssetPastPlayoutLimit(a)||t.assetList[a].error){var l;const t=null==(l=this.schedule.items)?void 0:l[r+1];t&&this.bufferedToItem(t)}else this.bufferedToItem(o,a)};f.on(nn.BUFFERED_TO_END,m);const v=e=>()=>{if(!this.getAssetPlayer(u))return;this.shouldPlay=!0;const i=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,i,e)};return f.once(nn.MEDIA_ENDED,v(i)),f.once(nn.PLAYOUT_LIMIT_REACHED,v(1/0)),f.on(nn.ERROR,((e,n)=>{const r=this.getAssetPlayer(u);if(n.details!==en.BUFFER_STALLED_ERROR)this.handleAssetItemError(n,t,this.schedule.findEventIndex(t.identifier),i,`Asset player error ${n.error} ${t}`);else if(null!=r&&r.media){const e=r.currentTime,i=r.duration-e;e&&t.appendInPlace&&i/r.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${u} ${t} at ${r.media.currentTime}`),m()):(this.warn(`Stalled at ${e} of ${e+i} in asset ${u} ${t}`),this.onTimeupdate(),this.checkBuffer(!0))}})),f.on(nn.DESTROYING,(()=>{if(!this.getAssetPlayer(u))return;const e=new Error(`Asset player destroyed unexpectedly ${u}`),n={fatal:!0,type:tn.OTHER_ERROR,details:en.INTERSTITIAL_ASSET_ITEM_ERROR,error:e};this.handleAssetItemError(n,t,this.schedule.findEventIndex(t.identifier),i,e.message)})),this.hls.trigger(nn.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:i,event:t,player:f}),f}clearInterstitial(t,e){t.assetList.forEach((t=>{this.clearAssetPlayer(t.identifier,e)})),t.reset()}clearAssetPlayer(t,e){const i=this.getAssetPlayerQueueIndex(t);if(-1!==i){this.log(`clearAssetPlayer "${t}" toSegment: ${e?Qc(e):e}`);const n=this.playerQueue[i];this.transferMediaFromPlayer(n,e),this.playerQueue.splice(i,1),n.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,i,n,r){const{interstitial:s,assetItem:a,assetId:o}=t,l=s.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,c&&c.identifier===o||(c&&(this.clearAssetPlayer(c.identifier,i[n]),delete c.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${l} ${t}`),this.hls.trigger(nn.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:e,event:s,schedule:i.slice(0),scheduleIndex:n,player:t})),this.bufferAssetPlayer(t,r)}bufferAssetPlayer(t,e){var i,n;const{interstitial:r,assetItem:s,assetId:a}=t,o=this.schedule.findEventIndex(r.identifier),l=null==(i=this.schedule.items)?void 0:i[o];if(!l)return;this.setBufferingItem(l),this.bufferingAsset=s;const c=this.getBufferingPlayer();if(c===t)return;const u=r.appendInPlace;if(u&&!1===(null==c?void 0:c.interstitial.appendInPlace))return;const h=(null==c?void 0:c.tracks)||(null==(n=this.detachedData)?void 0:n.tracks)||this.requiredTracks;if(u&&s!==this.playingAsset){if(!t.tracks)return;if(h&&!Tn(h,t.tracks)){const e=new Error(`Asset "${a}" SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(h)}')`),i={fatal:!0,type:tn.OTHER_ERROR,details:en.INTERSTITIAL_ASSET_ITEM_ERROR,error:e},n=r.findAssetIndex(s);return void this.handleAssetItemError(i,r,o,n,e.message)}}this.transferMediaTo(t,e)}handleAssetItemError(t,e,i,n,r){if(t.details===en.BUFFER_STALLED_ERROR)return;const s=e.assetList[n]||null;let a=null;if(s){const t=this.getAssetPlayerQueueIndex(s.identifier);a=this.playerQueue[t]||null}const o=this.schedule.items,l=pn({},t,{fatal:!1,errorAction:ms(!0),asset:s,assetListIndex:n,event:e,schedule:o,scheduleIndex:i,player:a});if(this.warn(`Asset item error: ${t.error}`),this.hls.trigger(nn.INTERSTITIAL_ASSET_ERROR,l),!t.fatal)return;const c=new Error(r);s&&(this.playingAsset!==s&&this.clearAssetPlayer(s.identifier,null),s.error=c),e.assetList.some((t=>!t.error))?e.appendInPlace&&(e.error=c):e.error=c,this.primaryFallback(e)}primaryFallback(t){const e=t.timelineStart,i=this.effectivePlayingItem;if(this.updateSchedule(),i){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${i?Qc(i):"<none>"} error: ${t.error}`),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e));let n=this.timelinePos;-1===n&&(n=this.hls.startPosition);const r=this.updateItem(i,n);if(this.itemsMatch(i,r))this.clearInterstitial(t,null);else{const t=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(t)}}else this.checkStart()}onAssetListLoaded(t,e){var i;const n=e.event,r=n.identifier,s=e.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;const a=n.timelineStart,o=n.duration;let l=0;s.forEach(((t,e)=>{const i=parseFloat(t.DURATION);this.createAsset(n,e,l,a+l,i,t.URI),l+=i})),n.duration=l,this.log(`Loaded asset-list with duration: ${l} (was: ${o}) ${n}`);const c=this.waitingItem,u=(null==c?void 0:c.event.identifier)===r;this.updateSchedule();const h=null==(i=this.bufferingItem)?void 0:i.event;if(u){var d;const t=this.schedule.findEventIndex(r),e=null==(d=this.schedule.items)?void 0:d[t];if(e){if(!this.playingItem&&this.timelinePos>e.end){if(this.schedule.findItemIndexAtTime(this.timelinePos)!==t)return n.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${n}`),void this.primaryFallback(n)}this.setBufferingItem(e)}this.setSchedulePosition(t)}else if((null==h?void 0:h.identifier)===r&&h.appendInPlace){const t=n.assetList[0],e=this.getAssetPlayer(t.identifier),i=this.primaryMedia;t&&e&&i&&this.bufferAssetPlayer(e,i)}}onError(t,e){switch(e.details){case en.ASSET_LIST_PARSING_ERROR:case en.ASSET_LIST_LOAD_ERROR:case en.ASSET_LIST_LOAD_TIMEOUT:{const t=e.interstitial;t&&this.primaryFallback(t);break}case en.BUFFER_STALLED_ERROR:this.onTimeupdate(),this.checkBuffer(!0)}}}});function sh(t){return t&&"object"===typeof t?Array.isArray(t)?t.map(sh):Object.keys(t).reduce(((e,i)=>(e[i]=sh(t[i]),e)),{}):t}function ah(t,e){const i=t.loader;if(i!==Zu&&i!==nh)e.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(Bw){}return!1})()&&(t.loader=Zu,t.progressive=!0,t.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class oh extends Ms{constructor(t,e){super("gap-controller",t.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var t;null!=(t=this.media)&&t.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var t;this.hls&&(this.ended=(null==(t=this.media)?void 0:t.currentTime)||1,this.hls.trigger(nn.MEDIA_ENDED,{stalled:!1}))},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(100),this.mediaSource=e.mediaSource;const i=this.media=e.media;Zc(i,"playing",this.onMediaPlaying),Zc(i,"waiting",this.onMediaWaiting),Zc(i,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:i}=this;i&&(tu(i,"playing",this.onMediaPlaying),tu(i,"waiting",this.onMediaWaiting),tu(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(null==(t=this.media)||!t.readyState||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var i,n;const r=null==(i=this.hls)?void 0:i.config;if(!r)return;const{media:s,stalled:a}=this;if(!s)return;const{seeking:o}=s,l=this.seeking&&!o,c=!this.seeking&&o,u=s.paused&&!o||s.ended||0===s.playbackRate;if(this.seeking=o,t!==e)return e&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!u&&t>e&&this.nudgeOnVideoHole(t,e)),void(0===this.waiting&&this.stallResolved(t));if(c||l)return void(l&&this.stallResolved(t));if(u)return this.nudgeRetry=0,this.stallResolved(t),void(!this.ended&&s.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(nn.MEDIA_ENDED,{stalled:!1})));if(!Us.getBuffered(s).length)return void(this.nudgeRetry=0);const h=Us.bufferInfo(s,t,0),d=h.nextStart||0,f=this.fragmentTracker;if(o&&f&&this.hls){const e=lh(this.hls.inFlightFragments,t),i=h.len>2,n=!d||e||d-t>2&&!f.getPartialFragment(t);if(i||n)return;this.moved=!1}const p=null==(n=this.hls)?void 0:n.latestLevelDetails;if(!this.moved&&null!==this.stalled&&f){if(!(h.len>0)&&!d)return;const e=Math.max(d,h.start||0)-t,i=!(null==p||!p.live)?2*p.targetduration:2,n=f.getPartialFragment(t);if(e>0&&(e<=i||n))return void(s.paused||this._trySkipBufferHole(n))}const g=r.detectStallWithCurrentTimeMs,m=self.performance.now(),v=this.waiting;if(null===a)return void(this.stalled=v>0&&m-v<g?v:m);const y=m-a;if(!o&&(y>=g||v)&&this.hls){var b;if("ended"===(null==(b=this.mediaSource)?void 0:b.readyState)&&(null==p||!p.live)&&Math.abs(t-((null==p?void 0:p.edge)||0))<1){if(this.ended)return;return this.ended=t||1,void this.hls.trigger(nn.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(h),!this.media||!this.hls)return}const S=Us.bufferInfo(s,t,r.maxBufferHole);this._tryFixBufferStall(S,y)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(nn.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var i;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(i=this.buffered.audio)&&i.length&&n&&n.length>1&&t>n.end(0)){const i=Us.bufferedInfo(Us.timeRangesToArray(this.buffered.audio),t,0);if(i.len>1&&e>=i.start){const i=Us.timeRangesToArray(n),r=Us.bufferedInfo(i,e,0).bufferedIndex;if(r>-1&&r<i.length-1){const e=Us.bufferedInfo(i,t,0).bufferedIndex,n=i[r].end,s=i[r+1].start;if((-1===e||e>r)&&s-n<1&&t-n<2){const i=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${n} -> ${s} buffered index: ${e}`);this.warn(i.message),this.media.currentTime+=1e-6;const r=this.fragmentTracker.getPartialFragment(t)||void 0,a=Us.bufferInfo(this.media,t,0);this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:i,reason:i.message,frag:r,buffer:a.len,bufferInfo:a})}}}}}_tryFixBufferStall(t,e){var i,n;const{fragmentTracker:r,media:s}=this,a=null==(i=this.hls)?void 0:i.config;if(!s||!r||!a)return;const o=s.currentTime,l=null==(n=this.hls)?void 0:n.latestLevelDetails,c=r.getPartialFragment(o);if(c||null!=l&&l.live&&o<l.fragmentStart){if(this._trySkipBufferHole(c)||!this.media)return}const u=t.buffered;(u&&u.length>1&&t.len>a.maxBufferHole||t.nextStart&&t.nextStart-o<a.maxBufferHole)&&(e>1e3*a.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}_reportStall(t){const{hls:e,media:i,stallReported:n,stalled:r}=this;if(!n&&null!==r&&i&&e){this.stallReported=!0;const n=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${qr(t)})`);this.warn(n.message),e.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:t.len,bufferInfo:t,stalled:{start:r}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:i,media:n}=this,r=null==(e=this.hls)?void 0:e.config;if(!n||!i||!r)return 0;const s=n.currentTime,a=Us.bufferInfo(n,s,0),o=s<a.start?a.start:a.nextStart;if(o&&this.hls){const e=a.len<=r.maxBufferHole,c=a.len>0&&a.len<1&&n.readyState<3,u=o-s;if(u>0&&(e||c)){if(u>r.maxBufferHole){let e=!1;if(0===s){const t=i.getAppendedFrag(0,ln);t&&o<t.end&&(e=!0)}if(!e){const e=t||i.getAppendedFrag(s,ln);if(e){var l;if(null==(l=this.hls.loadLevelObj)||!l.details)return 0;if(lh(this.hls.inFlightFragments,o))return 0;let t=!1,n=e.end;for(;n<o;){const e=i.getPartialFragment(n);if(!e){t=!0;break}n+=e.duration}if(t)return 0}}}const e=Math.max(o+.05,s+.1);if(this.warn(`skipping hole, adjusting currentTime from ${s} to ${e}`),this.moved=!0,n.currentTime=e,null==t||!t.gap){const i=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${e}`);this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:i,reason:i.message,frag:t||void 0,buffer:a.len,bufferInfo:a})}return e}}return 0}_tryNudgeBuffer(t){const{hls:e,media:i,nudgeRetry:n}=this,r=null==e?void 0:e.config;if(!i||!r)return 0;const s=i.currentTime;if(this.nudgeRetry++,n<r.nudgeMaxRetry){const a=s+(n+1)*r.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);this.warn(o.message),i.currentTime=a,e.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:t.len,bufferInfo:t})}else{const i=new Error(`Playhead still not moving while enough data buffered @${s} after ${r.nudgeMaxRetry} nudges`);this.error(i.message),e.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.BUFFER_STALLED_ERROR,error:i,fatal:!0,buffer:t.len,bufferInfo:t})}}}function lh(t,e){const i=ch(t.main);if(i&&i.start<=e)return i;const n=ch(t.audio);return n&&n.start<=e?n:null}function ch(t){if(!t)return null;switch(t.state){case io:case eo:case co:case uo:return null}return t.frag}function uh(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function hh(t,e,i,n,r){let s=new t(e,i,"");try{s.value=n,r&&(s.type=r)}catch(Bw){s=new t(e,i,qr(r?mn({type:r},n):n))}return s}const dh=(()=>{const t=uh();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch(Bw){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class fh{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(nn.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t.on(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(nn.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:t}=this;t.off(nn.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(nn.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(nn.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(t,e){var i;this.media=e.media,!1===(null==(i=e.overrides)?void 0:i.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){const t=this.hls.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(t,e){this.media=null;!!e.transferMedia||(this.id3Track&&(this.removeCues&&Bc(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if("metadata"===i.kind&&"id3"===i.label)return Mc(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:n}}}=this;if(!i&&!n)return;const{samples:r}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=uh();if(s)for(let a=0;a<r.length;a++){const t=r[a].type;if(t===Go.emsg&&!i||!n)continue;const e=$o(r[a].data);if(e){const i=r[a].pts;let n=i+r[a].duration;n>dh&&(n=dh);n-i<=0&&(n=i+.25);for(let r=0;r<e.length;r++){const a=e[r];if(!zo(a)){this.updateId3CueEnds(i,t);const e=hh(s,i,n,a,t);e&&this.id3Track.addCue(e)}}}}}updateId3CueEnds(t,e){var i;const n=null==(i=this.id3Track)?void 0:i.cues;if(n)for(let r=n.length;r--;){const i=n[r];i.type===e&&i.startTime<t&&i.endTime===dh&&(i.endTime=t)}}onBufferFlushing(t,e){let{startOffset:i,endOffset:n,type:r}=e;const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let t;t="audio"===r?t=>t.type===Go.audioId3&&l:"video"===r?t=>t.type===Go.emsg&&o:t=>t.type===Go.audioId3&&l||t.type===Go.emsg&&o,Uc(s,i,n,t)}}onLevelUpdated(t,e){let{details:i}=e;this.updateDateRangeCues(i,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:i}=this,{dateRanges:n}=t,r=Object.keys(n);let s=this.dateRangeCuesAppended;var a;if(i&&e)if(null!=(a=i.cues)&&a.length){const t=Object.keys(s).filter((t=>!r.includes(t)));for(let e=t.length;e--;){const n=t[e],r=s[n].cues;delete s[n],Object.keys(r).forEach((t=>{try{const e=r[t];e.removeEventListener("enter",this.onEventCueEnter),i.removeCue(e)}catch(Bw){}}))}}else s=this.dateRangeCuesAppended={};const o=t.fragments[t.fragments.length-1];if(0===r.length||!Qi(null==o?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=uh();for(let h=0;h<r.length;h++){const t=r[h],e=n[t],i=e.startTime,a=s[t],o=(null==a?void 0:a.cues)||{};let d=(null==a?void 0:a.durationKnown)||!1,f=dh;const{duration:p,endDate:g}=e;if(g&&null!==p)f=i+p,d=!0;else if(e.endOnNext&&!d){const t=r.reduce(((t,i)=>{if(i!==e.id){const r=n[i];if(r.class===e.class&&r.startDate>e.startDate&&(!t||e.startDate<t.startDate))return r}return t}),null);t&&(f=t.startTime,d=!0)}const m=Object.keys(e.attr);for(let n=0;n<m.length;n++){const r=m[n];if("ID"===(u=r)||"CLASS"===u||"CUE"===u||"START-DATE"===u||"DURATION"===u||"END-DATE"===u||"END-ON-NEXT"===u)continue;const s=o[r];if(s)d&&!a.durationKnown?s.endTime=f:Math.abs(s.startTime-i)>.01&&(s.startTime=i,s.endTime=f);else if(l){let n=e.attr[r];Ks(r)&&(c=n,n=Uint8Array.from(c.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);const s=hh(l,i,f,{key:r,data:n},Go.dateRange);s&&(s.id=t,this.id3Track.addCue(s),o[r]=s,this.hls.config.interstitialsController&&("X-ASSET-LIST"!==r&&"X-ASSET-URL"!==r||s.addEventListener("enter",this.onEventCueEnter)))}}s[t]={cues:o,dateRange:e,durationKnown:d}}var c,u}}class ph{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,e=this.levelDetails;if(!t||!e)return;this.currentTime=t.currentTime;const i=this.computeLatency();if(null===i)return;this._latency=i;const{lowLatencyMode:n,maxLiveSyncPlaybackRate:r}=this.config;if(!n||1===r||!e.live)return;const s=this.targetLatency;if(null===s)return;const a=i-s;if(a<Math.min(this.maxLatency,s+e.targetduration)&&a>.05&&this.forwardBufferLength>1){const e=Math.min(2,Math.max(1,r)),i=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20,n=Math.min(e,Math.max(1,i));this.changeMediaPlaybackRate(t,n)}else 1!==t.playbackRate&&0!==t.playbackRate&&this.changeMediaPlaybackRate(t,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return(null==(t=this.hls)?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(void 0!==t.liveMaxLatencyDuration)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(null===t||null===this.hls)return null;const{holdBack:e,partHoldBack:i,targetduration:n}=t,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&i||e;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*n);const c=n;return l+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(null===t||null===e)return null;const i=this.levelDetails;if(null===i)return null;const n=i.edge,r=t-e-this.edgeStalled,s=n-i.totalduration,a=n-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const t=this.levelDetails;return null===t?1:t.drift}get edgeStalled(){const t=this.levelDetails;if(null===t)return 0;const e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(nn.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(nn.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(nn.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(nn.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,e){let{details:i}=e;i.advanced&&this.onTimeupdate(),!i.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var i;e.details===en.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(i=this.levelDetails)&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var i,n;t.playbackRate!==e&&(null==(i=this.hls)||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(n=this.targetLatency)?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return null===t?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}class gh extends Gl{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.on(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(nn.FRAG_BUFFERED,this.onFragBuffered,this),t.on(nn.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.off(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(nn.FRAG_BUFFERED,this.onFragBuffered,this),t.off(nn.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((t=>{t.loadError=0,t.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const i=this.hls.config.preferManagedMediaSource,n=[],r={},s={};let a=!1,o=!1,l=!1;e.levels.forEach((t=>{var e;const c=t.attrs;let{audioCodec:u,videoCodec:h}=t;u&&(t.audioCodec=u=Lr(u,i)||void 0),0===(null==(e=h)?void 0:e.indexOf("avc1"))&&(h=t.videoCodec=function(t){const e=t.split(",");for(let i=0;i<e.length;i++){const t=e[i].split(".");if(t.length>2){let n=t.shift()+".";n+=parseInt(t.shift()).toString(16),n+=("000"+parseInt(t.shift()).toString(16)).slice(-4),e[i]=n}}return e.join(",")}(h));const{width:d,height:f,unknownCodecs:p}=t;let g=p?p.length:0;if(p)for(let i=g;i--;){const e=p[i];this.isAudioSupported(e)?(t.audioCodec=u=u?`${u},${e}`:e,g--,gr.audio[u.substring(0,4)]=2):this.isVideoSupported(e)&&(t.videoCodec=h=h?`${h},${e}`:e,g--,gr.video[h.substring(0,4)]=2)}if(a||(a=!(!d||!f)),o||(o=!!h),l||(l=!!u),g||u&&!this.isAudioSupported(u)||h&&!this.isVideoSupported(h))return void this.log(`Some or all CODECS not supported "${c.CODECS}"`);const{CODECS:m,"FRAME-RATE":v,"HDCP-LEVEL":y,"PATHWAY-ID":b,RESOLUTION:S,"VIDEO-RANGE":w}=c,x=`${`${b||"."}-`}${t.bitrate}-${S}-${v}-${m}-${w}-${y}`;if(r[x])if(r[x].uri===t.url||t.attrs["PATHWAY-ID"])r[x].addGroupId("audio",c.AUDIO),r[x].addGroupId("text",c.SUBTITLES);else{const e=s[x]+=1;t.attrs["PATHWAY-ID"]=new Array(e+1).join(".");const i=this.createLevel(t);r[x]=i,n.push(i)}else{const e=this.createLevel(t);r[x]=e,s[x]=1,n.push(e)}})),this.filterAndSortMediaOptions(n,e,a,o,l)}createLevel(t){const e=new $r(t),i=t.supplemental;if(null!=i&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const t=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(t.message),e.supportedResult=Rr(t,[])}return e}isAudioSupported(t){return vr(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return vr(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,i,n,r){let s=[],a=[],o=t;if((i||n)&&r&&(o=o.filter((t=>{let{videoCodec:e,videoRange:i,width:n,height:r}=t;return(!!e||!(!n||!r))&&(!!(s=i)&&Or.indexOf(s)>-1);var s}))),0===o.length)return void Promise.resolve().then((()=>{if(this.hls){let t="no level with compatible codecs found in manifest",i=t;e.levels.length&&(i=`one or more CODECS in variant not supported: ${qr(e.levels.map((t=>t.attrs.CODECS)).filter(((t,e,i)=>i.indexOf(t)===e)))}`,this.warn(i),t+=` (${i})`);const n=new Error(t);this.hls.trigger(nn.ERROR,{type:tn.MEDIA_ERROR,details:en.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:n,reason:i})}}));e.audioTracks&&(s=e.audioTracks.filter((t=>!t.audioCodec||this.isAudioSupported(t.audioCodec))),mh(s)),e.subtitles&&(a=e.subtitles,mh(a));const l=o.slice(0);o.sort(((t,e)=>{if(t.attrs["HDCP-LEVEL"]!==e.attrs["HDCP-LEVEL"])return(t.attrs["HDCP-LEVEL"]||"")>(e.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&t.height!==e.height)return t.height-e.height;if(t.frameRate!==e.frameRate)return t.frameRate-e.frameRate;if(t.videoRange!==e.videoRange)return Or.indexOf(t.videoRange)-Or.indexOf(e.videoRange);if(t.videoCodec!==e.videoCodec){const i=Sr(t.videoCodec),n=Sr(e.videoCodec);if(i!==n)return n-i}if(t.uri===e.uri&&t.codecSet!==e.codecSet){const i=wr(t.codecSet),n=wr(e.codecSet);if(i!==n)return n-i}return t.averageBitrate!==e.averageBitrate?t.averageBitrate-e.averageBitrate:0}));let c=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==l.length))for(let g=0;g<l.length;g++)if(l[g].pathwayId===o[0].pathwayId){c=l[g];break}this._levels=o;for(let g=0;g<o.length;g++)if(o[g]===c){var u;this._firstLevel=g;const t=c.bitrate,e=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${t}`),void 0===(null==(u=this.hls.userConfig)?void 0:u.abrEwmaDefaultEstimate)){const i=Math.min(t,this.hls.config.abrEwmaDefaultEstimateMax);i>e&&e===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=i)}break}const h=r&&!n,d=this.hls.config,f=!(!d.audioStreamController||!d.audioTrackController),p={levels:o,audioTracks:s,subtitleTracks:a,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:r,video:n,altAudio:f&&!h&&s.some((t=>!!t.url))};this.hls.trigger(nn.MANIFEST_PARSED,p)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(0===e.length)return;if(t<0||t>=e.length){const i=new Error("invalid level idx"),n=t<0;if(this.hls.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.LEVEL_SWITCH_ERROR,level:t,fatal:n,error:i,reason:i.message}),n)return;t=Math.min(t,e.length-1)}const i=this.currentLevelIndex,n=this.currentLevel,r=n?n.attrs["PATHWAY-ID"]:void 0,s=e[t],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=s,i===t&&n&&r===a)return;this.log(`Switching to level ${t} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${a?" with Pathway "+a:""} from level ${i}${r?" with Pathway "+r:""}`);const o={level:t,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(nn.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const t=this.switchParams(s.uri,null==n?void 0:n.details,l);this.loadPlaylist(t)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(void 0===this._startLevel){const t=this.hls.config.startLevel;return void 0!==t?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),i=t.filter((t=>-1!==e.indexOf(t)));if(t.length<1)return void this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);this.steering.pathwayPriority=i}}onError(t,e){!e.fatal&&e.context&&e.context.type===sn&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,e){let{frag:i}=e;if(void 0!==i&&i.type===ln){const t=i.elementaryStreams;if(!Object.keys(t).some((e=>!!t[e])))return;const e=this._levels[i.level];null!=e&&e.loadError&&(this.log(`Resetting level error count of ${e.loadError} on frag buffered`),e.loadError=0)}}onLevelLoaded(t,e){var i;const{level:n,details:r}=e,s=e.levelInfo;var a;if(!s)return this.warn(`Invalid level index ${n}`),void(null!=(a=e.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));if(s===this.currentLevel||e.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let t=s.details;t===e.details&&t.advanced&&(t=void 0),this.playlistLoaded(n,e,t)}else null!=(i=e.deliveryDirectives)&&i.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const i=this.getUrlWithDirectives(t.uri,e),n=this.currentLevelIndex,r=t.attrs["PATHWAY-ID"],s=t.details,a=null==s?void 0:s.age;this.log(`Loading level index ${n}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""}${r?" Pathway "+r:""}${a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""} ${i}`),this.hls.trigger(nn.LEVEL_LOADING,{url:i,level:n,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(1===this._levels.length)return;const i=this._levels.filter(((e,i)=>i!==t||(this.steering&&this.steering.removeLevel(e),e===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,e.details&&e.details.fragments.forEach((t=>t.level=-1))),!1)));Ka(i),this._levels=i,this.currentLevelIndex>-1&&null!=(e=this.currentLevel)&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=i.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(nn.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,e){let{levels:i}=e;this._levels=i}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(nn.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function mh(t){const e={};t.forEach((t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++}))}function vh(){return self.SourceBuffer||self.WebKitSourceBuffer}function yh(){if(!Ln())return!1;const t=vh();return!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove}class bh extends po{constructor(t,e,i){super(t,e,i,"stream-controller",ln),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const t=this.media,e=t?t.currentTime:null;if(null===e||!Qi(e))return;if(this.log(`Media seeked to ${e.toFixed(3)}`),!this.getBufferedFrag(e))return;const i=this.getFwdBufferInfoAtPos(t,e,ln,0);null!==i&&0!==i.len?this.tick():this.warn(`Main forward buffer length at ${e} on "seeked" event ${i?i.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.on(nn.LEVEL_LOADING,this.onLevelLoading,this),t.on(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.on(nn.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(nn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(nn.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(nn.BUFFER_CREATED,this.onBufferCreated,this),t.on(nn.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(nn.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(nn.MANIFEST_PARSED,this.onManifestParsed,this),t.off(nn.LEVEL_LOADED,this.onLevelLoaded,this),t.off(nn.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(nn.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(nn.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(nn.BUFFER_CREATED,this.onBufferCreated,this),t.off(nn.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(nn.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(nn.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:i,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let t=n.startLevel;-1===t&&(n.config.testBandwidth&&this.levels.length>1?(t=0,this.bitrateTest=!0):t=n.firstAutoLevel),n.nextLoadLevel=t,this.level=n.loadLevel,this._hasEnoughToStart=!!e}i>0&&-1===t&&!e&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state=io,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=eo}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case fo:{const{levels:t,level:e}=this,i=null==t?void 0:t[e],n=null==i?void 0:i.details;if(n&&(!n.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(n))break;this.state=io;break}if(this.hls.nextLoadLevel!==this.level){this.state=io;break}break}case so:{var t;const e=self.performance.now(),i=this.retryDate;if(!i||e>=i||null!=(t=this.media)&&t.seeking){const{levels:t,level:e}=this,i=null==t?void 0:t[e];this.resetStartWhenNotLoaded(i||null),this.state=io}}}this.state===io&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),null!=(t=this.media)&&t.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:i,media:n}=this;if(null===e||!n&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?t.nextLoadLevel:t.loadLevel;if(null==i||!i[r])return;const s=i[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const t={};return 2===this.altAudio&&(t.type="video"),this.hls.trigger(nn.BUFFER_EOS,t),void(this.state=co)}if(!this.buffering)return;t.loadLevel!==r&&-1===t.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=t.nextLoadLevel=r;const l=s.details;if(!l||this.state===fo||this.waitForLive(s))return this.level=r,this.state=fo,void(this.startFragRequested=!1);const c=a.len,u=this.getMaxBufferLength(s.maxBitrate);if(c>=u)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:a.end;let d=this.getNextFragment(h,l);if(this.couldBacktrack&&!this.fragPrevious&&d&&Fn(d)&&this.fragmentTracker.getState(d)!==Ss){var f;const t=(null!=(f=this.backtrackFragment)?f:d).sn-l.startSN,e=l.fragments[t-1];e&&d.cc===e.cc&&(d=e,this.fragmentTracker.removeFragment(e))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(d&&this.isLoopLoading(d,h)){if(!d.gap){const t=this.audioOnly&&!this.altAudio?Dn:Nn,e=(t===Nn?this.videoBuffer:this.mediaBuffer)||this.media;e&&this.afterBufferFlushed(e,t,ln)}d=this.getNextFragmentLoopLoading(d,l,a,ln,u)}d&&(!d.initSegment||d.initSegment.data||this.bitrateTest||(d=d.initSegment),this.loadFragment(d,s,h))}loadFragment(t,e,i){const n=this.fragmentTracker.getState(t);n===vs||n===bs?Fn(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,i):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,ln)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(null!=e&&e.readyState){let i;const n=this.getAppendedFrag(e.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const t=this.getMainFwdBufferInfo();if(!t||t.len<2*r.targetduration)return}if(!e.paused&&t){const e=t[this.hls.nextLoadLevel],n=this.fragLastKbps;i=n&&this.fragCurrent?this.fragCurrent.duration*e.maxBitrate/(1e3*n)+1:0}else i=0;const s=this.getBufferedFrag(e.currentTime+i);if(s){const t=this.followingBufferedFrag(s);if(t){this.abortCurrentFrag();const e=t.maxStartPTS?t.maxStartPTS:t.start,i=t.duration,n=Math.max(s.end,e+Math.min(Math.max(i-this.config.maxFragLookUpTolerance,i*(this.couldBacktrack?.5:.125)),i*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(n,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case no:case ro:case so:case oo:case lo:this.state=io}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,2===this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;Zc(i,"playing",this.onMediaPlaying),Zc(i,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:i}=this;i&&(tu(i,"playing",this.onMediaPlaying),tu(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e);!!e.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(nn.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let i=!1,n=!1;e.levels.forEach((t=>{const e=t.audioCodec;e&&(i=i||-1!==e.indexOf("mp4a.40.2"),n=n||-1!==e.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=i&&n&&!function(){var t;const e=vh();return"function"===typeof(null==e||null==(t=e.prototype)?void 0:t.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||this.state!==io)return;const n=e.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=fo)}onLevelLoaded(t,e){var i;const{levels:n,startFragRequested:r}=this,s=e.level,a=e.details,o=a.totalduration;if(!n)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=e.levelInfo,c=this.fragCurrent;!c||this.state!==ro&&this.state!==so||c.level!==e.level&&c.loader&&this.abortCurrentFrag();let u=0;if(a.live||null!=(i=l.details)&&i.live){var h;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,l.details,null==(h=this.levelLastLoaded)?void 0:h.details)}if(l.details=a,this.levelLastLoaded=l,r||this.setStartPosition(a,u),this.hls.trigger(nn.LEVEL_UPDATED,{details:a,level:s}),this.state===fo){if(this.waitForCdnTuneIn(a))return;this.state=io}r&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const n=this.hls.liveSyncPosition,r=this.getLoadPosition(),s=t.fragmentStart,a=t.edge,o=r>=s-e.maxFragLookUpTolerance&&r<=a;if(null!==n&&i.duration>n&&(r<n||!o)){const s=void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;(!o&&i.readyState<4||r<a-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),i.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${n.toFixed(3)}`),i.currentTime=n))}}_handleFragmentLoadProgress(t){var e;const i=t.frag,{part:n,payload:r}=t,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const a=s[i.level];if(!a)return void this.warn(`Level ${i.level} not found on progress`);const o=a.details;if(!o)return this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),void this.fragmentTracker.removeFragment(i);const l=a.videoCodec,c=o.PTSKnown||!o.live,u=null==(e=i.initSegment)?void 0:e.data,h=this._getAudioCodec(a),d=this.transmuxer=this.transmuxer||new ql(this.hls,ln,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=n?n.index:-1,p=-1!==f,g=new Fs(i.level,i.sn,i.stats.chunkCount,r.byteLength,f,p),m=this.initPTS[i.cc];d.push(r,u,h,l,i,n,o.totalduration,c,g,m)}onAudioTrackSwitching(t,e){const i=this.hls,n=2===this.altAudio;if(Jr(e.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const t=this.fragCurrent;t&&(this.log("Switching to main audio track, cancel main fragment load"),t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n)return this.fragmentTracker.removeAllFragments(),i.once(nn.BUFFER_FLUSHED,(()=>{var t;null==(t=this.hls)||t.trigger(nn.AUDIO_TRACK_SWITCHED,e)})),void i.trigger(nn.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});i.trigger(nn.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const i=Jr(e.url,this.hls);if(i){const t=this.videoBuffer;t&&this.mediaBuffer!==t&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t)}this.altAudio=i?2:0,this.tick()}onBufferCreated(t,e){const i=e.tracks;let n,r,s=!1;for(const a in i){const t=i[a];if("main"===t.id){if(r=a,n=t,"video"===a){const t=i[a];t&&(this.videoBuffer=t.buffer)}}else s=!0}s&&n?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:n}=e,r=i.type===ln;if(r){if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===lo&&(this.state=io));const t=n?n.stats:i.stats;this.fragLastKbps=Math.round(8*t.total/(t.buffering.end-t.loading.first)),Fn(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,n)}const s=this.media;s&&(!this._hasEnoughToStart&&Us.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var i;if(e.fatal)this.state=uo;else switch(e.details){case en.FRAG_GAP:case en.FRAG_PARSING_ERROR:case en.FRAG_DECRYPT_ERROR:case en.FRAG_LOAD_ERROR:case en.FRAG_LOAD_TIMEOUT:case en.KEY_LOAD_ERROR:case en.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ln,e);break;case en.LEVEL_LOAD_ERROR:case en.LEVEL_LOAD_TIMEOUT:case en.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==fo||(null==(i=e.context)?void 0:i.type)!==sn||(this.state=io);break;case en.BUFFER_ADD_CODEC_ERROR:case en.BUFFER_APPEND_ERROR:if("main"!==e.parent)return;this.resetLoadingState();break;case en.BUFFER_FULL_ERROR:if("main"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case en.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onFragLoadEmergencyAborted(){this.state=io,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,e){let{type:i}=e;if(i!==Dn||!this.altAudio){const t=(i===Nn?this.videoBuffer:this.mediaBuffer)||this.media;t&&(this.afterBufferFlushed(t,i,ln),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking)return void this.log(`could not seek to ${i}, already seeking at ${e}`);const n=this.timelineOffset;n&&i&&(i+=n);const r=this.getLevelDetails(),s=Us.getBuffered(t),a=s.length?s.start(0):0,o=a-i,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);o>0&&(o<l||this.loadingParts&&o<2*((null==r?void 0:r.partTarget)||0))&&(this.log(`adjusting start position by ${o} to match buffer start`),i+=o,this.startPosition=i),e<i&&(this.log(`seek to target start position ${i} from current time ${e} buffer start ${a}`),t.currentTime=i)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then((t=>{const{hls:i}=this,n=null==t?void 0:t.frag;if(!n||this.fragContextChanged(n))return;e.fragmentError=0,this.state=io,this.startFragRequested=!1,this.bitrateTest=!1;const r=n.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(nn.FRAG_LOADED,t),n.bitrateTest=!1}))}_handleTransmuxComplete(t){var e;const i=this.playlistType,{hls:n}=this,{remuxResult:r,chunkMeta:s}=t,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{video:u,text:h,id3:d,initSegment:f}=r,{details:p}=c,g=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=oo,f){if(null!=f&&f.tracks){const t=o.initSegment||o;this._bufferInitSegment(c,f.tracks,t,s),n.trigger(nn.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:i,tracks:f.tracks})}const t=f.initPTS,e=f.timescale;Qi(t)&&(this.initPTS[o.cc]={baseTime:t,timescale:e},n.trigger(nn.INIT_PTS_FOUND,{frag:o,id:i,initPTS:t,timescale:e}))}if(u&&p){g&&"audiovideo"===u.type&&this.logMuxedErr(o);const t=p.fragments[o.sn-1-p.startSN],e=o.sn===p.startSN,i=!t||o.cc>t.cc;if(!1!==r.independent){const{startPTS:t,endPTS:n,startDTS:r,endDTS:a}=u;if(l)l.elementaryStreams[u.type]={startPTS:t,endPTS:n,startDTS:r,endDTS:a};else if(u.firstKeyFrame&&u.independent&&1===s.id&&!i&&(this.couldBacktrack=!0),u.dropped&&u.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=u.firstKeyFramePTS?u.firstKeyFramePTS:t;if(!e&&s<l-this.config.maxBufferHole&&!i)return void this.backtrack(o);i&&(o.gap=!0),o.setElementaryStreamInfo(u.type,o.start,n,o.start,a,!0)}else e&&t-(p.appliedTimelineOffset||0)>2&&(o.gap=!0);o.setElementaryStreamInfo(u.type,t,n,r,a),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(u,o,l,s,e||i)}else{if(!e&&!i)return void this.backtrack(o);o.gap=!0}}if(g){const{startPTS:t,endPTS:e,startDTS:i,endDTS:n}=g;l&&(l.elementaryStreams[Dn]={startPTS:t,endPTS:e,startDTS:i,endDTS:n}),o.setElementaryStreamInfo(Dn,t,e,i,n),this.bufferFragmentData(g,o,l,s)}if(p&&null!=d&&null!=(e=d.samples)&&e.length){const t={id:i,frag:o,details:p,samples:d.samples};n.trigger(nn.FRAG_PARSING_METADATA,t)}if(p&&h){const t={id:i,frag:o,details:p,samples:h.samples};n.trigger(nn.FRAG_PARSING_USERDATA,t)}}}logMuxedErr(t){this.warn(`${Fn(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,i,n){if(this.state!==oo)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(i));const{audio:r,video:s,audiovideo:a}=e;if(r){let i=Tr(r.codec,t.audioCodec);"mp4a"===i&&(i="mp4a.40.5");const n=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){i&&(i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const t=r.metadata;t&&"channelCount"in t&&1!==(t.channelCount||1)&&-1===n.indexOf("firefox")&&(i="mp4a.40.5")}i&&-1!==i.indexOf("mp4a.40.5")&&-1!==n.indexOf("android")&&"audio/mpeg"!==r.container&&(i="mp4a.40.2",this.log(`Android: force audio codec to ${i}`)),t.audioCodec&&t.audioCodec!==i&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${i}"`),r.levelCodec=i,r.id=ln,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${i||""}/${t.audioCodec||""}/${r.codec}]`),delete e.audiovideo}if(s){s.levelCodec=t.videoCodec,s.id=ln;const i=s.codec;if(4===(null==i?void 0:i.length))switch(i){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e"}this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${t.videoCodec||""}/${i}]${s.codec!==i?" parsed-corrected="+s.codec:""}${s.supplemental?" supplemental="+s.supplemental:""}`),delete e.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${t.codecs}/${a.codec}]`),delete e.video,delete e.audio);const o=Object.keys(e);if(o.length){if(this.hls.trigger(nn.BUFFER_CODECS,e),!this.hls)return;o.forEach((t=>{const r=e[t].initSegment;null!=r&&r.byteLength&&this.hls.trigger(nn.BUFFER_APPENDING,{type:t,data:r,frag:i,part:null,chunkMeta:n,parent:i.type})}))}this.tickImmediate()}getMainFwdBufferInfo(){const t=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,ln)}get maxBufferLength(){const{levels:t,level:e}=this,i=null==t?void 0:t[e];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=io}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&!1===t.seeking){const i=t.currentTime;if(Us.isBuffered(t,i)?e=this.getAppendedFrag(i):Us.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;const t=this.fragPlaying,i=e.level;t&&e.sn===t.sn&&t.level===i||(this.fragPlaying=e,this.hls.trigger(nn.FRAG_CHANGED,{frag:e}),t&&t.level===i||this.hls.trigger(nn.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;return Qi(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;if(Qi(e)){const t=this.getLevelDetails(),i=this.currentFrag||(t?ts(null,t.fragments,e):null);if(i){const t=i.programDateTime;if(null!==t){const n=t+1e3*(e-i.start);return new Date(n)}}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class Sh{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const i in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[i].loader;if(n){var e;if(t&&t!==(null==(e=n.context)?void 0:e.frag.type))return;n.abort()}}}detach(){for(const t in this.keyUriToKeyInfo){const e=this.keyUriToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyUriToKeyInfo){const e=this.keyUriToKeyInfo[t].loader;e&&e.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:en.KEY_LOAD_ERROR,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return new Os({type:tn.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:r,error:i,networkDetails:n})}loadClear(t,e){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:n}=t;for(let t=0;t<e.length;t++){const r=e[t];if(n<=r.cc&&("initSegment"===i||"initSegment"===r.sn||i<r.sn)){this.emeController.selectKeySystemFormat(r).then((t=>{r.setKeyFormat(t)}));break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then((e=>this.loadInternal(t,e))):this.loadInternal(t)}loadInternal(t,e){var i,n;e&&t.setKeyFormat(e);const r=t.decryptdata;if(!r){const i=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,en.KEY_LOAD_ERROR,i))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(t,en.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let a=this.keyUriToKeyInfo[s];if(null!=(i=a)&&i.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:t,keyInfo:a});var o;if(null!=(n=a)&&n.keyLoadPromise)switch(null==(o=a.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((e=>(r.key=e.keyInfo.decryptdata.key,{frag:t,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[s]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,t):this.loadKeyEME(a,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(a,t);default:return Promise.reject(this.createKeyLoadError(t,en.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(t,e){const i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const e=this.emeController.loadKey(i);if(e)return(t.keyLoadPromise=e.then((e=>(t.mediaKeySessionContext=e,i)))).catch((e=>{throw t.keyLoadPromise=null,e}))}return Promise.resolve(i)}loadKeyHTTP(t,e){const i=this.config,n=new(0,i.loader)(i);return e.keyLoader=t.loader=n,t.keyLoadPromise=new Promise(((r,s)=>{const a={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},o=i.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(t,e,i,n)=>{const{frag:a,keyInfo:o,url:l}=i;if(!a.decryptdata||o!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(a,en.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),n));o.decryptdata.key=a.decryptdata.key=new Uint8Array(t.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(t,i,n,r)=>{this.resetLoader(i),s(this.createKeyLoadError(e,en.KEY_LOAD_ERROR,new Error(`HTTP Error ${t.code} loading key ${t.text}`),n,mn({url:a.url,data:void 0},t)))},onTimeout:(t,i,n)=>{this.resetLoader(i),s(this.createKeyLoadError(e,en.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),n))},onAbort:(t,i,n)=>{this.resetLoader(i),s(this.createKeyLoadError(e,en.INTERNAL_ABORTED,new Error("key loading aborted"),n))}};n.load(a,l,c)}))}resetLoader(t){const{frag:e,keyInfo:i,url:n}=t,r=i.loader;e.keyLoader===r&&(e.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[n],r&&r.destroy()}}function wh(t){const{type:e}=t;switch(e){case an:return cn;case on:return un;default:return ln}}function xh(t,e){let i=t.url;return void 0!==i&&0!==i.indexOf("data:")||(i=e.url),i}class Eh{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.on(nn.LEVEL_LOADING,this.onLevelLoading,this),t.on(nn.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(nn.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(nn.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(nn.MANIFEST_LOADING,this.onManifestLoading,this),t.off(nn.LEVEL_LOADING,this.onLevelLoading,this),t.off(nn.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(nn.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(nn.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,i=e.pLoader,n=e.loader,r=new(i||n)(e);return this.loaders[t.type]=r,r}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:rn,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:i,level:n,pathwayId:r,url:s,deliveryDirectives:a,levelInfo:o}=e;this.load({id:i,level:n,pathwayId:r,responseType:"text",type:sn,url:s,deliveryDirectives:a,levelOrTrack:o})}onAudioTrackLoading(t,e){const{id:i,groupId:n,url:r,deliveryDirectives:s,track:a}=e;this.load({id:i,groupId:n,level:null,responseType:"text",type:an,url:r,deliveryDirectives:s,levelOrTrack:a})}onSubtitleTrackLoading(t,e){const{id:i,groupId:n,url:r,deliveryDirectives:s,track:a}=e;this.load({id:i,groupId:n,level:null,responseType:"text",type:on,url:r,deliveryDirectives:s,levelOrTrack:a})}onLevelsUpdated(t,e){const i=this.loaders[sn];if(i){const t=i.context;t&&!e.levels.some((e=>e===t.levelOrTrack))&&(i.abort(),delete this.loaders[sn])}}load(t){var e;const i=this.hls.config;let n,r=this.getInternalLoader(t);if(r){const e=this.hls.logger,i=r.context;if(i&&i.levelOrTrack===t.levelOrTrack&&(i.url===t.url||i.deliveryDirectives&&!t.deliveryDirectives))return void(i.url===t.url?e.log(`[playlist-loader]: ignore ${t.url} ongoing request`):e.log(`[playlist-loader]: ignore ${t.url} in favor of ${i.url}`));e.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),r.abort()}if(n=t.type===rn?i.manifestLoadPolicy.default:pn({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(t),Qi(null==(e=t.deliveryDirectives)?void 0:e.part)){let e;if(t.type===sn&&null!==t.level?e=this.hls.levels[t.level].details:t.type===an&&null!==t.id?e=this.hls.audioTracks[t.id].details:t.type===on&&null!==t.id&&(e=this.hls.subtitleTracks[t.id].details),e){const t=e.partTarget,i=e.targetduration;if(t&&i){const e=1e3*Math.max(3*t,.8*i);n=pn({},n,{maxTimeToFirstByteMs:Math.min(e,n.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(e,n.maxTimeToFirstByteMs)})}}}const s=n.errorRetry||n.timeoutRetry||{},a={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(t,e,i,n)=>{const r=this.getInternalLoader(i);this.resetInternalLoader(i.type);const s=t.data;0===s.indexOf("#EXTM3U")?(e.parsing.start=performance.now(),Aa.isMediaPlaylist(s)||i.type!==rn?this.handleTrackOrLevelPlaylist(t,e,i,n||null,r):this.handleMasterPlaylist(t,e,i,n)):this.handleManifestParsingError(t,i,new Error("no EXTM3U delimiter"),n||null,e)},onError:(t,e,i,n)=>{this.handleNetworkError(e,i,!1,t,n)},onTimeout:(t,e,i)=>{this.handleNetworkError(e,i,!0,void 0,t)}};r.load(t,a,o)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:i}=this.hls;(t||i)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,i,n){const r=this.hls,s=t.data,a=xh(t,i),o=Aa.parseMasterPlaylist(s,a);if(o.playlistParsingError)return void this.handleManifestParsingError(t,i,o.playlistParsingError,n,e);const{contentSteering:l,levels:c,sessionData:u,sessionKeys:h,startTimeOffset:d,variableList:f}=o;this.variableList=f;const{AUDIO:p=[],SUBTITLES:g,"CLOSED-CAPTIONS":m}=Aa.parseMasterPlaylistMedia(s,a,o);if(p.length){p.some((t=>!t.url))||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ws({}),bitrate:0,url:""}))}r.trigger(nn.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:g,captions:m,contentSteering:l,url:a,stats:e,networkDetails:n,sessionData:u,sessionKeys:h,startTimeOffset:d,variableList:f})}handleTrackOrLevelPlaylist(t,e,i,n,r){const s=this.hls,{id:a,level:o,type:l}=i,c=xh(t,i),u=Qi(o)?o:Qi(a)?a:0,h=wh(i),d=Aa.parseLevelPlaylist(t.data,c,u,h,0,this.variableList);if(l===rn){const t={attrs:new Ws({}),bitrate:0,details:d,name:"",url:c};d.requestScheduled=e.loading.start+qa(d,0),s.trigger(nn.MANIFEST_LOADED,{levels:[t],audioTracks:[],url:c,stats:e,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=d,this.handlePlaylistLoaded(d,t,e,i,n,r)}handleManifestParsingError(t,e,i,n,r){this.hls.trigger(nn.ERROR,{type:tn.NETWORK_ERROR,details:en.MANIFEST_PARSING_ERROR,fatal:e.type===rn,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:n,stats:r})}handleNetworkError(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=`A network ${i?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${t.type}`;t.type===sn?s+=`: ${t.level} id: ${t.id}`:t.type!==an&&t.type!==on||(s+=` id: ${t.id} group-id: "${t.groupId}"`);const a=new Error(s);this.hls.logger.warn(`[playlist-loader]: ${s}`);let o=en.UNKNOWN,l=!1;const c=this.getInternalLoader(t);switch(t.type){case rn:o=i?en.MANIFEST_LOAD_TIMEOUT:en.MANIFEST_LOAD_ERROR,l=!0;break;case sn:o=i?en.LEVEL_LOAD_TIMEOUT:en.LEVEL_LOAD_ERROR,l=!1;break;case an:o=i?en.AUDIO_TRACK_LOAD_TIMEOUT:en.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case on:o=i?en.SUBTITLE_TRACK_LOAD_TIMEOUT:en.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(t.type);const u={type:tn.NETWORK_ERROR,details:o,fatal:l,url:t.url,loader:c,context:t,error:a,networkDetails:e,stats:r};if(n){const i=(null==e?void 0:e.url)||t.url;u.response=mn({url:i,data:void 0},n)}this.hls.trigger(nn.ERROR,u)}handlePlaylistLoaded(t,e,i,n,r,s){const a=this.hls,{type:o,level:l,id:c,groupId:u,deliveryDirectives:h}=n,d=xh(e,n),f=wh(n),p="number"===typeof n.level&&f===ln?l:void 0;if(!t.fragments.length){const s=t.playlistParsingError=new Error("No Segments found in Playlist");return void a.trigger(nn.ERROR,{type:tn.NETWORK_ERROR,details:en.LEVEL_EMPTY_ERROR,fatal:!1,url:d,error:s,reason:s.message,response:e,context:n,level:p,parent:f,networkDetails:r,stats:i})}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const g=t.playlistParsingError;if(g){if(this.hls.logger.warn(g),!a.config.ignorePlaylistParsingErrors)return void a.trigger(nn.ERROR,{type:tn.NETWORK_ERROR,details:en.LEVEL_PARSING_ERROR,fatal:!1,url:d,error:g,reason:g.message,response:e,context:n,level:p,parent:f,networkDetails:r,stats:i});t.playlistParsingError=null}switch(t.live&&s&&(s.getCacheAge&&(t.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),o){case rn:case sn:a.trigger(nn.LEVEL_LOADED,{details:t,levelInfo:n.levelOrTrack||a.levels[0],level:p||0,id:c||0,stats:i,networkDetails:r,deliveryDirectives:h,withoutMultiVariant:o===rn});break;case an:a.trigger(nn.AUDIO_TRACK_LOADED,{details:t,track:n.levelOrTrack,id:c||0,groupId:u||"",stats:i,networkDetails:r,deliveryDirectives:h});break;case on:a.trigger(nn.SUBTITLE_TRACK_LOADED,{details:t,track:n.levelOrTrack,id:c||0,groupId:u||"",stats:i,networkDetails:r,deliveryDirectives:h})}}}class Lh{static get version(){return wo}static isMSESupported(){return yh()}static isSupported(){return function(){if(!yh())return!1;const t=Ln();return"function"===typeof(null==t?void 0:t.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((e=>t.isTypeSupported(br(e,"video"))))||["mp4a.40.2","fLaC"].some((e=>t.isTypeSupported(br(e,"audio")))))}()}static getMediaSource(){return Ln()}static get Events(){return nn}static get MetadataSchema(){return Go}static get ErrorTypes(){return tn}static get ErrorDetails(){return en}static get DefaultConfig(){return Lh.defaultConfig?Lh.defaultConfig:rh}static set DefaultConfig(t){Lh.defaultConfig=t}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new So,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const e=this.logger=function(t,e,i){const n=Sn();if("object"===typeof console&&!0===t||"object"===typeof t){const r=["debug","log","info","warn","error"];r.forEach((e=>{n[e]=wn(e,t,i)}));try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.2`)}catch(Bw){return Sn()}r.forEach((e=>{xn[e]=wn(e,t)}))}else pn(xn,n);return n}(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=function(t,e,i){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=sh(t),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((t=>{const s=`${"level"===t?"playlist":t}LoadPolicy`,a=void 0===e[s],o=[];r.forEach((i=>{const r=`${t}Loading${i}`,l=e[r];if(void 0!==l&&a){o.push(r);const t=n[s].default;switch(e[s]={default:t},i){case"TimeOut":t.maxLoadTimeMs=l,t.maxTimeToFirstByteMs=l;break;case"MaxRetry":t.errorRetry.maxNumRetry=l,t.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":t.errorRetry.retryDelayMs=l,t.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":t.errorRetry.maxRetryDelayMs=l,t.timeoutRetry.maxRetryDelayMs=l}}})),o.length&&i.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${s}": ${qr(e[s])}`)})),mn(mn({},n),e)}(Lh.DefaultConfig,t,e);this.userConfig=t,i.progressive&&ah(i,e);const{abrController:n,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=i,l=new a(this),c=this.abrController=new n(this),u=new ws(this),h=i.interstitialsController,d=h?this.interstitialsController=new h(this,Lh):null,f=this.bufferController=new r(this,u),p=this.capLevelController=new s(this),g=new o(this),m=new Eh(this),v=i.contentSteeringController,y=v?new v(this):null,b=this.levelController=new gh(this,y),S=new fh(this),w=new Sh(this.config),x=this.streamController=new bh(this,u,w),E=this.gapController=new oh(this,u);p.setStreamController(x),g.setStreamController(x);const L=[m,b,x];d&&L.splice(1,0,d),y&&L.splice(1,0,y),this.networkControllers=L;const T=[c,f,E,p,g,S,u];this.audioTrackController=this.createController(i.audioTrackController,L);const A=i.audioStreamController;A&&L.push(this.audioStreamController=new A(this,u,w)),this.subtitleTrackController=this.createController(i.subtitleTrackController,L);const _=i.subtitleStreamController;_&&L.push(this.subtititleStreamController=new _(this,u,w)),this.createController(i.timelineController,T),w.emeController=this.emeController=this.createController(i.emeController,T),this.cmcdController=this.createController(i.cmcdController,T),this.latencyController=this.createController(ph,T),this.coreComponents=T,L.push(l);const k=l.onErrorOut;"function"===typeof k&&this.on(nn.ERROR,k,l),this.on(nn.MANIFEST_LOADED,m.onManifestLoaded,m)}createController(t,e){if(t){const i=new t(this);return e&&e.push(i),i}return null}on(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.on(t,e,i)}once(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,n=arguments.length>3?arguments[3]:void 0;this._emitter.off(t,e,i,n)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(i){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const e=t===nn.ERROR;this.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.INTERNAL_EXCEPTION,fatal:e,event:t,error:i}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(nn.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((t=>t.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((t=>t.destroy())),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){const e=new Error(`attachMedia failed: invalid argument (${t})`);return void this.trigger(nn.ERROR,{type:tn.OTHER_ERROR,details:en.ATTACH_MEDIA_ERROR,fatal:!0,error:e})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const e="media"in t,i=e?t.media:t,n=e?t:{media:i};this._media=i,this.trigger(nn.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(nn.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const t=this.bufferController.transferMedia();return this.trigger(nn.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();const e=this.media,i=this._url,n=this._url=In.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),e&&i&&(i!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(nn.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1?arguments[1]:void 0;this.logger.log(`startLoad(${t+(e?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t,e),this.started&&this.networkControllers);i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!this.started&&this.networkControllers);t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((t=>{t.resumeBuffering&&t.resumeBuffering()})))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((t=>{t.pauseBuffering&&t.pauseBuffering()})))}get inFlightFragments(){const t={[ln]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[cn]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[un]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const t=this._media,e=null==t?void 0:t.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=function(){try{return crypto.randomUUID()}catch(t){try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch(t){let e=(new Date).getTime();const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}));return i}}}()),t}get levels(){const t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return-1===t&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log(`set startLevel:${t}`),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){const{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){(function(t){return Nr.indexOf(t)>-1})(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const i=t.length;for(let n=0;n<i;n++)if(t[n].maxBitrate>=e)return n;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:i}=this;let n;if(n=-1===e&&null!=t&&t.length?t.length-1:e,i)for(let r=n;r--;){const e=t[r].attrs["HDCP-LEVEL"];if(e&&e<=i)return r}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return(null==(e=this.audioTrackController)?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return(null==(e=this.subtitleTrackController)?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!(null==(t=this.bufferController)||!t.bufferedToEnd)}get interstitialsManager(){var t;return(null==(t=this.interstitialsController)?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t){return Dr(t,Vr(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.allAudioTracks),navigator.mediaCapabilities)}}Lh.defaultConfig=void 0;const Th=t=>{let{onSaved:e}=t;const[i,n]=(0,s.useState)([]),[r,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[h,d]=(0,s.useState)(""),[f,p]=(0,s.useState)(!1),[g,m]=(0,s.useState)(1),[v,y]=(0,s.useState)(""),b=(0,s.useRef)(null),[S,w]=(0,s.useState)(!1);return(0,zi.jsxs)("div",{children:[(0,zi.jsx)("h3",{children:"Registro de C\xe1maras"}),1===g&&(0,zi.jsxs)(zi.Fragment,{children:[(0,zi.jsx)("button",{onClick:async()=>{p(!0);try{const t=await fetch("http://localhost:4050/scan-network"),e=await t.json();n(e.devices||[])}catch(ny){console.error("Error escaneando red:",ny),alert("No se pudo escanear la red.")}p(!1)},disabled:f,children:f?"Escaneando...":"Escanear red"}),i.length>0&&(0,zi.jsxs)("div",{children:[(0,zi.jsx)("label",{children:"Seleccion\xe1 una IP:"}),(0,zi.jsxs)("select",{value:r,onChange:t=>a(t.target.value),children:[(0,zi.jsx)("option",{value:"",children:"-- Eleg\xed una IP --"}),i.map(((t,e)=>(0,zi.jsxs)("option",{value:t.ip,children:[t.ip," ",t.mac&&"Desconocido"!==t.mac?`(${t.mac})`:""]},e)))]}),(0,zi.jsx)("label",{children:"Contrase\xf1a de la c\xe1mara:"}),(0,zi.jsx)("input",{type:"password",value:o,onChange:t=>l(t.target.value)}),(0,zi.jsxs)("label",{children:[(0,zi.jsx)("input",{type:"checkbox",checked:S,onChange:t=>w(t.target.checked)}),"\xbfEs una c\xe1mara t\xe9rmica?"]}),(0,zi.jsx)("button",{onClick:async()=>{if(!r||!o)return alert("Seleccion\xe1 una IP y escrib\xed la contrase\xf1a.");const t=`cam-${Date.now()}`;y(t);try{const e=await fetch("http://localhost:4000/start-stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:r,user:"admin",password:o,streamKey:t,extraParams:"/cam/realmonitor?channel=1&subtype=0&proto=Onvif"})}),i=await e.json();if(!e.ok)return alert(`Error al iniciar stream: ${i.error}`);const n=b.current,s=new Lh;s.loadSource(`http://localhost:4000/streams/${t}/index.m3u8`),s.attachMedia(n),m(2)}catch(ny){console.error("Error al iniciar stream:",ny),alert("Error al iniciar la c\xe1mara.")}},children:"Probar c\xe1mara"})]})]}),2===g&&(0,zi.jsxs)("div",{children:[(0,zi.jsx)("h4",{children:"\u2705 Conexi\xf3n exitosa"}),(0,zi.jsx)("video",{ref:b,controls:!0,autoPlay:!0,width:"500"}),(0,zi.jsxs)("div",{children:[(0,zi.jsx)("label",{children:"Nombre de la c\xe1mara:"}),(0,zi.jsx)("input",{type:"text",value:c,onChange:t=>u(t.target.value),placeholder:"Cam 1 - Galp\xf3n",required:!0})]}),(0,zi.jsxs)("div",{children:[(0,zi.jsx)("label",{children:"Ubicaci\xf3n (opcional):"}),(0,zi.jsx)("input",{type:"text",value:h,onChange:t=>d(t.target.value)})]}),(0,zi.jsx)("button",{onClick:async()=>{const t=JSON.parse(localStorage.getItem("user")),i=localStorage.getItem("token"),n=v||localStorage.getItem("streamKey");if(null===t||void 0===t||!t._id||!r||!c||!n)return console.warn("\u274c Faltan campos:",{adminId:null===t||void 0===t?void 0:t._id,ip:r,name:c,streamKey:n}),alert("Faltan campos requeridos para guardar la c\xe1mara.");console.log("\ud83d\udd12 Enviando datos a /api/cameras:"),console.log("adminId:",t._id),console.log("ip:",r),console.log("name:",c),console.log("location:",h),console.log("streamKey:",n);try{const s=await fetch("http://localhost:4000/api/cameras",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`,"x-admin-id":t._id},body:JSON.stringify({adminId:t._id,ip:r,name:c,location:h,streamKey:n,password:o,isThermal:S})});if(!s.ok){const t=await s.json();return alert(`Error al guardar c\xe1mara: ${t.error}`)}alert("\u2705 C\xe1mara registrada correctamente."),null===e||void 0===e||e()}catch(ny){console.error("\u274c Error al registrar c\xe1mara:",ny),alert("Ocurri\xf3 un error inesperado al guardar la c\xe1mara.")}},children:"Guardar c\xe1mara"})]})]})},Ah=()=>{const[t,e]=(0,s.useState)([]),[i,n]=(0,s.useState)({ip:"",name:"",location:"",streamKey:""}),r=localStorage.getItem("adminId")||"admin-default",a=async()=>{try{const t=await fetch("http://localhost:4000/api/cameras/my",{headers:{"x-admin-id":r}}),i=await t.json();e(i)}catch(ny){console.error("Error al obtener c\xe1maras",ny)}};return(0,s.useEffect)((()=>{a()}),[]),(0,zi.jsxs)("div",{style:{padding:20},children:[(0,zi.jsx)("h2",{children:"\ud83d\udcf7 C\xe1maras del administrador"}),(0,zi.jsxs)("div",{style:{marginBottom:20},children:[(0,zi.jsx)("input",{placeholder:"IP",value:i.ip,onChange:t=>n({...i,ip:t.target.value})}),(0,zi.jsx)("input",{placeholder:"Nombre",value:i.name,onChange:t=>n({...i,name:t.target.value})}),(0,zi.jsx)("input",{placeholder:"Ubicaci\xf3n",value:i.location,onChange:t=>n({...i,location:t.target.value})}),(0,zi.jsx)("input",{placeholder:"StreamKey",value:i.streamKey,onChange:t=>n({...i,streamKey:t.target.value})}),(0,zi.jsx)("button",{onClick:async()=>{if(!i.ip||!i.name||!i.streamKey)return alert("Faltan datos obligatorios");try{const t=await fetch("http://localhost:4000/api/cameras",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,adminId:r})});if(201===t.status)alert("C\xe1mara guardada"),n({ip:"",name:"",location:"",streamKey:""}),a();else{const e=await t.json();alert(e.error||"Error al guardar")}}catch(ny){console.error("Error al agregar c\xe1mara",ny)}},children:"\u2795 Guardar c\xe1mara"})]}),(0,zi.jsx)("ul",{children:t.map((t=>(0,zi.jsxs)("li",{children:[(0,zi.jsx)("b",{children:t.name})," - ",t.ip," (",t.location||"sin ubicaci\xf3n",")",(0,zi.jsx)("button",{onClick:()=>(async t=>{try{const e=await fetch(`http://localhost:4000/api/cameras/${t}`,{method:"DELETE",headers:{"x-admin-id":r}});(await e.json()).deleted?(alert("C\xe1mara eliminada"),a()):alert("No se pudo eliminar")}catch(ny){console.error("Error al eliminar c\xe1mara",ny)}})(t._id),style:{marginLeft:10},children:"\ud83d\uddd1 Eliminar"})]},t._id)))})]})},_h=()=>{const t=(0,s.useRef)(null),e=(0,s.useRef)(null),[i,n]=(0,s.useState)(null),[r,a]=(0,s.useState)(null),[o,l]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>(e.current=new WebSocket("ws://localhost:4000/stream/thermal"),e.current.onmessage=e=>{const i=t.current.getContext("2d"),n=new Image;n.onload=()=>i.drawImage(n,0,0,t.current.width,t.current.height),n.src="data:image/jpeg;base64,"+e.data},()=>{e.current.close()})),[]);return(0,zi.jsxs)("div",{className:"thermal-container",children:[(0,zi.jsx)("h2",{children:"Vista en Tiempo Real - C\xe1mara T\xe9rmica"}),(0,zi.jsx)("canvas",{ref:t,width:640,height:480,className:"thermal-canvas"}),(0,zi.jsxs)("div",{className:"thermal-controls",children:[(0,zi.jsx)("button",{onClick:()=>{const e=t.current.toDataURL("image/jpeg");a("image"),l(e),alert("Imagen capturada. Ahora escanea el chip.")},disabled:c,children:"\ud83d\udcf8 Tomar Captura"}),(0,zi.jsx)("button",{onClick:async()=>{if(c)return;u(!0);const e=[],i=t.current,n=setInterval((()=>{e.push(i.toDataURL("image/jpeg"))}),200);await new Promise((t=>setTimeout(t,5e3))),clearInterval(n),a("video"),l(e),u(!1),alert("Video capturado. Ahora escanea el chip.")},disabled:c,children:"\ud83c\udfa5 Grabar Video (5s)"})]}),o&&!i&&(0,zi.jsxs)("div",{className:"nfc-section",children:[(0,zi.jsx)("p",{children:"Escanea el chip de la vaca para continuar..."}),(0,zi.jsx)(Gi,{onDataRead:async t=>{n(t);try{const e=await fetch("http://localhost:4000/api/thermal/mint",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({uid:t.serialNumber,cowName:t.name,mediaType:r,mediaData:o})});await e.json();alert("NFT ALERTA T\xc9RMICA minteado exitosamente.")}catch(e){console.error("Error al mintear ALERTA T\xc9RMICA:",e),alert("Hubo un error al mintear el NFT.")}}})]})]})};function kh(t){return t+.5|0}const Ph=(t,e,i)=>Math.max(Math.min(t,i),e);function Rh(t){return Ph(kh(2.55*t),0,255)}function Ih(t){return Ph(kh(255*t),0,255)}function Ch(t){return Ph(kh(t/2.55)/100,0,1)}function Dh(t){return Ph(kh(100*t),0,100)}const Nh={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Oh=[..."0123456789ABCDEF"],Mh=t=>Oh[15&t],Fh=t=>Oh[(240&t)>>4]+Oh[15&t],Bh=t=>(240&t)>>4===(15&t);function Uh(t){var e=(t=>Bh(t.r)&&Bh(t.g)&&Bh(t.b)&&Bh(t.a))(t)?Mh:Fh;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}const jh=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function $h(t,e,i){const n=e*Math.min(i,1-i),r=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+t/30)%12;return i-n*Math.max(Math.min(r-3,9-r,1),-1)};return[r(0),r(8),r(4)]}function zh(t,e,i){const n=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(n+t/60)%6;return i-i*e*Math.max(Math.min(r,4-r,1),0)};return[n(5),n(3),n(1)]}function Hh(t,e,i){const n=$h(t,1,.5);let r;for(e+i>1&&(r=1/(e+i),e*=r,i*=r),r=0;r<3;r++)n[r]*=1-e-i,n[r]+=e;return n}function qh(t){const e=t.r/255,i=t.g/255,n=t.b/255,r=Math.max(e,i,n),s=Math.min(e,i,n),a=(r+s)/2;let o,l,c;return r!==s&&(c=r-s,l=a>.5?c/(2-r-s):c/(r+s),o=function(t,e,i,n,r){return t===r?(e-i)/n+(e<i?6:0):e===r?(i-t)/n+2:(t-e)/n+4}(e,i,n,c,r),o=60*o+.5),[0|o,l||0,a]}function Gh(t,e,i,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,n)).map(Ih)}function Vh(t,e,i){return Gh($h,t,e,i)}function Wh(t){return(t%360+360)%360}function Kh(t){const e=jh.exec(t);let i,n=255;if(!e)return;e[5]!==i&&(n=e[6]?Rh(+e[5]):Ih(+e[5]));const r=Wh(+e[2]),s=+e[3]/100,a=+e[4]/100;return i="hwb"===e[1]?function(t,e,i){return Gh(Hh,t,e,i)}(r,s,a):"hsv"===e[1]?function(t,e,i){return Gh(zh,t,e,i)}(r,s,a):Vh(r,s,a),{r:i[0],g:i[1],b:i[2],a:n}}const Yh={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Xh={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Qh;function Jh(t){Qh||(Qh=function(){const t={},e=Object.keys(Xh),i=Object.keys(Yh);let n,r,s,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],r=0;r<i.length;r++)s=i[r],o=o.replace(s,Yh[s]);s=parseInt(Xh[a],16),t[o]=[s>>16&255,s>>8&255,255&s]}return t}(),Qh.transparent=[0,0,0,0]);const e=Qh[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}const Zh=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const td=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,ed=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function id(t,e,i){if(t){let n=qh(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*i,0===e?360:1)),n=Vh(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function nd(t,e){return t?Object.assign(e||{},t):t}function rd(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ih(t[3]))):(e=nd(t,{r:0,g:0,b:0,a:1})).a=Ih(e.a),e}function sd(t){return"r"===t.charAt(0)?function(t){const e=Zh.exec(t);let i,n,r,s=255;if(e){if(e[7]!==i){const t=+e[7];s=e[8]?Rh(t):Ph(255*t,0,255)}return i=+e[1],n=+e[3],r=+e[5],i=255&(e[2]?Rh(i):Ph(i,0,255)),n=255&(e[4]?Rh(n):Ph(n,0,255)),r=255&(e[6]?Rh(r):Ph(r,0,255)),{r:i,g:n,b:r,a:s}}}(t):Kh(t)}class ad{constructor(t){if(t instanceof ad)return t;const e=typeof t;let i;"object"===e?i=rd(t):"string"===e&&(i=function(t){var e,i=t.length;return"#"===t[0]&&(4===i||5===i?e={r:255&17*Nh[t[1]],g:255&17*Nh[t[2]],b:255&17*Nh[t[3]],a:5===i?17*Nh[t[4]]:255}:7!==i&&9!==i||(e={r:Nh[t[1]]<<4|Nh[t[2]],g:Nh[t[3]]<<4|Nh[t[4]],b:Nh[t[5]]<<4|Nh[t[6]],a:9===i?Nh[t[7]]<<4|Nh[t[8]]:255})),e}(t)||Jh(t)||sd(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=nd(this._rgb);return t&&(t.a=Ch(t.a)),t}set rgb(t){this._rgb=rd(t)}rgbString(){return this._valid?function(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ch(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}(this._rgb):void 0}hexString(){return this._valid?Uh(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=qh(t),i=e[0],n=Dh(e[1]),r=Dh(e[2]);return t.a<255?`hsla(${i}, ${n}%, ${r}%, ${Ch(t.a)})`:`hsl(${i}, ${n}%, ${r}%)`}(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,n=t.rgb;let r;const s=e===r?.5:e,a=2*s-1,o=i.a-n.a,l=((a*o===-1?a:(a+o)/(1+a*o))+1)/2;r=1-l,i.r=255&l*i.r+r*n.r+.5,i.g=255&l*i.g+r*n.g+.5,i.b=255&l*i.b+r*n.b+.5,i.a=s*i.a+(1-s)*n.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,i){const n=ed(Ch(t.r)),r=ed(Ch(t.g)),s=ed(Ch(t.b));return{r:Ih(td(n+i*(ed(Ch(e.r))-n))),g:Ih(td(r+i*(ed(Ch(e.g))-r))),b:Ih(td(s+i*(ed(Ch(e.b))-s))),a:t.a+i*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new ad(this.rgb)}alpha(t){return this._rgb.a=Ih(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=kh(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return id(this._rgb,2,t),this}darken(t){return id(this._rgb,2,-t),this}saturate(t){return id(this._rgb,1,t),this}desaturate(t){return id(this._rgb,1,-t),this}rotate(t){return function(t,e){var i=qh(t);i[0]=Wh(i[0]+e),i=Vh(i),t.r=i[0],t.g=i[1],t.b=i[2]}(this._rgb,t),this}}function od(){}const ld=(()=>{let t=0;return()=>t++})();function cd(t){return null===t||void 0===t}function ud(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function hd(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function dd(t){return("number"===typeof t||t instanceof Number)&&isFinite(+t)}function fd(t,e){return dd(t)?t:e}function pd(t,e){return"undefined"===typeof t?e:t}const gd=(t,e)=>"string"===typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function md(t,e,i){if(t&&"function"===typeof t.call)return t.apply(i,e)}function vd(t,e,i,n){let r,s,a;if(ud(t))if(s=t.length,n)for(r=s-1;r>=0;r--)e.call(i,t[r],r);else for(r=0;r<s;r++)e.call(i,t[r],r);else if(hd(t))for(a=Object.keys(t),s=a.length,r=0;r<s;r++)e.call(i,t[a[r]],a[r])}function yd(t,e){let i,n,r,s;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(r=t[i],s=e[i],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function bd(t){if(ud(t))return t.map(bd);if(hd(t)){const e=Object.create(null),i=Object.keys(t),n=i.length;let r=0;for(;r<n;++r)e[i[r]]=bd(t[i[r]]);return e}return t}function Sd(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function wd(t,e,i,n){if(!Sd(t))return;const r=e[t],s=i[t];hd(r)&&hd(s)?xd(r,s,n):e[t]=bd(s)}function xd(t,e,i){const n=ud(e)?e:[e],r=n.length;if(!hd(t))return t;const s=(i=i||{}).merger||wd;let a;for(let o=0;o<r;++o){if(a=n[o],!hd(a))continue;const e=Object.keys(a);for(let n=0,r=e.length;n<r;++n)s(e[n],t,a,i)}return t}function Ed(t,e){return xd(t,e,{merger:Ld})}function Ld(t,e,i){if(!Sd(t))return;const n=e[t],r=i[t];hd(n)&&hd(r)?Ed(n,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=bd(r))}const Td={"":t=>t,x:t=>t.x,y:t=>t.y};function Ad(t,e){const i=Td[e]||(Td[e]=function(t){const e=function(t){const e=t.split("."),i=[];let n="";for(const r of e)n+=r,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}(t);return t=>{for(const i of e){if(""===i)break;t=t&&t[i]}return t}}(e));return i(t)}function _d(t){return t.charAt(0).toUpperCase()+t.slice(1)}const kd=t=>"undefined"!==typeof t,Pd=t=>"function"===typeof t,Rd=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};const Id=Math.PI,Cd=2*Id,Dd=Number.POSITIVE_INFINITY,Nd=Id/180,Od=Id/2,Md=Id/4,Fd=2*Id/3,Bd=Math.log10,Ud=Math.sign;function jd(t,e,i){return Math.abs(t-e)<i}function $d(t){const e=Math.round(t);t=jd(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(Bd(t))),n=t/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function zd(t){return!function(t){return"symbol"===typeof t||"object"===typeof t&&null!==t&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Hd(t,e,i){let n,r,s;for(n=0,r=t.length;n<r;n++)s=t[n][i],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function qd(t){return t*(Id/180)}function Gd(t){return t*(180/Id)}function Vd(t){if(!dd(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function Wd(t,e){const i=e.x-t.x,n=e.y-t.y,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s<-.5*Id&&(s+=Cd),{angle:s,distance:r}}function Kd(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Yd(t){return(t%Cd+Cd)%Cd}function Xd(t,e,i,n){const r=Yd(t),s=Yd(e),a=Yd(i),o=Yd(s-r),l=Yd(a-r),c=Yd(r-s),u=Yd(r-a);return r===s||r===a||n&&s===a||o>l&&c<u}function Qd(t,e,i){return Math.max(e,Math.min(i,t))}function Jd(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return t>=Math.min(e,i)-n&&t<=Math.max(e,i)+n}function Zd(t,e,i){i=i||(i=>t[i]<e);let n,r=t.length-1,s=0;for(;r-s>1;)n=s+r>>1,i(n)?s=n:r=n;return{lo:s,hi:r}}const tf=(t,e,i,n)=>Zd(t,i,n?n=>{const r=t[n][e];return r<i||r===i&&t[n+1][e]===i}:n=>t[n][e]<i),ef=(t,e,i)=>Zd(t,i,(n=>t[n][e]>=i));const nf=["push","pop","shift","splice","unshift"];function rf(t,e){const i=t._chartjs;if(!i)return;const n=i.listeners,r=n.indexOf(e);-1!==r&&n.splice(r,1),n.length>0||(nf.forEach((e=>{delete t[e]})),delete t._chartjs)}function sf(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const af="undefined"===typeof window?function(t){return t()}:window.requestAnimationFrame;function of(t,e){let i=[],n=!1;return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];i=s,n||(n=!0,af.call(window,(()=>{n=!1,t.apply(e,i)})))}}const lf=t=>"start"===t?"left":"end"===t?"right":"center",cf=(t,e,i)=>"start"===t?e:"end"===t?i:(e+i)/2;const uf=t=>0===t||1===t,hf=(t,e,i)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*Cd/i),df=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*Cd/i)+1,ff={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Od),easeOutSine:t=>Math.sin(t*Od),easeInOutSine:t=>-.5*(Math.cos(Id*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>uf(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>uf(t)?t:hf(t,.075,.3),easeOutElastic:t=>uf(t)?t:df(t,.075,.3),easeInOutElastic(t){const e=.1125;return uf(t)?t:t<.5?.5*hf(2*t,e,.45):.5+.5*df(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-ff.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeInOutBounce:t=>t<.5?.5*ff.easeInBounce(2*t):.5*ff.easeOutBounce(2*t-1)+.5};function pf(t){if(t&&"object"===typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function gf(t){return pf(t)?t:new ad(t)}function mf(t){return pf(t)?t:new ad(t).saturate(.5).darken(.1).hexString()}const vf=["x","y","borderWidth","radius","tension"],yf=["color","borderColor","backgroundColor"];const bf=new Map;function Sf(t,e,i){return function(t,e){e=e||{};const i=t+JSON.stringify(e);let n=bf.get(i);return n||(n=new Intl.NumberFormat(t,e),bf.set(i,n)),n}(e,i).format(t)}const wf={values:t=>ud(t)?t:""+t,numeric(t,e,i){if(0===t)return"0";const n=this.chart.options.locale;let r,s=t;if(i.length>1){const e=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(e<1e-4||e>1e15)&&(r="scientific"),s=function(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t));return i}(t,i)}const a=Bd(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),Sf(t,n,l)},logarithmic(t,e,i){if(0===t)return"0";const n=i[e].significand||t/Math.pow(10,Math.floor(Bd(t)));return[1,2,3,5,10,15].includes(n)||e>.8*i.length?wf.numeric.call(this,t,e,i):""}};var xf={formatters:wf};const Ef=Object.create(null),Lf=Object.create(null);function Tf(t,e){if(!e)return t;const i=e.split(".");for(let n=0,r=i.length;n<r;++n){const e=i[n];t=t[e]||(t[e]=Object.create(null))}return t}function Af(t,e,i){return"string"===typeof e?xd(Tf(t,e),i):xd(Tf(t,""),e)}class _f{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>mf(e.backgroundColor),this.hoverBorderColor=(t,e)=>mf(e.borderColor),this.hoverColor=(t,e)=>mf(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Af(this,t,e)}get(t){return Tf(this,t)}describe(t,e){return Af(Lf,t,e)}override(t,e){return Af(Ef,t,e)}route(t,e,i,n){const r=Tf(this,t),s=Tf(this,i),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[a],e=s[n];return hd(t)?Object.assign({},e,t):pd(t,e)},set(t){this[a]=t}}})}apply(t){t.forEach((t=>t(this)))}}var kf=new _f({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:yf},numbers:{type:"number",properties:vf}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:xf.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function Pf(t,e,i,n,r){let s=e[r];return s||(s=e[r]=t.measureText(r).width,i.push(r)),s>n&&(n=s),n}function Rf(t,e,i){const n=t.currentDevicePixelRatio,r=0!==i?Math.max(i/2,.5):0;return Math.round((e-r)*n)/n+r}function If(t,e){(e||t)&&((e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Cf(t,e,i,n){Df(t,e,i,n,null)}function Df(t,e,i,n,r){let s,a,o,l,c,u,h,d;const f=e.pointStyle,p=e.rotation,g=e.radius;let m=(p||0)*Nd;if(f&&"object"===typeof f&&(s=f.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return t.save(),t.translate(i,n),t.rotate(m),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void t.restore();if(!(isNaN(g)||g<=0)){switch(t.beginPath(),f){default:r?t.ellipse(i,n,r/2,g,0,0,Cd):t.arc(i,n,g,0,Cd),t.closePath();break;case"triangle":u=r?r/2:g,t.moveTo(i+Math.sin(m)*u,n-Math.cos(m)*g),m+=Fd,t.lineTo(i+Math.sin(m)*u,n-Math.cos(m)*g),m+=Fd,t.lineTo(i+Math.sin(m)*u,n-Math.cos(m)*g),t.closePath();break;case"rectRounded":c=.516*g,l=g-c,a=Math.cos(m+Md)*l,h=Math.cos(m+Md)*(r?r/2-c:l),o=Math.sin(m+Md)*l,d=Math.sin(m+Md)*(r?r/2-c:l),t.arc(i-h,n-o,c,m-Id,m-Od),t.arc(i+d,n-a,c,m-Od,m),t.arc(i+h,n+o,c,m,m+Od),t.arc(i-d,n+a,c,m+Od,m+Id),t.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=r?r/2:l,t.rect(i-u,n-l,2*u,2*l);break}m+=Md;case"rectRot":h=Math.cos(m)*(r?r/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(i-h,n-o),t.lineTo(i+d,n-a),t.lineTo(i+h,n+o),t.lineTo(i-d,n+a),t.closePath();break;case"crossRot":m+=Md;case"cross":h=Math.cos(m)*(r?r/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(i-h,n-o),t.lineTo(i+h,n+o),t.moveTo(i+d,n-a),t.lineTo(i-d,n+a);break;case"star":h=Math.cos(m)*(r?r/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(i-h,n-o),t.lineTo(i+h,n+o),t.moveTo(i+d,n-a),t.lineTo(i-d,n+a),m+=Md,h=Math.cos(m)*(r?r/2:g),a=Math.cos(m)*g,o=Math.sin(m)*g,d=Math.sin(m)*(r?r/2:g),t.moveTo(i-h,n-o),t.lineTo(i+h,n+o),t.moveTo(i+d,n-a),t.lineTo(i-d,n+a);break;case"line":a=r?r/2:Math.cos(m)*g,o=Math.sin(m)*g,t.moveTo(i-a,n-o),t.lineTo(i+a,n+o);break;case"dash":t.moveTo(i,n),t.lineTo(i+Math.cos(m)*(r?r/2:g),n+Math.sin(m)*g);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function Nf(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function Of(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Mf(t){t.restore()}function Ff(t,e,i,n,r){if(r.strikethrough||r.underline){const s=t.measureText(n),a=e-s.actualBoundingBoxLeft,o=e+s.actualBoundingBoxRight,l=i-s.actualBoundingBoxAscent,c=i+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(a,u),t.lineTo(o,u),t.stroke()}}function Bf(t,e){const i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function Uf(t,e,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=ud(e)?e:[e],o=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(t.save(),t.font=r.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),cd(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,s),l=0;l<a.length;++l)c=a[l],s.backdrop&&Bf(t,s.backdrop),o&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),cd(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,i,n,s.maxWidth)),t.fillText(c,i,n,s.maxWidth),Ff(t,i,n,c,s),n+=Number(r.lineHeight);t.restore()}function jf(t,e){const{x:i,y:n,w:r,h:s,radius:a}=e;t.arc(i+a.topLeft,n+a.topLeft,a.topLeft,1.5*Id,Id,!0),t.lineTo(i,n+s-a.bottomLeft),t.arc(i+a.bottomLeft,n+s-a.bottomLeft,a.bottomLeft,Id,Od,!0),t.lineTo(i+r-a.bottomRight,n+s),t.arc(i+r-a.bottomRight,n+s-a.bottomRight,a.bottomRight,Od,0,!0),t.lineTo(i+r,n+a.topRight),t.arc(i+r-a.topRight,n+a.topRight,a.topRight,0,-Od,!0),t.lineTo(i+a.topLeft,n)}const $f=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,zf=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Hf(t,e){const i=(""+t).match($f);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t}const qf=t=>+t||0;function Gf(t,e){const i={},n=hd(e),r=n?Object.keys(e):e,s=hd(t)?n?i=>pd(t[i],t[e[i]]):e=>t[e]:()=>t;for(const a of r)i[a]=qf(s(a));return i}function Vf(t){return Gf(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Wf(t){return Gf(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Kf(t){const e=Vf(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Yf(t,e){t=t||{},e=e||kf.font;let i=pd(t.size,e.size);"string"===typeof i&&(i=parseInt(i,10));let n=pd(t.style,e.style);n&&!(""+n).match(zf)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:pd(t.family,e.family),lineHeight:Hf(pd(t.lineHeight,e.lineHeight),i),size:i,style:n,weight:pd(t.weight,e.weight),string:""};return r.string=function(t){return!t||cd(t.size)||cd(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(r),r}function Xf(t,e,i,n){let r,s,a,o=!0;for(r=0,s=t.length;r<s;++r)if(a=t[r],void 0!==a&&(void 0!==e&&"function"===typeof a&&(a=a(e),o=!1),void 0!==i&&ud(a)&&(a=a[i%a.length],o=!1),void 0!==a))return n&&!o&&(n.cacheable=!1),a}function Qf(t,e){return Object.assign(Object.create(t),e)}function Jf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],i=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>t[0];const r=(arguments.length>2?arguments[2]:void 0)||t;"undefined"===typeof i&&(i=cp("_fallback",t));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:r,_fallback:i,_getTarget:n,override:n=>Jf([n,...t],e,r,i)};return new Proxy(s,{deleteProperty:(e,i)=>(delete e[i],delete e._keys,delete t[0][i],!0),get:(i,n)=>np(i,n,(()=>function(t,e,i,n){let r;for(const s of e)if(r=cp(ep(s,t),i),"undefined"!==typeof r)return ip(t,r)?op(i,n,t,r):r}(n,e,t,i))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>up(t).includes(e),ownKeys:t=>up(t),set(t,e,i){const r=t._storage||(t._storage=n());return t[e]=r[e]=i,delete t._keys,!0}})}function Zf(t,e,i,n){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:tp(t,n),setContext:e=>Zf(t,e,i,n),override:r=>Zf(t.override(r),e,i,n)};return new Proxy(r,{deleteProperty:(e,i)=>(delete e[i],delete t[i],!0),get:(t,e,i)=>np(t,e,(()=>function(t,e,i){const{_proxy:n,_context:r,_subProxy:s,_descriptors:a}=t;let o=n[e];Pd(o)&&a.isScriptable(e)&&(o=function(t,e,i,n){const{_proxy:r,_context:s,_subProxy:a,_stack:o}=i;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=e(s,a||n);o.delete(t),ip(t,l)&&(l=op(r._scopes,r,t,l));return l}(e,o,t,i));ud(o)&&o.length&&(o=function(t,e,i,n){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=i;if("undefined"!==typeof s.index&&n(t))return e[s.index%e.length];if(hd(e[0])){const i=e,n=r._scopes.filter((t=>t!==i));e=[];for(const l of i){const i=op(n,r,t,l);e.push(Zf(i,s,a&&a[t],o))}}return e}(e,o,t,a.isIndexable));ip(e,o)&&(o=Zf(o,r,s&&s[e],a));return o}(t,e,i))),getOwnPropertyDescriptor:(e,i)=>e._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,i)=>Reflect.has(t,i),ownKeys:()=>Reflect.ownKeys(t),set:(e,i,n)=>(t[i]=n,delete e[i],!0)})}function tp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:i=e.scriptable,_indexable:n=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:i,indexable:n,isScriptable:Pd(i)?i:()=>i,isIndexable:Pd(n)?n:()=>n}}const ep=(t,e)=>t?t+_d(e):e,ip=(t,e)=>hd(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function np(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e)||"constructor"===e)return t[e];const n=i();return t[e]=n,n}function rp(t,e,i){return Pd(t)?t(e,i):t}const sp=(t,e)=>!0===t?e:"string"===typeof t?Ad(e,t):void 0;function ap(t,e,i,n,r){for(const s of e){const e=sp(i,s);if(e){t.add(e);const s=rp(e._fallback,i,r);if("undefined"!==typeof s&&s!==i&&s!==n)return s}else if(!1===e&&"undefined"!==typeof n&&i!==n)return null}return!1}function op(t,e,i,n){const r=e._rootScopes,s=rp(e._fallback,i,n),a=[...t,...r],o=new Set;o.add(n);let l=lp(o,a,i,s||i,n);return null!==l&&(("undefined"===typeof s||s===i||(l=lp(o,a,s,l,n),null!==l))&&Jf(Array.from(o),[""],r,s,(()=>function(t,e,i){const n=t._getTarget();e in n||(n[e]={});const r=n[e];if(ud(r)&&hd(i))return i;return r||{}}(e,i,n))))}function lp(t,e,i,n,r){for(;i;)i=ap(t,e,i,n,r);return i}function cp(t,e){for(const i of e){if(!i)continue;const e=i[t];if("undefined"!==typeof e)return e}}function up(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const i of t)for(const t of Object.keys(i).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}Number.EPSILON;function hp(){return"undefined"!==typeof window&&"undefined"!==typeof document}function dp(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function fp(t,e,i){let n;return"string"===typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}const pp=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);const gp=["top","right","bottom","left"];function mp(t,e,i){const n={};i=i?"-"+i:"";for(let r=0;r<4;r++){const s=gp[r];n[s]=parseFloat(t[e+"-"+s+i])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function vp(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:n}=e,r=pp(i),s="border-box"===r.boxSizing,a=mp(r,"padding"),o=mp(r,"border","width"),{x:l,y:c,box:u}=function(t,e){const i=t.touches,n=i&&i.length?i[0]:t,{offsetX:r,offsetY:s}=n;let a,o,l=!1;if(((t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot))(r,s,t.target))a=r,o=s;else{const t=e.getBoundingClientRect();a=n.clientX-t.left,o=n.clientY-t.top,l=!0}return{x:a,y:o,box:l}}(t,i),h=a.left+(u&&o.left),d=a.top+(u&&o.top);let{width:f,height:p}=e;return s&&(f-=a.width+o.width,p-=a.height+o.height),{x:Math.round((l-h)/f*i.width/n),y:Math.round((c-d)/p*i.height/n)}}const yp=t=>Math.round(10*t)/10;function bp(t,e,i,n){const r=pp(t),s=mp(r,"margin"),a=fp(r.maxWidth,t,"clientWidth")||Dd,o=fp(r.maxHeight,t,"clientHeight")||Dd,l=function(t,e,i){let n,r;if(void 0===e||void 0===i){const s=t&&dp(t);if(s){const t=s.getBoundingClientRect(),a=pp(s),o=mp(a,"border","width"),l=mp(a,"padding");e=t.width-l.width-o.width,i=t.height-l.height-o.height,n=fp(a.maxWidth,s,"clientWidth"),r=fp(a.maxHeight,s,"clientHeight")}else e=t.clientWidth,i=t.clientHeight}return{width:e,height:i,maxWidth:n||Dd,maxHeight:r||Dd}}(t,e,i);let{width:c,height:u}=l;if("content-box"===r.boxSizing){const t=mp(r,"border","width"),e=mp(r,"padding");c-=e.width+t.width,u-=e.height+t.height}c=Math.max(0,c-s.width),u=Math.max(0,n?c/n:u-s.height),c=yp(Math.min(c,a,l.maxWidth)),u=yp(Math.min(u,o,l.maxHeight)),c&&!u&&(u=yp(c/2));return(void 0!==e||void 0!==i)&&n&&l.height&&u>l.height&&(u=l.height,c=yp(Math.floor(u*n))),{width:c,height:u}}function Sp(t,e,i){const n=e||1,r=Math.floor(t.height*n),s=Math.floor(t.width*n);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const a=t.canvas;return a.style&&(i||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==n||a.height!==r||a.width!==s)&&(t.currentDevicePixelRatio=n,a.height=r,a.width=s,t.ctx.setTransform(n,0,0,n,0,0),!0)}const wp=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};hp()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(Bw){}return t}();function xp(t,e){const i=function(t,e){return pp(t).getPropertyValue(e)}(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Ep(t,e,i){return t?function(t,e){return{x:i=>t+t+e-i,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,i):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function Lp(t,e){let i,n;"ltr"!==e&&"rtl"!==e||(i=t.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=n)}function Tp(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}class Ap{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,n){const r=e.listeners[n],s=e.duration;r.forEach((n=>n({chart:t,initial:e.initial,numSteps:s,currentStep:Math.min(i-e.start,s)})))}_refresh(){this._request||(this._running=!0,this._request=af.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),e=0;this._charts.forEach(((i,n)=>{if(!i.running||!i.items.length)return;const r=i.items;let s,a=r.length-1,o=!1;for(;a>=0;--a)s=r[a],s._active?(s._total>i.duration&&(i.duration=s._total),s.tick(t),o=!0):(r[a]=r[r.length-1],r.pop());o&&(n.draw(),this._notify(n,i,t,"progress")),r.length||(i.running=!1,this._notify(n,i,t,"complete"),i.initial=!1),e+=r.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var _p=new Ap;const kp="transparent",Pp={boolean:(t,e,i)=>i>.5?e:t,color(t,e,i){const n=gf(t||kp),r=n.valid&&gf(e||kp);return r&&r.valid?r.mix(n,i).hexString():e},number:(t,e,i)=>t+(e-t)*i};class Rp{constructor(t,e,i,n){const r=e[i];n=Xf([t.to,n,r,t.from]);const s=Xf([t.from,r,n]);this._active=!0,this._fn=t.fn||Pp[t.type||typeof s],this._easing=ff[t.easing]||ff.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=s,this._to=n,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const n=this._target[this._prop],r=i-this._start,s=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(s,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=Xf([t.to,e,n,t.from]),this._from=Xf([t.from,n,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,n=this._prop,r=this._from,s=this._loop,a=this._to;let o;if(this._active=r!==a&&(s||e<i),!this._active)return this._target[n]=a,void this._notify(!0);e<0?this._target[n]=r:(o=e/i%2,o=s&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[n]=this._fn(r,a,o))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,i)=>{t.push({res:e,rej:i})}))}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let n=0;n<i.length;n++)i[n][e]()}}class Ip{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!hd(t))return;const e=Object.keys(kf.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach((n=>{const r=t[n];if(!hd(r))return;const s={};for(const t of e)s[t]=r[t];(ud(r.properties)&&r.properties||[n]).forEach((t=>{t!==n&&i.has(t)||i.set(t,s)}))}))}_animateOptions(t,e){const i=e.options,n=function(t,e){if(!e)return;let i=t.options;if(!i)return void(t.options=e);i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}}));return i}(t,i);if(!n)return[];const r=this._createAnimations(n,i);return i.$shared&&function(t,e){const i=[],n=Object.keys(e);for(let r=0;r<n.length;r++){const e=t[n[r]];e&&e.active()&&i.push(e.wait())}return Promise.all(i)}(t.options.$animations,i).then((()=>{t.options=i}),(()=>{})),r}_createAnimations(t,e){const i=this._properties,n=[],r=t.$animations||(t.$animations={}),s=Object.keys(e),a=Date.now();let o;for(o=s.length-1;o>=0;--o){const l=s[o];if("$"===l.charAt(0))continue;if("options"===l){n.push(...this._animateOptions(t,e));continue}const c=e[l];let u=r[l];const h=i.get(l);if(u){if(h&&u.active()){u.update(h,c,a);continue}u.cancel()}h&&h.duration?(r[l]=u=new Rp(h,t,l,c),n.push(u)):t[l]=c}return n}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const i=this._createAnimations(t,e);return i.length?(_p.add(this._chart,i),!0):void 0}}function Cp(t,e){const i=t&&t.options||{},n=i.reverse,r=void 0===i.min?e:0,s=void 0===i.max?e:0;return{start:n?s:r,end:n?r:s}}function Dp(t,e){const i=[],n=t._getSortedDatasetMetas(e);let r,s;for(r=0,s=n.length;r<s;++r)i.push(n[r].index);return i}function Np(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=t.keys,s="single"===n.mode;let a,o,l,c;if(null===e)return;let u=!1;for(a=0,o=r.length;a<o;++a){if(l=+r[a],l===i){if(u=!0,n.all)continue;break}c=t.values[l],dd(c)&&(s||0===e||Ud(e)===Ud(c))&&(e+=c)}return u||n.all?e:0}function Op(t,e){const i=t&&t.options.stacked;return i||void 0===i&&void 0!==e.stack}function Mp(t,e,i){const n=t[e]||(t[e]={});return n[i]||(n[i]={})}function Fp(t,e,i,n){for(const r of e.getMatchingVisibleMetas(n).reverse()){const e=t[r.index];if(i&&e>0||!i&&e<0)return r.index}return null}function Bp(t,e){const{chart:i,_cachedMeta:n}=t,r=i._stacks||(i._stacks={}),{iScale:s,vScale:a,index:o}=n,l=s.axis,c=a.axis,u=function(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}(s,a,n),h=e.length;let d;for(let f=0;f<h;++f){const t=e[f],{[l]:i,[c]:s}=t;d=(t._stacks||(t._stacks={}))[c]=Mp(r,u,i),d[o]=s,d._top=Fp(d,a,!0,n.type),d._bottom=Fp(d,a,!1,n.type);(d._visualValues||(d._visualValues={}))[o]=s}}function Up(t,e){const i=t.scales;return Object.keys(i).filter((t=>i[t].axis===e)).shift()}function jp(t,e){const i=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[n]||void 0===e[n][i])return;delete e[n][i],void 0!==e[n]._visualValues&&void 0!==e[n]._visualValues[i]&&delete e[n]._visualValues[i]}}}const $p=t=>"reset"===t||"none"===t,zp=(t,e)=>e?t:Object.assign({},t);class Hp{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Op(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&jp(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),n=(t,e,i,n)=>"x"===t?e:"r"===t?n:i,r=e.xAxisID=pd(i.xAxisID,Up(t,"x")),s=e.yAxisID=pd(i.yAxisID,Up(t,"y")),a=e.rAxisID=pd(i.rAxisID,Up(t,"r")),o=e.indexAxis,l=e.iAxisID=n(o,r,s,a),c=e.vAxisID=n(o,s,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(s),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&rf(this._data,this),t._stacked&&jp(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(hd(e)){const t=this._cachedMeta;this._data=function(t,e){const{iScale:i,vScale:n}=e,r="x"===i.axis?"x":"y",s="x"===n.axis?"x":"y",a=Object.keys(t),o=new Array(a.length);let l,c,u;for(l=0,c=a.length;l<c;++l)u=a[l],o[l]={[r]:u,[s]:t[u]};return o}(e,t)}else if(i!==e){if(i){rf(i,this);const t=this._cachedMeta;jp(t),t._parsed=[]}e&&Object.isExtensible(e)&&(r=this,(n=e)._chartjs?n._chartjs.listeners.push(r):(Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),nf.forEach((t=>{const e="_onData"+_d(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];const a=i.apply(this,r);return n._chartjs.listeners.forEach((t=>{"function"===typeof t[e]&&t[e](...r)})),a}})})))),this._syncList=[],this._data=e}var n,r}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const r=e._stacked;e._stacked=Op(e.vScale,e),e.stack!==i.stack&&(n=!0,jp(e),e.stack=i.stack),this._resyncElements(t),(n||r!==e._stacked)&&(Bp(this,e._parsed),e._stacked=Op(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:n}=this,{iScale:r,_stacked:s}=i,a=r.axis;let o,l,c,u=0===t&&e===n.length||i._sorted,h=t>0&&i._parsed[t-1];if(!1===this._parsing)i._parsed=n,i._sorted=!0,c=n;else{c=ud(n[t])?this.parseArrayData(i,n,t,e):hd(n[t])?this.parseObjectData(i,n,t,e):this.parsePrimitiveData(i,n,t,e);const r=()=>null===l[a]||h&&l[a]<h[a];for(o=0;o<e;++o)i._parsed[o+t]=l=c[o],u&&(r()&&(u=!1),h=l);i._sorted=u}s&&Bp(this,c)}parsePrimitiveData(t,e,i,n){const{iScale:r,vScale:s}=t,a=r.axis,o=s.axis,l=r.getLabels(),c=r===s,u=new Array(n);let h,d,f;for(h=0,d=n;h<d;++h)f=h+i,u[h]={[a]:c||r.parse(l[f],f),[o]:s.parse(e[f],f)};return u}parseArrayData(t,e,i,n){const{xScale:r,yScale:s}=t,a=new Array(n);let o,l,c,u;for(o=0,l=n;o<l;++o)c=o+i,u=e[c],a[o]={x:r.parse(u[0],c),y:s.parse(u[1],c)};return a}parseObjectData(t,e,i,n){const{xScale:r,yScale:s}=t,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l=new Array(n);let c,u,h,d;for(c=0,u=n;c<u;++c)h=c+i,d=e[h],l[c]={x:r.parse(Ad(d,a),h),y:s.parse(Ad(d,o),h)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const n=this.chart,r=this._cachedMeta,s=e[t.axis];return Np({keys:Dp(n,!0),values:e._stacks[t.axis]._visualValues},s,r.index,{mode:i})}updateRangeFromParsed(t,e,i,n){const r=i[e.axis];let s=null===r?NaN:r;const a=n&&i._stacks[e.axis];n&&a&&(n.values=a,s=Np(n,r,this._cachedMeta.index)),t.min=Math.min(t.min,s),t.max=Math.max(t.max,s)}getMinMax(t,e){const i=this._cachedMeta,n=i._parsed,r=i._sorted&&t===i.iScale,s=n.length,a=this._getOtherScale(t),o=((t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:Dp(i,!0),values:null})(e,i,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(t){const{min:e,max:i,minDefined:n,maxDefined:r}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:r?i:Number.POSITIVE_INFINITY}}(a);let h,d;function f(){d=n[h];const e=d[a.axis];return!dd(d[t.axis])||c>e||u<e}for(h=0;h<s&&(f()||(this.updateRangeFromParsed(l,t,d,o),!r));++h);if(r)for(h=s-1;h>=0;--h)if(!f()){this.updateRangeFromParsed(l,t,d,o);break}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let n,r,s;for(n=0,r=e.length;n<r;++n)s=e[n][t.axis],dd(s)&&i.push(s);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,n=e.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:n?""+n.getLabelForValue(r[n.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,i,n,r;return hd(t)?(e=t.top,i=t.right,n=t.bottom,r=t.left):e=i=n=r=t,{top:e,right:i,bottom:n,left:r,disabled:!1===t}}(pd(this.options.clip,function(t,e,i){if(!1===i)return!1;const n=Cp(t,i),r=Cp(e,i);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,n=i.data||[],r=e.chartArea,s=[],a=this._drawStart||0,o=this._drawCount||n.length-a,l=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(t,r,a,o),c=a;c<a+o;++c){const e=n[c];e.hidden||(e.active&&l?s.push(e):e.draw(t,r))}for(c=0;c<s.length;++c)s[c].draw(t,r)}getStyle(t,e){const i=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const n=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];r=e.$context||(e.$context=function(t,e,i){return Qf(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),r.parsed=this.getParsed(t),r.raw=n.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=function(t,e){return Qf(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=n,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=i,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2?arguments[2]:void 0;const n="active"===e,r=this._cachedDataOpts,s=t+"-"+e,a=r[s],o=this.enableOptionSharing&&kd(i);if(a)return zp(a,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),u=n?[`${t}Hover`,"hover",t,""]:[t,""],h=l.getOptionScopes(this.getDataset(),c),d=Object.keys(kf.elements[t]),f=l.resolveNamedOptions(h,d,(()=>this.getContext(i,n,e)),u);return f.$shared&&(f.$shared=o,r[s]=Object.freeze(zp(f,o))),f}_resolveAnimations(t,e,i){const n=this.chart,r=this._cachedDataOpts,s=`animation-${e}`,a=r[s];if(a)return a;let o;if(!1!==n.options.animation){const n=this.chart.config,r=n.datasetAnimationScopeKeys(this._type,e),s=n.getOptionScopes(this.getDataset(),r);o=n.createResolver(s,this.getContext(t,i,e))}const l=new Ip(n,o&&o.animations);return o&&o._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||$p(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),n=this._sharedOptions,r=this.getSharedOptions(i),s=this.includeOptions(e,r)||r!==n;return this.updateSharedOptions(r,e,i),{sharedOptions:r,includeOptions:s}}updateElement(t,e,i,n){$p(n)?Object.assign(t,i):this._resolveAnimations(e,n).update(t,i)}updateSharedOptions(t,e,i){t&&!$p(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,n){t.active=n;const r=this.getStyle(e,n);this._resolveAnimations(e,i,n).update(t,{options:!n&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[a,o,l]of this._syncList)this[a](o,l);this._syncList=[];const n=i.length,r=e.length,s=Math.min(r,n);s&&this.parse(0,s),r>n?this._insertElements(n,r-n,t):r<n&&this._removeElements(r,n-r)}_insertElements(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=this._cachedMeta,r=n.data,s=t+e;let a;const o=t=>{for(t.length+=e,a=t.length-1;a>=s;a--)t[a]=t[a-e]};for(o(r),a=t;a<s;++a)r[a]=new this.dataElementType;this._parsing&&o(n._parsed),this.parse(t,e),i&&this.updateElements(r,t,e,"reset")}updateElements(t,e,i,n){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const n=i._parsed.splice(t,e);i._stacked&&jp(i,n)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,n]=t;this[e](i,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function qp(t){const e=t.iScale,i=function(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let n=[];for(let e=0,r=i.length;e<r;e++)n=n.concat(i[e].controller.getAllParsedValues(t));t._cache.$bar=sf(n.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let n,r,s,a,o=e._length;const l=()=>{32767!==s&&-32768!==s&&(kd(a)&&(o=Math.min(o,Math.abs(s-a)||o)),a=s)};for(n=0,r=i.length;n<r;++n)s=e.getPixelForValue(i[n]),l();for(a=void 0,n=0,r=e.ticks.length;n<r;++n)s=e.getPixelForTick(n),l();return o}function Gp(t,e,i,n){return ud(t)?function(t,e,i,n){const r=i.parse(t[0],n),s=i.parse(t[1],n),a=Math.min(r,s),o=Math.max(r,s);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),e[i.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:s,min:a,max:o}}(t,e,i,n):e[i.axis]=i.parse(t,n),e}function Vp(t,e,i,n){const r=t.iScale,s=t.vScale,a=r.getLabels(),o=r===s,l=[];let c,u,h,d;for(c=i,u=i+n;c<u;++c)d=e[c],h={},h[r.axis]=o||r.parse(a[c],c),l.push(Gp(d,h,s,c));return l}function Wp(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function Kp(t,e,i,n){let r=e.borderSkipped;const s={};if(!r)return void(t.borderSkipped=s);if(!0===r)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:a,end:o,reverse:l,top:c,bottom:u}=function(t){let e,i,n,r,s;return t.horizontal?(e=t.base>t.x,i="left",n="right"):(e=t.base<t.y,i="bottom",n="top"),e?(r="end",s="start"):(r="start",s="end"),{start:i,end:n,reverse:e,top:r,bottom:s}}(t);"middle"===r&&i&&(t.enableBorderRadius=!0,(i._top||0)===n?r=c:(i._bottom||0)===n?r=u:(s[Yp(u,a,o,l)]=!0,r=c)),s[Yp(r,a,o,l)]=!0,t.borderSkipped=s}function Yp(t,e,i,n){var r,s,a;return n?(a=i,t=Xp(t=(r=t)===(s=e)?a:r===a?s:r,i,e)):t=Xp(t,e,i),t}function Xp(t,e,i){return"start"===t?e:"end"===t?i:t}function Qp(t,e,i){let{inflateAmount:n}=e;t.inflateAmount="auto"===n?1===i?.33:0:n}class Jp extends Hp{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,n){return Vp(t,e,i,n)}parseArrayData(t,e,i,n){return Vp(t,e,i,n)}parseObjectData(t,e,i,n){const{iScale:r,vScale:s}=t,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l="x"===r.axis?a:o,c="x"===s.axis?a:o,u=[];let h,d,f,p;for(h=i,d=i+n;h<d;++h)p=e[h],f={},f[r.axis]=r.parse(Ad(p,l),h),u.push(Gp(Ad(p,c),f,s,h));return u}updateRangeFromParsed(t,e,i,n){super.updateRangeFromParsed(t,e,i,n);const r=i._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:n}=e,r=this.getParsed(t),s=r._custom,a=Wp(s)?"["+s.start+", "+s.end+"]":""+n.getLabelForValue(r[n.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,n){const r="reset"===n,{index:s,_cachedMeta:{vScale:a}}=this,o=a.getBasePixel(),l=a.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(e,n);for(let d=e;d<e+i;d++){const e=this.getParsed(d),i=r||cd(e[a.axis])?{base:o,head:o}:this._calculateBarValuePixels(d),f=this._calculateBarIndexPixels(d,c),p=(e._stacks||{})[a.axis],g={horizontal:l,base:i.base,enableBorderRadius:!p||Wp(e._custom)||s===p._top||s===p._bottom,x:l?i.head:f.center,y:l?f.center:i.head,height:l?f.size:Math.abs(i.size),width:l?Math.abs(i.size):f.size};h&&(g.options=u||this.resolveDataElementOptions(d,t[d].active?"active":n));const m=g.options||t[d].options;Kp(g,m,p,s),Qp(g,m,c.ratio),this.updateElement(t[d],d,g,n)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,n=i.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),r=i.options.stacked,s=[],a=this._cachedMeta.controller.getParsed(e),o=a&&a[i.axis],l=t=>{const e=t._parsed.find((t=>t[i.axis]===o)),n=e&&e[t.vScale.axis];if(cd(n)||isNaN(n))return!0};for(const c of n)if((void 0===e||!l(c))&&((!1===r||-1===s.indexOf(c.stack)||void 0===r&&void 0===c.stack)&&s.push(c.stack),c.index===t))break;return s.length||s.push(void 0),s}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,i){const n=this._getStacks(t,i),r=void 0!==e?n.indexOf(e):-1;return-1===r?n.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,n=[];let r,s;for(r=0,s=e.data.length;r<s;++r)n.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const a=t.barThickness;return{min:a||qp(e),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:n},options:{base:r,minBarLength:s}}=this,a=r||0,o=this.getParsed(t),l=o._custom,c=Wp(l);let u,h,d=o[e.axis],f=0,p=i?this.applyStack(e,o,i):d;p!==d&&(f=p-d,p=d),c&&(d=l.barStart,p=l.barEnd-l.barStart,0!==d&&Ud(d)!==Ud(l.barEnd)&&(f=0),f+=d);const g=cd(r)||c?f:r;let m=e.getPixelForValue(g);if(u=this.chart.getDataVisibility(t)?e.getPixelForValue(f+p):m,h=u-m,Math.abs(h)<s){h=function(t,e,i){return 0!==t?Ud(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}(h,e,a)*s,d===a&&(m-=h/2);const t=e.getPixelForDecimal(0),r=e.getPixelForDecimal(1),l=Math.min(t,r),f=Math.max(t,r);m=Math.max(Math.min(m,f),l),u=m+h,i&&!c&&(o._stacks[e.axis]._visualValues[n]=e.getValueForPixel(u)-e.getValueForPixel(m))}if(m===e.getPixelForValue(a)){const t=Ud(h)*e.getLineWidthForValue(a)/2;m+=t,h-=t}return{size:h,base:m,head:u,center:u+h/2}}_calculateBarIndexPixels(t,e){const i=e.scale,n=this.options,r=n.skipNull,s=pd(n.maxBarThickness,1/0);let a,o;if(e.grouped){const i=r?this._getStackCount(t):e.stackCount,l="flex"===n.barThickness?function(t,e,i,n){const r=e.pixels,s=r[t];let a=t>0?r[t-1]:null,o=t<r.length-1?r[t+1]:null;const l=i.categoryPercentage;null===a&&(a=s-(null===o?e.end-e.start:o-s)),null===o&&(o=s+s-a);const c=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/n,ratio:i.barPercentage,start:c}}(t,e,n,i):function(t,e,i,n){const r=i.barThickness;let s,a;return cd(r)?(s=e.min*i.categoryPercentage,a=i.barPercentage):(s=r*n,a=1),{chunk:s/n,ratio:a,start:e.pixels[t]-s/2}}(t,e,n,i),c=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);a=l.start+l.chunk*c+l.chunk/2,o=Math.min(s,l.chunk*l.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),o=Math.min(s,e.min*e.ratio);return{base:a-o/2,head:a+o/2,center:a,size:o}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,n=i.length;let r=0;for(;r<n;++r)null===this.getParsed(r)[e.axis]||i[r].hidden||i[r].draw(this._ctx)}}function Zp(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class tg{static override(t){Object.assign(tg.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Zp()}parse(){return Zp()}format(){return Zp()}add(){return Zp()}diff(){return Zp()}startOf(){return Zp()}endOf(){return Zp()}}var eg=tg;function ig(t,e,i,n){const{controller:r,data:s,_sorted:a}=t,o=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&"r"!==e&&a&&s.length){const a=o._reversePixels?ef:tf;if(!n){const n=a(s,e,i);if(l){const{vScale:e}=r._cachedMeta,{_parsed:i}=t,s=i.slice(0,n.lo+1).reverse().findIndex((t=>!cd(t[e.axis])));n.lo-=Math.max(0,s);const a=i.slice(n.hi).findIndex((t=>!cd(t[e.axis])));n.hi+=Math.max(0,a)}return n}if(r._sharedOptions){const t=s[0],n="function"===typeof t.getRange&&t.getRange(e);if(n){const t=a(s,e,i-n),r=a(s,e,i+n);return{lo:t.lo,hi:r.hi}}}}return{lo:0,hi:s.length-1}}function ng(t,e,i,n,r){const s=t.getSortedVisibleDatasetMetas(),a=i[e];for(let o=0,l=s.length;o<l;++o){const{index:t,data:i}=s[o],{lo:l,hi:c}=ig(s[o],e,a,r);for(let e=l;e<=c;++e){const r=i[e];r.skip||n(r,t,e)}}}function rg(t,e,i,n,r){const s=[];if(!r&&!t.isPointInArea(e))return s;return ng(t,i,e,(function(i,a,o){(r||Nf(i,t.chartArea,0))&&i.inRange(e.x,e.y,n)&&s.push({element:i,datasetIndex:a,index:o})}),!0),s}function sg(t,e,i,n,r,s){let a=[];const o=function(t){const e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,n){const r=e?Math.abs(t.x-n.x):0,s=i?Math.abs(t.y-n.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(s,2))}}(i);let l=Number.POSITIVE_INFINITY;return ng(t,i,e,(function(i,c,u){const h=i.inRange(e.x,e.y,r);if(n&&!h)return;const d=i.getCenterPoint(r);if(!(!!s||t.isPointInArea(d))&&!h)return;const f=o(e,d);f<l?(a=[{element:i,datasetIndex:c,index:u}],l=f):f===l&&a.push({element:i,datasetIndex:c,index:u})})),a}function ag(t,e,i,n,r,s){return s||t.isPointInArea(e)?"r"!==i||n?sg(t,e,i,n,r,s):function(t,e,i,n){let r=[];return ng(t,i,e,(function(t,i,s){const{startAngle:a,endAngle:o}=t.getProps(["startAngle","endAngle"],n),{angle:l}=Wd(t,{x:e.x,y:e.y});Xd(l,a,o)&&r.push({element:t,datasetIndex:i,index:s})})),r}(t,e,i,r):[]}function og(t,e,i,n,r){const s=[],a="x"===i?"inXRange":"inYRange";let o=!1;return ng(t,i,e,((t,n,l)=>{t[a]&&t[a](e[i],r)&&(s.push({element:t,datasetIndex:n,index:l}),o=o||t.inRange(e.x,e.y,r))})),n&&!o?[]:s}var lg={evaluateInteractionItems:ng,modes:{index(t,e,i,n){const r=vp(e,t),s=i.axis||"x",a=i.includeInvisible||!1,o=i.intersect?rg(t,r,s,n,a):ag(t,r,s,!1,n,a),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=o[0].index,i=t.data[e];i&&!i.skip&&l.push({element:i,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,i,n){const r=vp(e,t),s=i.axis||"xy",a=i.includeInvisible||!1;let o=i.intersect?rg(t,r,s,n,a):ag(t,r,s,!1,n,a);if(o.length>0){const e=o[0].datasetIndex,i=t.getDatasetMeta(e).data;o=[];for(let t=0;t<i.length;++t)o.push({element:i[t],datasetIndex:e,index:t})}return o},point:(t,e,i,n)=>rg(t,vp(e,t),i.axis||"xy",n,i.includeInvisible||!1),nearest(t,e,i,n){const r=vp(e,t),s=i.axis||"xy",a=i.includeInvisible||!1;return ag(t,r,s,i.intersect,n,a)},x:(t,e,i,n)=>og(t,vp(e,t),"x",i.intersect,n),y:(t,e,i,n)=>og(t,vp(e,t),"y",i.intersect,n)}};const cg=["left","top","right","bottom"];function ug(t,e){return t.filter((t=>t.pos===e))}function hg(t,e){return t.filter((t=>-1===cg.indexOf(t.pos)&&t.box.axis===e))}function dg(t,e){return t.sort(((t,i)=>{const n=e?i:t,r=e?t:i;return n.weight===r.weight?n.index-r.index:n.weight-r.weight}))}function fg(t,e){const i=function(t){const e={};for(const i of t){const{stack:t,pos:n,stackWeight:r}=i;if(!t||!cg.includes(n))continue;const s=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=r}return e}(t),{vBoxMaxWidth:n,hBoxMaxHeight:r}=e;let s,a,o;for(s=0,a=t.length;s<a;++s){o=t[s];const{fullSize:a}=o.box,l=i[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*n:a&&e.availableWidth,o.height=r):(o.width=n,o.height=c?c*r:a&&e.availableHeight)}return i}function pg(t,e,i,n){return Math.max(t[i],e[i])+Math.max(t[n],e[n])}function gg(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function mg(t,e,i,n){const{pos:r,box:s}=i,a=t.maxPadding;if(!hd(r)){i.size&&(t[r]-=i.size);const e=n[i.stack]||{size:0,count:1};e.size=Math.max(e.size,i.horizontal?s.height:s.width),i.size=e.size/e.count,t[r]+=i.size}s.getPadding&&gg(a,s.getPadding());const o=Math.max(0,e.outerWidth-pg(a,t,"left","right")),l=Math.max(0,e.outerHeight-pg(a,t,"top","bottom")),c=o!==t.w,u=l!==t.h;return t.w=o,t.h=l,i.horizontal?{same:c,other:u}:{same:u,other:c}}function vg(t,e){const i=e.maxPadding;function n(t){const n={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{n[t]=Math.max(e[t],i[t])})),n}return n(t?["left","right"]:["top","bottom"])}function yg(t,e,i,n){const r=[];let s,a,o,l,c,u;for(s=0,a=t.length,c=0;s<a;++s){o=t[s],l=o.box,l.update(o.width||e.w,o.height||e.h,vg(o.horizontal,e));const{same:a,other:h}=mg(e,i,o,n);c|=a&&r.length,u=u||h,l.fullSize||r.push(o)}return c&&yg(r,e,i,n)||u}function bg(t,e,i,n,r){t.top=i,t.left=e,t.right=e+n,t.bottom=i+r,t.width=n,t.height=r}function Sg(t,e,i,n){const r=i.padding;let{x:s,y:a}=e;for(const o of t){const t=o.box,l=n[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const n=e.w*c,s=l.size||t.height;kd(l.start)&&(a=l.start),t.fullSize?bg(t,r.left,a,i.outerWidth-r.right-r.left,s):bg(t,e.left+l.placed,a,n,s),l.start=a,l.placed+=n,a=t.bottom}else{const n=e.h*c,a=l.size||t.width;kd(l.start)&&(s=l.start),t.fullSize?bg(t,s,r.top,a,i.outerHeight-r.bottom-r.top):bg(t,s,e.top+l.placed,a,n),l.start=s,l.placed+=n,s=t.right}}e.x=s,e.y=a}var wg={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,n){if(!t)return;const r=Kf(t.options.layout.padding),s=Math.max(e-r.width,0),a=Math.max(i-r.height,0),o=function(t){const e=function(t){const e=[];let i,n,r,s,a,o;for(i=0,n=(t||[]).length;i<n;++i)r=t[i],({position:s,options:{stack:a,stackWeight:o=1}}=r),e.push({index:i,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&s+a,stackWeight:o});return e}(t),i=dg(e.filter((t=>t.box.fullSize)),!0),n=dg(ug(e,"left"),!0),r=dg(ug(e,"right")),s=dg(ug(e,"top"),!0),a=dg(ug(e,"bottom")),o=hg(e,"x"),l=hg(e,"y");return{fullSize:i,leftAndTop:n.concat(s),rightAndBottom:r.concat(l).concat(a).concat(o),chartArea:ug(e,"chartArea"),vertical:n.concat(r).concat(l),horizontal:s.concat(a).concat(o)}}(t.boxes),l=o.vertical,c=o.horizontal;vd(t.boxes,(t=>{"function"===typeof t.beforeLayout&&t.beforeLayout()}));const u=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,h=Object.freeze({outerWidth:e,outerHeight:i,padding:r,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/u,hBoxMaxHeight:a/2}),d=Object.assign({},r);gg(d,Kf(n));const f=Object.assign({maxPadding:d,w:s,h:a,x:r.left,y:r.top},r),p=fg(l.concat(c),h);yg(o.fullSize,f,h,p),yg(l,f,h,p),yg(c,f,h,p)&&yg(l,f,h,p),function(t){const e=t.maxPadding;function i(i){const n=Math.max(e[i]-t[i],0);return t[i]+=n,n}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}(f),Sg(o.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,Sg(o.rightAndBottom,f,h,p),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},vd(o.chartArea,(e=>{const i=e.box;Object.assign(i,t.chartArea),i.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class xg{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,n){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,n?Math.floor(e/n):i)}}isAttached(t){return!0}updateConfig(t){}}class Eg extends xg{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Lg="$chartjs",Tg={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ag=t=>null===t||""===t;const _g=!!wp&&{passive:!0};function kg(t,e,i){t&&t.canvas&&t.canvas.removeEventListener(e,i,_g)}function Pg(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function Rg(t,e,i){const n=t.canvas,r=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||Pg(i.addedNodes,n),e=e&&!Pg(i.removedNodes,n);e&&i()}));return r.observe(document,{childList:!0,subtree:!0}),r}function Ig(t,e,i){const n=t.canvas,r=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||Pg(i.removedNodes,n),e=e&&!Pg(i.addedNodes,n);e&&i()}));return r.observe(document,{childList:!0,subtree:!0}),r}const Cg=new Map;let Dg=0;function Ng(){const t=window.devicePixelRatio;t!==Dg&&(Dg=t,Cg.forEach(((e,i)=>{i.currentDevicePixelRatio!==t&&e()})))}function Og(t,e,i){const n=t.canvas,r=n&&dp(n);if(!r)return;const s=of(((t,e)=>{const n=r.clientWidth;i(t,e),n<r.clientWidth&&i()}),window),a=new ResizeObserver((t=>{const e=t[0],i=e.contentRect.width,n=e.contentRect.height;0===i&&0===n||s(i,n)}));return a.observe(r),function(t,e){Cg.size||window.addEventListener("resize",Ng),Cg.set(t,e)}(t,s),a}function Mg(t,e,i){i&&i.disconnect(),"resize"===e&&function(t){Cg.delete(t),Cg.size||window.removeEventListener("resize",Ng)}(t)}function Fg(t,e,i){const n=t.canvas,r=of((e=>{null!==t.ctx&&i(function(t,e){const i=Tg[t.type]||t.type,{x:n,y:r}=vp(t,e);return{type:i,chart:e,native:t,x:void 0!==n?n:null,y:void 0!==r?r:null}}(e,t))}),t);return function(t,e,i){t&&t.addEventListener(e,i,_g)}(n,e,r),r}class Bg extends xg{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(function(t,e){const i=t.style,n=t.getAttribute("height"),r=t.getAttribute("width");if(t[Lg]={initial:{height:n,width:r,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",Ag(r)){const e=xp(t,"width");void 0!==e&&(t.width=e)}if(Ag(n))if(""===t.style.height)t.height=t.width/(e||2);else{const e=xp(t,"height");void 0!==e&&(t.height=e)}}(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[Lg])return!1;const i=e[Lg].initial;["height","width"].forEach((t=>{const n=i[t];cd(n)?e.removeAttribute(t):e.setAttribute(t,n)}));const n=i.style||{};return Object.keys(n).forEach((t=>{e.style[t]=n[t]})),e.width=e.width,delete e[Lg],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const n=t.$proxies||(t.$proxies={}),r={attach:Rg,detach:Ig,resize:Og}[e]||Fg;n[e]=r(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),n=i[e];if(!n)return;({attach:Mg,detach:Mg,resize:Mg}[e]||kg)(t,e,n),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,n){return bp(t,e,i,n)}isAttached(t){const e=t&&dp(t);return!(!e||!e.isConnected)}}class Ug{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return zd(this.x)&&zd(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const n={};return t.forEach((t=>{n[t]=i[t]&&i[t].active()?i[t]._to:this[t]})),n}}function jg(t,e){const i=t.options.ticks,n=function(t){const e=t.options.offset,i=t._tickSize(),n=t._length/i+(e?0:1),r=t._maxLength/i;return Math.floor(Math.min(n,r))}(t),r=Math.min(i.maxTicksLimit||n,n),s=i.major.enabled?function(t){const e=[];let i,n;for(i=0,n=t.length;i<n;i++)t[i].major&&e.push(i);return e}(e):[],a=s.length,o=s[0],l=s[a-1],c=[];if(a>r)return function(t,e,i,n){let r,s=0,a=i[0];for(n=Math.ceil(n),r=0;r<t.length;r++)r===a&&(e.push(t[r]),s++,a=i[s*n])}(e,c,s,a/r),c;const u=function(t,e,i){const n=function(t){const e=t.length;let i,n;if(e<2)return!1;for(n=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==n)return!1;return n}(t),r=e.length/i;if(!n)return Math.max(r,1);const s=function(t){const e=[],i=Math.sqrt(t);let n;for(n=1;n<i;n++)t%n===0&&(e.push(n),e.push(t/n));return i===(0|i)&&e.push(i),e.sort(((t,e)=>t-e)).pop(),e}(n);for(let a=0,o=s.length-1;a<o;a++){const t=s[a];if(t>r)return t}return Math.max(r,1)}(s,e,r);if(a>0){let t,i;const n=a>1?Math.round((l-o)/(a-1)):null;for($g(e,c,u,cd(n)?0:o-n,o),t=0,i=a-1;t<i;t++)$g(e,c,u,s[t],s[t+1]);return $g(e,c,u,l,cd(n)?e.length:l+n),c}return $g(e,c,u),c}function $g(t,e,i,n,r){const s=pd(n,0),a=Math.min(pd(r,t.length),t.length);let o,l,c,u=0;for(i=Math.ceil(i),r&&(o=r-n,i=o/Math.floor(o/i)),c=s;c<0;)u++,c=Math.round(s+u*i);for(l=Math.max(s,0);l<a;l++)l===c&&(e.push(t[l]),u++,c=Math.round(s+u*i))}const zg=(t,e,i)=>"top"===e||"left"===e?t[e]+i:t[e]-i,Hg=(t,e)=>Math.min(e||t,t);function qg(t,e){const i=[],n=t.length/e,r=t.length;let s=0;for(;s<r;s+=n)i.push(t[Math.floor(s)]);return i}function Gg(t,e,i){const n=t.ticks.length,r=Math.min(e,n-1),s=t._startPixel,a=t._endPixel,o=1e-6;let l,c=t.getPixelForTick(r);if(!(i&&(l=1===n?Math.max(c-s,a-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(r-1))/2,c+=r<e?l:-l,c<s-o||c>a+o)))return c}function Vg(t){return t.drawTicks?t.tickLength:0}function Wg(t,e){if(!t.display)return 0;const i=Yf(t.font,e),n=Kf(t.padding);return(ud(t.text)?t.text.length:1)*i.lineHeight+n.height}function Kg(t,e,i){let n=lf(t);return(i&&"right"!==e||!i&&"right"===e)&&(n=(t=>"left"===t?"right":"right"===t?"left":t)(n)),n}class Yg extends Ug{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:n}=this;return t=fd(t,Number.POSITIVE_INFINITY),e=fd(e,Number.NEGATIVE_INFINITY),i=fd(i,Number.POSITIVE_INFINITY),n=fd(n,Number.NEGATIVE_INFINITY),{min:fd(t,i),max:fd(e,n),minDefined:dd(t),maxDefined:dd(e)}}getMinMax(t){let e,{min:i,max:n,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:i,max:n};const a=this.getMatchingVisibleMetas();for(let o=0,l=a.length;o<l;++o)e=a[o].controller.getMinMax(this,t),r||(i=Math.min(i,e.min)),s||(n=Math.max(n,e.max));return i=s&&i>n?n:i,n=r&&i>n?i:n,{min:fd(i,fd(n,i)),max:fd(n,fd(i,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){md(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:n,grace:r,ticks:s}=this.options,a=s.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,i){const{min:n,max:r}=t,s=gd(e,(r-n)/2),a=(t,e)=>i&&0===t?0:t+e;return{min:a(n,-Math.abs(s)),max:a(r,s)}}(this,r,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=a<this.ticks.length;this._convertTicksToLabels(o?qg(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=jg(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,i=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,i=!i),this._startPixel=t,this._endPixel=e,this._reversePixels=i,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){md(this.options.afterUpdate,[this])}beforeSetDimensions(){md(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){md(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),md(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){md(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,n,r;for(i=0,n=t.length;i<n;i++)r=t[i],r.label=md(e.callback,[r.value,i,t],this)}afterTickToLabelConversion(){md(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){md(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=Hg(this.ticks.length,t.ticks.maxTicksLimit),n=e.minRotation||0,r=e.maxRotation;let s,a,o,l=n;if(!this._isVisible()||!e.display||n>=r||i<=1||!this.isHorizontal())return void(this.labelRotation=n);const c=this._getLabelSizes(),u=c.widest.width,h=c.highest.height,d=Qd(this.chart.width-u,0,this.maxWidth);s=t.offset?this.maxWidth/i:d/(i-1),u+6>s&&(s=d/(i-(t.offset?.5:1)),a=this.maxHeight-Vg(t.grid)-e.padding-Wg(t.title,this.chart.options.font),o=Math.sqrt(u*u+h*h),l=Gd(Math.min(Math.asin(Qd((c.highest.height+6)/s,-1,1)),Math.asin(Qd(a/o,-1,1))-Math.asin(Qd(h/o,-1,1)))),l=Math.max(n,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){md(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){md(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:n,grid:r}}=this,s=this._isVisible(),a=this.isHorizontal();if(s){const s=Wg(n,e.options.font);if(a?(t.width=this.maxWidth,t.height=Vg(r)+s):(t.height=this.maxHeight,t.width=Vg(r)+s),i.display&&this.ticks.length){const{first:e,last:n,widest:r,highest:s}=this._getLabelSizes(),o=2*i.padding,l=qd(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(a){const e=i.mirror?0:u*r.width+c*s.height;t.height=Math.min(this.maxHeight,t.height+e+o)}else{const e=i.mirror?0:c*r.width+u*s.height;t.width=Math.min(this.maxWidth,t.width+e+o)}this._calculatePadding(e,n,u,c)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,n){const{ticks:{align:r,padding:s},position:a}=this.options,o=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;o?l?(u=n*t.width,h=i*e.height):(u=i*t.height,h=n*e.width):"start"===r?h=e.width:"end"===r?u=t.width:"inner"!==r&&(u=t.width/2,h=e.width/2),this.paddingLeft=Math.max((u-a+s)*this.width/(this.width-a),0),this.paddingRight=Math.max((h-c+s)*this.width/(this.width-c),0)}else{let i=e.height/2,n=t.height/2;"start"===r?(i=0,n=t.height):"end"===r&&(i=e.height,n=0),this.paddingTop=i+s,this.paddingBottom=n+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){md(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,i=t.length;e<i;e++)cd(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=qg(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:n,_longestTextCache:r}=this,s=[],a=[],o=Math.floor(e/Hg(e,i));let l,c,u,h,d,f,p,g,m,v,y,b=0,S=0;for(l=0;l<e;l+=o){if(h=t[l].label,d=this._resolveTickFontOptions(l),n.font=f=d.string,p=r[f]=r[f]||{data:{},gc:[]},g=d.lineHeight,m=v=0,cd(h)||ud(h)){if(ud(h))for(c=0,u=h.length;c<u;++c)y=h[c],cd(y)||ud(y)||(m=Pf(n,p.data,p.gc,m,y),v+=g)}else m=Pf(n,p.data,p.gc,m,h),v=g;s.push(m),a.push(v),b=Math.max(m,b),S=Math.max(v,S)}!function(t,e){vd(t,(t=>{const i=t.gc,n=i.length/2;let r;if(n>e){for(r=0;r<n;++r)delete t.data[i[r]];i.splice(0,n)}}))}(r,e);const w=s.indexOf(b),x=a.indexOf(S),E=t=>({width:s[t]||0,height:a[t]||0});return{first:E(0),last:E(e-1),widest:E(w),highest:E(x),widths:s,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Qd(this._alignToPixels?Rf(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=function(t,e,i){return Qf(t,{tick:i,index:e,type:"tick"})}(this.getContext(),t,i))}return this.$context||(this.$context=Qf(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=qd(this.labelRotation),i=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e)),r=this._getLabelSizes(),s=t.autoSkipPadding||0,a=r?r.widest.width+s:0,o=r?r.highest.height+s:0;return this.isHorizontal()?o*i>a*n?a/i:o/n:o*n<a*i?o/i:a/n}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,n=this.options,{grid:r,position:s,border:a}=n,o=r.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),u=Vg(r),h=[],d=a.setContext(this.getContext()),f=d.display?d.width:0,p=f/2,g=function(t){return Rf(i,t,f)};let m,v,y,b,S,w,x,E,L,T,A,_;if("top"===s)m=g(this.bottom),w=this.bottom-u,E=m-p,T=g(t.top)+p,_=t.bottom;else if("bottom"===s)m=g(this.top),T=t.top,_=g(t.bottom)-p,w=m+p,E=this.top+u;else if("left"===s)m=g(this.right),S=this.right-u,x=m-p,L=g(t.left)+p,A=t.right;else if("right"===s)m=g(this.left),L=t.left,A=g(t.right)-p,S=m+p,x=this.left+u;else if("x"===e){if("center"===s)m=g((t.top+t.bottom)/2+.5);else if(hd(s)){const t=Object.keys(s)[0],e=s[t];m=g(this.chart.scales[t].getPixelForValue(e))}T=t.top,_=t.bottom,w=m+p,E=w+u}else if("y"===e){if("center"===s)m=g((t.left+t.right)/2);else if(hd(s)){const t=Object.keys(s)[0],e=s[t];m=g(this.chart.scales[t].getPixelForValue(e))}S=m-p,x=S-u,L=t.left,A=t.right}const k=pd(n.ticks.maxTicksLimit,c),P=Math.max(1,Math.ceil(c/k));for(v=0;v<c;v+=P){const t=this.getContext(v),e=r.setContext(t),n=a.setContext(t),s=e.lineWidth,c=e.color,u=n.dash||[],d=n.dashOffset,f=e.tickWidth,p=e.tickColor,g=e.tickBorderDash||[],m=e.tickBorderDashOffset;y=Gg(this,v,o),void 0!==y&&(b=Rf(i,y,s),l?S=x=L=A=b:w=E=T=_=b,h.push({tx1:S,ty1:w,tx2:x,ty2:E,x1:L,y1:T,x2:A,y2:_,width:s,color:c,borderDash:u,borderDashOffset:d,tickWidth:f,tickColor:p,tickBorderDash:g,tickBorderDashOffset:m}))}return this._ticksLength=c,this._borderValue=m,h}_computeLabelItems(t){const e=this.axis,i=this.options,{position:n,ticks:r}=i,s=this.isHorizontal(),a=this.ticks,{align:o,crossAlign:l,padding:c,mirror:u}=r,h=Vg(i.grid),d=h+c,f=u?-c:d,p=-qd(this.labelRotation),g=[];let m,v,y,b,S,w,x,E,L,T,A,_,k="middle";if("top"===n)w=this.bottom-f,x=this._getXAxisLabelAlignment();else if("bottom"===n)w=this.top+f,x=this._getXAxisLabelAlignment();else if("left"===n){const t=this._getYAxisLabelAlignment(h);x=t.textAlign,S=t.x}else if("right"===n){const t=this._getYAxisLabelAlignment(h);x=t.textAlign,S=t.x}else if("x"===e){if("center"===n)w=(t.top+t.bottom)/2+d;else if(hd(n)){const t=Object.keys(n)[0],e=n[t];w=this.chart.scales[t].getPixelForValue(e)+d}x=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===n)S=(t.left+t.right)/2-d;else if(hd(n)){const t=Object.keys(n)[0],e=n[t];S=this.chart.scales[t].getPixelForValue(e)}x=this._getYAxisLabelAlignment(h).textAlign}"y"===e&&("start"===o?k="top":"end"===o&&(k="bottom"));const P=this._getLabelSizes();for(m=0,v=a.length;m<v;++m){y=a[m],b=y.label;const t=r.setContext(this.getContext(m));E=this.getPixelForTick(m)+r.labelOffset,L=this._resolveTickFontOptions(m),T=L.lineHeight,A=ud(b)?b.length:1;const e=A/2,i=t.color,o=t.textStrokeColor,c=t.textStrokeWidth;let h,d=x;if(s?(S=E,"inner"===x&&(d=m===v-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),_="top"===n?"near"===l||0!==p?-A*T+T/2:"center"===l?-P.highest.height/2-e*T+T:-P.highest.height+T/2:"near"===l||0!==p?T/2:"center"===l?P.highest.height/2-e*T:P.highest.height-A*T,u&&(_*=-1),0===p||t.showLabelBackdrop||(S+=T/2*Math.sin(p))):(w=E,_=(1-A)*T/2),t.showLabelBackdrop){const e=Kf(t.backdropPadding),i=P.heights[m],n=P.widths[m];let r=_-e.top,s=0-e.left;switch(k){case"middle":r-=i/2;break;case"bottom":r-=i}switch(x){case"center":s-=n/2;break;case"right":s-=n;break;case"inner":m===v-1?s-=n:m>0&&(s-=n/2)}h={left:s,top:r,width:n+e.width,height:i+e.height,color:t.backdropColor}}g.push({label:b,font:L,textOffset:_,options:{rotation:p,color:i,strokeColor:o,strokeWidth:c,textAlign:d,textBaseline:k,translation:[S,w],backdrop:h}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-qd(this.labelRotation))return"top"===t?"left":"right";let i="center";return"start"===e.align?i="left":"end"===e.align?i="right":"inner"===e.align&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:n,padding:r}}=this.options,s=t+r,a=this._getLabelSizes().widest.width;let o,l;return"left"===e?n?(l=this.right+r,"near"===i?o="left":"center"===i?(o="center",l+=a/2):(o="right",l+=a)):(l=this.right-s,"near"===i?o="right":"center"===i?(o="center",l-=a/2):(o="left",l=this.left)):"right"===e?n?(l=this.left+r,"near"===i?o="right":"center"===i?(o="center",l-=a/2):(o="left",l-=a)):(l=this.left+s,"near"===i?o="left":"center"===i?(o="center",l+=a/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:n,width:r,height:s}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,n,r,s),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex((e=>e.value===t));if(i>=0){return e.setContext(this.getContext(i)).lineWidth}return 0}drawGrid(t){const e=this.options.grid,i=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,s;const a=(t,e,n)=>{n.width&&n.color&&(i.save(),i.lineWidth=n.width,i.strokeStyle=n.color,i.setLineDash(n.borderDash||[]),i.lineDashOffset=n.borderDashOffset,i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.stroke(),i.restore())};if(e.display)for(r=0,s=n.length;r<s;++r){const t=n[r];e.drawOnChartArea&&a({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&a({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:n}}=this,r=i.setContext(this.getContext()),s=i.display?r.width:0;if(!s)return;const a=n.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=Rf(t,this.left,s)-s/2,c=Rf(t,this.right,a)+a/2,u=h=o):(u=Rf(t,this.top,s)-s/2,h=Rf(t,this.bottom,a)+a/2,l=c=o),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(l,u),e.lineTo(c,h),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,i=this._computeLabelArea();i&&Of(e,i);const n=this.getLabelItems(t);for(const r of n){const t=r.options,i=r.font;Uf(e,r.label,0,r.textOffset,i,t)}i&&Mf(e)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:n}}=this;if(!i.display)return;const r=Yf(i.font),s=Kf(i.padding),a=i.align;let o=r.lineHeight/2;"bottom"===e||"center"===e||hd(e)?(o+=s.bottom,ud(i.text)&&(o+=r.lineHeight*(i.text.length-1))):o+=s.top;const{titleX:l,titleY:c,maxWidth:u,rotation:h}=function(t,e,i,n){const{top:r,left:s,bottom:a,right:o,chart:l}=t,{chartArea:c,scales:u}=l;let h,d,f,p=0;const g=a-r,m=o-s;if(t.isHorizontal()){if(d=cf(n,s,o),hd(i)){const t=Object.keys(i)[0],n=i[t];f=u[t].getPixelForValue(n)+g-e}else f="center"===i?(c.bottom+c.top)/2+g-e:zg(t,i,e);h=o-s}else{if(hd(i)){const t=Object.keys(i)[0],n=i[t];d=u[t].getPixelForValue(n)-m+e}else d="center"===i?(c.left+c.right)/2-m+e:zg(t,i,e);f=cf(n,a,r),p="left"===i?-Od:Od}return{titleX:d,titleY:f,maxWidth:h,rotation:p}}(this,o,e,a);Uf(t,i.text,0,0,r,{color:i.color,maxWidth:u,rotation:h,textAlign:Kg(a,e,n),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=pd(t.grid&&t.grid.z,-1),n=pd(t.border&&t.border.z,0);return this._isVisible()&&this.draw===Yg.prototype.draw?[{z:i,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let r,s;for(r=0,s=e.length;r<s;++r){const s=e[r];s[i]!==this.id||t&&s.type!==t||n.push(s)}return n}_resolveTickFontOptions(t){return Yf(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Xg{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;(function(t){return"id"in t&&"defaults"in t})(e)&&(i=this.register(e));const n=this.items,r=t.id,s=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in n||(n[r]=t,function(t,e,i){const n=xd(Object.create(null),[i?kf.get(i):{},kf.get(e),t.defaults]);kf.set(e,n),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((i=>{const n=i.split("."),r=n.pop(),s=[t].concat(n).join("."),a=e[i].split("."),o=a.pop(),l=a.join(".");kf.route(s,r,l,o)}))}(e,t.defaultRoutes);t.descriptors&&kf.describe(e,t.descriptors)}(t,s,i),this.override&&kf.override(t.id,t.overrides)),s}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,n=this.scope;i in e&&delete e[i],n&&i in kf[n]&&(delete kf[n][i],this.override&&delete Ef[i])}}class Qg{constructor(){this.controllers=new Xg(Hp,"datasets",!0),this.elements=new Xg(Ug,"elements"),this.plugins=new Xg(Object,"plugins"),this.scales=new Xg(Yg,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("register",e)}remove(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("unregister",e)}addControllers(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("register",e,this.controllers)}addElements(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("register",e,this.elements)}addPlugins(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("register",e,this.plugins)}addScales(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("register",e,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("unregister",e,this.controllers)}removeElements(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("unregister",e,this.elements)}removePlugins(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("unregister",e,this.plugins)}removeScales(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._each("unregister",e,this.scales)}_each(t,e,i){[...e].forEach((e=>{const n=i||this._getRegistryForType(e);i||n.isForType(e)||n===this.plugins&&e.id?this._exec(t,n,e):vd(e,(e=>{const n=i||this._getRegistryForType(e);this._exec(t,n,e)}))}))}_exec(t,e,i){const n=_d(t);md(i["before"+n],[],i),e[t](i),md(i["after"+n],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const n=e.get(t);if(void 0===n)throw new Error('"'+t+'" is not a registered '+i+".");return n}}var Jg=new Qg;class Zg{constructor(){this._init=[]}notify(t,e,i,n){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=n?this._descriptors(t).filter(n):this._descriptors(t),s=this._notify(r,t,e,i);return"afterDestroy"===e&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),s}_notify(t,e,i,n){n=n||{};for(const r of t){const t=r.plugin;if(!1===md(t[i],[e,n,r.options],t)&&n.cancelable)return!1}return!0}invalidate(){cd(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,n=pd(i.options&&i.options.plugins,{}),r=function(t){const e={},i=[],n=Object.keys(Jg.plugins.items);for(let s=0;s<n.length;s++)i.push(Jg.getPlugin(n[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const t=r[s];-1===i.indexOf(t)&&(i.push(t),e[t.id]=!0)}return{plugins:i,localIds:e}}(i);return!1!==n||e?function(t,e,i,n){let{plugins:r,localIds:s}=e;const a=[],o=t.getContext();for(const l of r){const e=l.id,r=tm(i[e],n);null!==r&&a.push({plugin:l,options:em(t.config,{plugin:l,local:s[e]},r,o)})}return a}(t,r,n,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,n=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(n(e,i),t,"stop"),this._notify(n(i,e),t,"start")}}function tm(t,e){return e||!1!==t?!0===t?{}:t:null}function em(t,e,i,n){let{plugin:r,local:s}=e;const a=t.pluginScopeKeys(r),o=t.getOptionScopes(i,a);return s&&r.defaults&&o.push(r.defaults),t.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function im(t,e){const i=kf.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function nm(t){if("x"===t||"y"===t||"r"===t)return t}function rm(t){if(nm(t))return t;for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];for(const s of i){const e=s.axis||("top"===(r=s.position)||"bottom"===r?"x":"left"===r||"right"===r?"y":void 0)||t.length>1&&nm(t[0].toLowerCase());if(e)return e}var r;throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function sm(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function am(t,e){const i=Ef[t.type]||{scales:{}},n=e.scales||{},r=im(t.type,e),s=Object.create(null);return Object.keys(n).forEach((e=>{const a=n[e];if(!hd(a))return console.error(`Invalid scale configuration for scale: ${e}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const o=rm(e,a,function(t,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter((e=>e.xAxisID===t||e.yAxisID===t));if(i.length)return sm(t,"x",i[0])||sm(t,"y",i[0])}return{}}(e,t),kf.scales[a.type]),l=function(t,e){return t===e?"_index_":"_value_"}(o,r),c=i.scales||{};s[e]=Ed(Object.create(null),[{axis:o},a,c[o],c[l]])})),t.data.datasets.forEach((i=>{const r=i.type||t.type,a=i.indexAxis||im(r,e),o=(Ef[r]||{}).scales||{};Object.keys(o).forEach((t=>{const e=function(t,e){let i=t;return"_index_"===t?i=e:"_value_"===t&&(i="x"===e?"y":"x"),i}(t,a),r=i[e+"AxisID"]||e;s[r]=s[r]||Object.create(null),Ed(s[r],[{axis:e},n[r],o[t]])}))})),Object.keys(s).forEach((t=>{const e=s[t];Ed(e,[kf.scales[e.type],kf.scale])})),s}function om(t){const e=t.options||(t.options={});e.plugins=pd(e.plugins,{}),e.scales=am(t,e)}function lm(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const cm=new Map,um=new Set;function hm(t,e){let i=cm.get(t);return i||(i=e(),cm.set(t,i),um.add(i)),i}const dm=(t,e,i)=>{const n=Ad(e,i);void 0!==n&&t.add(n)};class fm{constructor(t){this._config=function(t){return(t=t||{}).data=lm(t.data),om(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=lm(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),om(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return hm(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return hm(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return hm(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return hm(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const i=this._scopeCache;let n=i.get(t);return n&&!e||(n=new Map,i.set(t,n)),n}getOptionScopes(t,e,i){const{options:n,type:r}=this,s=this._cachedScopes(t,i),a=s.get(e);if(a)return a;const o=new Set;e.forEach((e=>{t&&(o.add(t),e.forEach((e=>dm(o,t,e)))),e.forEach((t=>dm(o,n,t))),e.forEach((t=>dm(o,Ef[r]||{},t))),e.forEach((t=>dm(o,kf,t))),e.forEach((t=>dm(o,Lf,t)))}));const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),um.has(e)&&s.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,Ef[e]||{},kf.datasets[e]||{},{type:e},kf,Lf]}resolveNamedOptions(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const r={$shared:!0},{resolver:s,subPrefixes:a}=pm(this._resolverCache,t,n);let o=s;if(function(t,e){const{isScriptable:i,isIndexable:n}=tp(t);for(const r of e){const e=i(r),s=n(r),a=(s||e)&&t[r];if(e&&(Pd(a)||gm(a))||s&&ud(a))return!0}return!1}(s,e)){r.$shared=!1;o=Zf(s,i=Pd(i)?i():i,this.createResolver(t,i,a))}for(const l of e)r[l]=o[l];return r}createResolver(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],n=arguments.length>3?arguments[3]:void 0;const{resolver:r}=pm(this._resolverCache,t,i);return hd(e)?Zf(r,e,void 0,n):r}}function pm(t,e,i){let n=t.get(e);n||(n=new Map,t.set(e,n));const r=i.join();let s=n.get(r);if(!s){s={resolver:Jf(e,i),subPrefixes:i.filter((t=>!t.toLowerCase().includes("hover")))},n.set(r,s)}return s}const gm=t=>hd(t)&&Object.getOwnPropertyNames(t).some((e=>Pd(t[e])));const mm=["top","bottom","left","right","chartArea"];function vm(t,e){return"top"===t||"bottom"===t||-1===mm.indexOf(t)&&"x"===e}function ym(t,e){return function(i,n){return i[t]===n[t]?i[e]-n[e]:i[t]-n[t]}}function bm(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),md(i&&i.onComplete,[t],e)}function Sm(t){const e=t.chart,i=e.options.animation;md(i&&i.onProgress,[t],e)}function wm(t){return hp()&&"string"===typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const xm={},Em=t=>{const e=wm(t);return Object.values(xm).filter((t=>t.canvas===e)).pop()};function Lm(t,e,i){const n=Object.keys(t);for(const r of n){const n=+r;if(n>=e){const s=t[r];delete t[r],(i>0||n>e)&&(t[n+i]=s)}}}function Tm(t,e,i){return t.options.clip?t[i]:e[i]}class Am{static defaults=(()=>kf)();static instances=(()=>xm)();static overrides=(()=>Ef)();static registry=(()=>Jg)();static version="4.4.8";static getChart=(()=>Em)();static register(){Jg.add(...arguments),_m()}static unregister(){Jg.remove(...arguments),_m()}constructor(t,e){const i=this.config=new fm(e),n=wm(t),r=Em(n);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const s=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||function(t){return!hp()||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas?Eg:Bg}(n)),this.platform.updateConfig(i);const a=this.platform.acquireContext(n,s.aspectRatio),o=a&&a.canvas,l=o&&o.height,c=o&&o.width;this.id=ld(),this.ctx=a,this.canvas=o,this.width=c,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Zg,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let i;return function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e?(clearTimeout(i),i=setTimeout(t,e,r)):t.apply(this,r),e}}((t=>this.update(t)),s.resizeDelay||0),this._dataChanges=[],xm[this.id]=this,a&&o?(_p.listen(this,"complete",bm),_p.listen(this,"progress",Sm),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:n,_aspectRatio:r}=this;return cd(t)?e&&r?r:n?i/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Jg}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Sp(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return If(this.canvas,this.ctx),this}stop(){return _p.stop(this),this}resize(t,e){_p.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,n=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(n,t,e,r),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,Sp(this,a,!0)&&(this.notifyPlugins("resize",{size:s}),md(i.onResize,[this,s],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){vd(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,n=Object.keys(i).reduce(((t,e)=>(t[e]=!1,t)),{});let r=[];e&&(r=r.concat(Object.keys(e).map((t=>{const i=e[t],n=rm(t,i),r="r"===n,s="x"===n;return{options:i,dposition:r?"chartArea":s?"bottom":"left",dtype:r?"radialLinear":s?"category":"linear"}})))),vd(r,(e=>{const r=e.options,s=r.id,a=rm(s,r),o=pd(r.type,e.dtype);void 0!==r.position&&vm(r.position,a)===vm(e.dposition)||(r.position=e.dposition),n[s]=!0;let l=null;if(s in i&&i[s].type===o)l=i[s];else{l=new(Jg.getScale(o))({id:s,type:o,ctx:this.ctx,chart:this}),i[l.id]=l}l.init(r,t)})),vd(n,((t,e)=>{t||delete i[e]})),vd(i,(t=>{wg.configure(this,t,t.options),wg.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort(((t,e)=>t.index-e.index)),i>e){for(let t=e;t<i;++t)this._destroyDatasetMeta(t);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(ym("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,i)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(i)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,n;for(this._removeUnreferencedMetasets(),i=0,n=e.length;i<n;i++){const n=e[i];let r=this.getDatasetMeta(i);const s=n.type||this.config.type;if(r.type&&r.type!==s&&(this._destroyDatasetMeta(i),r=this.getDatasetMeta(i)),r.type=s,r.indexAxis=n.indexAxis||im(s,this.options),r.order=n.order||0,r.index=i,r.label=""+n.label,r.visible=this.isDatasetVisible(i),r.controller)r.controller.updateIndex(i),r.controller.linkScales();else{const e=Jg.getController(s),{datasetElementType:n,dataElementType:a}=kf.datasets[s];Object.assign(e,{dataElementType:Jg.getElement(a),datasetElementType:n&&Jg.getElement(n)}),r.controller=new e(this,i),t.push(r.controller)}}return this._updateMetasets(),t}_resetElements(){vd(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:t}=this.getDatasetMeta(l),e=!n&&-1===r.indexOf(t);t.buildOrUpdateElements(e),s=Math.max(+t.getMaxOverflow(),s)}s=this._minPadding=i.layout.autoPadding?s:0,this._updateLayout(s),n||vd(r,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(ym("z","_idx"));const{_active:a,_lastEvent:o}=this;o?this._eventHandler(o,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){vd(this.scales,(t=>{wg.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);Rd(e,i)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:n,count:r}of e){Lm(t,n,"_removeElements"===i?-r:r)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),n=i(0);for(let r=1;r<e;r++)if(!Rd(n,i(r)))return;return Array.from(n).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;wg.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],vd(this.boxes,(t=>{i&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,Pd(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),n={meta:i,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(i.controller._update(e),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(_p.has(this)?this.attached&&!_p.running(this)&&_p.start(this):(this.draw(),bm({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(t,e)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let n,r;for(n=0,r=e.length;n<r;++n){const r=e[n];t&&!r.visible||i.push(r)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i=t._clip,n=!i.disabled,r=function(t,e){const{xScale:i,yScale:n}=t;return i&&n?{left:Tm(i,e,"left"),right:Tm(i,e,"right"),top:Tm(n,e,"top"),bottom:Tm(n,e,"bottom")}:e}(t,this.chartArea),s={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(n&&Of(e,{left:!1===i.left?0:r.left-i.left,right:!1===i.right?this.width:r.right+i.right,top:!1===i.top?0:r.top-i.top,bottom:!1===i.bottom?this.height:r.bottom+i.bottom}),t.controller.draw(),n&&Mf(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return Nf(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,n){const r=lg.modes[e];return"function"===typeof r?r(this,t,i,n):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let n=i.filter((t=>t&&t._dataset===e)).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=Qf(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return"boolean"===typeof i.hidden?!i.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const n=i?"show":"hide",r=this.getDatasetMeta(t),s=r.controller._resolveAnimations(void 0,n);kd(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),s.update(r,{visible:i}),this.update((e=>e.datasetIndex===t?n:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),_p.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),If(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete xm[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(i,n)=>{e.addEventListener(this,i,n),t[i]=n},n=(t,e,i)=>{t.offsetX=e,t.offsetY=i,this._eventHandler(t)};vd(this.options.events,(t=>i(t,n)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(i,n)=>{e.addEventListener(this,i,n),t[i]=n},n=(i,n)=>{t[i]&&(e.removeEventListener(this,i,n),delete t[i])},r=(t,e)=>{this.canvas&&this.resize(t,e)};let s;const a=()=>{n("attach",a),this.attached=!0,this.resize(),i("resize",r),i("detach",s)};s=()=>{this.attached=!1,n("resize",r),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():s()}unbindEvents(){vd(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},vd(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const n=i?"set":"remove";let r,s,a,o;for("dataset"===e&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+n+"DatasetHoverStyle"]()),a=0,o=t.length;a<o;++a){s=t[a];const e=s&&this.getDatasetMeta(s.datasetIndex).controller;e&&e[n+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map((t=>{let{datasetIndex:e,index:i}=t;const n=this.getDatasetMeta(e);if(!n)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:n.data[i],index:i}}));!yd(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,i){const n=this.options.hover,r=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),s=r(e,t),a=i?t:r(t,e);s.length&&this.updateHoverStyle(s,n.mode,!1),a.length&&n.mode&&this.updateHoverStyle(a,n.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,n))return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(r||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:n=[],options:r}=this,s=e,a=this._getActiveElements(t,n,i,s),o=function(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(t),l=function(t,e,i,n){return i&&"mouseout"!==t.type?n?e:t:null}(t,this._lastEvent,i,o);i&&(this._lastEvent=null,md(r.onHover,[t,a,this],this),o&&md(r.onClick,[t,a,this],this));const c=!yd(a,n);return(c||e)&&(this._active=a,this._updateHoverStyles(a,n,e)),this._lastEvent=l,c}_getActiveElements(t,e,i,n){if("mouseout"===t.type)return[];if(!i)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,n)}}function _m(){return vd(Am.instances,(t=>t._plugins.invalidate()))}function km(t,e){const{x:i,y:n,base:r,width:s,height:a}=t.getProps(["x","y","base","width","height"],e);let o,l,c,u,h;return t.horizontal?(h=a/2,o=Math.min(i,r),l=Math.max(i,r),c=n-h,u=n+h):(h=s/2,o=i-h,l=i+h,c=Math.min(n,r),u=Math.max(n,r)),{left:o,top:c,right:l,bottom:u}}function Pm(t,e,i,n){return t?0:Qd(e,i,n)}function Rm(t){const e=km(t),i=e.right-e.left,n=e.bottom-e.top,r=function(t,e,i){const n=t.options.borderWidth,r=t.borderSkipped,s=Vf(n);return{t:Pm(r.top,s.top,0,i),r:Pm(r.right,s.right,0,e),b:Pm(r.bottom,s.bottom,0,i),l:Pm(r.left,s.left,0,e)}}(t,i/2,n/2),s=function(t,e,i){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,s=Wf(r),a=Math.min(e,i),o=t.borderSkipped,l=n||hd(r);return{topLeft:Pm(!l||o.top||o.left,s.topLeft,0,a),topRight:Pm(!l||o.top||o.right,s.topRight,0,a),bottomLeft:Pm(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:Pm(!l||o.bottom||o.right,s.bottomRight,0,a)}}(t,i/2,n/2);return{outer:{x:e.left,y:e.top,w:i,h:n,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:i-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function Im(t,e,i,n){const r=null===e,s=null===i,a=t&&!(r&&s)&&km(t,n);return a&&(r||Jd(e,a.left,a.right))&&(s||Jd(i,a.top,a.bottom))}function Cm(t,e){t.rect(e.x,e.y,e.w,e.h)}function Dm(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=t.x!==i.x?-e:0,r=t.y!==i.y?-e:0,s=(t.x+t.w!==i.x+i.w?e:0)-n,a=(t.y+t.h!==i.y+i.h?e:0)-r;return{x:t.x+n,y:t.y+r,w:t.w+s,h:t.h+a,radius:t.radius}}class Nm extends Ug{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:n}}=this,{inner:r,outer:s}=Rm(this),a=(o=s.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?jf:Cm;var o;t.save(),s.w===r.w&&s.h===r.h||(t.beginPath(),a(t,Dm(s,e,r)),t.clip(),a(t,Dm(r,-e,s)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,Dm(r,e)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,e,i){return Im(this,t,e,i)}inXRange(t,e){return Im(this,t,null,e)}inYRange(t,e){return Im(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:n,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+n)/2:e,y:r?i:(i+n)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}const Om=(t,e)=>{let{boxHeight:i=e,boxWidth:n=e}=t;return t.usePointStyle&&(i=Math.min(i,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(e,i)}};class Mm extends Ug{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=md(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,i)=>t.sort(e,i,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const i=t.labels,n=Yf(i.font),r=n.size,s=this._computeTitleHeight(),{boxWidth:a,itemHeight:o}=Om(i,r);let l,c;e.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,r,a,o)+10):(c=this.maxHeight,l=this._fitCols(s,n,a,o)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,n){const{ctx:r,maxWidth:s,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=n+a;let u=t;r.textAlign="left",r.textBaseline="middle";let h=-1,d=-c;return this.legendItems.forEach(((t,f)=>{const p=i+e/2+r.measureText(t.text).width;(0===f||l[l.length-1]+p+2*a>s)&&(u+=c,l[l.length-(f>0?0:1)]=0,d+=c,h++),o[f]={left:0,top:d,row:h,width:p,height:n},l[l.length-1]+=p+a})),u}_fitCols(t,e,i,n){const{ctx:r,maxHeight:s,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-t;let u=a,h=0,d=0,f=0,p=0;return this.legendItems.forEach(((t,s)=>{const{itemWidth:g,itemHeight:m}=function(t,e,i,n,r){const s=function(t,e,i,n){let r=t.text;r&&"string"!==typeof r&&(r=r.reduce(((t,e)=>t.length>e.length?t:e)));return e+i.size/2+n.measureText(r).width}(n,t,e,i),a=function(t,e,i){let n=t;"string"!==typeof e.text&&(n=Fm(e,i));return n}(r,n,e.lineHeight);return{itemWidth:s,itemHeight:a}}(i,e,r,t,n);s>0&&d+m+2*a>c&&(u+=h+a,l.push({width:h,height:d}),f+=h+a,p++,h=d=0),o[s]={left:f,top:d,col:p,width:g,height:m},h=Math.max(h,g),d+=m+a})),u+=h,l.push({width:h,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:n},rtl:r}}=this,s=Ep(r,this.left,this.width);if(this.isHorizontal()){let r=0,a=cf(i,this.left+n,this.right-this.lineWidths[r]);for(const o of e)r!==o.row&&(r=o.row,a=cf(i,this.left+n,this.right-this.lineWidths[r])),o.top+=this.top+t+n,o.left=s.leftForLtr(s.x(a),o.width),a+=o.width+n}else{let r=0,a=cf(i,this.top+t+n,this.bottom-this.columnSizes[r].height);for(const o of e)o.col!==r&&(r=o.col,a=cf(i,this.top+t+n,this.bottom-this.columnSizes[r].height)),o.top=a,o.left+=this.left+n,o.left=s.leftForLtr(s.x(o.left),o.width),a+=o.height+n}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;Of(t,this),this._draw(),Mf(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:n}=this,{align:r,labels:s}=t,a=kf.color,o=Ep(t.rtl,this.left,this.width),l=Yf(s.font),{padding:c}=s,u=l.size,h=u/2;let d;this.drawTitle(),n.textAlign=o.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=l.string;const{boxWidth:f,boxHeight:p,itemHeight:g}=Om(s,u),m=this.isHorizontal(),v=this._computeTitleHeight();d=m?{x:cf(r,this.left+c,this.right-i[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:cf(r,this.top+v+c,this.bottom-e[0].height),line:0},Lp(this.ctx,t.textDirection);const y=g+c;this.legendItems.forEach(((b,S)=>{n.strokeStyle=b.fontColor,n.fillStyle=b.fontColor;const w=n.measureText(b.text).width,x=o.textAlign(b.textAlign||(b.textAlign=s.textAlign)),E=f+h+w;let L=d.x,T=d.y;o.setWidth(this.width),m?S>0&&L+E+c>this.right&&(T=d.y+=y,d.line++,L=d.x=cf(r,this.left+c,this.right-i[d.line])):S>0&&T+y>this.bottom&&(L=d.x=L+e[d.line].width+c,d.line++,T=d.y=cf(r,this.top+v+c,this.bottom-e[d.line].height));if(function(t,e,i){if(isNaN(f)||f<=0||isNaN(p)||p<0)return;n.save();const r=pd(i.lineWidth,1);if(n.fillStyle=pd(i.fillStyle,a),n.lineCap=pd(i.lineCap,"butt"),n.lineDashOffset=pd(i.lineDashOffset,0),n.lineJoin=pd(i.lineJoin,"miter"),n.lineWidth=r,n.strokeStyle=pd(i.strokeStyle,a),n.setLineDash(pd(i.lineDash,[])),s.usePointStyle){const a={radius:p*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:r},l=o.xPlus(t,f/2);Df(n,a,l,e+h,s.pointStyleWidth&&f)}else{const s=e+Math.max((u-p)/2,0),a=o.leftForLtr(t,f),l=Wf(i.borderRadius);n.beginPath(),Object.values(l).some((t=>0!==t))?jf(n,{x:a,y:s,w:f,h:p,radius:l}):n.rect(a,s,f,p),n.fill(),0!==r&&n.stroke()}n.restore()}(o.x(L),T,b),L=((t,e,i,n)=>t===(n?"left":"right")?i:"center"===t?(e+i)/2:e)(x,L+f+h,m?L+E:this.right,t.rtl),function(t,e,i){Uf(n,i.text,t,e+g/2,l,{strikethrough:i.hidden,textAlign:o.textAlign(i.textAlign)})}(o.x(L),T,b),m)d.x+=E+c;else if("string"!==typeof b.text){const t=l.lineHeight;d.y+=Fm(b,t)+c}else d.y+=y})),Tp(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=Yf(e.font),n=Kf(e.padding);if(!e.display)return;const r=Ep(t.rtl,this.left,this.width),s=this.ctx,a=e.position,o=i.size/2,l=n.top+o;let c,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+l,u=cf(t.align,u,this.right-h);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);c=l+cf(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const d=cf(a,u,u+h);s.textAlign=r.textAlign(lf(a)),s.textBaseline="middle",s.strokeStyle=e.color,s.fillStyle=e.color,s.font=i.string,Uf(s,e.text,d,c,i)}_computeTitleHeight(){const t=this.options.title,e=Yf(t.font),i=Kf(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,n,r;if(Jd(t,this.left,this.right)&&Jd(e,this.top,this.bottom))for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(n=r[i],Jd(t,n.left,n.left+n.width)&&Jd(e,n.top,n.top+n.height))return this.legendItems[i];return null}handleEvent(t){const e=this.options;if(!function(t,e){if(("mousemove"===t||"mouseout"===t)&&(e.onHover||e.onLeave))return!0;if(e.onClick&&("click"===t||"mouseup"===t))return!0;return!1}(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const n=this._hoveredItem,r=((t,e)=>null!==t&&null!==e&&t.datasetIndex===e.datasetIndex&&t.index===e.index)(n,i);n&&!r&&md(e.onLeave,[t,n,this],this),this._hoveredItem=i,i&&!r&&md(e.onHover,[t,i,this],this)}else i&&md(e.onClick,[t,i,this],this)}}function Fm(t,e){return e*(t.text?t.text.length:0)}var Bm={id:"legend",_element:Mm,start(t,e,i){const n=t.legend=new Mm({ctx:t.ctx,options:i,chart:t});wg.configure(t,n,i),wg.addBox(t,n)},stop(t){wg.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const n=t.legend;wg.configure(t,n,i),n.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const n=e.datasetIndex,r=i.chart;r.isDatasetVisible(n)?(r.hide(n),e.hidden=!0):(r.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:n,textAlign:r,color:s,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const l=t.controller.getStyle(i?0:void 0),c=Kf(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:n||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:a&&(o||l.borderRadius),datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Um extends Ug{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const n=ud(i.text)?i.text.length:1;this._padding=Kf(i.padding);const r=n*Yf(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:i,bottom:n,right:r,options:s}=this,a=s.align;let o,l,c,u=0;return this.isHorizontal()?(l=cf(a,i,r),c=e+t,o=r-i):("left"===s.position?(l=i+t,c=cf(a,n,e),u=-.5*Id):(l=r-t,c=cf(a,e,n),u=.5*Id),o=n-e),{titleX:l,titleY:c,maxWidth:o,rotation:u}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=Yf(e.font),n=i.lineHeight/2+this._padding.top,{titleX:r,titleY:s,maxWidth:a,rotation:o}=this._drawArgs(n);Uf(t,e.text,0,0,i,{color:e.color,maxWidth:a,rotation:o,textAlign:lf(e.align),textBaseline:"middle",translation:[r,s]})}}var jm={id:"title",_element:Um,start(t,e,i){!function(t,e){const i=new Um({ctx:t.ctx,options:e,chart:t});wg.configure(t,i,e),wg.addBox(t,i),t.titleBlock=i}(t,i)},stop(t){const e=t.titleBlock;wg.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const n=t.titleBlock;wg.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const $m={average(t){if(!t.length)return!1;let e,i,n=new Set,r=0,s=0;for(e=0,i=t.length;e<i;++e){const i=t[e].element;if(i&&i.hasValue()){const t=i.tooltipPosition();n.add(t.x),r+=t.y,++s}}if(0===s||0===n.size)return!1;const a=[...n].reduce(((t,e)=>t+e))/n.size;return{x:a,y:r/s}},nearest(t,e){if(!t.length)return!1;let i,n,r,s=e.x,a=e.y,o=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){const n=t[i].element;if(n&&n.hasValue()){const t=Kd(e,n.getCenterPoint());t<o&&(o=t,r=n)}}if(r){const t=r.tooltipPosition();s=t.x,a=t.y}return{x:s,y:a}}};function zm(t,e){return e&&(ud(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Hm(t){return("string"===typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function qm(t,e){const{element:i,datasetIndex:n,index:r}=e,s=t.getDatasetMeta(n).controller,{label:a,value:o}=s.getLabelAndValue(r);return{chart:t,label:a,parsed:s.getParsed(r),raw:t.data.datasets[n].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:n,element:i}}function Gm(t,e){const i=t.chart.ctx,{body:n,footer:r,title:s}=t,{boxWidth:a,boxHeight:o}=e,l=Yf(e.bodyFont),c=Yf(e.titleFont),u=Yf(e.footerFont),h=s.length,d=r.length,f=n.length,p=Kf(e.padding);let g=p.height,m=0,v=n.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);if(v+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),v){g+=f*(e.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(v-f)*l.lineHeight+(v-1)*e.bodySpacing}d&&(g+=e.footerMarginTop+d*u.lineHeight+(d-1)*e.footerSpacing);let y=0;const b=function(t){m=Math.max(m,i.measureText(t).width+y)};return i.save(),i.font=c.string,vd(t.title,b),i.font=l.string,vd(t.beforeBody.concat(t.afterBody),b),y=e.displayColors?a+2+e.boxPadding:0,vd(n,(t=>{vd(t.before,b),vd(t.lines,b),vd(t.after,b)})),y=0,i.font=u.string,vd(t.footer,b),i.restore(),m+=p.width,{width:m,height:g}}function Vm(t,e,i,n){const{x:r,width:s}=i,{width:a,chartArea:{left:o,right:l}}=t;let c="center";return"center"===n?c=r<=(o+l)/2?"left":"right":r<=s/2?c="left":r>=a-s/2&&(c="right"),function(t,e,i,n){const{x:r,width:s}=n,a=i.caretSize+i.caretPadding;return"left"===t&&r+s+a>e.width||"right"===t&&r-s-a<0||void 0}(c,t,e,i)&&(c="center"),c}function Wm(t,e,i){const n=i.yAlign||e.yAlign||function(t,e){const{y:i,height:n}=e;return i<n/2?"top":i>t.height-n/2?"bottom":"center"}(t,i);return{xAlign:i.xAlign||e.xAlign||Vm(t,e,i,n),yAlign:n}}function Km(t,e,i,n){const{caretSize:r,caretPadding:s,cornerRadius:a}=t,{xAlign:o,yAlign:l}=i,c=r+s,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=Wf(a);let p=function(t,e){let{x:i,width:n}=t;return"right"===e?i-=n:"center"===e&&(i-=n/2),i}(e,o);const g=function(t,e,i){let{y:n,height:r}=t;return"top"===e?n+=i:n-="bottom"===e?r+i:r/2,n}(e,l,c);return"center"===l?"left"===o?p+=c:"right"===o&&(p-=c):"left"===o?p-=Math.max(u,d)+r:"right"===o&&(p+=Math.max(h,f)+r),{x:Qd(p,0,n.width-e.width),y:Qd(g,0,n.height-e.height)}}function Ym(t,e,i){const n=Kf(i.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-n.right:t.x+n.left}function Xm(t){return zm([],Hm(t))}function Qm(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}const Jm={beforeTitle:od,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,n=i?i.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return i[e.dataIndex]}return""},afterTitle:od,beforeBody:od,beforeLabel:od,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const i=t.formattedValue;return cd(i)||(e+=i),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:od,afterBody:od,beforeFooter:od,footer:od,afterFooter:od};function Zm(t,e,i,n){const r=t[e].call(i,n);return"undefined"===typeof r?Jm[e].call(i,n):r}class tv extends Ug{static positioners=(()=>$m)();constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&e.options.animation&&i.animations,r=new Ip(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(t=this.chart.getContext(),e=this,i=this._tooltipItems,Qf(t,{tooltip:e,tooltipItems:i,type:"tooltip"})));var t,e,i}getTitle(t,e){const{callbacks:i}=e,n=Zm(i,"beforeTitle",this,t),r=Zm(i,"title",this,t),s=Zm(i,"afterTitle",this,t);let a=[];return a=zm(a,Hm(n)),a=zm(a,Hm(r)),a=zm(a,Hm(s)),a}getBeforeBody(t,e){return Xm(Zm(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,n=[];return vd(t,(t=>{const e={before:[],lines:[],after:[]},r=Qm(i,t);zm(e.before,Hm(Zm(r,"beforeLabel",this,t))),zm(e.lines,Zm(r,"label",this,t)),zm(e.after,Hm(Zm(r,"afterLabel",this,t))),n.push(e)})),n}getAfterBody(t,e){return Xm(Zm(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,n=Zm(i,"beforeFooter",this,t),r=Zm(i,"footer",this,t),s=Zm(i,"afterFooter",this,t);let a=[];return a=zm(a,Hm(n)),a=zm(a,Hm(r)),a=zm(a,Hm(s)),a}_createItems(t){const e=this._active,i=this.chart.data,n=[],r=[],s=[];let a,o,l=[];for(a=0,o=e.length;a<o;++a)l.push(qm(this.chart,e[a]));return t.filter&&(l=l.filter(((e,n,r)=>t.filter(e,n,r,i)))),t.itemSort&&(l=l.sort(((e,n)=>t.itemSort(e,n,i)))),vd(l,(e=>{const i=Qm(t.callbacks,e);n.push(Zm(i,"labelColor",this,e)),r.push(Zm(i,"labelPointStyle",this,e)),s.push(Zm(i,"labelTextColor",this,e))})),this.labelColors=n,this.labelPointStyles=r,this.labelTextColors=s,this.dataPoints=l,l}update(t,e){const i=this.options.setContext(this.getContext()),n=this._active;let r,s=[];if(n.length){const t=$m[i.position].call(this,n,this._eventPosition);s=this._createItems(i),this.title=this.getTitle(s,i),this.beforeBody=this.getBeforeBody(s,i),this.body=this.getBody(s,i),this.afterBody=this.getAfterBody(s,i),this.footer=this.getFooter(s,i);const e=this._size=Gm(this,i),a=Object.assign({},t,e),o=Wm(this.chart,i,a),l=Km(i,a,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,r={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=s,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,n){const r=this.getCaretPosition(t,i,n);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,i){const{xAlign:n,yAlign:r}=this,{caretSize:s,cornerRadius:a}=i,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:u}=Wf(a),{x:h,y:d}=t,{width:f,height:p}=e;let g,m,v,y,b,S;return"center"===r?(b=d+p/2,"left"===n?(g=h,m=g-s,y=b+s,S=b-s):(g=h+f,m=g+s,y=b-s,S=b+s),v=g):(m="left"===n?h+Math.max(o,c)+s:"right"===n?h+f-Math.max(l,u)-s:this.caretX,"top"===r?(y=d,b=y-s,g=m-s,v=m+s):(y=d+p,b=y+s,g=m+s,v=m-s),S=y),{x1:g,x2:m,x3:v,y1:y,y2:b,y3:S}}drawTitle(t,e,i){const n=this.title,r=n.length;let s,a,o;if(r){const l=Ep(i.rtl,this.x,this.width);for(t.x=Ym(this,i.titleAlign,i),e.textAlign=l.textAlign(i.titleAlign),e.textBaseline="middle",s=Yf(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=s.string,o=0;o<r;++o)e.fillText(n[o],l.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+a,o+1===r&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,n,r){const s=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:o,boxWidth:l}=r,c=Yf(r.bodyFont),u=Ym(this,"left",r),h=n.x(u),d=o<c.lineHeight?(c.lineHeight-o)/2:0,f=e.y+d;if(r.usePointStyle){const e={radius:Math.min(l,o)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},i=n.leftForLtr(h,l)+l/2,c=f+o/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,Cf(t,e,i,c),t.strokeStyle=s.borderColor,t.fillStyle=s.backgroundColor,Cf(t,e,i,c)}else{t.lineWidth=hd(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,t.strokeStyle=s.borderColor,t.setLineDash(s.borderDash||[]),t.lineDashOffset=s.borderDashOffset||0;const e=n.leftForLtr(h,l),i=n.leftForLtr(n.xPlus(h,1),l-2),a=Wf(s.borderRadius);Object.values(a).some((t=>0!==t))?(t.beginPath(),t.fillStyle=r.multiKeyBackground,jf(t,{x:e,y:f,w:l,h:o,radius:a}),t.fill(),t.stroke(),t.fillStyle=s.backgroundColor,t.beginPath(),jf(t,{x:i,y:f+1,w:l-2,h:o-2,radius:a}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(e,f,l,o),t.strokeRect(e,f,l,o),t.fillStyle=s.backgroundColor,t.fillRect(i,f+1,l-2,o-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:n}=this,{bodySpacing:r,bodyAlign:s,displayColors:a,boxHeight:o,boxWidth:l,boxPadding:c}=i,u=Yf(i.bodyFont);let h=u.lineHeight,d=0;const f=Ep(i.rtl,this.x,this.width),p=function(i){e.fillText(i,f.x(t.x+d),t.y+h/2),t.y+=h+r},g=f.textAlign(s);let m,v,y,b,S,w,x;for(e.textAlign=s,e.textBaseline="middle",e.font=u.string,t.x=Ym(this,g,i),e.fillStyle=i.bodyColor,vd(this.beforeBody,p),d=a&&"right"!==g?"center"===s?l/2+c:l+2+c:0,b=0,w=n.length;b<w;++b){for(m=n[b],v=this.labelTextColors[b],e.fillStyle=v,vd(m.before,p),y=m.lines,a&&y.length&&(this._drawColorBox(e,t,b,f,i),h=Math.max(u.lineHeight,o)),S=0,x=y.length;S<x;++S)p(y[S]),h=u.lineHeight;vd(m.after,p)}d=0,h=u.lineHeight,vd(this.afterBody,p),t.y-=r}drawFooter(t,e,i){const n=this.footer,r=n.length;let s,a;if(r){const o=Ep(i.rtl,this.x,this.width);for(t.x=Ym(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=o.textAlign(i.footerAlign),e.textBaseline="middle",s=Yf(i.footerFont),e.fillStyle=i.footerColor,e.font=s.string,a=0;a<r;++a)e.fillText(n[a],o.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+i.footerSpacing}}drawBackground(t,e,i,n){const{xAlign:r,yAlign:s}=this,{x:a,y:o}=t,{width:l,height:c}=i,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=Wf(n.cornerRadius);e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.beginPath(),e.moveTo(a+u,o),"top"===s&&this.drawCaret(t,e,i,n),e.lineTo(a+l-h,o),e.quadraticCurveTo(a+l,o,a+l,o+h),"center"===s&&"right"===r&&this.drawCaret(t,e,i,n),e.lineTo(a+l,o+c-f),e.quadraticCurveTo(a+l,o+c,a+l-f,o+c),"bottom"===s&&this.drawCaret(t,e,i,n),e.lineTo(a+d,o+c),e.quadraticCurveTo(a,o+c,a,o+c-d),"center"===s&&"left"===r&&this.drawCaret(t,e,i,n),e.lineTo(a,o+u),e.quadraticCurveTo(a,o,a+u,o),e.closePath(),e.fill(),n.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,n=i&&i.x,r=i&&i.y;if(n||r){const i=$m[t.position].call(this,this._active,this._eventPosition);if(!i)return;const s=this._size=Gm(this,t),a=Object.assign({},i,this._size),o=Wm(e,t,a),l=Km(t,a,o,e);n._to===l.x&&r._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=s.width,this.height=s.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const n={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const s=Kf(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(r,t,n,e),Lp(t,e.textDirection),r.y+=s.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),Tp(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,n=t.map((t=>{let{datasetIndex:e,index:i}=t;const n=this.chart.getDatasetMeta(e);if(!n)throw new Error("Cannot find a dataset at index "+e);return{datasetIndex:e,element:n.data[i],index:i}})),r=!yd(i,n),s=this._positionChanged(n,e);(r||s)&&(this._active=n,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,r=this._active||[],s=this._getActiveElements(t,r,e,i),a=this._positionChanged(s,t),o=e||!yd(s,r)||a;return o&&(this._active=s,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),o}_getActiveElements(t,e,i,n){const r=this.options;if("mouseout"===t.type)return[];if(!n)return e.filter((t=>this.chart.data.datasets[t.datasetIndex]&&void 0!==this.chart.getDatasetMeta(t.datasetIndex).controller.getParsed(t.index)));const s=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&s.reverse(),s}_positionChanged(t,e){const{caretX:i,caretY:n,options:r}=this,s=$m[r.position].call(this,t,e);return!1!==s&&(i!==s.x||n!==s.y)}}var ev={id:"tooltip",_element:tv,positioners:$m,afterInit(t,e,i){i&&(t.tooltip=new tv({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Jm},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function iv(t,e,i,n){const r=t.indexOf(e);if(-1===r)return((t,e,i,n)=>("string"===typeof e?(i=t.push(e)-1,n.unshift({index:i,label:e})):isNaN(e)&&(i=null),i))(t,e,i,n);return r!==t.lastIndexOf(e)?i:r}function nv(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class rv extends Yg{static id="category";static defaults=(()=>({ticks:{callback:nv}}))();constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:i,label:n}of e)t[i]===n&&t.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(cd(t))return null;const i=this.getLabels();return((t,e)=>null===t?null:Qd(Math.round(t),0,e))(e=isFinite(e)&&i[e]===t?e:iv(i,t,pd(e,t),this._addedLabels),i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(i=0),e||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,n=[];let r=this.getLabels();r=0===t&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let s=t;s<=e;s++)n.push({value:s});return n}getLabelForValue(t){return nv.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!==typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function sv(t,e){const i=[],{bounds:n,step:r,min:s,max:a,precision:o,count:l,maxTicks:c,maxDigits:u,includeBounds:h}=t,d=r||1,f=c-1,{min:p,max:g}=e,m=!cd(s),v=!cd(a),y=!cd(l),b=(g-p)/(u+1);let S,w,x,E,L=$d((g-p)/f/d)*d;if(L<1e-14&&!m&&!v)return[{value:p},{value:g}];E=Math.ceil(g/L)-Math.floor(p/L),E>f&&(L=$d(E*L/f/d)*d),cd(o)||(S=Math.pow(10,o),L=Math.ceil(L*S)/S),"ticks"===n?(w=Math.floor(p/L)*L,x=Math.ceil(g/L)*L):(w=p,x=g),m&&v&&r&&function(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}((a-s)/r,L/1e3)?(E=Math.round(Math.min((a-s)/L,c)),L=(a-s)/E,w=s,x=a):y?(w=m?s:w,x=v?a:x,E=l-1,L=(x-w)/E):(E=(x-w)/L,E=jd(E,Math.round(E),L/1e3)?Math.round(E):Math.ceil(E));const T=Math.max(Vd(L),Vd(w));S=Math.pow(10,cd(o)?T:o),w=Math.round(w*S)/S,x=Math.round(x*S)/S;let A=0;for(m&&(h&&w!==s?(i.push({value:s}),w<s&&A++,jd(Math.round((w+A*L)*S)/S,s,av(s,b,t))&&A++):w<s&&A++);A<E;++A){const t=Math.round((w+A*L)*S)/S;if(v&&t>a)break;i.push({value:t})}return v&&h&&x!==a?i.length&&jd(i[i.length-1].value,a,av(a,b,t))?i[i.length-1].value=a:i.push({value:a}):v&&x!==a||i.push({value:x}),i}function av(t,e,i){let{horizontal:n,minRotation:r}=i;const s=qd(r),a=(n?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+t).length;return Math.min(e/a,o)}class ov extends Yg{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return cd(t)||("number"===typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:n,max:r}=this;const s=t=>n=e?n:t,a=t=>r=i?r:t;if(t){const t=Ud(n),e=Ud(r);t<0&&e<0?a(0):t>0&&e>0&&s(0)}if(n===r){let e=0===r?1:Math.abs(.05*r);a(r+e),t||s(n-e)}this.min=n,this.max=r}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:i,stepSize:n}=t;return n?(e=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),i=i||11),i&&(e=Math.min(i,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const n=sv({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&Hd(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const n=(i-e)/Math.max(t.length-1,1)/2;e-=n,i+=n}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return Sf(t,this.chart.options.locale,this.options.ticks.format)}}class lv extends ov{static id="linear";static defaults=(()=>({ticks:{callback:xf.formatters.numeric}}))();determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=dd(t)?t:0,this.max=dd(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=qd(this.options.ticks.minRotation),n=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/n))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}xf.formatters.logarithmic;xf.formatters.numeric;const cv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},uv=Object.keys(cv);function hv(t,e){return t-e}function dv(t,e){if(cd(e))return null;const i=t._adapter,{parser:n,round:r,isoWeekday:s}=t._parseOpts;let a=e;return"function"===typeof n&&(a=n(a)),dd(a)||(a="string"===typeof n?i.parse(a,n):i.parse(a)),null===a?null:(r&&(a="week"!==r||!zd(s)&&!0!==s?i.startOf(a,r):i.startOf(a,"isoWeek",s)),+a)}function fv(t,e,i,n){const r=uv.length;for(let s=uv.indexOf(t);s<r-1;++s){const t=cv[uv[s]],r=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((i-e)/(r*t.size))<=n)return uv[s]}return uv[r-1]}function pv(t,e,i){if(i){if(i.length){const{lo:n,hi:r}=Zd(i,e);t[i[n]>=e?i[n]:i[r]]=!0}}else t[e]=!0}function gv(t,e,i){const n=[],r={},s=e.length;let a,o;for(a=0;a<s;++a)o=e[a],r[o]=a,n.push({value:o,major:!1});return 0!==s&&i?function(t,e,i,n){const r=t._adapter,s=+r.startOf(e[0].value,n),a=e[e.length-1].value;let o,l;for(o=s;o<=a;o=+r.add(o,1,n))l=i[o],l>=0&&(e[l].major=!0);return e}(t,n,r,i):n}class mv extends Yg{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t.time||(t.time={}),n=this._adapter=new eg(t.adapters.date);n.init(e),Ed(i.displayFormats,n.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:dv(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:n,max:r,minDefined:s,maxDefined:a}=this.getUserBounds();function o(t){s||isNaN(t.min)||(n=Math.min(n,t.min)),a||isNaN(t.max)||(r=Math.max(r,t.max))}s&&a||(o(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||o(this.getMinMax(!1))),n=dd(n)&&!isNaN(n)?n:+e.startOf(Date.now(),i),r=dd(r)&&!isNaN(r)?r:+e.endOf(Date.now(),i)+1,this.min=Math.min(n,r-1),this.max=Math.max(n+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,n="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const r=this.min,s=function(t,e,i){let n=0,r=t.length;for(;n<r&&t[n]<e;)n++;for(;r>n&&t[r-1]>i;)r--;return n>0||r<t.length?t.slice(n,r):t}(n,r,this.max);return this._unit=e.unit||(i.autoSkip?fv(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(t,e,i,n,r){for(let s=uv.length-1;s>=uv.indexOf(i);s--){const i=uv[s];if(cv[i].common&&t._adapter.diff(r,n,i)>=e-1)return i}return uv[i?uv.indexOf(i):0]}(this,s.length,e.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(t){for(let e=uv.indexOf(t)+1,i=uv.length;e<i;++e)if(cv[uv[e]].common)return uv[e]}(this._unit):void 0,this.initOffsets(n),t.reverse&&s.reverse(),gv(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=0,r=0;this.options.offset&&i.length&&(t=this.getDecimalForValue(i[0]),n=1===i.length?1-t:(this.getDecimalForValue(i[1])-t)/2,e=this.getDecimalForValue(i[i.length-1]),r=1===i.length?e:(e-this.getDecimalForValue(i[i.length-2]))/2);const s=i.length<3?.5:.25;n=Qd(n,0,s),r=Qd(r,0,s),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const t=this._adapter,e=this.min,i=this.max,n=this.options,r=n.time,s=r.unit||fv(r.minUnit,e,i,this._getLabelCapacity(e)),a=pd(n.ticks.stepSize,1),o="week"===s&&r.isoWeekday,l=zd(o)||!0===o,c={};let u,h,d=e;if(l&&(d=+t.startOf(d,"isoWeek",o)),d=+t.startOf(d,l?"day":s),t.diff(i,e,s)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+s);const f="data"===n.ticks.source&&this.getDataTimestamps();for(u=d,h=0;u<i;u=+t.add(u,a,s),h++)pv(c,u,f);return u!==i&&"ticks"!==n.bounds&&1!==h||pv(c,u,f),Object.keys(c).sort(hv).map((t=>+t))}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,n=this._unit,r=e||i[n];return this._adapter.format(t,r)}_tickFormatFunction(t,e,i,n){const r=this.options,s=r.ticks.callback;if(s)return md(s,[t,e,i],this);const a=r.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&a[o],u=l&&a[l],h=i[e],d=l&&u&&h&&h.major;return this._adapter.format(t,n||(d?u:c))}generateTickLabels(t){let e,i,n;for(e=0,i=t.length;e<i;++e)n=t[e],n.label=this._tickFormatFunction(n.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,n=qd(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(n),s=Math.sin(n),a=this._resolveTickFontOptions(0).size;return{w:i*r+a*s,h:i*s+a*r}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,n=i[e.unit]||i.millisecond,r=this._tickFormatFunction(t,0,gv(this,[t],this._majorUnit),n),s=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return a>0?a:1}getDataTimestamps(){let t,e,i=this._cache.data||[];if(i.length)return i;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(t=0,e=n.length;t<e;++t)i=i.concat(n[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const n=this.getLabels();for(e=0,i=n.length;e<i;++e)t.push(dv(this,n[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return sf(t.sort(hv))}}const vv="label";function yv(t,e){"function"===typeof t?t(e):t&&(t.current=e)}function bv(t,e){t.labels=e}function Sv(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vv;const n=[];t.datasets=e.map((e=>{const r=t.datasets.find((t=>t[i]===e[i]));return r&&e.data&&!n.includes(r)?(n.push(r),Object.assign(r,e),r):{...e}}))}function wv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vv;const i={labels:[],datasets:[]};return bv(i,t.labels),Sv(i,t.datasets,e),i}function xv(t,e){const{height:i=150,width:n=300,redraw:r=!1,datasetIdKey:a,type:o,data:l,options:c,plugins:u=[],fallbackContent:h,updateMode:d,...f}=t,p=(0,s.useRef)(null),g=(0,s.useRef)(null),m=()=>{p.current&&(g.current=new Am(p.current,{type:o,data:wv(l,a),options:c&&{...c},plugins:u}),yv(e,g.current))},v=()=>{yv(e,null),g.current&&(g.current.destroy(),g.current=null)};return(0,s.useEffect)((()=>{!r&&g.current&&c&&function(t,e){const i=t.options;i&&e&&Object.assign(i,e)}(g.current,c)}),[r,c]),(0,s.useEffect)((()=>{!r&&g.current&&bv(g.current.config.data,l.labels)}),[r,l.labels]),(0,s.useEffect)((()=>{!r&&g.current&&l.datasets&&Sv(g.current.config.data,l.datasets,a)}),[r,l.datasets]),(0,s.useEffect)((()=>{g.current&&(r?(v(),setTimeout(m)):g.current.update(d))}),[r,c,l.labels,l.datasets,d]),(0,s.useEffect)((()=>{g.current&&(v(),setTimeout(m))}),[o]),(0,s.useEffect)((()=>(m(),()=>v())),[]),s.createElement("canvas",{ref:p,role:"img",height:i,width:n,...f},h)}const Ev=(0,s.forwardRef)(xv);function Lv(t,e){return Am.register(e),(0,s.forwardRef)(((e,i)=>s.createElement(Ev,{...e,ref:i,type:t})))}const Tv=Lv("bar",Jp);Am.register(rv,lv,Nm,jm,ev,Bm);const Av=()=>{const t=nt(),[e,i]=(0,s.useState)(null),[n,r]=(0,s.useState)(null),[a,o]=(0,s.useState)("home"),[l,c]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),[d,f]=(0,s.useState)(0),[p,g]=(0,s.useState)(0),[m,v]=(0,s.useState)([]),[y,b]=(0,s.useState)(!1),[S,w]=(0,s.useState)("Usuario"),[x,E]=(0,s.useState)(null),[L,T]=(0,s.useState)(""),[A,_]=(0,s.useState)("");(0,s.useEffect)((()=>{const t=()=>{f((t=>t+Math.floor(5*Math.random()))),g((t=>t+Math.floor(2*Math.random())))};t();const e=setInterval(t,6e5);return()=>clearInterval(e)}),[]),(0,s.useEffect)((()=>{const t=localStorage.getItem("user");if(t)try{const e=JSON.parse(t);w(e.fullName||"Usuario"),T(e.role||""),_(e._id),e.photo&&!e.photo.startsWith("http")?E("http://localhost:3000/"+e.photo):E(e.photo)}catch(Bw){console.error("Error parseando el usuario:",Bw)}}),[]);const k=async()=>{try{const t=await fetch("http://localhost:4000/api/cameras/my",{headers:{"x-admin-id":A}}),e=await t.json();v(e)}catch(ny){console.error("Error cargando c\xe1maras del admin",ny)}};return(0,s.useEffect)((()=>{"cameras"===a&&"admin"===L&&A&&k()}),[a,L,A]),(0,zi.jsxs)("div",{className:"dashboard-container",children:[(0,zi.jsxs)("aside",{className:"sidebar",children:[(0,zi.jsxs)("div",{className:"profile-section",children:[(0,zi.jsx)("div",{className:"profile-pic",children:(0,zi.jsx)("img",{src:x,alt:"Perfil"})}),(0,zi.jsx)("h3",{className:"profile-name",children:S}),(0,zi.jsxs)("p",{className:"profile-role",children:["Rol: ",L]})]}),(0,zi.jsx)("nav",{className:"menu",children:(0,zi.jsxs)("ul",{children:[(0,zi.jsx)("li",{className:"home"===a?"active":"",onClick:()=>o("home"),children:"Dashboard"}),"admin"===L&&(0,zi.jsxs)(zi.Fragment,{children:[(0,zi.jsx)("li",{className:"create-worker"===a?"active":"",onClick:()=>o("create-worker"),children:"Crear Trabajador"}),(0,zi.jsx)("li",{className:"my-workers"===a?"active":"",onClick:()=>o("my-workers"),children:"Ver Trabajadores"}),(0,zi.jsx)("li",{className:"my-chips"===a?"active":"",onClick:()=>o("my-chips"),children:"Ver Chips"}),(0,zi.jsx)("li",{className:"register-chip"===a?"active":"",onClick:()=>o("register-chip"),children:"Registrar Chip"}),(0,zi.jsx)("li",{className:"cameras"===a?"active":"",onClick:()=>o("cameras"),children:"C\xe1maras"})]}),"operator"===L&&(0,zi.jsx)("li",{className:"mass-scan"===a?"active":"",onClick:()=>o("mass-scan"),children:"Escaneo Masivo"}),"thermal-operator"===L&&(0,zi.jsx)("li",{className:"thermal-view"===a?"active":"",onClick:()=>o("thermal-view"),children:"Vista T\xe9rmica"})]})})]}),(0,zi.jsxs)("main",{className:"main-content",children:[(0,zi.jsxs)("header",{className:"top-bar",children:[(0,zi.jsx)("div",{className:"search-container",children:(0,zi.jsx)("input",{type:"text",placeholder:"Buscar..."})}),(0,zi.jsxs)("div",{className:"top-bar-icons",children:[(0,zi.jsx)("span",{className:"icon",children:"\ud83d\udd14"}),(0,zi.jsx)("span",{className:"icon",children:"\ud83d\udc8c"}),(0,zi.jsx)("button",{className:"logout-btn",onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t("/login")},children:"Cerrar Sesi\xf3n"})]})]}),"home"===a&&(0,zi.jsxs)(zi.Fragment,{children:[(0,zi.jsx)("section",{className:"welcome-section",children:(0,zi.jsxs)("h2",{children:["Hola, ",S]})}),(0,zi.jsxs)("section",{className:"stats-section",children:[(0,zi.jsxs)("div",{className:"card",children:[(0,zi.jsx)("h3",{children:"Escaneos"}),(0,zi.jsxs)("p",{children:[d," escaneos realizados hoy"]})]}),(0,zi.jsxs)("div",{className:"card",children:[(0,zi.jsx)("h3",{children:"Trabajadores Activos"}),(0,zi.jsxs)("p",{children:[p," trabajadores activos hoy"]})]}),(0,zi.jsxs)("div",{className:"card",children:[(0,zi.jsx)("h3",{children:"Mayor Hora de Actividad"}),(0,zi.jsx)("div",{className:"placeholder",children:"[Gr\xe1fico de Actividad]"})]})]}),(0,zi.jsx)("section",{className:"stats-section",children:(0,zi.jsxs)("div",{className:"card",children:[(0,zi.jsx)("h3",{children:"Escaneos por Hora"}),(0,zi.jsx)(Tv,{data:{labels:["00:00","06:00","12:00","18:00","24:00"],datasets:[{label:"Escaneos por hora",data:[5,15,30,25,10],backgroundColor:"rgba(45, 137, 239, 0.5)",borderColor:"#2D89EF",borderWidth:1}]},options:{responsive:!0,plugins:{title:{display:!0,text:"Mayor hora de actividad"}},scales:{x:{type:"category"},y:{type:"linear"}}}})]})})]}),"cameras"===a&&"admin"===L&&(0,zi.jsxs)(zi.Fragment,{children:[(0,zi.jsx)(Ah,{cameras:m,onRefresh:k}),(0,zi.jsx)("button",{style:{marginTop:20},onClick:()=>b(!0),children:"\u2795 A\xf1adir nueva c\xe1mara"}),y&&(0,zi.jsx)(Th,{onSaved:()=>{k(),b(!1)}})]}),"thermal-view"===a&&"thermal-operator"===L&&(0,zi.jsx)(_h,{}),"create-worker"===a&&"admin"===L&&(0,zi.jsx)(Vi,{}),"my-workers"===a&&"admin"===L&&(0,zi.jsx)(Wi,{}),"my-chips"===a&&"admin"===L&&(0,zi.jsx)(Ki,{}),"register-chip"===a&&"admin"===L&&(0,zi.jsx)(Yi,{}),"mass-scan"===a&&"operator"===L&&(0,zi.jsx)(Xi,{})]})]})};var _v=i(284),kv=Uint8Array,Pv=Uint16Array,Rv=Int32Array,Iv=new kv([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Cv=new kv([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dv=new kv([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nv=function(t,e){for(var i=new Pv(31),n=0;n<31;++n)i[n]=e+=1<<t[n-1];var r=new Rv(i[30]);for(n=1;n<30;++n)for(var s=i[n];s<i[n+1];++s)r[s]=s-i[n]<<5|n;return{b:i,r:r}},Ov=Nv(Iv,2),Mv=Ov.b,Fv=Ov.r;Mv[28]=258,Fv[258]=28;for(var Bv=Nv(Cv,0),Uv=Bv.b,jv=Bv.r,$v=new Pv(32768),zv=0;zv<32768;++zv){var Hv=(43690&zv)>>1|(21845&zv)<<1;Hv=(61680&(Hv=(52428&Hv)>>2|(13107&Hv)<<2))>>4|(3855&Hv)<<4,$v[zv]=((65280&Hv)>>8|(255&Hv)<<8)>>1}var qv=function(t,e,i){for(var n=t.length,r=0,s=new Pv(e);r<n;++r)t[r]&&++s[t[r]-1];var a,o=new Pv(e);for(r=1;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;if(i){a=new Pv(1<<e);var l=15-e;for(r=0;r<n;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],h=o[t[r]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[$v[h]>>l]=c}else for(a=new Pv(n),r=0;r<n;++r)t[r]&&(a[r]=$v[o[t[r]-1]++]>>15-t[r]);return a},Gv=new kv(288);for(zv=0;zv<144;++zv)Gv[zv]=8;for(zv=144;zv<256;++zv)Gv[zv]=9;for(zv=256;zv<280;++zv)Gv[zv]=7;for(zv=280;zv<288;++zv)Gv[zv]=8;var Vv=new kv(32);for(zv=0;zv<32;++zv)Vv[zv]=5;var Wv=qv(Gv,9,0),Kv=qv(Gv,9,1),Yv=qv(Vv,5,0),Xv=qv(Vv,5,1),Qv=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},Jv=function(t,e,i){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&i},Zv=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(7&e)},ty=function(t){return(t+7)/8|0},ey=function(t,e,i){return(null==e||e<0)&&(e=0),(null==i||i>t.length)&&(i=t.length),new kv(t.subarray(e,i))},iy=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ny=function(t,e,i){var n=new Error(e||iy[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ny),!i)throw n;return n},ry=function(t,e,i,n){var r=t.length,s=n?n.length:0;if(!r||e.f&&!e.l)return i||new kv(0);var a=!i,o=a||2!=e.i,l=e.i;a&&(i=new kv(3*r));var c=function(t){var e=i.length;if(t>e){var n=new kv(Math.max(2*e,t));n.set(i),i=n}},u=e.f||0,h=e.p||0,d=e.b||0,f=e.l,p=e.d,g=e.m,m=e.n,v=8*r;do{if(!f){u=Jv(t,h,1);var y=Jv(t,h+1,3);if(h+=3,!y){var b=t[(R=ty(h)+4)-4]|t[R-3]<<8,S=R+b;if(S>r){l&&ny(0);break}o&&c(d+b),i.set(t.subarray(R,S),d),e.b=d+=b,e.p=h=8*S,e.f=u;continue}if(1==y)f=Kv,p=Xv,g=9,m=5;else if(2==y){var w=Jv(t,h,31)+257,x=Jv(t,h+10,15)+4,E=w+Jv(t,h+5,31)+1;h+=14;for(var L=new kv(E),T=new kv(19),A=0;A<x;++A)T[Dv[A]]=Jv(t,h+3*A,7);h+=3*x;var _=Qv(T),k=(1<<_)-1,P=qv(T,_,1);for(A=0;A<E;){var R,I=P[Jv(t,h,k)];if(h+=15&I,(R=I>>4)<16)L[A++]=R;else{var C=0,D=0;for(16==R?(D=3+Jv(t,h,3),h+=2,C=L[A-1]):17==R?(D=3+Jv(t,h,7),h+=3):18==R&&(D=11+Jv(t,h,127),h+=7);D--;)L[A++]=C}}var N=L.subarray(0,w),O=L.subarray(w);g=Qv(N),m=Qv(O),f=qv(N,g,1),p=qv(O,m,1)}else ny(1);if(h>v){l&&ny(0);break}}o&&c(d+131072);for(var M=(1<<g)-1,F=(1<<m)-1,B=h;;B=h){var U=(C=f[Zv(t,h)&M])>>4;if((h+=15&C)>v){l&&ny(0);break}if(C||ny(2),U<256)i[d++]=U;else{if(256==U){B=h,f=null;break}var j=U-254;if(U>264){var $=Iv[A=U-257];j=Jv(t,h,(1<<$)-1)+Mv[A],h+=$}var z=p[Zv(t,h)&F],H=z>>4;z||ny(3),h+=15&z;O=Uv[H];if(H>3){$=Cv[H];O+=Zv(t,h)&(1<<$)-1,h+=$}if(h>v){l&&ny(0);break}o&&c(d+131072);var q=d+j;if(d<O){var G=s-O,V=Math.min(O,q);for(G+d<0&&ny(3);d<V;++d)i[d]=n[G+d]}for(;d<q;++d)i[d]=i[d-O]}}e.l=f,e.p=B,e.b=d,e.f=u,f&&(u=1,e.m=g,e.d=p,e.n=m)}while(!u);return d!=i.length&&a?ey(i,0,d):i.subarray(0,d)},sy=function(t,e,i){i<<=7&e;var n=e/8|0;t[n]|=i,t[n+1]|=i>>8},ay=function(t,e,i){i<<=7&e;var n=e/8|0;t[n]|=i,t[n+1]|=i>>8,t[n+2]|=i>>16},oy=function(t,e){for(var i=[],n=0;n<t.length;++n)t[n]&&i.push({s:n,f:t[n]});var r=i.length,s=i.slice();if(!r)return{t:py,l:0};if(1==r){var a=new kv(i[0].s+1);return a[i[0].s]=1,{t:a,l:1}}i.sort((function(t,e){return t.f-e.f})),i.push({s:-1,f:25001});var o=i[0],l=i[1],c=0,u=1,h=2;for(i[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=r-1;)o=i[i[c].f<i[h].f?c++:h++],l=i[c!=u&&i[c].f<i[h].f?c++:h++],i[u++]={s:-1,f:o.f+l.f,l:o,r:l};var d=s[0].s;for(n=1;n<r;++n)s[n].s>d&&(d=s[n].s);var f=new Pv(d+1),p=ly(i[u-1],f,0);if(p>e){n=0;var g=0,m=p-e,v=1<<m;for(s.sort((function(t,e){return f[e.s]-f[t.s]||t.f-e.f}));n<r;++n){var y=s[n].s;if(!(f[y]>e))break;g+=v-(1<<p-f[y]),f[y]=e}for(g>>=m;g>0;){var b=s[n].s;f[b]<e?g-=1<<e-f[b]++-1:++n}for(;n>=0&&g;--n){var S=s[n].s;f[S]==e&&(--f[S],++g)}p=e}return{t:new kv(f),l:p}},ly=function(t,e,i){return-1==t.s?Math.max(ly(t.l,e,i+1),ly(t.r,e,i+1)):e[t.s]=i},cy=function(t){for(var e=t.length;e&&!t[--e];);for(var i=new Pv(++e),n=0,r=t[0],s=1,a=function(t){i[n++]=t},o=1;o<=e;++o)if(t[o]==r&&o!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(r),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(r);s=1,r=t[o]}return{c:i.subarray(0,n),n:e}},uy=function(t,e){for(var i=0,n=0;n<e.length;++n)i+=t[n]*e[n];return i},hy=function(t,e,i){var n=i.length,r=ty(e+2);t[r]=255&n,t[r+1]=n>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var s=0;s<n;++s)t[r+s+4]=i[s];return 8*(r+4+n)},dy=function(t,e,i,n,r,s,a,o,l,c,u){sy(e,u++,i),++r[256];for(var h=oy(r,15),d=h.t,f=h.l,p=oy(s,15),g=p.t,m=p.l,v=cy(d),y=v.c,b=v.n,S=cy(g),w=S.c,x=S.n,E=new Pv(19),L=0;L<y.length;++L)++E[31&y[L]];for(L=0;L<w.length;++L)++E[31&w[L]];for(var T=oy(E,7),A=T.t,_=T.l,k=19;k>4&&!A[Dv[k-1]];--k);var P,R,I,C,D=c+5<<3,N=uy(r,Gv)+uy(s,Vv)+a,O=uy(r,d)+uy(s,g)+a+14+3*k+uy(E,A)+2*E[16]+3*E[17]+7*E[18];if(l>=0&&D<=N&&D<=O)return hy(e,u,t.subarray(l,l+c));if(sy(e,u,1+(O<N)),u+=2,O<N){P=qv(d,f,0),R=d,I=qv(g,m,0),C=g;var M=qv(A,_,0);sy(e,u,b-257),sy(e,u+5,x-1),sy(e,u+10,k-4),u+=14;for(L=0;L<k;++L)sy(e,u+3*L,A[Dv[L]]);u+=3*k;for(var F=[y,w],B=0;B<2;++B){var U=F[B];for(L=0;L<U.length;++L){var j=31&U[L];sy(e,u,M[j]),u+=A[j],j>15&&(sy(e,u,U[L]>>5&127),u+=U[L]>>12)}}}else P=Wv,R=Gv,I=Yv,C=Vv;for(L=0;L<o;++L){var $=n[L];if($>255){ay(e,u,P[(j=$>>18&31)+257]),u+=R[j+257],j>7&&(sy(e,u,$>>23&31),u+=Iv[j]);var z=31&$;ay(e,u,I[z]),u+=C[z],z>3&&(ay(e,u,$>>5&8191),u+=Cv[z])}else ay(e,u,P[$]),u+=R[$]}return ay(e,u,P[256]),u+R[256]},fy=new Rv([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),py=new kv(0),gy=function(t,e,i,n,r,s){var a=s.z||t.length,o=new kv(n+a+5*(1+Math.ceil(a/7e3))+r),l=o.subarray(n,o.length-r),c=s.l,u=7&(s.r||0);if(e){u&&(l[0]=s.r>>3);for(var h=fy[e-1],d=h>>13,f=8191&h,p=(1<<i)-1,g=s.p||new Pv(32768),m=s.h||new Pv(p+1),v=Math.ceil(i/3),y=2*v,b=function(e){return(t[e]^t[e+1]<<v^t[e+2]<<y)&p},S=new Rv(25e3),w=new Pv(288),x=new Pv(32),E=0,L=0,T=s.i||0,A=0,_=s.w||0,k=0;T+2<a;++T){var P=b(T),R=32767&T,I=m[P];if(g[R]=I,m[P]=R,_<=T){var C=a-T;if((E>7e3||A>24576)&&(C>423||!c)){u=dy(t,l,0,S,w,x,L,A,k,T-k,u),A=E=L=0,k=T;for(var D=0;D<286;++D)w[D]=0;for(D=0;D<30;++D)x[D]=0}var N=2,O=0,M=f,F=R-I&32767;if(C>2&&P==b(T-F))for(var B=Math.min(d,C)-1,U=Math.min(32767,T),j=Math.min(258,C);F<=U&&--M&&R!=I;){if(t[T+N]==t[T+N-F]){for(var $=0;$<j&&t[T+$]==t[T+$-F];++$);if($>N){if(N=$,O=F,$>B)break;var z=Math.min(F,$-2),H=0;for(D=0;D<z;++D){var q=T-F+D&32767,G=q-g[q]&32767;G>H&&(H=G,I=q)}}}F+=(R=I)-(I=g[R])&32767}if(O){S[A++]=268435456|Fv[N]<<18|jv[O];var V=31&Fv[N],W=31&jv[O];L+=Iv[V]+Cv[W],++w[257+V],++x[W],_=T+N,++E}else S[A++]=t[T],++w[t[T]]}}for(T=Math.max(T,_);T<a;++T)S[A++]=t[T],++w[t[T]];u=dy(t,l,c,S,w,x,L,A,k,T-k,u),c||(s.r=7&u|l[u/8|0]<<3,u-=7,s.h=m,s.p=g,s.i=T,s.w=_)}else{for(T=s.w||0;T<a+c;T+=65535){var K=T+65535;K>=a&&(l[u/8|0]=c,K=a),u=hy(l,u+1,t.subarray(T,K))}s.i=a}return ey(o,0,n+ty(u)+r)},my=function(){var t=1,e=0;return{p:function(i){for(var n=t,r=e,s=0|i.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)r+=n+=i[a];n=(65535&n)+15*(n>>16),r=(65535&r)+15*(r>>16)}t=n,e=r},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(e%=65521))<<8|e>>8}}},vy=function(t,e,i,n,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new kv(s.length+t.length);a.set(s),a.set(t,s.length),t=a,r.w=s.length}return gy(t,null==e.level?6:e.level,null==e.mem?r.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+e.mem,i,n,r)},yy=function(t,e,i){for(;i;++e)t[e]=i,i>>>=8},by=function(t,e){var i=e.level,n=0==i?0:i<6?1:9==i?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var r=my();r.p(e.dictionary),yy(t,2,r.d())}},Sy=function(t,e){return(8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ny(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&ny(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4)};function wy(t,e){e||(e={});var i=my();i.p(t);var n=vy(t,e,e.dictionary?6:2,4);return by(n,e),yy(n,n.length-4,i.d()),n}function xy(t,e){return ry(t.subarray(Sy(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var Ey="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ey.decode(py,{stream:!0})}catch(Bw){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var Ly=function(){return"undefined"!=typeof window?window:"undefined"!=typeof i.g?i.g:"undefined"!=typeof self?self:this}();function Ty(){Ly.console&&"function"==typeof Ly.console.log&&Ly.console.log.apply(Ly.console,arguments)}var Ay={log:Ty,warn:function(t){Ly.console&&("function"==typeof Ly.console.warn?Ly.console.warn.apply(Ly.console,arguments):Ty.call(null,arguments))},error:function(t){Ly.console&&("function"==typeof Ly.console.error?Ly.console.error.apply(Ly.console,arguments):Ty(t))}};function _y(t,e,i){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Cy(n.response,e,i)},n.onerror=function(){Ay.error("could not download file")},n.send()}function ky(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return e.status>=200&&e.status<=299}function Py(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Ry,Iy,Cy=Ly.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,_v.A)(window))||window!==Ly?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(t,e,i){var n=Ly.URL||Ly.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin!==location.origin?ky(r.href)?_y(t,e,i):Py(r,r.target="_blank"):Py(r)):(r.href=n.createObjectURL(t),setTimeout((function(){n.revokeObjectURL(r.href)}),4e4),setTimeout((function(){Py(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,i){if(e=e||t.name||"download","string"==typeof t)if(ky(t))_y(t,e,i);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout((function(){Py(n)}))}else navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!==(0,_v.A)(e)&&(Ay.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}(t,i),e)}:function(t,e,i,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return _y(t,e,i);var r="application/octet-stream"===t.type,s=/constructor/i.test(Ly.HTMLElement)||Ly.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||r&&s)&&"object"===("undefined"==typeof FileReader?"undefined":(0,_v.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var t=o.result;t=a?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},o.readAsDataURL(t)}else{var l=Ly.URL||Ly.webkitURL,c=l.createObjectURL(t);n?n.location=c:location.href=c,n=null,setTimeout((function(){l.revokeObjectURL(c)}),4e4)}});function Dy(t){var e;t=t||"",this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],n=0;n<i.length;n++){var r=i[n].re,s=i[n].process,a=r.exec(t);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),"#"+t+e+i}}function Ny(t,e){var i=t[0],n=t[1],r=t[2],s=t[3];i=My(i,n,r,s,e[0],7,-680876936),s=My(s,i,n,r,e[1],12,-389564586),r=My(r,s,i,n,e[2],17,606105819),n=My(n,r,s,i,e[3],22,-1044525330),i=My(i,n,r,s,e[4],7,-176418897),s=My(s,i,n,r,e[5],12,1200080426),r=My(r,s,i,n,e[6],17,-1473231341),n=My(n,r,s,i,e[7],22,-45705983),i=My(i,n,r,s,e[8],7,1770035416),s=My(s,i,n,r,e[9],12,-1958414417),r=My(r,s,i,n,e[10],17,-42063),n=My(n,r,s,i,e[11],22,-1990404162),i=My(i,n,r,s,e[12],7,1804603682),s=My(s,i,n,r,e[13],12,-40341101),r=My(r,s,i,n,e[14],17,-1502002290),i=Fy(i,n=My(n,r,s,i,e[15],22,1236535329),r,s,e[1],5,-165796510),s=Fy(s,i,n,r,e[6],9,-1069501632),r=Fy(r,s,i,n,e[11],14,643717713),n=Fy(n,r,s,i,e[0],20,-373897302),i=Fy(i,n,r,s,e[5],5,-701558691),s=Fy(s,i,n,r,e[10],9,38016083),r=Fy(r,s,i,n,e[15],14,-660478335),n=Fy(n,r,s,i,e[4],20,-405537848),i=Fy(i,n,r,s,e[9],5,568446438),s=Fy(s,i,n,r,e[14],9,-1019803690),r=Fy(r,s,i,n,e[3],14,-187363961),n=Fy(n,r,s,i,e[8],20,1163531501),i=Fy(i,n,r,s,e[13],5,-1444681467),s=Fy(s,i,n,r,e[2],9,-51403784),r=Fy(r,s,i,n,e[7],14,1735328473),i=By(i,n=Fy(n,r,s,i,e[12],20,-1926607734),r,s,e[5],4,-378558),s=By(s,i,n,r,e[8],11,-2022574463),r=By(r,s,i,n,e[11],16,1839030562),n=By(n,r,s,i,e[14],23,-35309556),i=By(i,n,r,s,e[1],4,-1530992060),s=By(s,i,n,r,e[4],11,1272893353),r=By(r,s,i,n,e[7],16,-155497632),n=By(n,r,s,i,e[10],23,-1094730640),i=By(i,n,r,s,e[13],4,681279174),s=By(s,i,n,r,e[0],11,-358537222),r=By(r,s,i,n,e[3],16,-722521979),n=By(n,r,s,i,e[6],23,76029189),i=By(i,n,r,s,e[9],4,-640364487),s=By(s,i,n,r,e[12],11,-421815835),r=By(r,s,i,n,e[15],16,530742520),i=Uy(i,n=By(n,r,s,i,e[2],23,-995338651),r,s,e[0],6,-198630844),s=Uy(s,i,n,r,e[7],10,1126891415),r=Uy(r,s,i,n,e[14],15,-1416354905),n=Uy(n,r,s,i,e[5],21,-57434055),i=Uy(i,n,r,s,e[12],6,1700485571),s=Uy(s,i,n,r,e[3],10,-1894986606),r=Uy(r,s,i,n,e[10],15,-1051523),n=Uy(n,r,s,i,e[1],21,-2054922799),i=Uy(i,n,r,s,e[8],6,1873313359),s=Uy(s,i,n,r,e[15],10,-30611744),r=Uy(r,s,i,n,e[6],15,-1560198380),n=Uy(n,r,s,i,e[13],21,1309151649),i=Uy(i,n,r,s,e[4],6,-145523070),s=Uy(s,i,n,r,e[11],10,-1120210379),r=Uy(r,s,i,n,e[2],15,718787259),n=Uy(n,r,s,i,e[9],21,-343485551),t[0]=Wy(i,t[0]),t[1]=Wy(n,t[1]),t[2]=Wy(r,t[2]),t[3]=Wy(s,t[3])}function Oy(t,e,i,n,r,s){return e=Wy(Wy(e,t),Wy(n,s)),Wy(e<<r|e>>>32-r,i)}function My(t,e,i,n,r,s,a){return Oy(e&i|~e&n,t,e,r,s,a)}function Fy(t,e,i,n,r,s,a){return Oy(e&n|i&~n,t,e,r,s,a)}function By(t,e,i,n,r,s,a){return Oy(e^i^n,t,e,r,s,a)}function Uy(t,e,i,n,r,s,a){return Oy(i^(e|~n),t,e,r,s,a)}function jy(t){var e,i=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Ny(n,$y(t.substring(e-64,e)));t=t.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(Ny(n,r),e=0;e<16;e++)r[e]=0;return r[14]=8*i,Ny(n,r),n}function $y(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}Ry=Ly.atob.bind(Ly),Iy=Ly.btoa.bind(Ly);var zy="0123456789abcdef".split("");function Hy(t){for(var e="",i=0;i<4;i++)e+=zy[t>>8*i+4&15]+zy[t>>8*i&15];return e}function qy(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Gy(t){return jy(t).map(qy).join("")}var Vy="5d41402abc4b2a76b9719d911017c592"!=function(t){for(var e=0;e<t.length;e++)t[e]=Hy(t[e]);return t.join("")}(jy("hello"));function Wy(t,e){if(Vy){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}return t+e&4294967295}function Ky(t,e){var i,n,r,s;if(t!==i){for(var a=(r=t,s=1+(256/t.length|0),new Array(s+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+a.charCodeAt(l))%256,o[l]=o[c],o[c]=u}i=t,n=o}else o=n;var h=e.length,d=0,f=0,p="";for(l=0;l<h;l++)f=(f+(u=o[d=(d+1)%256]))%256,o[d]=o[f],o[f]=u,a=o[(o[d]+o[f])%256],p+=String.fromCharCode(e.charCodeAt(l)^a);return p}var Yy={print:4,modify:8,copy:16,"annot-forms":32};function Xy(t,e,i,n){this.v=1,this.r=2;var r=192;t.forEach((function(t){if(void 0!==Yy.perm)throw new Error("Invalid permission: "+t);r+=Yy[t]})),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var s=(e+this.padding).substr(0,32),a=(i+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^r)),this.encryptionKey=Gy(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Ky(this.encryptionKey,this.padding)}function Qy(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",i=t.length,n=0;n<i;n++){var r=t.charCodeAt(n);e+=r<33||35===r||37===r||40===r||41===r||47===r||60===r||62===r||91===r||93===r||123===r||125===r||r>126?"#"+("0"+r.toString(16)).slice(-2):t[n]}return e}function Jy(t){if("object"!==(0,_v.A)(t))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,i,n){if(n=n||!1,"string"!=typeof t||"function"!=typeof i||"boolean"!=typeof n)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var r=Math.random().toString(35);return e[t][r]=[i,!!n],r},this.unsubscribe=function(t){for(var i in e)if(e[i][t])return delete e[i][t],0===Object.keys(e[i]).length&&delete e[i],!0;return!1},this.publish=function(i){if(e.hasOwnProperty(i)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[i]){var a=e[i][s];try{a[0].apply(t,n)}catch(i){Ly.console&&Ay.error("jsPDF PubSub Error",i.message,i)}a[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Zy(t){if(!(this instanceof Zy))return new Zy(t);var e="opacity,stroke-opacity".split(",");for(var i in t)t.hasOwnProperty(i)&&e.indexOf(i)>=0&&(this[i]=t[i]);this.id="",this.objectNumber=-1}function tb(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function eb(t,e,i,n,r){if(!(this instanceof eb))return new eb(t,e,i,n,r);this.type="axial"===t?2:3,this.coords=e,this.colors=i,tb.call(this,n,r)}function ib(t,e,i,n,r){if(!(this instanceof ib))return new ib(t,e,i,n,r);this.boundingBox=t,this.xStep=e,this.yStep=i,this.stream="",this.cloneIndex=0,tb.call(this,n,r)}function nb(t){var e,i="string"==typeof arguments[0]?arguments[0]:"p",n=arguments[1],r=arguments[2],s=arguments[3],a=[],o=1,l=16,c="S",u=null;"object"===(0,_v.A)(t=t||{})&&(i=t.orientation,n=t.unit||n,r=t.format||r,s=t.compress||t.compressPdf||s,null!==(u=t.encryption||null)&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(e=t.precision),void 0!==t.floatPrecision&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),a=t.filters||(!0===s?["FlateEncode"]:a),n=n||"mm",i=(""+(i||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,d={},f={internal:{},__private__:{}};f.__private__.PubSub=Jy;var p="1.3",g=f.__private__.getPdfVersion=function(){return p};f.__private__.setPdfVersion=function(t){p=t};var m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return m};var v=f.__private__.getPageFormat=function(t){return m[t]};r=r||"a4";var y="compat",b="advanced",S=y;function w(){this.saveGraphicsState(),Q(new It(dt,0,0,-dt,0,ci()*dt).toString()+" cm"),this.setFontSize(this.getFontSize()/dt),c="n",S=b}function x(){this.restoreGraphicsState(),c="S",S=y}var E=f.__private__.combineFontStyleAndFontWeight=function(t,e){if("bold"==t&&"normal"==e||"bold"==t&&400==e||"normal"==t&&"italic"==e||"bold"==t&&"italic"==e)throw new Error("Invalid Combination of fontweight and fontstyle");return e&&(t=400==e||"normal"===e?"italic"===t?"italic":"normal":700!=e&&"bold"!==e||"normal"!==t?(700==e?"bold":e)+""+t:"bold"),t};f.advancedAPI=function(t){var e=S===y;return e&&w.call(this),"function"!=typeof t||(t(this),e&&x.call(this)),this},f.compatAPI=function(t){var e=S===b;return e&&x.call(this),"function"!=typeof t||(t(this),e&&w.call(this)),this},f.isAdvancedAPI=function(){return S===b};var L,T=function(t){if(S!==b)throw new Error(t+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},A=f.roundToPrecision=f.__private__.roundToPrecision=function(t,i){var n=e||i;if(isNaN(t)||isNaN(n))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return t.toFixed(n).replace(/0+$/,"")};L=f.hpf=f.__private__.hpf="number"==typeof l?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return A(t,l)}:"smart"===l?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return A(t,t>-1&&t<1?16:5)}:function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return A(t,16)};var _=f.f2=f.__private__.f2=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return A(t,2)},k=f.__private__.f3=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f3");return A(t,3)},P=f.scale=f.__private__.scale=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.scale");return S===y?t*dt:S===b?t:void 0},R=function(t){return P(function(t){return S===y?ci()-t:S===b?t:void 0}(t))};f.__private__.setPrecision=f.setPrecision=function(t){"number"==typeof parseInt(t,10)&&(e=parseInt(t,10))};var I,C="00000000000000000000000000000000",D=f.__private__.getFileId=function(){return C},N=f.__private__.setFileId=function(t){return C=void 0!==t&&/^[a-fA-F0-9]{32}$/.test(t)?t.toUpperCase():C.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),null!==u&&(be=new Xy(u.userPermissions,u.userPassword,u.ownerPassword,C)),C};f.setFileId=function(t){return N(t),this},f.getFileId=function(){return D()};var O=f.__private__.convertDateToPDFDate=function(t){var e=t.getTimezoneOffset(),i=e<0?"+":"-",n=Math.floor(Math.abs(e/60)),r=Math.abs(e%60),s=[i,j(n),"'",j(r),"'"].join("");return["D:",t.getFullYear(),j(t.getMonth()+1),j(t.getDate()),j(t.getHours()),j(t.getMinutes()),j(t.getSeconds()),s].join("")},M=f.__private__.convertPDFDateToDate=function(t){var e=parseInt(t.substr(2,4),10),i=parseInt(t.substr(6,2),10)-1,n=parseInt(t.substr(8,2),10),r=parseInt(t.substr(10,2),10),s=parseInt(t.substr(12,2),10),a=parseInt(t.substr(14,2),10);return new Date(e,i,n,r,s,a,0)},F=f.__private__.setCreationDate=function(t){var e;if(void 0===t&&(t=new Date),t instanceof Date)e=O(t);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(t))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=t}return I=e},B=f.__private__.getCreationDate=function(t){var e=I;return"jsDate"===t&&(e=M(I)),e};f.setCreationDate=function(t){return F(t),this},f.getCreationDate=function(t){return B(t)};var U,j=f.__private__.padd2=function(t){return("0"+parseInt(t)).slice(-2)},$=f.__private__.padd2Hex=function(t){return("00"+(t=t.toString())).substr(t.length)},z=0,H=[],q=[],G=0,V=[],W=[],K=!1,Y=q;f.__private__.setCustomOutputDestination=function(t){K=!0,Y=t};var X=function(t){K||(Y=t)};f.__private__.resetCustomOutputDestination=function(){K=!1,Y=q};var Q=f.__private__.out=function(t){return t=t.toString(),G+=t.length+1,Y.push(t),Y},J=f.__private__.write=function(t){return Q(1===arguments.length?t.toString():Array.prototype.join.call(arguments," "))},Z=f.__private__.getArrayBuffer=function(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i);e--;)n[e]=t.charCodeAt(e);return i},tt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return tt};var et=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(t){return et=S===b?t/dt:t,this};var it,nt=f.__private__.getFontSize=f.getFontSize=function(){return S===y?et:et*dt},rt=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(t){return rt=t,this},f.__private__.getR2L=f.getR2L=function(){return rt};var st,at=f.__private__.setZoomMode=function(t){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(t))it=t;else if(isNaN(t)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(t))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t+'" is not recognized.');it=t}else it=parseInt(t,10)};f.__private__.getZoomMode=function(){return it};var ot,lt=f.__private__.setPageMode=function(t){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t+'" is not recognized.');st=t};f.__private__.getPageMode=function(){return st};var ct=f.__private__.setLayoutMode=function(t){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t+'" is not recognized.');ot=t};f.__private__.getLayoutMode=function(){return ot},f.__private__.setDisplayMode=f.setDisplayMode=function(t,e,i){return at(t),ct(e),lt(i),this};var ut={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(t){if(-1===Object.keys(ut).indexOf(t))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ut[t]},f.__private__.getDocumentProperties=function(){return ut},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(t){for(var e in ut)ut.hasOwnProperty(e)&&t[e]&&(ut[e]=t[e]);return this},f.__private__.setDocumentProperty=function(t,e){if(-1===Object.keys(ut).indexOf(t))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ut[t]=e};var ht,dt,ft,pt,gt,mt={},vt={},yt=[],bt={},St={},wt={},xt={},Et=null,Lt=0,Tt=[],At=new Jy(f),_t=t.hotfixes||[],kt={},Pt={},Rt=[],It=function t(e,i,n,r,s,a){if(!(this instanceof t))return new t(e,i,n,r,s,a);isNaN(e)&&(e=1),isNaN(i)&&(i=0),isNaN(n)&&(n=0),isNaN(r)&&(r=1),isNaN(s)&&(s=0),isNaN(a)&&(a=0),this._matrix=[e,i,n,r,s,a]};Object.defineProperty(It.prototype,"sx",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(It.prototype,"shy",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(It.prototype,"shx",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(It.prototype,"sy",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(It.prototype,"tx",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(It.prototype,"ty",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(It.prototype,"a",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(It.prototype,"b",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(It.prototype,"c",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(It.prototype,"d",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(It.prototype,"e",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(It.prototype,"f",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(It.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(It.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(It.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(It.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),It.prototype.join=function(t){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(t)},It.prototype.multiply=function(t){var e=t.sx*this.sx+t.shy*this.shx,i=t.sx*this.shy+t.shy*this.sy,n=t.shx*this.sx+t.sy*this.shx,r=t.shx*this.shy+t.sy*this.sy,s=t.tx*this.sx+t.ty*this.shx+this.tx,a=t.tx*this.shy+t.ty*this.sy+this.ty;return new It(e,i,n,r,s,a)},It.prototype.decompose=function(){var t=this.sx,e=this.shy,i=this.shx,n=this.sy,r=this.tx,s=this.ty,a=Math.sqrt(t*t+e*e),o=(t/=a)*i+(e/=a)*n;i-=t*o,n-=e*o;var l=Math.sqrt(i*i+n*n);return o/=l,t*(n/=l)<e*(i/=l)&&(t=-t,e=-e,o=-o,a=-a),{scale:new It(a,0,0,l,0,0),translate:new It(1,0,0,1,r,s),rotate:new It(t,e,-e,t,0,0),skew:new It(1,0,o,1,0,0)}},It.prototype.toString=function(t){return this.join(" ")},It.prototype.inversed=function(){var t=this.sx,e=this.shy,i=this.shx,n=this.sy,r=this.tx,s=this.ty,a=1/(t*n-e*i),o=n*a,l=-e*a,c=-i*a,u=t*a;return new It(o,l,c,u,-o*r-c*s,-l*r-u*s)},It.prototype.applyToPoint=function(t){var e=t.x*this.sx+t.y*this.shx+this.tx,i=t.x*this.shy+t.y*this.sy+this.ty;return new ii(e,i)},It.prototype.applyToRectangle=function(t){var e=this.applyToPoint(t),i=this.applyToPoint(new ii(t.x+t.w,t.y+t.h));return new ni(e.x,e.y,i.x-e.x,i.y-e.y)},It.prototype.clone=function(){var t=this.sx,e=this.shy,i=this.shx,n=this.sy,r=this.tx,s=this.ty;return new It(t,e,i,n,r,s)},f.Matrix=It;var Ct=f.matrixMult=function(t,e){return e.multiply(t)},Dt=new It(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Dt;var Nt=function(t,e){if(!St[t]){var i=(e instanceof eb?"Sh":"P")+(Object.keys(bt).length+1).toString(10);e.id=i,St[t]=i,bt[i]=e,At.publish("addPattern",e)}};f.ShadingPattern=eb,f.TilingPattern=ib,f.addShadingPattern=function(t,e){return T("addShadingPattern()"),Nt(t,e),this},f.beginTilingPattern=function(t){T("beginTilingPattern()"),si(t.boundingBox[0],t.boundingBox[1],t.boundingBox[2]-t.boundingBox[0],t.boundingBox[3]-t.boundingBox[1],t.matrix)},f.endTilingPattern=function(t,e){T("endTilingPattern()"),e.stream=W[U].join("\n"),Nt(t,e),At.publish("endTilingPattern",e),Rt.pop().restore()};var Ot,Mt=f.__private__.newObject=function(){var t=Ft();return Bt(t,!0),t},Ft=f.__private__.newObjectDeferred=function(){return z++,H[z]=function(){return G},z},Bt=function(t,e){return e="boolean"==typeof e&&e,H[t]=G,e&&Q(t+" 0 obj"),t},Ut=f.__private__.newAdditionalObject=function(){var t={objId:Ft(),content:""};return V.push(t),t},jt=Ft(),$t=Ft(),zt=f.__private__.decodeColorString=function(t){var e=t.split(" ");if(2!==e.length||"g"!==e[1]&&"G"!==e[1])5!==e.length||"k"!==e[4]&&"K"!==e[4]||(e=[(1-e[0])*(1-e[3]),(1-e[1])*(1-e[3]),(1-e[2])*(1-e[3]),"r"]);else{var i=parseFloat(e[0]);e=[i,i,i,"r"]}for(var n="#",r=0;r<3;r++)n+=("0"+Math.floor(255*parseFloat(e[r])).toString(16)).slice(-2);return n},Ht=f.__private__.encodeColorString=function(t){var e;"string"==typeof t&&(t={ch1:t});var i=t.ch1,n=t.ch2,r=t.ch3,s=t.ch4,a="draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof i&&"#"!==i.charAt(0)){var o=new Dy(i);if(o.ok)i=o.toHex();else if(!/^\d*\.?\d*$/.test(i))throw new Error('Invalid color "'+i+'" passed to jsPDF.encodeColorString.')}if("string"==typeof i&&/^#[0-9A-Fa-f]{3}$/.test(i)&&(i="#"+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]),"string"==typeof i&&/^#[0-9A-Fa-f]{6}$/.test(i)){var l=parseInt(i.substr(1),16);i=l>>16&255,n=l>>8&255,r=255&l}if(void 0===n||void 0===s&&i===n&&n===r)if("string"==typeof i)e=i+" "+a[0];else if(2===t.precision)e=_(i/255)+" "+a[0];else e=k(i/255)+" "+a[0];else if(void 0===s||"object"===(0,_v.A)(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",a[1]].join(" ");if("string"==typeof i)e=[i,n,r,a[1]].join(" ");else if(2===t.precision)e=[_(i/255),_(n/255),_(r/255),a[1]].join(" ");else e=[k(i/255),k(n/255),k(r/255),a[1]].join(" ")}else if("string"==typeof i)e=[i,n,r,s,a[2]].join(" ");else if(2===t.precision)e=[_(i),_(n),_(r),_(s),a[2]].join(" ");else e=[k(i),k(n),k(r),k(s),a[2]].join(" ");return e},qt=f.__private__.getFilters=function(){return a},Gt=f.__private__.putStream=function(t){var e=(t=t||{}).data||"",i=t.filters||qt(),n=t.alreadyAppliedFilters||[],r=t.addLength1||!1,s=e.length,a=t.objectId,o=function(t){return t};if(null!==u&&void 0===a)throw new Error("ObjectId must be passed to putStream for file encryption");null!==u&&(o=be.encryptor(a,0));var l={};!0===i&&(i=["FlateEncode"]);var c=t.additionalKeyValues||[],h=(l=void 0!==nb.API.processDataByFilters?nb.API.processDataByFilters(e,i):{data:e,reverseChain:[]}).reverseChain+(Array.isArray(n)?n.join(" "):n.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===r&&c.push({key:"Length1",value:s})),0!=h.length)if(h.split("/").length-1==1)c.push({key:"Filter",value:h});else{c.push({key:"Filter",value:"["+h+"]"});for(var d=0;d<c.length;d+=1)if("DecodeParms"===c[d].key){for(var f=[],p=0;p<l.reverseChain.split("/").length-1;p+=1)f.push("null");f.push(c[d].value),c[d].value="["+f.join(" ")+"]"}}Q("<<");for(var g=0;g<c.length;g++)Q("/"+c[g].key+" "+c[g].value);Q(">>"),0!==l.data.length&&(Q("stream"),Q(o(l.data)),Q("endstream"))},Vt=f.__private__.putPage=function(t){var e=t.number,i=t.data,n=t.objId,r=t.contentsObjId;Bt(n,!0),Q("<</Type /Page"),Q("/Parent "+t.rootDictionaryObjId+" 0 R"),Q("/Resources "+t.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(L(t.mediaBox.bottomLeftX))+" "+parseFloat(L(t.mediaBox.bottomLeftY))+" "+L(t.mediaBox.topRightX)+" "+L(t.mediaBox.topRightY)+"]"),null!==t.cropBox&&Q("/CropBox ["+L(t.cropBox.bottomLeftX)+" "+L(t.cropBox.bottomLeftY)+" "+L(t.cropBox.topRightX)+" "+L(t.cropBox.topRightY)+"]"),null!==t.bleedBox&&Q("/BleedBox ["+L(t.bleedBox.bottomLeftX)+" "+L(t.bleedBox.bottomLeftY)+" "+L(t.bleedBox.topRightX)+" "+L(t.bleedBox.topRightY)+"]"),null!==t.trimBox&&Q("/TrimBox ["+L(t.trimBox.bottomLeftX)+" "+L(t.trimBox.bottomLeftY)+" "+L(t.trimBox.topRightX)+" "+L(t.trimBox.topRightY)+"]"),null!==t.artBox&&Q("/ArtBox ["+L(t.artBox.bottomLeftX)+" "+L(t.artBox.bottomLeftY)+" "+L(t.artBox.topRightX)+" "+L(t.artBox.topRightY)+"]"),"number"==typeof t.userUnit&&1!==t.userUnit&&Q("/UserUnit "+t.userUnit),At.publish("putPage",{objId:n,pageContext:Tt[e],pageNumber:e,page:i}),Q("/Contents "+r+" 0 R"),Q(">>"),Q("endobj");var s=i.join("\n");return S===b&&(s+="\nQ"),Bt(r,!0),Gt({data:s,filters:qt(),objectId:r}),Q("endobj"),n},Wt=f.__private__.putPages=function(){var t,e,i=[];for(t=1;t<=Lt;t++)Tt[t].objId=Ft(),Tt[t].contentsObjId=Ft();for(t=1;t<=Lt;t++)i.push(Vt({number:t,data:W[t],objId:Tt[t].objId,contentsObjId:Tt[t].contentsObjId,mediaBox:Tt[t].mediaBox,cropBox:Tt[t].cropBox,bleedBox:Tt[t].bleedBox,trimBox:Tt[t].trimBox,artBox:Tt[t].artBox,userUnit:Tt[t].userUnit,rootDictionaryObjId:jt,resourceDictionaryObjId:$t}));Bt(jt,!0),Q("<</Type /Pages");var n="/Kids [";for(e=0;e<Lt;e++)n+=i[e]+" 0 R ";Q(n+"]"),Q("/Count "+Lt),Q(">>"),Q("endobj"),At.publish("postPutPages")},Kt=function(t){At.publish("putFont",{font:t,out:Q,newObject:Mt,putStream:Gt}),!0!==t.isAlreadyPutted&&(t.objectNumber=Mt(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+Qy(t.postScriptName)),Q("/Subtype /Type1"),"string"==typeof t.encoding&&Q("/Encoding /"+t.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},Yt=function(t){t.objectNumber=Mt();var e=[];e.push({key:"Type",value:"/XObject"}),e.push({key:"Subtype",value:"/Form"}),e.push({key:"BBox",value:"["+[L(t.x),L(t.y),L(t.x+t.width),L(t.y+t.height)].join(" ")+"]"}),e.push({key:"Matrix",value:"["+t.matrix.toString()+"]"});var i=t.pages[1].join("\n");Gt({data:i,additionalKeyValues:e,objectId:t.objectNumber}),Q("endobj")},Xt=function(t,e){e||(e=21);var i=Mt(),n=function(t,e){var i,n=[],r=1/(e-1);for(i=0;i<1;i+=r)n.push(i);if(n.push(1),0!=t[0].offset){var s={offset:0,color:t[0].color};t.unshift(s)}if(1!=t[t.length-1].offset){var a={offset:1,color:t[t.length-1].color};t.push(a)}for(var o="",l=0,c=0;c<n.length;c++){for(i=n[c];i>t[l+1].offset;)l++;var u=t[l].offset,h=(i-u)/(t[l+1].offset-u),d=t[l].color,f=t[l+1].color;o+=$(Math.round((1-h)*d[0]+h*f[0]).toString(16))+$(Math.round((1-h)*d[1]+h*f[1]).toString(16))+$(Math.round((1-h)*d[2]+h*f[2]).toString(16))}return o.trim()}(t.colors,e),r=[];r.push({key:"FunctionType",value:"0"}),r.push({key:"Domain",value:"[0.0 1.0]"}),r.push({key:"Size",value:"["+e+"]"}),r.push({key:"BitsPerSample",value:"8"}),r.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),r.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Gt({data:n,additionalKeyValues:r,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:i}),Q("endobj"),t.objectNumber=Mt(),Q("<< /ShadingType "+t.type),Q("/ColorSpace /DeviceRGB");var s="/Coords ["+L(parseFloat(t.coords[0]))+" "+L(parseFloat(t.coords[1]))+" ";2===t.type?s+=L(parseFloat(t.coords[2]))+" "+L(parseFloat(t.coords[3])):s+=L(parseFloat(t.coords[2]))+" "+L(parseFloat(t.coords[3]))+" "+L(parseFloat(t.coords[4]))+" "+L(parseFloat(t.coords[5])),Q(s+="]"),t.matrix&&Q("/Matrix ["+t.matrix.toString()+"]"),Q("/Function "+i+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},Qt=function(t,e){var i=Ft(),n=Mt();e.push({resourcesOid:i,objectOid:n}),t.objectNumber=n;var r=[];r.push({key:"Type",value:"/Pattern"}),r.push({key:"PatternType",value:"1"}),r.push({key:"PaintType",value:"1"}),r.push({key:"TilingType",value:"1"}),r.push({key:"BBox",value:"["+t.boundingBox.map(L).join(" ")+"]"}),r.push({key:"XStep",value:L(t.xStep)}),r.push({key:"YStep",value:L(t.yStep)}),r.push({key:"Resources",value:i+" 0 R"}),t.matrix&&r.push({key:"Matrix",value:"["+t.matrix.toString()+"]"}),Gt({data:t.stream,additionalKeyValues:r,objectId:t.objectNumber}),Q("endobj")},Jt=function(t){for(var e in t.objectNumber=Mt(),Q("<<"),t)switch(e){case"opacity":Q("/ca "+_(t[e]));break;case"stroke-opacity":Q("/CA "+_(t[e]))}Q(">>"),Q("endobj")},Zt=function(t){Bt(t.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var t in Q("/Font <<"),mt)mt.hasOwnProperty(t)&&(!1===h||!0===h&&d.hasOwnProperty(t))&&Q("/"+t+" "+mt[t].objectNumber+" 0 R");Q(">>")}(),function(){if(Object.keys(bt).length>0){for(var t in Q("/Shading <<"),bt)bt.hasOwnProperty(t)&&bt[t]instanceof eb&&bt[t].objectNumber>=0&&Q("/"+t+" "+bt[t].objectNumber+" 0 R");At.publish("putShadingPatternDict"),Q(">>")}}(),function(t){if(Object.keys(bt).length>0){for(var e in Q("/Pattern <<"),bt)bt.hasOwnProperty(e)&&bt[e]instanceof f.TilingPattern&&bt[e].objectNumber>=0&&bt[e].objectNumber<t&&Q("/"+e+" "+bt[e].objectNumber+" 0 R");At.publish("putTilingPatternDict"),Q(">>")}}(t.objectOid),function(){if(Object.keys(wt).length>0){var t;for(t in Q("/ExtGState <<"),wt)wt.hasOwnProperty(t)&&wt[t].objectNumber>=0&&Q("/"+t+" "+wt[t].objectNumber+" 0 R");At.publish("putGStateDict"),Q(">>")}}(),function(){for(var t in Q("/XObject <<"),kt)kt.hasOwnProperty(t)&&kt[t].objectNumber>=0&&Q("/"+t+" "+kt[t].objectNumber+" 0 R");At.publish("putXobjectDict"),Q(">>")}(),Q(">>"),Q("endobj")},te=function(){var t=[];(function(){for(var t in mt)mt.hasOwnProperty(t)&&(!1===h||!0===h&&d.hasOwnProperty(t))&&Kt(mt[t])})(),function(){var t;for(t in wt)wt.hasOwnProperty(t)&&Jt(wt[t])}(),function(){for(var t in kt)kt.hasOwnProperty(t)&&Yt(kt[t])}(),function(t){var e;for(e in bt)bt.hasOwnProperty(e)&&(bt[e]instanceof eb?Xt(bt[e]):bt[e]instanceof ib&&Qt(bt[e],t))}(t),At.publish("putResources"),t.forEach(Zt),Zt({resourcesOid:$t,objectOid:Number.MAX_SAFE_INTEGER}),At.publish("postPutResources")},ee=function(t){vt[t.fontName]=vt[t.fontName]||{},vt[t.fontName][t.fontStyle]=t.id},ie=function(t,e,i,n,r){var s={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:t,fontName:e,fontStyle:i,encoding:n,isStandardFont:r||!1,metadata:{}};return At.publish("addFont",{font:s,instance:this}),mt[s.id]=s,ee(s),s.id},ne=f.__private__.pdfEscape=f.pdfEscape=function(t,e){return function(t,e){var i,n,r,s,a,o,l,c,u;if(r=(e=e||{}).sourceEncoding||"Unicode",a=e.outputEncoding,(e.autoencode||a)&&mt[ht].metadata&&mt[ht].metadata[r]&&mt[ht].metadata[r].encoding&&(s=mt[ht].metadata[r].encoding,!a&&mt[ht].encoding&&(a=mt[ht].encoding),!a&&s.codePages&&(a=s.codePages[0]),"string"==typeof a&&(a=s[a]),a)){for(l=!1,o=[],i=0,n=t.length;i<n;i++)(c=a[t.charCodeAt(i)])?o.push(String.fromCharCode(c)):o.push(t[i]),o[i].charCodeAt(0)>>8&&(l=!0);t=o.join("")}for(i=t.length;void 0===l&&0!==i;)t.charCodeAt(i-1)>>8&&(l=!0),i--;if(!l)return t;for(o=e.noBOM?[]:[254,255],i=0,n=t.length;i<n;i++){if((u=(c=t.charCodeAt(i))>>8)>>8)throw new Error("Character at position "+i+" of string '"+t+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(u),o.push(c-(u<<8))}return String.fromCharCode.apply(void 0,o)}(t,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},re=f.__private__.beginPage=function(t){W[++Lt]=[],Tt[Lt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t[0]),topRightY:Number(t[1])}},oe(Lt),X(W[U])},se=function(t,e){var n,s,a;switch(i=e||i,"string"==typeof t&&(n=v(t.toLowerCase()),Array.isArray(n)&&(s=n[0],a=n[1])),Array.isArray(t)&&(s=t[0]*dt,a=t[1]*dt),isNaN(s)&&(s=r[0],a=r[1]),(s>14400||a>14400)&&(Ay.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),a=Math.min(14400,a)),r=[s,a],i.substr(0,1)){case"l":a>s&&(r=[a,s]);break;case"p":s>a&&(r=[a,s])}re(r),Ue(Fe),Q(We),0!==Ze&&Q(Ze+" J"),0!==ti&&Q(ti+" j"),At.publish("addPage",{pageNumber:Lt})},ae=function(t){t>0&&t<=Lt&&(W.splice(t,1),Tt.splice(t,1),Lt--,U>Lt&&(U=Lt),this.setPage(U))},oe=function(t){t>0&&t<=Lt&&(U=t)},le=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return W.length-1},ce=function(t,e,i){var n,r=void 0;return i=i||{},t=void 0!==t?t:mt[ht].fontName,e=void 0!==e?e:mt[ht].fontStyle,n=t.toLowerCase(),void 0!==vt[n]&&void 0!==vt[n][e]?r=vt[n][e]:void 0!==vt[t]&&void 0!==vt[t][e]?r=vt[t][e]:!1===i.disableWarning&&Ay.warn("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts."),r||i.noFallback||null==(r=vt.times[e])&&(r=vt.times.normal),r},ue=f.__private__.putInfo=function(){var t=Mt(),e=function(t){return t};for(var i in null!==u&&(e=be.encryptor(t,0)),Q("<<"),Q("/Producer ("+ne(e("jsPDF "+nb.version))+")"),ut)ut.hasOwnProperty(i)&&ut[i]&&Q("/"+i.substr(0,1).toUpperCase()+i.substr(1)+" ("+ne(e(ut[i]))+")");Q("/CreationDate ("+ne(e(I))+")"),Q(">>"),Q("endobj")},he=f.__private__.putCatalog=function(t){var e=(t=t||{}).rootDictionaryObjId||jt;switch(Mt(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+e+" 0 R"),it||(it="fullwidth"),it){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var i=""+it;"%"===i.substr(i.length-1)&&(it=parseInt(it)/100),"number"==typeof it&&Q("/OpenAction [3 0 R /XYZ null null "+_(it)+"]")}switch(ot||(ot="continuous"),ot){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}st&&Q("/PageMode /"+st),At.publish("putCatalog"),Q(">>"),Q("endobj")},de=f.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(z+1)),Q("/Root "+z+" 0 R"),Q("/Info "+(z-1)+" 0 R"),null!==u&&Q("/Encrypt "+be.oid+" 0 R"),Q("/ID [ <"+C+"> <"+C+"> ]"),Q(">>")},fe=f.__private__.putHeader=function(){Q("%PDF-"+p),Q("%\xba\xdf\xac\xe0")},pe=f.__private__.putXRef=function(){var t="0000000000";Q("xref"),Q("0 "+(z+1)),Q("0000000000 65535 f ");for(var e=1;e<=z;e++)"function"==typeof H[e]?Q((t+H[e]()).slice(-10)+" 00000 n "):void 0!==H[e]?Q((t+H[e]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},ge=f.__private__.buildDocument=function(){z=0,G=0,q=[],H=[],V=[],jt=Ft(),$t=Ft(),X(q),At.publish("buildDocument"),fe(),Wt(),function(){At.publish("putAdditionalObjects");for(var t=0;t<V.length;t++){var e=V[t];Bt(e.objId,!0),Q(e.content),Q("endobj")}At.publish("postPutAdditionalObjects")}(),te(),null!==u&&(be.oid=Mt(),Q("<<"),Q("/Filter /Standard"),Q("/V "+be.v),Q("/R "+be.r),Q("/U <"+be.toHexString(be.U)+">"),Q("/O <"+be.toHexString(be.O)+">"),Q("/P "+be.P),Q(">>"),Q("endobj")),ue(),he();var t=G;return pe(),de(),Q("startxref"),Q(""+t),Q("%%EOF"),X(W[U]),q.join("\n")},me=f.__private__.getBlob=function(t){return new Blob([Z(t)],{type:"application/pdf"})},ve=f.output=f.__private__.output=(Ot=function(t,e){switch("string"==typeof(e=e||{})?e={filename:e}:e.filename=e.filename||"generated.pdf",t){case void 0:return ge();case"save":f.save(e.filename);break;case"arraybuffer":return Z(ge());case"blob":return me(ge());case"bloburi":case"bloburl":if(void 0!==Ly.URL&&"function"==typeof Ly.URL.createObjectURL)return Ly.URL&&Ly.URL.createObjectURL(me(ge()))||void 0;Ay.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var i="",n=ge();try{i=Iy(n)}catch(t){i=Iy(unescape(encodeURIComponent(n)))}return"data:application/pdf;filename="+e.filename+";base64,"+i;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(Ly)){var r="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';e.pdfObjectUrl&&(r=e.pdfObjectUrl,s="");var a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+r+'"'+s+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(e)+");<\/script></body></html>",o=Ly.open();return null!==o&&o.document.write(a),o}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(Ly)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+e.filename+'" width="500px" height="400px" /></body></html>',c=Ly.open();if(null!==c){c.document.write(l);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=e.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(Ly))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",e)+'"></iframe></body></html>',d=Ly.open();if(null!==d&&(d.document.write(h),d.document.title=e.filename),d||"undefined"==typeof safari)return d;break;case"datauri":case"dataurl":return Ly.document.location.href=this.output("datauristring",e);default:return null}},Ot.foo=function(){try{return Ot.apply(this,arguments)}catch(Ot){var t=Ot.stack||"";~t.indexOf(" at ")&&(t=t.split(" at ")[1]);var e="Error in function "+t.split("\n")[0].split("<")[0]+": "+Ot.message;if(!Ly.console)throw new Error(e);Ly.console.error(e,Ot),Ly.alert&&alert(e)}},Ot.foo.bar=Ot,Ot.foo),ye=function(t){return!0===Array.isArray(_t)&&_t.indexOf(t)>-1};switch(n){case"pt":dt=1;break;case"mm":dt=72/25.4;break;case"cm":dt=72/2.54;break;case"in":dt=72;break;case"px":dt=1==ye("px_scaling")?.75:96/72;break;case"pc":case"em":dt=12;break;case"ex":dt=6;break;default:if("number"!=typeof n)throw new Error("Invalid unit: "+n);dt=n}var be=null;F(),N();var Se=f.__private__.getPageInfo=f.getPageInfo=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Tt[t].objId,pageNumber:t,pageContext:Tt[t]}},we=f.__private__.getPageInfoByObjId=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var e in Tt)if(Tt[e].objId===t)break;return Se(e)},xe=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Tt[U].objId,pageNumber:U,pageContext:Tt[U]}};f.addPage=function(){return se.apply(this,arguments),this},f.setPage=function(){return oe.apply(this,arguments),X.call(this,W[U]),this},f.insertPage=function(t){return this.addPage(),this.movePage(U,t),this},f.movePage=function(t,e){var i,n;if(t>e){i=W[t],n=Tt[t];for(var r=t;r>e;r--)W[r]=W[r-1],Tt[r]=Tt[r-1];W[e]=i,Tt[e]=n,this.setPage(e)}else if(t<e){i=W[t],n=Tt[t];for(var s=t;s<e;s++)W[s]=W[s+1],Tt[s]=Tt[s+1];W[e]=i,Tt[e]=n,this.setPage(e)}return this},f.deletePage=function(){return ae.apply(this,arguments),this},f.__private__.text=f.text=function(t,e,i,n,r){var s,a,o,l,c,u,h,f,p,g=(n=n||{}).scope||this;if("number"==typeof t&&"number"==typeof e&&("string"==typeof i||Array.isArray(i))){var m=i;i=e,e=t,t=m}if(arguments[3]instanceof It==0?(o=arguments[4],l=arguments[5],"object"===(0,_v.A)(h=arguments[3])&&null!==h||("string"==typeof o&&(l=o,o=null),"string"==typeof h&&(l=h,h=null),"number"==typeof h&&(o=h,h=null),n={flags:h,angle:o,align:l})):(T("The transform parameter of text() with a Matrix value"),p=r),isNaN(e)||isNaN(i)||null==t)throw new Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return g;var v,y="",w="number"==typeof n.lineHeightFactor?n.lineHeightFactor:Me,x=g.internal.scaleFactor;function E(t){return t=t.split("\t").join(Array(n.TabLen||9).join(" ")),ne(t,h)}function A(t){for(var e,i=t.concat(),n=[],r=i.length;r--;)"string"==typeof(e=i.shift())?n.push(e):Array.isArray(t)&&(1===e.length||void 0===e[1]&&void 0===e[2])?n.push(e[0]):n.push([e[0],e[1],e[2]]);return n}function _(t,e){var i;if("string"==typeof t)i=e(t)[0];else if(Array.isArray(t)){for(var n,r,s=t.concat(),a=[],o=s.length;o--;)"string"==typeof(n=s.shift())?a.push(e(n)[0]):Array.isArray(n)&&"string"==typeof n[0]&&(r=e(n[0],n[1],n[2]),a.push([r[0],r[1],r[2]]));i=a}return i}var k=!1,R=!0;if("string"==typeof t)k=!0;else if(Array.isArray(t)){var I=t.concat();a=[];for(var C,D=I.length;D--;)("string"!=typeof(C=I.shift())||Array.isArray(C)&&"string"!=typeof C[0])&&(R=!1);k=R}if(!1===k)throw new Error('Type of text must be string or Array. "'+t+'" is not recognized.');"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var N=et/g.internal.scaleFactor,O=N*(w-1);switch(n.baseline){case"bottom":i-=O;break;case"top":i+=N-O;break;case"hanging":i+=N-2*O;break;case"middle":i+=N/2-O}if((u=n.maxWidth||0)>0&&("string"==typeof t?t=g.splitTextToSize(t,u):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce((function(t,e){return t.concat(g.splitTextToSize(e,u))}),[]))),s={text:t,x:e,y:i,options:n,mutex:{pdfEscape:ne,activeFontKey:ht,fonts:mt,activeFontSize:et}},At.publish("preProcessText",s),t=s.text,o=(n=s.options).angle,p instanceof It==0&&o&&"number"==typeof o){o*=Math.PI/180,0===n.rotationDirection&&(o=-o),S===b&&(o=-o);var M=Math.cos(o),F=Math.sin(o);p=new It(M,F,-F,M,0,0)}else o&&o instanceof It&&(p=o);S!==b||p||(p=Dt),void 0!==(c=n.charSpace||Qe)&&(y+=L(P(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=n.horizontalScale)&&(y+=L(100*f)+" Tz\n"),n.lang;var B=-1,U=void 0!==n.renderingMode?n.renderingMode:n.stroke,j=g.internal.getCurrentPageInfo().pageContext;switch(U){case 0:case!1:case"fill":B=0;break;case 1:case!0:case"stroke":B=1;break;case 2:case"fillThenStroke":B=2;break;case 3:case"invisible":B=3;break;case 4:case"fillAndAddForClipping":B=4;break;case 5:case"strokeAndAddPathForClipping":B=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":B=6;break;case 7:case"addToPathForClipping":B=7}var $=void 0!==j.usedRenderingMode?j.usedRenderingMode:-1;-1!==B?y+=B+" Tr\n":-1!==$&&(y+="0 Tr\n"),-1!==B&&(j.usedRenderingMode=B),l=n.align||"left";var z,H=et*w,q=g.internal.pageSize.getWidth(),G=mt[ht];c=n.charSpace||Qe,u=n.maxWidth||0,h=Object.assign({autoencode:!0,noBOM:!0},n.flags);var V=[],W=function(t){return g.getStringUnitWidth(t,{font:G,charSpace:c,fontSize:et,doKerning:!1})*et/x};if("[object Array]"===Object.prototype.toString.call(t)){var K;a=A(t),"left"!==l&&(z=a.map(W));var Y,X=0;if("right"===l){e-=z[0],t=[],D=a.length;for(var J=0;J<D;J++)0===J?(Y=He(e),K=qe(i)):(Y=P(X-z[J]),K=-H),t.push([a[J],Y,K]),X=z[J]}else if("center"===l){e-=z[0]/2,t=[],D=a.length;for(var Z=0;Z<D;Z++)0===Z?(Y=He(e),K=qe(i)):(Y=P((X-z[Z])/2),K=-H),t.push([a[Z],Y,K]),X=z[Z]}else if("left"===l){t=[],D=a.length;for(var tt=0;tt<D;tt++)t.push(a[tt])}else if("justify"===l&&"Identity-H"===G.encoding){t=[],D=a.length,u=0!==u?u:q;for(var it=0,nt=0;nt<D;nt++)if(K=0===nt?qe(i):-H,Y=0===nt?He(e):it,nt<D-1){var st=P((u-z[nt])/(a[nt].split(" ").length-1)),at=a[nt].split(" ");t.push([at[0]+" ",Y,K]),it=0;for(var ot=1;ot<at.length;ot++){var lt=(W(at[ot-1]+" "+at[ot])-W(at[ot]))*x+st;ot==at.length-1?t.push([at[ot],lt,0]):t.push([at[ot]+" ",lt,0]),it-=lt}}else t.push([a[nt],Y,K]);t.push(["",it,0])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(t=[],D=a.length,u=0!==u?u:q,nt=0;nt<D;nt++)K=0===nt?qe(i):-H,Y=0===nt?He(e):0,nt<D-1?V.push(L(P((u-z[nt])/(a[nt].split(" ").length-1)))):V.push(0),t.push([a[nt],Y,K])}}!0===("boolean"==typeof n.R2L?n.R2L:rt)&&(t=_(t,(function(t,e,i){return[t.split("").reverse().join(""),e,i]}))),s={text:t,x:e,y:i,options:n,mutex:{pdfEscape:ne,activeFontKey:ht,fonts:mt,activeFontSize:et}},At.publish("postProcessText",s),t=s.text,v=s.mutex.isHex||!1;var ct=mt[ht].encoding;"WinAnsiEncoding"!==ct&&"StandardEncoding"!==ct||(t=_(t,(function(t,e,i){return[E(t),e,i]}))),a=A(t),t=[];for(var ut,dt,ft,pt=Array.isArray(a[0])?1:0,gt="",vt=function(t,e,i){var r="";return i instanceof It?(i="number"==typeof n.angle?Ct(i,new It(1,0,0,1,t,e)):Ct(new It(1,0,0,1,t,e),i),S===b&&(i=Ct(new It(1,0,0,-1,0,0),i)),r=i.join(" ")+" Tm\n"):r=L(t)+" "+L(e)+" Td\n",r},yt=0;yt<a.length;yt++){switch(gt="",pt){case 1:ft=(v?"<":"(")+a[yt][0]+(v?">":")"),ut=parseFloat(a[yt][1]),dt=parseFloat(a[yt][2]);break;case 0:ft=(v?"<":"(")+a[yt]+(v?">":")"),ut=He(e),dt=qe(i)}void 0!==V&&void 0!==V[yt]&&(gt=V[yt]+" Tw\n"),0===yt?t.push(gt+vt(ut,dt,p)+ft):0===pt?t.push(gt+ft):1===pt&&t.push(gt+vt(ut,dt,p)+ft)}t=0===pt?t.join(" Tj\nT* "):t.join(" Tj\n"),t+=" Tj\n";var bt="BT\n/";return bt+=ht+" "+et+" Tf\n",bt+=L(et*w)+" TL\n",bt+=Ye+"\n",bt+=y,bt+=t,Q(bt+="ET"),d[ht]=!0,g};var Ee=f.__private__.clip=f.clip=function(t){return Q("evenodd"===t?"W*":"W"),this};f.clipEvenOdd=function(){return Ee("evenodd")},f.__private__.discardPath=f.discardPath=function(){return Q("n"),this};var Le=f.__private__.isValidStyle=function(t){var e=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(t)&&(e=!0),e};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(t){return Le(t)&&(c=t),this};var Te=f.__private__.getStyle=f.getStyle=function(t){var e=c;switch(t){case"D":case"S":e="S";break;case"F":e="f";break;case"FD":case"DF":e="B";break;case"f":case"f*":case"B":case"B*":e=t}return e},Ae=f.close=function(){return Q("h"),this};f.stroke=function(){return Q("S"),this},f.fill=function(t){return _e("f",t),this},f.fillEvenOdd=function(t){return _e("f*",t),this},f.fillStroke=function(t){return _e("B",t),this},f.fillStrokeEvenOdd=function(t){return _e("B*",t),this};var _e=function(t,e){"object"===(0,_v.A)(e)?Re(e,t):Q(t)},ke=function(t){null===t||S===b&&void 0===t||(t=Te(t),Q(t))};function Pe(t,e,i,n,r){var s=new ib(e||this.boundingBox,i||this.xStep,n||this.yStep,this.gState,r||this.matrix);s.stream=this.stream;var a=t+"$$"+this.cloneIndex+++"$$";return Nt(a,s),s}var Re=function(t,e){var i=St[t.key],n=bt[i];if(n instanceof eb)Q("q"),Q(Ie(e)),n.gState&&f.setGState(n.gState),Q(t.matrix.toString()+" cm"),Q("/"+i+" sh"),Q("Q");else if(n instanceof ib){var r=new It(1,0,0,-1,0,ci());t.matrix&&(r=r.multiply(t.matrix||Dt),i=Pe.call(n,t.key,t.boundingBox,t.xStep,t.yStep,r).id),Q("q"),Q("/Pattern cs"),Q("/"+i+" scn"),n.gState&&f.setGState(n.gState),Q(e),Q("Q")}},Ie=function(t){switch(t){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ce=f.moveTo=function(t,e){return Q(L(P(t))+" "+L(R(e))+" m"),this},De=f.lineTo=function(t,e){return Q(L(P(t))+" "+L(R(e))+" l"),this},Ne=f.curveTo=function(t,e,i,n,r,s){return Q([L(P(t)),L(R(e)),L(P(i)),L(R(n)),L(P(r)),L(R(s)),"c"].join(" ")),this};f.__private__.line=f.line=function(t,e,i,n,r){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||!Le(r))throw new Error("Invalid arguments passed to jsPDF.line");return S===y?this.lines([[i-t,n-e]],t,e,[1,1],r||"S"):this.lines([[i-t,n-e]],t,e,[1,1]).stroke()},f.__private__.lines=f.lines=function(t,e,i,n,r,s){var a,o,l,c,u,h,d,f,p,g,m,v;if("number"==typeof t&&(v=i,i=e,e=t,t=v),n=n||[1,1],s=s||!1,isNaN(e)||isNaN(i)||!Array.isArray(t)||!Array.isArray(n)||!Le(r)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(Ce(e,i),a=n[0],o=n[1],c=t.length,g=e,m=i,l=0;l<c;l++)2===(u=t[l]).length?(g=u[0]*a+g,m=u[1]*o+m,De(g,m)):(h=u[0]*a+g,d=u[1]*o+m,f=u[2]*a+g,p=u[3]*o+m,g=u[4]*a+g,m=u[5]*o+m,Ne(h,d,f,p,g,m));return s&&Ae(),ke(r),this},f.path=function(t){for(var e=0;e<t.length;e++){var i=t[e],n=i.c;switch(i.op){case"m":Ce(n[0],n[1]);break;case"l":De(n[0],n[1]);break;case"c":Ne.apply(this,n);break;case"h":Ae()}}return this},f.__private__.rect=f.rect=function(t,e,i,n,r){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||!Le(r))throw new Error("Invalid arguments passed to jsPDF.rect");return S===y&&(n=-n),Q([L(P(t)),L(R(e)),L(P(i)),L(P(n)),"re"].join(" ")),ke(r),this},f.__private__.triangle=f.triangle=function(t,e,i,n,r,s,a){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(s)||!Le(a))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[i-t,n-e],[r-i,s-n],[t-r,e-s]],t,e,[1,1],a,!0),this},f.__private__.roundedRect=f.roundedRect=function(t,e,i,n,r,s,a){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(s)||!Le(a))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return r=Math.min(r,.5*i),s=Math.min(s,.5*n),this.lines([[i-2*r,0],[r*o,0,r,s-s*o,r,s],[0,n-2*s],[0,s*o,-r*o,s,-r,s],[2*r-i,0],[-r*o,0,-r,-s*o,-r,-s],[0,2*s-n],[0,-s*o,r*o,-s,r,-s]],t+r,e,[1,1],a,!0),this},f.__private__.ellipse=f.ellipse=function(t,e,i,n,r){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||!Le(r))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*i,a=4/3*(Math.SQRT2-1)*n;return Ce(t+i,e),Ne(t+i,e-a,t+s,e-n,t,e-n),Ne(t-s,e-n,t-i,e-a,t-i,e),Ne(t-i,e+a,t-s,e+n,t,e+n),Ne(t+s,e+n,t+i,e+a,t+i,e),ke(r),this},f.__private__.circle=f.circle=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||!Le(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t,e,i,i,n)},f.setFont=function(t,e,i){return i&&(e=E(e,i)),ht=ce(t,e,{disableWarning:!1}),this};var Oe=f.__private__.getFont=f.getFont=function(){return mt[ce.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var t,e,i={};for(t in vt)if(vt.hasOwnProperty(t))for(e in i[t]=[],vt[t])vt[t].hasOwnProperty(e)&&i[t].push(e);return i},f.addFont=function(t,e,i,n,r){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?r=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(i=E(i,n)),ie.call(this,t,e,i,r=r||"Identity-H")};var Me,Fe=t.lineWidth||.200025,Be=f.__private__.getLineWidth=f.getLineWidth=function(){return Fe},Ue=f.__private__.setLineWidth=f.setLineWidth=function(t){return Fe=t,Q(L(P(t))+" w"),this};f.__private__.setLineDash=nb.API.setLineDash=nb.API.setLineDashPattern=function(t,e){if(t=t||[],e=e||0,isNaN(e)||!Array.isArray(t))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t=t.map((function(t){return L(P(t))})).join(" "),e=L(P(e)),Q("["+t+"] "+e+" d"),this};var je=f.__private__.getLineHeight=f.getLineHeight=function(){return et*Me};f.__private__.getLineHeight=f.getLineHeight=function(){return et*Me};var $e=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(t){return"number"==typeof(t=t||1.15)&&(Me=t),this},ze=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Me};$e(t.lineHeight);var He=f.__private__.getHorizontalCoordinate=function(t){return P(t)},qe=f.__private__.getVerticalCoordinate=function(t){return S===b?t:Tt[U].mediaBox.topRightY-Tt[U].mediaBox.bottomLeftY-P(t)},Ge=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(t){return L(He(t))},Ve=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(t){return L(qe(t))},We=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return zt(We)},f.__private__.setStrokeColor=f.setDrawColor=function(t,e,i,n){return We=Ht({ch1:t,ch2:e,ch3:i,ch4:n,pdfColorType:"draw",precision:2}),Q(We),this};var Ke=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return zt(Ke)},f.__private__.setFillColor=f.setFillColor=function(t,e,i,n){return Ke=Ht({ch1:t,ch2:e,ch3:i,ch4:n,pdfColorType:"fill",precision:2}),Q(Ke),this};var Ye=t.textColor||"0 g",Xe=f.__private__.getTextColor=f.getTextColor=function(){return zt(Ye)};f.__private__.setTextColor=f.setTextColor=function(t,e,i,n){return Ye=Ht({ch1:t,ch2:e,ch3:i,ch4:n,pdfColorType:"text",precision:3}),this};var Qe=t.charSpace,Je=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Qe||0)};f.__private__.setCharSpace=f.setCharSpace=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Qe=t,this};var Ze=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(t){var e=f.CapJoinStyles[t];if(void 0===e)throw new Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ze=e,Q(e+" J"),this};var ti=0;f.__private__.setLineJoin=f.setLineJoin=function(t){var e=f.CapJoinStyles[t];if(void 0===e)throw new Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ti=e,Q(e+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(t){if(t=t||0,isNaN(t))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(L(P(t))+" M"),this},f.GState=Zy,f.setGState=function(t){(t="string"==typeof t?wt[xt[t]]:ei(null,t)).equals(Et)||(Q("/"+t.id+" gs"),Et=t)};var ei=function(t,e){if(!t||!xt[t]){var i=!1;for(var n in wt)if(wt.hasOwnProperty(n)&&wt[n].equals(e)){i=!0;break}if(i)e=wt[n];else{var r="GS"+(Object.keys(wt).length+1).toString(10);wt[r]=e,e.id=r}return t&&(xt[t]=e.id),At.publish("addGState",e),e}};f.addGState=function(t,e){return ei(t,e),this},f.saveGraphicsState=function(){return Q("q"),yt.push({key:ht,size:et,color:Ye}),this},f.restoreGraphicsState=function(){Q("Q");var t=yt.pop();return ht=t.key,et=t.size,Ye=t.color,Et=null,this},f.setCurrentTransformationMatrix=function(t){return Q(t.toString()+" cm"),this},f.comment=function(t){return Q("#"+t),this};var ii=function(t,e){var i=t||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return i},set:function(t){isNaN(t)||(i=parseFloat(t))}});var n=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(t){isNaN(t)||(n=parseFloat(t))}});var r="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return r},set:function(t){r=t.toString()}}),this},ni=function(t,e,i,n){ii.call(this,t,e),this.type="rect";var r=i||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))}});var s=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(t){isNaN(t)||(s=parseFloat(t))}}),this},ri=function(){this.page=Lt,this.currentPage=U,this.pages=W.slice(0),this.pagesContext=Tt.slice(0),this.x=ft,this.y=pt,this.matrix=gt,this.width=oi(U),this.height=ci(U),this.outputDestination=Y,this.id="",this.objectNumber=-1};ri.prototype.restore=function(){Lt=this.page,U=this.currentPage,Tt=this.pagesContext,W=this.pages,ft=this.x,pt=this.y,gt=this.matrix,li(U,this.width),ui(U,this.height),Y=this.outputDestination};var si=function(t,e,i,n,r){Rt.push(new ri),Lt=U=0,W=[],ft=t,pt=e,gt=r,re([i,n])};for(var ai in f.beginFormObject=function(t,e,i,n,r){return si(t,e,i,n,r),this},f.endFormObject=function(t){return function(t){if(Pt[t])Rt.pop().restore();else{var e=new ri,i="Xo"+(Object.keys(kt).length+1).toString(10);e.id=i,Pt[t]=i,kt[i]=e,At.publish("addFormObject",e),Rt.pop().restore()}}(t),this},f.doFormObject=function(t,e){var i=kt[Pt[t]];return Q("q"),Q(e.toString()+" cm"),Q("/"+i.id+" Do"),Q("Q"),this},f.getFormObject=function(t){var e=kt[Pt[t]];return{x:e.x,y:e.y,width:e.width,height:e.height,matrix:e.matrix}},f.save=function(t,e){return t=t||"generated.pdf",(e=e||{}).returnPromise=e.returnPromise||!1,!1===e.returnPromise?(Cy(me(ge()),t),"function"==typeof Cy.unload&&Ly.setTimeout&&setTimeout(Cy.unload,911),this):new Promise((function(e,i){try{var n=Cy(me(ge()),t);"function"==typeof Cy.unload&&Ly.setTimeout&&setTimeout(Cy.unload,911),e(n)}catch(t){i(t.message)}}))},nb.API)nb.API.hasOwnProperty(ai)&&("events"===ai&&nb.API.events.length?function(t,e){var i,n,r;for(r=e.length-1;-1!==r;r--)i=e[r][0],n=e[r][1],t.subscribe.apply(t,[i].concat("function"==typeof n?[n]:n))}(At,nb.API.events):f[ai]=nb.API[ai]);var oi=f.getPageWidth=function(t){return(Tt[t=t||U].mediaBox.topRightX-Tt[t].mediaBox.bottomLeftX)/dt},li=f.setPageWidth=function(t,e){Tt[t].mediaBox.topRightX=e*dt+Tt[t].mediaBox.bottomLeftX},ci=f.getPageHeight=function(t){return(Tt[t=t||U].mediaBox.topRightY-Tt[t].mediaBox.bottomLeftY)/dt},ui=f.setPageHeight=function(t,e){Tt[t].mediaBox.topRightY=e*dt+Tt[t].mediaBox.bottomLeftY};return f.internal={pdfEscape:ne,getStyle:Te,getFont:Oe,getFontSize:nt,getCharSpace:Je,getTextColor:Xe,getLineHeight:je,getLineHeightFactor:ze,getLineWidth:Be,write:J,getHorizontalCoordinate:He,getVerticalCoordinate:qe,getCoordinateString:Ge,getVerticalCoordinateString:Ve,collections:{},newObject:Mt,newAdditionalObject:Ut,newObjectDeferred:Ft,newObjectDeferredBegin:Bt,getFilters:qt,putStream:Gt,events:At,scaleFactor:dt,pageSize:{getWidth:function(){return oi(U)},setWidth:function(t){li(U,t)},getHeight:function(){return ci(U)},setHeight:function(t){ui(U,t)}},encryptionOptions:u,encryption:be,getEncryptor:function(t){return null!==u?be.encryptor(t,0):function(t){return t}},output:ve,getNumberOfPages:le,pages:W,out:Q,f2:_,f3:k,getPageInfo:Se,getPageInfoByObjId:we,getCurrentPageInfo:xe,getPDFVersion:g,Point:ii,Rectangle:ni,Matrix:It,hasHotfix:ye},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return oi(U)},set:function(t){li(U,t)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return ci(U)},set:function(t){ui(U,t)},enumerable:!0,configurable:!0}),function(t){for(var e=0,i=tt.length;e<i;e++){var n=ie.call(this,t[e][0],t[e][1],t[e][2],tt[e][3],!0);!1===h&&(d[n]=!0);var r=t[e][0].split("-");ee({id:n,fontName:r[0],fontStyle:r[1]||""})}At.publish("addFonts",{fonts:mt,dictionary:vt})}.call(f,tt),ht="F1",se(r,i),At.publish("initialized"),f}Xy.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Xy.prototype.toHexString=function(t){return t.split("").map((function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)})).join("")},Xy.prototype.hexToBytes=function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(String.fromCharCode(parseInt(t.substr(i,2),16)));return e.join("")},Xy.prototype.processOwnerPassword=function(t,e){return Ky(Gy(e).substr(0,5),t)},Xy.prototype.encryptor=function(t,e){var i=Gy(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(t){return Ky(i,t)}},Zy.prototype.equals=function(t){var e,i="id,objectNumber,equals";if(!t||(0,_v.A)(t)!==(0,_v.A)(this))return!1;var n=0;for(e in this)if(!(i.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e))return!1;if(this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&i.indexOf(e)<0&&n--;return 0===n},nb.API={events:[]},nb.version="3.0.1";var rb=nb.API,sb=1,ab=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ob=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},lb=function(t){return t.toFixed(2)},cb=function(t){return t.toFixed(5)};rb.__acroform__={};var ub=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},hb=function(t){return t*sb},db=function(t){var e=new Pb,i=Hb.internal.getHeight(t)||0,n=Hb.internal.getWidth(t)||0;return e.BBox=[0,0,Number(lb(n)),Number(lb(i))],e},fb=rb.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},pb=rb.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},gb=rb.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(t&1<<e)?0:1},mb=rb.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return gb(t,e-1)},vb=rb.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return fb(t,e-1)},yb=rb.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return pb(t,e-1)},bb=rb.__acroform__.calculateCoordinates=function(t,e){var i=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,r=t[0],s=t[1],a=t[2],o=t[3],l={};return l.lowerLeft_X=i(r)||0,l.lowerLeft_Y=n(s+o)||0,l.upperRight_X=i(r+a)||0,l.upperRight_Y=n(s)||0,[Number(lb(l.lowerLeft_X)),Number(lb(l.lowerLeft_Y)),Number(lb(l.upperRight_X)),Number(lb(l.upperRight_Y))]},Sb=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],i=t._V||t.DV,n=wb(t,i),r=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+r+" "+lb(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=db(t);return s.scope=t.scope,s.stream=e.join("\n"),s}},wb=function(t,e){var i=0===t.fontSize?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},r=(e=")"==(e="("==e.substr(0,1)?e.substr(1):e).substr(e.length-1)?e.substr(0,e.length-1):e).split(" ");r=t.multiline?r.map((function(t){return t.split("\n")})):r.map((function(t){return[t]}));var s=i,a=Hb.internal.getHeight(t)||0;a=a<0?-a:a;var o=Hb.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(e,i,n){if(e+1<r.length){var s=i+" "+r[e+1][0];return xb(s,t,n).width<=o-4}return!1};s++;t:for(;s>0;){e="",s--;var c,u,h=xb("3",t,s).height,d=t.multiline?a-s:(a-h)/2,f=d+=2,p=0,g=0,m=0;if(s<=0){e="(...) Tj\n",e+="% Width of Text: "+xb(e,t,s=12).width+", FieldWidth:"+o+"\n";break}for(var v="",y=0,b=0;b<r.length;b++)if(r.hasOwnProperty(b)){var S=!1;if(1!==r[b].length&&m!==r[b].length-1){if((h+2)*(y+2)+2>a)continue t;v+=r[b][m],S=!0,g=b,b--}else{v=" "==(v+=r[b][m]+" ").substr(v.length-1)?v.substr(0,v.length-1):v;var w=parseInt(b),x=l(w,v,s),E=b>=r.length-1;if(x&&!E){v+=" ",m=0;continue}if(x||E){if(E)g=w;else if(t.multiline&&(h+2)*(y+2)+2>a)continue t}else{if(!t.multiline)continue t;if((h+2)*(y+2)+2>a)continue t;g=w}}for(var L="",T=p;T<=g;T++){var A=r[T];if(t.multiline){if(T===g){L+=A[m]+" ",m=(m+1)%A.length;continue}if(T===p){L+=A[A.length-1]+" ";continue}}L+=A[0]+" "}switch(L=" "==L.substr(L.length-1)?L.substr(0,L.length-1):L,u=xb(L,t,s).width,t.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}e+=lb(c)+" "+lb(f)+" Td\n",e+="("+ab(L)+") Tj\n",e+=-lb(c)+" 0 Td\n",f=-(s+2),u=0,p=S?g:g+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},xb=function(t,e,i){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(i),charSpace:0})*parseFloat(i);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(i),charSpace:0})*parseFloat(i)*1.5,width:r}},Eb={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Lb=function(t,e){var i={type:"reference",object:t};void 0===e.internal.getPageInfo(t.page).pageContext.annotations.find((function(t){return t.type===i.type&&t.object===i.object}))&&e.internal.getPageInfo(t.page).pageContext.annotations.push(i)},Tb=function(t,e){if(e.scope=t,void 0!==t.internal&&(void 0===t.internal.acroformPlugin||!1===t.internal.acroformPlugin.isInitialized)){if(Ib.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Eb)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");sb=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Rb,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",(function(){var e;(e=t).internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})),t.internal.events.subscribe("buildDocument",(function(){!function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];n.objId=void 0,n.hasAnnotation&&Lb(n,t)}}(t)})),t.internal.events.subscribe("putCatalog",(function(){!function(t){if(void 0===t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(t)})),t.internal.events.subscribe("postPutPages",(function(e){!function(t,e){var i=!t;for(var n in t||(e.internal.newObjectDeferredBegin(e.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),e.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),t=t||e.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(t.hasOwnProperty(n)){var r=t[n],s=[],a=r.Rect;if(r.Rect&&(r.Rect=bb(r.Rect,e)),e.internal.newObjectDeferredBegin(r.objId,!0),r.DA=Hb.createDefaultAppearanceStream(r),"object"===(0,_v.A)(r)&&"function"==typeof r.getKeyValueListForStream&&(s=r.getKeyValueListForStream()),r.Rect=a,r.hasAppearanceStream&&!r.appearanceStreamContent){var o=Sb(r);s.push({key:"AP",value:"<</N "+o+">>"}),e.internal.acroformPlugin.xForms.push(o)}if(r.appearanceStreamContent){var l="";for(var c in r.appearanceStreamContent)if(r.appearanceStreamContent.hasOwnProperty(c)){var u=r.appearanceStreamContent[c];if(l+="/"+c+" ",l+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var n in u)if(u.hasOwnProperty(n)){var h=u[n];"function"==typeof h&&(h=h.call(e,r)),l+="/"+n+" "+h+" ",e.internal.acroformPlugin.xForms.indexOf(h)>=0||e.internal.acroformPlugin.xForms.push(h)}}else"function"==typeof(h=u)&&(h=h.call(e,r)),l+="/"+n+" "+h,e.internal.acroformPlugin.xForms.indexOf(h)>=0||e.internal.acroformPlugin.xForms.push(h);l+=">>"}s.push({key:"AP",value:"<<\n"+l+">>"})}e.internal.putStream({additionalKeyValues:s,objectId:r.objId}),e.internal.out("endobj")}i&&function(t,e){for(var i in t)if(t.hasOwnProperty(i)){var n=i,r=t[i];e.internal.newObjectDeferredBegin(r.objId,!0),"object"===(0,_v.A)(r)&&"function"==typeof r.putStream&&r.putStream(),delete t[n]}}(e.internal.acroformPlugin.xForms,e)}(e,t)})),t.internal.acroformPlugin.isInitialized=!0}},Ab=rb.__acroform__.arrayToPdfArray=function(t,e,i){var n=function(t){return t};if(Array.isArray(t)){for(var r="[",s=0;s<t.length;s++)switch(0!==s&&(r+=" "),(0,_v.A)(t[s])){case"boolean":case"number":case"object":r+=t[s].toString();break;case"string":"/"!==t[s].substr(0,1)?(void 0!==e&&i&&(n=i.internal.getEncryptor(e)),r+="("+ab(n(t[s].toString()))+")"):r+=t[s].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},_b=function(t,e,i){var n=function(t){return t};return void 0!==e&&i&&(n=i.internal.getEncryptor(e)),(t=t||"").toString(),"("+ab(n(t))+")"},kb=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};kb.prototype.toString=function(){return this.objId+" 0 R"},kb.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},kb.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter((function(t){return"content"!=t&&"appearanceStreamContent"!=t&&"scope"!=t&&"objId"!=t&&"_"!=t.substring(0,1)}));for(var i in e)if(!1===Object.getOwnPropertyDescriptor(this,e[i]).configurable){var n=e[i],r=this[n];r&&(Array.isArray(r)?t.push({key:n,value:Ab(r,this.objId,this.scope)}):r instanceof kb?(r.scope=this.scope,t.push({key:n,value:r.objId+" 0 R"})):"function"!=typeof r&&t.push({key:n,value:r}))}return t};var Pb=function(){kb.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};ub(Pb,kb);var Rb=function(){kb.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(t){return t};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+ab(e(t))+")"}},set:function(e){t=e}})};ub(Rb,kb);var Ib=function t(){kb.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute F supplied.');e=t}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(e,3))},set:function(t){!0===Boolean(t)?this.F=vb(e,3):this.F=yb(e,3)}});var i=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return i},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute Ff supplied.');i=t}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(t){n=void 0!==t?t:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(t){n[0]=t}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(t){n[1]=t}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(t){n[2]=t}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(t){n[3]=t}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){switch(t){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=t;break;default:throw new Error('Invalid value "'+t+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Ub)return;s="FieldObject"+t.FieldNum++}var e=function(t){return t};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+ab(e(s))+")"},set:function(t){s=t.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(t){s=t}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(t){a=t}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(t){o=t}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(t){l=t}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/sb:c},set:function(t){c=t}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(t){u=t}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Ub||this instanceof $b))return _b(h,this.objId,this.scope)},set:function(t){t=t.toString(),h=t}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Mb==0?_b(d,this.objId,this.scope):d},set:function(t){t=t.toString(),d=this instanceof Mb==0?"("===t.substr(0,1)?ob(t.substr(1,t.length-2)):ob(t):t}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Mb==1?ob(d.substr(1,d.length-1)):d},set:function(t){t=t.toString(),d=this instanceof Mb==1?"/"+t:t}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(t){this.V=t}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Mb==0?_b(f,this.objId,this.scope):f},set:function(t){t=t.toString(),f=this instanceof Mb==0?"("===t.substr(0,1)?ob(t.substr(1,t.length-2)):ob(t):t}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Mb==1?ob(f.substr(1,f.length-1)):f},set:function(t){t=t.toString(),f=this instanceof Mb==1?"/"+t:t}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(t){t=Boolean(t),g=t}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(t){p=t}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,1))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,1):this.Ff=yb(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,2))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,2):this.Ff=yb(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,3))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,3):this.Ff=yb(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==m)return m},set:function(t){if(-1===[0,1,2].indexOf(t))throw new Error('Invalid value "'+t+'" for attribute Q supplied.');m=t}}),Object.defineProperty(this,"textAlign",{get:function(){var t;switch(m){case 0:default:t="left";break;case 1:t="center";break;case 2:t="right"}return t},configurable:!0,enumerable:!0,set:function(t){switch(t){case"right":case 2:m=2;break;case"center":case 1:m=1;break;default:m=0}}})};ub(Ib,kb);var Cb=function(){Ib.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Ab(e,this.objId,this.scope)},set:function(t){var i,n;n=[],"string"==typeof(i=t)&&(n=function(t,e,i){i||(i=1);for(var n,r=[];n=e.exec(t);)r.push(n[i]);return r}(i,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),!1!==i););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,18))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,18):this.Ff=yb(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,19))},set:function(t){!0===this.combo&&(!0===Boolean(t)?this.Ff=vb(this.Ff,19):this.Ff=yb(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,20))},set:function(t){!0===Boolean(t)?(this.Ff=vb(this.Ff,20),e.sort()):this.Ff=yb(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,22))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,22):this.Ff=yb(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,23):this.Ff=yb(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,27))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,27):this.Ff=yb(this.Ff,27)}}),this.hasAppearanceStream=!1};ub(Cb,Ib);var Db=function(){Cb.call(this),this.fontName="helvetica",this.combo=!1};ub(Db,Cb);var Nb=function(){Db.call(this),this.combo=!0};ub(Nb,Db);var Ob=function(){Nb.call(this),this.edit=!0};ub(Ob,Nb);var Mb=function(){Ib.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,15))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,15):this.Ff=yb(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,16))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,16):this.Ff=yb(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,17))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,17):this.Ff=yb(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,26):this.Ff=yb(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(e).length){var i,n=[];for(i in n.push("<<"),e)n.push("/"+i+" ("+ab(t(e[i]))+")");return n.push(">>"),n.join("\n")}},set:function(t){"object"===(0,_v.A)(t)&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){"string"==typeof t&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};ub(Mb,Ib);var Fb=function(){Mb.call(this),this.pushButton=!0};ub(Fb,Mb);var Bb=function(){Mb.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=void 0!==e?e:[]}})};ub(Bb,Mb);var Ub=function(){var t,e;Ib.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(t){e=t}});var i,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};this.scope&&(t=this.scope.internal.getEncryptor(this.objId));var e,i=[];for(e in i.push("<<"),n)i.push("/"+e+" ("+ab(t(n[e]))+")");return i.push(">>"),i.join("\n")},set:function(t){"object"===(0,_v.A)(t)&&(n=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t){"string"==typeof t&&(n.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(t){i="/"+t}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Hb.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ub(Ub,Ib),Bb.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var i=this.Kids[e];i.appearanceStreamContent=t.createAppearanceStream(i.optionName),i.caption=t.getCA()}},Bb.prototype.createOption=function(t){var e=new Ub;return e.Parent=this,e.optionName=t,this.Kids.push(e),qb.call(this.scope,e),e};var jb=function(){Mb.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Hb.CheckBox.createAppearanceStream()};ub(jb,Mb);var $b=function(){Ib.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,13))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,13):this.Ff=yb(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,21))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,21):this.Ff=yb(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,23):this.Ff=yb(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,24))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,24):this.Ff=yb(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,25))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,25):this.Ff=yb(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,26):this.Ff=yb(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ub($b,Ib);var zb=function(){$b.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(mb(this.Ff,14))},set:function(t){!0===Boolean(t)?this.Ff=vb(this.Ff,14):this.Ff=yb(this.Ff,14)}}),this.password=!0};ub(zb,$b);var Hb={CheckBox:{createAppearanceStream:function(){return{N:{On:Hb.CheckBox.YesNormal},D:{On:Hb.CheckBox.YesPushDown,Off:Hb.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=db(t);e.scope=t.scope;var i=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),s=wb(t,t.caption);return i.push("0.749023 g"),i.push("0 0 "+lb(Hb.internal.getWidth(t))+" "+lb(Hb.internal.getHeight(t))+" re"),i.push("f"),i.push("BMC"),i.push("q"),i.push("0 0 1 rg"),i.push("/"+n+" "+lb(s.fontSize)+" Tf "+r),i.push("BT"),i.push(s.text),i.push("ET"),i.push("Q"),i.push("EMC"),e.stream=i.join("\n"),e},YesNormal:function(t){var e=db(t);e.scope=t.scope;var i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),r=[],s=Hb.internal.getHeight(t),a=Hb.internal.getWidth(t),o=wb(t,t.caption);return r.push("1 g"),r.push("0 0 "+lb(a)+" "+lb(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+lb(a-1)+" "+lb(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+i+" "+lb(o.fontSize)+" Tf "+n),r.push(o.text),r.push("ET"),r.push("Q"),e.stream=r.join("\n"),e},OffPushDown:function(t){var e=db(t);e.scope=t.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+lb(Hb.internal.getWidth(t))+" "+lb(Hb.internal.getHeight(t))+" re"),i.push("f"),e.stream=i.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Hb.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Hb.RadioButton.Circle.YesNormal,e.D[t]=Hb.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=db(t);e.scope=t.scope;var i=[],n=Hb.internal.getWidth(t)<=Hb.internal.getHeight(t)?Hb.internal.getWidth(t)/4:Hb.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var r=Hb.internal.Bezier_C,s=Number((n*r).toFixed(5));return i.push("q"),i.push("1 0 0 1 "+cb(Hb.internal.getWidth(t)/2)+" "+cb(Hb.internal.getHeight(t)/2)+" cm"),i.push(n+" 0 m"),i.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),i.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),i.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),i.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join("\n"),e},YesPushDown:function(t){var e=db(t);e.scope=t.scope;var i=[],n=Hb.internal.getWidth(t)<=Hb.internal.getHeight(t)?Hb.internal.getWidth(t)/4:Hb.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*Hb.internal.Bezier_C).toFixed(5)),a=Number((n*Hb.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+cb(Hb.internal.getWidth(t)/2)+" "+cb(Hb.internal.getHeight(t)/2)+" cm"),i.push(r+" 0 m"),i.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),i.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),i.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),i.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),i.push("f"),i.push("Q"),i.push("0 g"),i.push("q"),i.push("1 0 0 1 "+cb(Hb.internal.getWidth(t)/2)+" "+cb(Hb.internal.getHeight(t)/2)+" cm"),i.push(n+" 0 m"),i.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),i.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),i.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),i.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join("\n"),e},OffPushDown:function(t){var e=db(t);e.scope=t.scope;var i=[],n=Hb.internal.getWidth(t)<=Hb.internal.getHeight(t)?Hb.internal.getWidth(t)/4:Hb.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*Hb.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+cb(Hb.internal.getWidth(t)/2)+" "+cb(Hb.internal.getHeight(t)/2)+" cm"),i.push(r+" 0 m"),i.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),i.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),i.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),i.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join("\n"),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Hb.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Hb.RadioButton.Cross.YesNormal,e.D[t]=Hb.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=db(t);e.scope=t.scope;var i=[],n=Hb.internal.calculateCross(t);return i.push("q"),i.push("1 1 "+lb(Hb.internal.getWidth(t)-2)+" "+lb(Hb.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(lb(n.x1.x)+" "+lb(n.x1.y)+" m"),i.push(lb(n.x2.x)+" "+lb(n.x2.y)+" l"),i.push(lb(n.x4.x)+" "+lb(n.x4.y)+" m"),i.push(lb(n.x3.x)+" "+lb(n.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join("\n"),e},YesPushDown:function(t){var e=db(t);e.scope=t.scope;var i=Hb.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+lb(Hb.internal.getWidth(t))+" "+lb(Hb.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+lb(Hb.internal.getWidth(t)-2)+" "+lb(Hb.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(lb(i.x1.x)+" "+lb(i.x1.y)+" m"),n.push(lb(i.x2.x)+" "+lb(i.x2.y)+" l"),n.push(lb(i.x4.x)+" "+lb(i.x4.y)+" m"),n.push(lb(i.x3.x)+" "+lb(i.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(t){var e=db(t);e.scope=t.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+lb(Hb.internal.getWidth(t))+" "+lb(Hb.internal.getHeight(t))+" re"),i.push("f"),e.stream=i.join("\n"),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+i}};Hb.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Hb.internal.getWidth(t),i=Hb.internal.getHeight(t),n=Math.min(e,i);return{x1:{x:(e-n)/2,y:(i-n)/2+n},x2:{x:(e-n)/2+n,y:(i-n)/2},x3:{x:(e-n)/2,y:(i-n)/2},x4:{x:(e-n)/2+n,y:(i-n)/2+n}}}},Hb.internal.getWidth=function(t){var e=0;return"object"===(0,_v.A)(t)&&(e=hb(t.Rect[2])),e},Hb.internal.getHeight=function(t){var e=0;return"object"===(0,_v.A)(t)&&(e=hb(t.Rect[3])),e};var qb=rb.addField=function(t){if(Tb(this,t),!(t instanceof Ib))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};rb.AcroFormChoiceField=Cb,rb.AcroFormListBox=Db,rb.AcroFormComboBox=Nb,rb.AcroFormEditBox=Ob,rb.AcroFormButton=Mb,rb.AcroFormPushButton=Fb,rb.AcroFormRadioButton=Bb,rb.AcroFormCheckBox=jb,rb.AcroFormTextField=$b,rb.AcroFormPasswordField=zb,rb.AcroFormAppearance=Hb,rb.AcroForm={ChoiceField:Cb,ListBox:Db,ComboBox:Nb,EditBox:Ob,Button:Mb,PushButton:Fb,RadioButton:Bb,CheckBox:jb,TextField:$b,PasswordField:zb,Appearance:Hb},nb.AcroForm={ChoiceField:Cb,ListBox:Db,ComboBox:Nb,EditBox:Ob,Button:Mb,PushButton:Fb,RadioButton:Bb,CheckBox:jb,TextField:$b,PasswordField:zb,Appearance:Hb};nb.AcroForm;function Gb(t){return t.reduce((function(t,e,i){return t[e]=i,t}),{})}!function(t){t.__addimage__={};var e="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(t,n){var r,s,a,o,l,c=e;if("RGBA"===(n=n||e)||void 0!==t.data&&t.data instanceof Uint8ClampedArray&&"height"in t&&"width"in t)return"RGBA";if(x(t))for(l in i)for(a=i[l],r=0;r<a.length;r+=1){for(o=!0,s=0;s<a[r].length;s+=1)if(void 0!==a[r][s]&&a[r][s]!==t[s]){o=!1;break}if(!0===o){c=l;break}}else for(l in i)for(a=i[l],r=0;r<a.length;r+=1){for(o=!0,s=0;s<a[r].length;s+=1)if(void 0!==a[r][s]&&a[r][s]!==t.charCodeAt(s)){o=!1;break}if(!0===o){c=l;break}}return c===e&&n!==e&&(c=n),c},r=function t(e){for(var i=this.internal.write,n=this.internal.putStream,r=(0,this.internal.getFilters)();-1!==r.indexOf("FlateEncode");)r.splice(r.indexOf("FlateEncode"),1);e.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:e.width}),s.push({key:"Height",value:e.height}),e.colorSpace===m.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e.palette.length/3-1)+" "+("sMask"in e&&void 0!==e.sMask?e.objectId+2:e.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+e.colorSpace}),e.colorSpace===m.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:e.bitsPerComponent}),"decodeParameters"in e&&void 0!==e.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+e.decodeParameters+">>"}),"transparency"in e&&Array.isArray(e.transparency)){for(var a="",o=0,l=e.transparency.length;o<l;o++)a+=e.transparency[o]+" "+e.transparency[o]+" ";s.push({key:"Mask",value:"["+a+"]"})}void 0!==e.sMask&&s.push({key:"SMask",value:e.objectId+1+" 0 R"});var c=void 0!==e.filter?["/"+e.filter]:void 0;if(n({data:e.data,additionalKeyValues:s,alreadyAppliedFilters:c,objectId:e.objectId}),i("endobj"),"sMask"in e&&void 0!==e.sMask){var u="/Predictor "+e.predictor+" /Colors 1 /BitsPerComponent "+e.bitsPerComponent+" /Columns "+e.width,h={width:e.width,height:e.height,colorSpace:"DeviceGray",bitsPerComponent:e.bitsPerComponent,decodeParameters:u,data:e.sMask};"filter"in e&&(h.filter=e.filter),t.call(this,h)}if(e.colorSpace===m.INDEXED){var d=this.internal.newObject();n({data:L(new Uint8Array(e.palette)),objectId:d}),i("endobj")}},s=function(){var t=this.internal.collections.addImage_images;for(var e in t)r.call(this,t[e])},a=function(){var t,e=this.internal.collections.addImage_images,i=this.internal.write;for(var n in e)i("/I"+(t=e[n]).index,t.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var t=this.internal.collections.addImage_images;return o.call(this),t},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(e){return"function"==typeof t["process"+e.toUpperCase()]},h=function(t){return"object"===(0,_v.A)(t)&&1===t.nodeType},d=function(e,i){if("IMG"===e.nodeName&&e.hasAttribute("src")){var n=""+e.getAttribute("src");if(0===n.indexOf("data:image/"))return Ry(unescape(n).split("base64,").pop());var r=t.loadFile(n,!0);if(void 0!==r)return r}if("CANVAS"===e.nodeName){if(0===e.width||0===e.height)throw new Error("Given canvas must have data. Canvas width: "+e.width+", height: "+e.height);var s;switch(i){case"PNG":s="image/png";break;case"WEBP":s="image/webp";break;default:s="image/jpeg"}return Ry(e.toDataURL(s,1).split("base64,").pop())}},f=function(t){var e=this.internal.collections.addImage_images;if(e)for(var i in e)if(t===e[i].alias)return e[i]},p=function(t,e,i){return t||e||(t=-96,e=-96),t<0&&(t=-1*i.width*72/t/this.internal.scaleFactor),e<0&&(e=-1*i.height*72/e/this.internal.scaleFactor),0===t&&(t=e*i.width/i.height),0===e&&(e=t*i.height/i.width),[t,e]},g=function(t,e,i,n,r,s){var a=p.call(this,i,n,r),o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=l.call(this);if(i=a[0],n=a[1],u[r.index]=r,s){s*=Math.PI/180;var h=Math.cos(s),d=Math.sin(s),f=function(t){return t.toFixed(4)},g=[f(h),f(d),f(-1*d),f(h),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,o(t),c(e+n),"cm"].join(" ")),this.internal.write(g.join(" ")),this.internal.write([o(i),"0","0",o(n),"0","0","cm"].join(" "))):this.internal.write([o(i),"0","0",o(n),o(t),c(e+n),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+r.index+" Do"),this.internal.write("Q")},m=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=t.__addimage__.sHashCode=function(t){var e,i,n=0;if("string"==typeof t)for(i=t.length,e=0;e<i;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;else if(x(t))for(i=t.byteLength/2,e=0;e<i;e++)n=(n<<5)-n+t[e],n|=0;return n},b=t.__addimage__.validateStringAsBase64=function(t){(t=t||"").toString().trim();var e=!0;return 0===t.length&&(e=!1),t.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+/]+$/.test(t.substr(0,t.length-2))&&(e=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(t.substr(-2))&&(e=!1),e},S=t.__addimage__.extractImageFromDataUrl=function(t){if(null==t)return null;if(!(t=t.trim()).startsWith("data:"))return null;var e=t.indexOf(",");return e<0?null:t.substring(0,e).trim().endsWith("base64")?t.substring(e+1):null},w=t.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};t.__addimage__.isArrayBuffer=function(t){return w()&&t instanceof ArrayBuffer};var x=t.__addimage__.isArrayBufferView=function(t){return w()&&"undefined"!=typeof Uint32Array&&(t instanceof Int8Array||t instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)},E=t.__addimage__.binaryStringToUint8Array=function(t){for(var e=t.length,i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.charCodeAt(n);return i},L=t.__addimage__.arrayBufferToBinaryString=function(t){for(var e="",i=x(t)?t:new Uint8Array(t),n=0;n<i.length;n+=8192)e+=String.fromCharCode.apply(null,i.subarray(n,n+8192));return e};t.addImage=function(){var t,i,n,r,s,a,l,c,u;if("number"==typeof arguments[1]?(i=e,n=arguments[1],r=arguments[2],s=arguments[3],a=arguments[4],l=arguments[5],c=arguments[6],u=arguments[7]):(i=arguments[1],n=arguments[2],r=arguments[3],s=arguments[4],a=arguments[5],l=arguments[6],c=arguments[7],u=arguments[8]),"object"===(0,_v.A)(t=arguments[0])&&!h(t)&&"imageData"in t){var d=t;t=d.imageData,i=d.format||i||e,n=d.x||n||0,r=d.y||r||0,s=d.w||d.width||s,a=d.h||d.height||a,l=d.alias||l,c=d.compression||c,u=d.rotation||d.angle||u}var f=this.internal.getFilters();if(void 0===c&&-1!==f.indexOf("FlateEncode")&&(c="SLOW"),isNaN(n)||isNaN(r))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var p=T.call(this,t,i,l,c);return g.call(this,n,r,s,a,p,u),this};var T=function(i,r,s,a){var o,l,p;if("string"==typeof i&&n(i)===e){i=unescape(i);var g=A(i,!1);(""!==g||void 0!==(g=t.loadFile(i,!0)))&&(i=g)}if(h(i)&&(i=d(i,r)),r=n(i,r),!u(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if((null==(p=s)||0===p.length)&&(s=function(t){return"string"==typeof t||x(t)?y(t):x(t.data)?y(t.data):null}(i)),(o=f.call(this,s))||(w()&&(i instanceof Uint8Array||"RGBA"===r||(l=i,i=E(i))),o=this["process"+r.toUpperCase()](i,c.call(this),s,function(e){return e&&"string"==typeof e&&(e=e.toUpperCase()),e in t.image_compression?e:v.NONE}(a),l)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},A=t.__addimage__.convertBase64ToBinaryString=function(t,e){e="boolean"!=typeof e||e;var i,n="";if("string"==typeof t){var r;i=null!==(r=S(t))&&void 0!==r?r:t;try{n=Ry(i)}catch(t){if(e)throw b(i)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+t.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return n};t.getImageProperties=function(i){var r,s,a="";if(h(i)&&(i=d(i)),"string"==typeof i&&n(i)===e&&(""===(a=A(i,!1))&&(a=t.loadFile(i)||""),i=a),s=n(i),!u(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(!w()||i instanceof Uint8Array||(i=E(i)),!(r=this["process"+s.toUpperCase()](i)))throw new Error("An unknown error occurred whilst processing the image");return r.fileType=s,r}}(nb.API),function(t){var e=function(t){if(void 0!==t&&""!=t)return!0};nb.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(t){for(var i,n,r,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,o=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,c=!1,u=0;u<l.length&&!c;u++)switch((i=l[u]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var h=0;h<l.length;h++){i=l[h];var d=this.internal.pdfEscape,f=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(p.objId),v=i.title||"Note";r="<</Type /Annot /Subtype /Text "+(n="/Rect ["+s(i.bounds.x)+" "+a(i.bounds.y+i.bounds.h)+" "+s(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y)+"] ")+"/Contents ("+d(m(i.contents))+")",r+=" /Popup "+g.objId+" 0 R",r+=" /P "+o.objId+" 0 R",r+=" /T ("+d(m(v))+") >>",p.content=r;var y=p.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+s(i.bounds.x+30)+" "+a(i.bounds.y+i.bounds.h)+" "+s(i.bounds.x+i.bounds.w+30)+" "+a(i.bounds.y)+"] ")+" /Parent "+y,i.open&&(r+=" /Open true"),r+=" >>",g.content=r,this.internal.write(p.objId,"0 R",g.objId,"0 R");break;case"freetext":n="/Rect ["+s(i.bounds.x)+" "+a(i.bounds.y)+" "+s(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y+i.bounds.h)+"] ";var b=i.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+d(f(i.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+b+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(i.options.name){var S=this.annotations._nameMap[i.options.name];i.options.pageNumber=S.page,i.options.top=S.y}else i.options.top||(i.options.top=0);if(n="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",r="",i.options.url)r="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+d(f(i.options.url))+") >>";else if(i.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,r+=" /FitV "+i.options.left+"]";break;default:var w=a(i.options.top);i.options.left=i.options.left||0,void 0===i.options.zoom&&(i.options.zoom=0),r+=" /XYZ "+i.options.left+" "+w+" "+i.options.zoom+"]"}""!=r&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),t.createAnnotation=function(t){var e=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":e.pageContext.annotations.push(t)}},t.link=function(t,e,i,n,r){var s=this.internal.getCurrentPageInfo(),a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:a(t),y:o(e),w:a(t+i),h:o(e+n)},options:r,type:"link"})},t.textWithLink=function(t,e,i,n){var r,s,a=this.getTextWidth(t),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==n.maxWidth){s=n.maxWidth;var l=this.splitTextToSize(t,s).length;r=Math.ceil(o*l)}else s=a,r=o;return this.text(t,e,i,n),i+=.2*o,"center"===n.align&&(e-=a/2),"right"===n.align&&(e-=a),this.link(e,i-o,s,r,n),a},t.getTextWidth=function(t){var e=this.internal.getFontSize();return this.getStringUnitWidth(t)*e/this.internal.scaleFactor}}(nb.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},i={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(t){return void 0!==e[t.charCodeAt(0)]},a=t.__arabicParser__.isArabicLetter=function(t){return"string"==typeof t&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t)},o=t.__arabicParser__.isArabicEndLetter=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(t){return a(t)&&r.indexOf(t.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(t){return a(t)&&s(t)&&4==e[t.charCodeAt(0)].length},h=t.__arabicParser__.resolveLigatures=function(t){var e=0,n=i,r="",s=0;for(e=0;e<t.length;e+=1)void 0!==n[t.charCodeAt(e)]?(s++,"number"==typeof(n=n[t.charCodeAt(e)])&&(r+=String.fromCharCode(n),n=i,s=0),e===t.length-1&&(n=i,r+=t.charAt(e-(s-1)),e-=s-1,s=0)):(n=i,r+=t.charAt(e-s),e-=s,s=0);return r};t.__arabicParser__.isArabicDiacritic=function(t){return void 0!==t&&void 0!==n[t.charCodeAt(0)]};var d=t.__arabicParser__.getCorrectForm=function(t,e,i){return a(t)?!1===s(t)?-1:!c(t)||!a(e)&&!a(i)||!a(i)&&o(e)||o(t)&&!a(e)||o(t)&&l(e)||o(t)&&o(e)?0:u(t)&&a(e)&&!o(e)&&a(i)&&c(i)?3:o(t)||!a(i)?1:2:-1},f=function(t){var i=0,n=0,r=0,s="",o="",l="",c=(t=t||"").split("\\s+"),u=[];for(i=0;i<c.length;i+=1){for(u.push(""),n=0;n<c[i].length;n+=1)s=c[i][n],o=c[i][n-1],l=c[i][n+1],a(s)?(r=d(s,o,l),u[i]+=-1!==r?String.fromCharCode(e[s.charCodeAt(0)][r]):s):u[i]+=s;u[i]=h(u[i])}return u.join(" ")},p=t.__arabicParser__.processArabic=t.processArabic=function(){var t,e="string"==typeof arguments[0]?arguments[0]:arguments[0].text,i=[];if(Array.isArray(e)){var n=0;for(i=[],n=0;n<e.length;n+=1)Array.isArray(e[n])?i.push([f(e[n][0]),e[n][1],e[n][2]]):i.push([f(e[n])]);t=i}else t=f(e);return"string"==typeof arguments[0]?t:(arguments[0].text=t,arguments[0])};t.events.push(["preProcessText",p])}(nb.API),nb.API.autoPrint=function(t){var e;if("javascript"===((t=t||{}).variant=t.variant||"non-conform",t.variant))this.addJS("print({});");else this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}));return this},function(t){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(e){t=e}});var e=150;Object.defineProperty(this,"width",{get:function(){return e},set:function(t){e=isNaN(t)||!1===Number.isInteger(t)||t<0?150:t,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(t){i=isNaN(t)||!1===Number.isInteger(t)||t<0?300:t,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(t){n=t}});var r={};Object.defineProperty(this,"style",{get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,e){var i;if("2d"!==(t=t||"2d"))return null;for(i in e)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=e[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(nb.API),function(t){var e={left:0,top:0,bottom:0,right:0},i=!1,n=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var t=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var e=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var i=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return i},set:function(t){i=t}});var n=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return n},set:function(t){n=t}});var r=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return r},set:function(t){r=t}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(t){s=t}});var a=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return a},set:function(t){a=t}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(t){return n.call(this),this.internal.__cell__.headerFunction="function"==typeof t?t:void 0,this},t.getTextDimensions=function(t,e){n.call(this);var i=(e=e||{}).fontSize||this.getFontSize(),r=e.font||this.getFont(),s=e.scaleFactor||this.internal.scaleFactor,a=0,o=0,l=0,c=this;if(!Array.isArray(t)&&"string"!=typeof t){if("number"!=typeof t)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");t=String(t)}var u=e.maxWidth;u>0?"string"==typeof t?t=this.splitTextToSize(t,u):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce((function(t,e){return t.concat(c.splitTextToSize(e,u))}),[])):t=Array.isArray(t)?t:[t];for(var h=0;h<t.length;h++)a<(l=this.getStringUnitWidth(t[h],{font:r})*i)&&(a=l);return 0!==a&&(o=t.length),{w:a/=s,h:Math.max((o*i*this.getLineHeightFactor()-i*(this.getLineHeightFactor()-1))/s,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var t=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(t.left,t.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var t;t=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var r=this.internal.__cell__.lastCell,a=this.internal.__cell__.padding,o=this.internal.__cell__.margins||e,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==r.lineNumber&&(r.lineNumber===t.lineNumber?(t.x=(r.x||0)+(r.width||0),t.y=r.y||0):r.y+r.height+t.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),t.y=o.top,c&&l&&(this.printHeaderRow(t.lineNumber,!0),t.y+=l[0].height)):t.y=r.y+r.height||t.y),void 0!==t.text[0]&&(this.rect(t.x,t.y,t.width,t.height,!0===i?"FD":void 0),"right"===t.align?this.text(t.text,t.x+t.width-a,t.y+a,{align:"right",baseline:"top"}):"center"===t.align?this.text(t.text,t.x+t.width/2,t.y+a,{align:"center",baseline:"top",maxWidth:t.width-a-a}):this.text(t.text,t.x+a,t.y+a,{align:"left",baseline:"top",maxWidth:t.width-a-a})),this.internal.__cell__.lastCell=t,this};t.table=function(t,i,l,c,u){if(n.call(this),!l)throw new Error("No data for PDF table.");var h,d,f,p,g=[],m=[],v=[],y={},b={},S=[],w=[],x=(u=u||{}).autoSize||!1,E=!1!==u.printHeaders,L=u.css&&void 0!==u.css["font-size"]?16*u.css["font-size"]:u.fontSize||12,T=u.margins||Object.assign({width:this.getPageWidth()},e),A="number"==typeof u.padding?u.padding:3,_=u.headerBackgroundColor||"#c8c8c8",k=u.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=L,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=_,this.internal.__cell__.headerTextColor=k,this.setFontSize(L),null==c)m=g=Object.keys(l[0]),v=g.map((function(){return"left"}));else if(Array.isArray(c)&&"object"===(0,_v.A)(c[0]))for(g=c.map((function(t){return t.name})),m=c.map((function(t){return t.prompt||t.name||""})),v=c.map((function(t){return t.align||"left"})),h=0;h<c.length;h+=1)b[c[h].name]=c[h].width*(19.049976/25.4);else Array.isArray(c)&&"string"==typeof c[0]&&(m=g=c,v=g.map((function(){return"left"})));if(x||Array.isArray(c)&&"string"==typeof c[0])for(h=0;h<g.length;h+=1){for(y[p=g[h]]=l.map((function(t){return t[p]})),this.setFont(void 0,"bold"),S.push(this.getTextDimensions(m[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),d=y[p],this.setFont(void 0,"normal"),f=0;f<d.length;f+=1)S.push(this.getTextDimensions(d[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);b[p]=Math.max.apply(null,S)+A+A,S=[]}if(E){var P={};for(h=0;h<g.length;h+=1)P[g[h]]={},P[g[h]].text=m[h],P[g[h]].align=v[h];var R=o.call(this,P,b);w=g.map((function(e){return new s(t,i,b[e],R,P[e].text,void 0,P[e].align)})),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var I=c.reduce((function(t,e){return t[e.name]=e.align,t}),{});for(h=0;h<l.length;h+=1){"rowStart"in u&&u.rowStart instanceof Function&&u.rowStart({row:h,data:l[h]},this);var C=o.call(this,l[h],b);for(f=0;f<g.length;f+=1){var D=l[h][g[f]];"cellStart"in u&&u.cellStart instanceof Function&&u.cellStart({row:h,col:f,data:D},this),a.call(this,new s(t,i,b[g[f]],C,D,h+2,I[g[f]]))}}return this.internal.__cell__.table_x=t,this.internal.__cell__.table_y=i,this};var o=function(t,e){var i=this.internal.__cell__.padding,n=this.internal.__cell__.table_font_size,r=this.internal.scaleFactor;return Object.keys(t).map((function(n){var r=t[n];return this.splitTextToSize(r.hasOwnProperty("text")?r.text:r,e[n]-i-i)}),this).map((function(t){return this.getLineHeightFactor()*t.length*n/r+i+i}),this).reduce((function(t,e){return Math.max(t,e)}),0)};t.setTableHeaderRow=function(t){n.call(this),this.internal.__cell__.tableHeaderRow=t},t.printHeaderRow=function(t,e){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var r;if(i=!0,"function"==typeof this.internal.__cell__.headerFunction){var o=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(o[0],o[1],o[2],o[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){r=this.internal.__cell__.tableHeaderRow[c].clone(),e&&(r.y=this.internal.__cell__.margins.top||0,l.push(r)),r.lineNumber=t;var u=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,r),this.setTextColor(u)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),i=!1}}(nb.API);var Vb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Wb=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Kb=Gb(Wb),Yb=[100,200,300,400,500,600,700,800,900],Xb=Gb(Yb);function Qb(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),i=function(t){return Vb[t=t||"normal"]?t:"normal"}(t.style),n=function(t){return t?"number"==typeof t?t>=100&&t<=900&&t%100==0?t:400:/^\d00$/.test(t)?parseInt(t):"bold"===t?700:400:400}(t.weight),r=function(t){return"number"==typeof Kb[t=t||"normal"]?t:"normal"}(t.stretch);return{family:e,style:i,weight:n,stretch:r,src:t.src||[],ref:t.ref||{name:e,style:[r,i,n].join(" ")}}}function Jb(t,e,i,n){var r;for(r=i;r>=0&&r<e.length;r+=n)if(t[e[r]])return t[e[r]];for(r=i;r>=0&&r<e.length;r-=n)if(t[e[r]])return t[e[r]]}var Zb={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},tS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function eS(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function iS(t){return t.trimLeft()}function nS(t,e){for(var i=0;i<t.length;){if(t.charAt(i)===e)return[t.substring(0,i),t.substring(i+1)];i+=1}return null}function rS(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===e?null:[e[0],t.substring(e[0].length)]}var sS,aS,oS,lS,cS=["times"];!function(t){var e,i,n,r,s,a,o,l,c,u=function(t){return t=t||{},this.isStrokeTransparent=t.isStrokeTransparent||!1,this.strokeOpacity=t.strokeOpacity||1,this.strokeStyle=t.strokeStyle||"#000000",this.fillStyle=t.fillStyle||"#000000",this.isFillTransparent=t.isFillTransparent||!1,this.fillOpacity=t.fillOpacity||1,this.font=t.font||"10px sans-serif",this.textBaseline=t.textBaseline||"alphabetic",this.textAlign=t.textAlign||"left",this.lineWidth=t.lineWidth||1,this.lineJoin=t.lineJoin||"miter",this.lineCap=t.lineCap||"butt",this.path=t.path||[],this.transform=void 0!==t.transform?t.transform.clone():new l,this.globalCompositeOperation=t.globalCompositeOperation||"normal",this.globalAlpha=t.globalAlpha||1,this.clip_path=t.clip_path||[],this.currentPoint=t.currentPoint||new a,this.miterLimit=t.miterLimit||10,this.lastPoint=t.lastPoint||new a,this.lineDashOffset=t.lineDashOffset||0,this.lineDash=t.lineDash||[],this.margin=t.margin||[0,0,0,0],this.prevPageLastElemOffset=t.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof t.ignoreClearRect||t.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,i=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var h=function(t){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var e=t;Object.defineProperty(this,"pdf",{get:function(){return e}});var i=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return i},set:function(t){i=Boolean(t)}});var n=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return n},set:function(t){n=Boolean(t)}});var r=0;Object.defineProperty(this,"posX",{get:function(){return r},set:function(t){isNaN(t)||(r=t)}});var s=0;Object.defineProperty(this,"posY",{get:function(){return s},set:function(t){isNaN(t)||(s=t)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(t){var e;"number"==typeof t?e=[t,t,t,t]:((e=new Array(4))[0]=t[0],e[1]=t.length>=2?t[1]:e[0],e[2]=t.length>=3?t[2]:e[0],e[3]=t.length>=4?t[3]:e[1]),c.margin=e}});var a=!1;Object.defineProperty(this,"autoPaging",{get:function(){return a},set:function(t){a=t}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(t){o=t}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(t){l=t}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(t){t instanceof u&&(c=t)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(t){c.path=t}});var h=[];Object.defineProperty(this,"ctxStack",{get:function(){return h},set:function(t){h=t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t){var e;e=d(t),this.ctx.fillStyle=e.style,this.ctx.isFillTransparent=0===e.a,this.ctx.fillOpacity=e.a,this.pdf.setFillColor(e.r,e.g,e.b,{a:e.a}),this.pdf.setTextColor(e.r,e.g,e.b,{a:e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t){var e=d(t);this.ctx.strokeStyle=e.style,this.ctx.isStrokeTransparent=0===e.a,this.ctx.strokeOpacity=e.a,0===e.a?this.pdf.setDrawColor(255,255,255):(e.a,this.pdf.setDrawColor(e.r,e.g,e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t){-1!==["butt","round","square"].indexOf(t)&&(this.ctx.lineCap=t,this.pdf.setLineCap(t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t){isNaN(t)||(this.ctx.lineWidth=t,this.pdf.setLineWidth(t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t){-1!==["bevel","round","miter"].indexOf(t)&&(this.ctx.lineJoin=t,this.pdf.setLineJoin(t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t){isNaN(t)||(this.ctx.miterLimit=t,this.pdf.setMiterLimit(t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t){this.ctx.textBaseline=t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t){-1!==["right","end","center","left","start"].indexOf(t)&&(this.ctx.textAlign=t)}});var f=null;function p(t,e){if(null===f){var i=function(t){var e=[];return Object.keys(t).forEach((function(i){t[i].forEach((function(t){var n=null;switch(t){case"bold":n={family:i,weight:"bold"};break;case"italic":n={family:i,style:"italic"};break;case"bolditalic":n={family:i,weight:"bold",style:"italic"};break;case"":case"normal":n={family:i}}null!==n&&(n.ref={name:i,style:t},e.push(n))}))})),e}(t.getFontList());f=function(t){for(var e={},i=0;i<t.length;++i){var n=Qb(t[i]),r=n.family,s=n.stretch,a=n.style,o=n.weight;e[r]=e[r]||{},e[r][s]=e[r][s]||{},e[r][s][a]=e[r][s][a]||{},e[r][s][a][o]=n}return e}(i.concat(e))}return f}var g=null;Object.defineProperty(this,"fontFaces",{get:function(){return g},set:function(t){f=null,g=t}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t){var e;if(this.ctx.font=t,null!==(e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(t))){var i=e[1];e[2];var n=e[3],r=e[4];e[5];var s=e[6],a=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(r)[2];r="px"===a?Math.floor(parseFloat(r)*this.pdf.internal.scaleFactor):"em"===a?Math.floor(parseFloat(r)*this.pdf.getFontSize()):Math.floor(parseFloat(r)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(r);var o=function(t){var e,i,n=[],r=t.trim();if(""===r)return cS;if(r in tS)return[tS[r]];for(;""!==r;){switch(i=null,e=(r=iS(r)).charAt(0)){case'"':case"'":i=nS(r.substring(1),e);break;default:i=rS(r)}if(null===i)return cS;if(n.push(i[0]),""!==(r=iS(i[1]))&&","!==r.charAt(0))return cS;r=r.replace(/^,/,"")}return n}(s);if(this.fontFaces){var l=function(t,e,i){for(var n=(i=i||{}).defaultFontFamily||"times",r=Object.assign({},Zb,i.genericFontFamilies||{}),s=null,a=null,o=0;o<e.length;++o)if(r[(s=Qb(e[o])).family]&&(s.family=r[s.family]),t.hasOwnProperty(s.family)){a=t[s.family];break}if(!(a=a||t[n]))throw new Error("Could not find a font-family for the rule '"+eS(s)+"' and default family '"+n+"'.");if(a=function(t,e){if(e[t])return e[t];var i=Kb[t],n=i<=Kb.normal?-1:1,r=Jb(e,Wb,i,n);if(!r)throw new Error("Could not find a matching font-stretch value for "+t);return r}(s.stretch,a),a=function(t,e){if(e[t])return e[t];for(var i=Vb[t],n=0;n<i.length;++n)if(e[i[n]])return e[i[n]];throw new Error("Could not find a matching font-style for "+t)}(s.style,a),!(a=function(t,e){if(e[t])return e[t];if(400===t&&e[500])return e[500];if(500===t&&e[400])return e[400];var i=Xb[t],n=Jb(e,Yb,i,t<400?-1:1);if(!n)throw new Error("Could not find a matching font-weight for value "+t);return n}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+eS(s)+"'.");return a}(p(this.pdf,this.fontFaces),o.map((function(t){return{family:t,stretch:"normal",weight:n,style:i}})));this.pdf.setFont(l.ref.name,l.ref.style)}else{var c="";("bold"===n||parseInt(n,10)>=700||"bold"===i)&&(c="bold"),"italic"===i&&(c+="italic"),0===c.length&&(c="normal");for(var u="",h={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},d=0;d<o.length;d++){if(void 0!==this.pdf.internal.getFont(o[d],c,{noFallback:!0,disableWarning:!0})){u=o[d];break}if("bolditalic"===c&&void 0!==this.pdf.internal.getFont(o[d],"bold",{noFallback:!0,disableWarning:!0}))u=o[d],c="bold";else if(void 0!==this.pdf.internal.getFont(o[d],"normal",{noFallback:!0,disableWarning:!0})){u=o[d],c="normal";break}}if(""===u)for(var f=0;f<o.length;f++)if(h[o[f]]){u=h[o[f]];break}u=""===u?"Times":u,this.pdf.setFont(u,c)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t){this.ctx.globalCompositeOperation=t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t){this.ctx.globalAlpha=t}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(t){this.ctx.lineDashOffset=t,F.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(t){this.ctx.lineDash=t,F.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t){this.ctx.ignoreClearRect=Boolean(t)}})};h.prototype.setLineDash=function(t){this.lineDash=t},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){S.call(this,"fill",!1)},h.prototype.stroke=function(){S.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(t,e){if(isNaN(t)||isNaN(e))throw Ay.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var i=this.ctx.transform.applyToPoint(new a(t,e));this.path.push({type:"mt",x:i.x,y:i.y}),this.ctx.lastPoint=new a(t,e)},h.prototype.closePath=function(){var t=new a(0,0),e=0;for(e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"===(0,_v.A)(this.path[e+1])&&"number"==typeof this.path[e+1].x){t=new a(this.path[e+1].x,this.path[e+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(t.x,t.y)},h.prototype.lineTo=function(t,e){if(isNaN(t)||isNaN(e))throw Ay.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var i=this.ctx.transform.applyToPoint(new a(t,e));this.path.push({type:"lt",x:i.x,y:i.y}),this.ctx.lastPoint=new a(i.x,i.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},h.prototype.quadraticCurveTo=function(t,e,i,n){if(isNaN(i)||isNaN(n)||isNaN(t)||isNaN(e))throw Ay.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var r=this.ctx.transform.applyToPoint(new a(i,n)),s=this.ctx.transform.applyToPoint(new a(t,e));this.path.push({type:"qct",x1:s.x,y1:s.y,x:r.x,y:r.y}),this.ctx.lastPoint=new a(r.x,r.y)},h.prototype.bezierCurveTo=function(t,e,i,n,r,s){if(isNaN(r)||isNaN(s)||isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw Ay.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new a(r,s)),l=this.ctx.transform.applyToPoint(new a(t,e)),c=this.ctx.transform.applyToPoint(new a(i,n));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new a(o.x,o.y)},h.prototype.arc=function(t,e,i,n,r,s){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r))throw Ay.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new a(t,e));t=o.x,e=o.y;var l=this.ctx.transform.applyToPoint(new a(0,i)),c=this.ctx.transform.applyToPoint(new a(0,0));i=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(r-n)>=2*Math.PI&&(n=0,r=2*Math.PI),this.path.push({type:"arc",x:t,y:e,radius:i,startAngle:n,endAngle:r,counterclockwise:s})},h.prototype.arcTo=function(t,e,i,n,r){throw new Error("arcTo not implemented.")},h.prototype.rect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw Ay.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.lineTo(t,e),this.lineTo(t+i,e),this.lineTo(t,e)},h.prototype.fillRect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw Ay.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var r={};"butt"!==this.lineCap&&(r.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(r.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t,e,i,n),this.fill(),r.hasOwnProperty("lineCap")&&(this.lineCap=r.lineCap),r.hasOwnProperty("lineJoin")&&(this.lineJoin=r.lineJoin)}},h.prototype.strokeRect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw Ay.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(t,e,i,n),this.stroke())},h.prototype.clearRect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw Ay.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t,e,i,n))},h.prototype.save=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,i=0;i<this.pdf.internal.getNumberOfPages();i++)this.pdf.setPage(i+1),this.pdf.internal.out("q");if(this.pdf.setPage(e),t){this.ctx.fontSize=this.pdf.internal.getFontSize();var n=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=n}},h.prototype.restore=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,i=0;i<this.pdf.internal.getNumberOfPages();i++)this.pdf.setPage(i+1),this.pdf.internal.out("Q");this.pdf.setPage(e),t&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(t){var e,i,n,r;if(!0===t.isCanvasGradient&&(t=t.getColor()),!t)return{r:0,g:0,b:0,a:0,style:t};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(t))e=0,i=0,n=0,r=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t);if(null!==s)e=parseInt(s[1]),i=parseInt(s[2]),n=parseInt(s[3]),r=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(t)))e=parseInt(s[1]),i=parseInt(s[2]),n=parseInt(s[3]),r=parseFloat(s[4]);else{if(r=1,"string"==typeof t&&"#"!==t.charAt(0)){var a=new Dy(t);t=a.ok?a.toHex():"#000000"}4===t.length?(e=t.substring(1,2),e+=e,i=t.substring(2,3),i+=i,n=t.substring(3,4),n+=n):(e=t.substring(1,3),i=t.substring(3,5),n=t.substring(5,7)),e=parseInt(e,16),i=parseInt(i,16),n=parseInt(n,16)}}return{r:e,g:i,b:n,a:r,style:t}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},p=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};h.prototype.fillText=function(t,e,i,n){if(isNaN(e)||isNaN(i)||"string"!=typeof t)throw Ay.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(n=isNaN(n)?void 0:n,!f.call(this)){var r=N(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;k.call(this,{text:t,x:e,y:i,scale:s,angle:r,align:this.textAlign,maxWidth:n})}},h.prototype.strokeText=function(t,e,i,n){if(isNaN(e)||isNaN(i)||"string"!=typeof t)throw Ay.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){n=isNaN(n)?void 0:n;var r=N(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;k.call(this,{text:t,x:e,y:i,scale:s,renderingMode:"stroke",angle:r,align:this.textAlign,maxWidth:n})}},h.prototype.measureText=function(t){if("string"!=typeof t)throw Ay.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,i=this.pdf.internal.scaleFactor,n=e.internal.getFontSize(),r=e.getStringUnitWidth(t)*n/e.internal.scaleFactor;return new function(t){var e=(t=t||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this}({width:r*=Math.round(96*i/72*1e4)/1e4})},h.prototype.scale=function(t,e){if(isNaN(t)||isNaN(e))throw Ay.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var i=new l(t,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(i)},h.prototype.rotate=function(t){if(isNaN(t))throw Ay.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e=new l(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0);this.ctx.transform=this.ctx.transform.multiply(e)},h.prototype.translate=function(t,e){if(isNaN(t)||isNaN(e))throw Ay.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var i=new l(1,0,0,1,t,e);this.ctx.transform=this.ctx.transform.multiply(i)},h.prototype.transform=function(t,e,i,n,r,s){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(s))throw Ay.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var a=new l(t,e,i,n,r,s);this.ctx.transform=this.ctx.transform.multiply(a)},h.prototype.setTransform=function(t,e,i,n,r,s){t=isNaN(t)?1:t,e=isNaN(e)?0:e,i=isNaN(i)?0:i,n=isNaN(n)?1:n,r=isNaN(r)?0:r,s=isNaN(s)?0:s,this.ctx.transform=new l(t,e,i,n,r,s)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(t,e,i,n,r,s,a,c,u){var h=this.pdf.getImageProperties(t),d=1,f=1,p=1,v=1;void 0!==n&&void 0!==c&&(p=c/n,v=u/r,d=h.width/n*c/n,f=h.height/r*u/r),void 0===s&&(s=e,a=i,e=0,i=0),void 0!==n&&void 0===c&&(c=n,u=r),void 0===n&&void 0===c&&(c=h.width,u=h.height);for(var S,x=this.ctx.transform.decompose(),E=N(x.rotate.shx),L=new l,T=(L=(L=(L=L.multiply(x.translate)).multiply(x.skew)).multiply(x.scale)).applyToRectangle(new o(s-e*p,a-i*v,n*d,r*f)),A=m.call(this,T),_=[],k=0;k<A.length;k+=1)-1===_.indexOf(A[k])&&_.push(A[k]);if(b(_),this.autoPaging)for(var P=_[0],R=_[_.length-1],I=P;I<R+1;I++){this.pdf.setPage(I);var C=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],D=1===I?this.posY+this.margin[0]:this.margin[0],O=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],M=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],F=1===I?0:O+(I-2)*M;if(0!==this.ctx.clip_path.length){var B=this.path;S=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(S,this.posX+this.margin[3],-F+D+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=B}var U=JSON.parse(JSON.stringify(T));U=y([U],this.posX+this.margin[3],-F+D+this.ctx.prevPageLastElemOffset)[0];var j=(I>P||I<R)&&g.call(this);j&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],C,M,null).clip().discardPath()),this.pdf.addImage(t,"JPEG",U.x,U.y,U.w,U.h,null,null,E),j&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(t,"JPEG",T.x,T.y,T.w,T.h,null,null,E)};var m=function(t,e,i){var n=[];e=e||this.pdf.internal.pageSize.width,i=i||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var r=this.posY+this.ctx.prevPageLastElemOffset;switch(t.type){default:case"mt":case"lt":n.push(Math.floor((t.y+r)/i)+1);break;case"arc":n.push(Math.floor((t.y+r-t.radius)/i)+1),n.push(Math.floor((t.y+r+t.radius)/i)+1);break;case"qct":var s=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x,t.y);n.push(Math.floor((s.y+r)/i)+1),n.push(Math.floor((s.y+s.h+r)/i)+1);break;case"bct":var a=M(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x2,t.y2,t.x,t.y);n.push(Math.floor((a.y+r)/i)+1),n.push(Math.floor((a.y+a.h+r)/i)+1);break;case"rect":n.push(Math.floor((t.y+r)/i)+1),n.push(Math.floor((t.y+t.h+r)/i)+1)}for(var o=0;o<n.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<n[o];)v.call(this);return n},v=function(){var t=this.fillStyle,e=this.strokeStyle,i=this.font,n=this.lineCap,r=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=t,this.strokeStyle=e,this.font=i,this.lineCap=n,this.lineWidth=r,this.lineJoin=s},y=function(t,e,i){for(var n=0;n<t.length;n++)switch(t[n].type){case"bct":t[n].x2+=e,t[n].y2+=i;case"qct":t[n].x1+=e,t[n].y1+=i;default:t[n].x+=e,t[n].y+=i}return t},b=function(t){return t.sort((function(t,e){return t-e}))},S=function(t,e){for(var i,n,r=this.fillStyle,s=this.strokeStyle,a=this.lineCap,o=this.lineWidth,l=Math.abs(o*this.ctx.transform.scaleX),c=this.lineJoin,u=JSON.parse(JSON.stringify(this.path)),h=JSON.parse(JSON.stringify(this.path)),d=[],f=0;f<h.length;f++)if(void 0!==h[f].x)for(var p=m.call(this,h[f]),S=0;S<p.length;S+=1)-1===d.indexOf(p[S])&&d.push(p[S]);for(var x=0;x<d.length;x++)for(;this.pdf.internal.getNumberOfPages()<d[x];)v.call(this);if(b(d),this.autoPaging)for(var E=d[0],L=d[d.length-1],T=E;T<L+1;T++){this.pdf.setPage(T),this.fillStyle=r,this.strokeStyle=s,this.lineCap=a,this.lineWidth=l,this.lineJoin=c;var A=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_=1===T?this.posY+this.margin[0]:this.margin[0],k=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],P=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],R=1===T?0:k+(T-2)*P;if(0!==this.ctx.clip_path.length){var I=this.path;i=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(i,this.posX+this.margin[3],-R+_+this.ctx.prevPageLastElemOffset),w.call(this,t,!0),this.path=I}if(n=JSON.parse(JSON.stringify(u)),this.path=y(n,this.posX+this.margin[3],-R+_+this.ctx.prevPageLastElemOffset),!1===e||0===T){var C=(T>E||T<L)&&g.call(this);C&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],A,P,null).clip().discardPath()),w.call(this,t,e),C&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=l,w.call(this,t,e),this.lineWidth=o;this.path=u},w=function(t,e){if(("stroke"!==t||e||!p.call(this))&&("stroke"===t||e||!f.call(this))){for(var i,n,r=[],s=this.path,a=0;a<s.length;a++){var o=s[a];switch(o.type){case"begin":r.push({begin:!0});break;case"close":r.push({close:!0});break;case"mt":r.push({start:o,deltas:[],abs:[]});break;case"lt":var l=r.length;if(s[a-1]&&!isNaN(s[a-1].x)&&(i=[o.x-s[a-1].x,o.y-s[a-1].y],l>0))for(;l>=0;l--)if(!0!==r[l-1].close&&!0!==r[l-1].begin){r[l-1].deltas.push(i),r[l-1].abs.push(o);break}break;case"bct":i=[o.x1-s[a-1].x,o.y1-s[a-1].y,o.x2-s[a-1].x,o.y2-s[a-1].y,o.x-s[a-1].x,o.y-s[a-1].y],r[r.length-1].deltas.push(i);break;case"qct":var c=s[a-1].x+2/3*(o.x1-s[a-1].x),u=s[a-1].y+2/3*(o.y1-s[a-1].y),h=o.x+2/3*(o.x1-o.x),d=o.y+2/3*(o.y1-o.y),g=o.x,m=o.y;i=[c-s[a-1].x,u-s[a-1].y,h-s[a-1].x,d-s[a-1].y,g-s[a-1].x,m-s[a-1].y],r[r.length-1].deltas.push(i);break;case"arc":r.push({deltas:[],abs:[],arc:!0}),Array.isArray(r[r.length-1].abs)&&r[r.length-1].abs.push(o)}}n=e?null:"stroke"===t?"stroke":"fill";for(var v=!1,y=0;y<r.length;y++)if(r[y].arc)for(var b=r[y].abs,S=0;S<b.length;S++){var w=b[S];"arc"===w.type?L.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,e,!v):P.call(this,w.x,w.y),v=!0}else if(!0===r[y].close)this.pdf.internal.out("h"),v=!1;else if(!0!==r[y].begin){var x=r[y].start.x,E=r[y].start.y;R.call(this,r[y].deltas,x,E),v=!0}n&&T.call(this,n),e&&A.call(this)}},x=function(t){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,i=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t-i;case"top":return t+e-i;case"hanging":return t+e-2*i;case"middle":return t+e/2-i;default:return t}},E=function(t){return t+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var t=function(){};return t.colorStops=[],t.addColorStop=function(t,e){this.colorStops.push([t,e])},t.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},t.isCanvasGradient=!0,t},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var L=function(t,e,i,n,r,s,a,o,l){for(var c=C.call(this,i,n,r,s),u=0;u<c.length;u++){var h=c[u];0===u&&(l?_.call(this,h.x1+t,h.y1+e):P.call(this,h.x1+t,h.y1+e)),I.call(this,t,e,h.x2,h.y2,h.x3,h.y3,h.x4,h.y4)}o?A.call(this):T.call(this,a)},T=function(t){switch(t){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},A=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(t,e){this.pdf.internal.out(i(t)+" "+n(e)+" m")},k=function(t){var e;switch(t.align){case"right":case"end":e="right";break;case"center":e="center";break;default:e="left"}var i=this.pdf.getTextDimensions(t.text),n=x.call(this,t.y),r=E.call(this,n)-i.h,s=this.ctx.transform.applyToPoint(new a(t.x,n)),c=this.ctx.transform.decompose(),u=new l;u=(u=(u=u.multiply(c.translate)).multiply(c.skew)).multiply(c.scale);for(var h,d,f,p=this.ctx.transform.applyToRectangle(new o(t.x,n,i.w,i.h)),v=u.applyToRectangle(new o(t.x,r,i.w,i.h)),S=m.call(this,v),L=[],T=0;T<S.length;T+=1)-1===L.indexOf(S[T])&&L.push(S[T]);if(b(L),this.autoPaging)for(var A=L[0],_=L[L.length-1],k=A;k<_+1;k++){this.pdf.setPage(k);var P=1===k?this.posY+this.margin[0]:this.margin[0],R=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],I=this.pdf.internal.pageSize.height-this.margin[2],C=I-this.margin[0],D=this.pdf.internal.pageSize.width-this.margin[1],N=D-this.margin[3],O=1===k?0:R+(k-2)*C;if(0!==this.ctx.clip_path.length){var M=this.path;h=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(h,this.posX+this.margin[3],-1*O+P),w.call(this,"fill",!0),this.path=M}var F=y([JSON.parse(JSON.stringify(v))],this.posX+this.margin[3],-O+P+this.ctx.prevPageLastElemOffset)[0];t.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*t.scale),f=this.lineWidth,this.lineWidth=f*t.scale);var B="text"!==this.autoPaging;if(B||F.y+F.h<=I){if(B||F.y>=P&&F.x<=D){var U=B?t.text:this.pdf.splitTextToSize(t.text,t.maxWidth||D-F.x)[0],j=y([JSON.parse(JSON.stringify(p))],this.posX+this.margin[3],-O+P+this.ctx.prevPageLastElemOffset)[0],$=B&&(k>A||k<_)&&g.call(this);$&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],N,C,null).clip().discardPath()),this.pdf.text(U,j.x,j.y,{angle:t.angle,align:e,renderingMode:t.renderingMode}),$&&this.pdf.restoreGraphicsState()}}else F.y<I&&(this.ctx.prevPageLastElemOffset+=I-F.y);t.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=f)}else t.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*t.scale),f=this.lineWidth,this.lineWidth=f*t.scale),this.pdf.text(t.text,s.x+this.posX,s.y+this.posY,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=f)},P=function(t,e,r,s){r=r||0,s=s||0,this.pdf.internal.out(i(t+r)+" "+n(e+s)+" l")},R=function(t,e,i){return this.pdf.lines(t,e,i,null,null)},I=function(t,i,n,a,o,l,c,u){this.pdf.internal.out([e(r(n+t)),e(s(a+i)),e(r(o+t)),e(s(l+i)),e(r(c+t)),e(s(u+i)),"c"].join(" "))},C=function(t,e,i,n){for(var r=2*Math.PI,s=Math.PI/2;e>i;)e-=r;var a=Math.abs(i-e);a<r&&n&&(a=r-a);for(var o=[],l=n?-1:1,c=e;a>1e-5;){var u=c+l*Math.min(a,s);o.push(D.call(this,t,c,u)),a-=Math.abs(u-c),c=u}return o},D=function(t,e,i){var n=(i-e)/2,r=t*Math.cos(n),s=t*Math.sin(n),a=r,o=-s,l=a*a+o*o,c=l+a*r+o*s,u=4/3*(Math.sqrt(2*l*c)-c)/(a*s-o*r),h=a-u*o,d=o+u*a,f=h,p=-d,g=n+e,m=Math.cos(g),v=Math.sin(g);return{x1:t*Math.cos(e),y1:t*Math.sin(e),x2:h*m-d*v,y2:h*v+d*m,x3:f*m-p*v,y3:f*v+p*m,x4:t*Math.cos(i),y4:t*Math.sin(i)}},N=function(t){return 180*t/Math.PI},O=function(t,e,i,n,r,s){var a=t+.5*(i-t),l=e+.5*(n-e),c=r+.5*(i-r),u=s+.5*(n-s),h=Math.min(t,r,a,c),d=Math.max(t,r,a,c),f=Math.min(e,s,l,u),p=Math.max(e,s,l,u);return new o(h,f,d-h,p-f)},M=function(t,e,i,n,r,s,a,l){var c,u,h,d,f,p,g,m,v,y,b,S,w,x,E=i-t,L=n-e,T=r-i,A=s-n,_=a-r,k=l-s;for(u=0;u<41;u++)v=(g=(h=t+(c=u/40)*E)+c*((f=i+c*T)-h))+c*(f+c*(r+c*_-f)-g),y=(m=(d=e+c*L)+c*((p=n+c*A)-d))+c*(p+c*(s+c*k-p)-m),0==u?(b=v,S=y,w=v,x=y):(b=Math.min(b,v),S=Math.min(S,y),w=Math.max(w,v),x=Math.max(x,y));return new o(Math.round(b),Math.round(S),Math.round(w-b),Math.round(x-S))},F=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var t,e,i=(t=this.ctx.lineDash,e=this.ctx.lineDashOffset,JSON.stringify({lineDash:t,lineDashOffset:e}));this.prevLineDash!==i&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=i)}}}(nb.API),function(t){var e=function(t){var e,i,n,r,s,a,o,l,c,u;for(/[^\x00-\xFF]/.test(t),i=[],n=0,r=(t+=e="\0\0\0\0".slice(t.length%4||4)).length;r>n;n+=4)0!==(s=(t.charCodeAt(n)<<24)+(t.charCodeAt(n+1)<<16)+(t.charCodeAt(n+2)<<8)+t.charCodeAt(n+3))?(a=(s=((s=((s=((s=(s-(u=s%85))/85)-(c=s%85))/85)-(l=s%85))/85)-(o=s%85))/85)%85,i.push(a+33,o+33,l+33,c+33,u+33)):i.push(122);return function(t,e){for(var i=e;i>0;i--)t.pop()}(i,e.length),String.fromCharCode.apply(String,i)+"~>"},i=function(t){var e,i,n,r,s,a=String,o="length",l=255,c="charCodeAt",u="slice",h="replace";for(t[u](-2),t=t[u](0,-2)[h](/\s/g,"")[h]("z","!!!!!"),n=[],r=0,s=(t+=e="uuuuu"[u](t[o]%5||5))[o];s>r;r+=5)i=52200625*(t[c](r)-33)+614125*(t[c](r+1)-33)+7225*(t[c](r+2)-33)+85*(t[c](r+3)-33)+(t[c](r+4)-33),n.push(l&i>>24,l&i>>16,l&i>>8,l&i);return function(t,e){for(var i=e;i>0;i--)t.pop()}(n,e[o]),a.fromCharCode.apply(a,n)},n=function(t){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(t=t.replace(/\s/g,"")).indexOf(">")&&(t=t.substr(0,t.indexOf(">"))),t.length%2&&(t+="0"),!1===e.test(t))return"";for(var i="",n=0;n<t.length;n+=2)i+=String.fromCharCode("0x"+(t[n]+t[n+1]));return i},r=function(t){for(var e=new Uint8Array(t.length),i=t.length;i--;)e[i]=t.charCodeAt(i);return(e=wy(e)).reduce((function(t,e){return t+String.fromCharCode(e)}),"")};t.processDataByFilters=function(t,s){var a=0,o=t||"",l=[];for("string"==typeof(s=s||[])&&(s=[s]),a=0;a<s.length;a+=1)switch(s[a]){case"ASCII85Decode":case"/ASCII85Decode":o=i(o),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":o=e(o),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":o=n(o),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":o=o.split("").map((function(t){return("0"+t.charCodeAt().toString(16)).slice(-2)})).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":o=r(o),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[a]+'" is not implemented')}return{data:o,reverseChain:l.reverse().join(" ")}}}(nb.API),(lS=nb.API).loadFile=function(t,e,i){return function(t,e,i){e=!1!==e,i="function"==typeof i?i:function(){};var n=void 0;try{n=function(t,e,i){var n=new XMLHttpRequest,r=0,s=function(t){var e=t.length,i=[],n=String.fromCharCode;for(r=0;r<e;r+=1)i.push(n(255&t.charCodeAt(r)));return i.join("")};if(n.open("GET",t,!e),n.overrideMimeType("text/plain; charset=x-user-defined"),!1===e&&(n.onload=function(){200===n.status?i(s(this.responseText)):i(void 0)}),n.send(null),e&&200===n.status)return s(n.responseText)}(t,e,i)}catch(t){}return n}(t,e,i)},lS.loadImageFile=lS.loadFile,function(t){function e(){return(Ly.html2canvas?Promise.resolve(Ly.html2canvas):i.e(239).then(i.t.bind(i,239,23))).catch((function(t){return Promise.reject(new Error("Could not load html2canvas: "+t))})).then((function(t){return t.default?t.default:t}))}function n(){return(Ly.DOMPurify?Promise.resolve(Ly.DOMPurify):i.e(977).then(i.bind(i,977))).catch((function(t){return Promise.reject(new Error("Could not load dompurify: "+t))})).then((function(t){return t.default?t.default:t}))}var r=function(t){var e=(0,_v.A)(t);return"undefined"===e?"undefined":"string"===e||t instanceof String?"string":"number"===e||t instanceof Number?"number":"function"===e||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"===e?"object":"unknown"},s=function(t,e){var i=document.createElement(t);for(var n in e.className&&(i.className=e.className),e.innerHTML&&e.dompurify&&(i.innerHTML=e.dompurify.sanitize(e.innerHTML)),e.style)i.style[n]=e.style[n];return i},a=function t(e){var i=Object.assign(t.convert(Promise.resolve()),JSON.parse(JSON.stringify(t.template))),n=t.convert(Promise.resolve(),i);return(n=n.setProgress(1,t,1,[t])).set(e)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(t,e){return t.__proto__=e||a.prototype,t},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(t,e){return this.then((function(){switch(e=e||function(t){switch(r(t)){case"string":return"string";case"element":return"canvas"===t.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(t)){case"string":return this.then(n).then((function(e){return this.set({src:s("div",{innerHTML:t,dompurify:e})})}));case"element":return this.set({src:t});case"canvas":return this.set({canvas:t});case"img":return this.set({img:t});default:return this.error("Unknown source type.")}}))},a.prototype.to=function(t){switch(t){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var t={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},e=function t(e,i){for(var n=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),r=e.firstChild;r;r=r.nextSibling)!0!==i&&1===r.nodeType&&"SCRIPT"===r.nodeName||n.appendChild(t(r,i));return 1===e.nodeType&&("CANVAS"===e.nodeName?(n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0)):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(n.value=e.value),n.addEventListener("load",(function(){n.scrollTop=e.scrollTop,n.scrollLeft=e.scrollLeft}),!0)),n}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===e.tagName&&(t.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:t}),this.prop.container.appendChild(e),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},a.prototype.toCanvas=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(e).then((function(t){var e=Object.assign({},this.opt.html2canvas);return delete e.onrendered,t(this.prop.container,e)})).then((function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)}))},a.prototype.toContext2d=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(e).then((function(t){var e=this.opt.jsPDF,i=this.opt.fontFaces,n="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,r=Object.assign({async:!0,allowTaint:!0,scale:n,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete r.onrendered,e.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,e.context2d.margin=this.opt.margin,e.context2d.fontFaces=i,i)for(var s=0;s<i.length;++s){var a=i[s],o=a.src.find((function(t){return"truetype"===t.format}));o&&e.addFont(o.url,a.ref.name,a.ref.style)}return r.windowHeight=r.windowHeight||0,r.windowHeight=0==r.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):r.windowHeight,e.context2d.save(!0),t(this.prop.container,r)})).then((function(t){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)}))},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var t=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t}))},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},a.prototype.output=function(t,e,i){return"img"===(i=i||"pdf").toLowerCase()||"image"===i.toLowerCase()?this.outputImg(t,e):this.outputPdf(t,e)},a.prototype.outputPdf=function(t,e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(t,e)}))},a.prototype.outputImg=function(t){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(t){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t+'" is not supported.'}}))},a.prototype.save=function(t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(t?{filename:t}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},a.prototype.set=function(t){if("object"!==r(t))return this;var e=Object.keys(t||{}).map((function(e){if(e in a.template.prop)return function(){this.prop[e]=t[e]};switch(e){case"margin":return this.setMargin.bind(this,t.margin);case"jsPDF":return function(){return this.opt.jsPDF=t.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,t.pageSize);default:return function(){this.opt[e]=t[e]}}}),this);return this.then((function(){return this.thenList(e)}))},a.prototype.get=function(t,e){return this.then((function(){var i=t in a.template.prop?this.prop[t]:this.opt[t];return e?e(i):i}))},a.prototype.setMargin=function(t){return this.then((function(){switch(r(t)){case"number":t=[t,t,t,t];case"array":if(2===t.length&&(t=[t[0],t[1],t[0],t[1]]),4===t.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=t})).then(this.setPageSize)},a.prototype.setPageSize=function(t){function e(t,e){return Math.floor(t*e/72*96)}return this.then((function(){(t=t||nb.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(t.inner={width:t.width-this.opt.margin[1]-this.opt.margin[3],height:t.height-this.opt.margin[0]-this.opt.margin[2]},t.inner.px={width:e(t.inner.width,t.k),height:e(t.inner.height,t.k)},t.inner.ratio=t.inner.height/t.inner.width),this.prop.pageSize=t}))},a.prototype.setProgress=function(t,e,i,n){return null!=t&&(this.progress.val=t),null!=e&&(this.progress.state=e),null!=i&&(this.progress.n=i),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(t,e,i,n){return this.setProgress(t?this.progress.val+t:null,e||null,i?this.progress.n+i:null,n?this.progress.stack.concat(n):null)},a.prototype.then=function(t,e){var i=this;return this.thenCore(t,e,(function(t,e){return i.updateProgress(null,null,1,[t]),Promise.prototype.then.call(this,(function(e){return i.updateProgress(null,t),e})).then(t,e).then((function(t){return i.updateProgress(1),t}))}))},a.prototype.thenCore=function(t,e,i){i=i||Promise.prototype.then,t&&(t=t.bind(this)),e&&(e=e.bind(this));var n=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:a.convert(Object.assign({},this),Promise.prototype),r=i.call(n,t,e);return a.convert(r,this.__proto__)},a.prototype.thenExternal=function(t,e){return Promise.prototype.then.call(this,t,e)},a.prototype.thenList=function(t){var e=this;return t.forEach((function(t){e=e.thenCore(t)})),e},a.prototype.catch=function(t){t&&(t=t.bind(this));var e=Promise.prototype.catch.call(this,t);return a.convert(e,this)},a.prototype.catchExternal=function(t){return Promise.prototype.catch.call(this,t)},a.prototype.error=function(t){return this.then((function(){throw new Error(t)}))},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,nb.getPageSize=function(t,e,i){if("object"===(0,_v.A)(t)){var n=t;t=n.orientation,e=n.unit||e,i=n.format||i}e=e||"mm",i=i||"a4",t=(""+(t||"P")).toLowerCase();var r,s=(""+i).toLowerCase(),a={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":r=1;break;case"mm":r=72/25.4;break;case"cm":r=72/2.54;break;case"in":r=72;break;case"px":r=.75;break;case"pc":case"em":r=12;break;case"ex":r=6;break;default:throw"Invalid unit: "+e}var o,l=0,c=0;if(a.hasOwnProperty(s))l=a[s][1]/r,c=a[s][0]/r;else try{l=i[1],c=i[0]}catch(lS){throw new Error("Invalid format: "+i)}if("p"===t||"portrait"===t)t="p",c>l&&(o=c,c=l,l=o);else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;t="l",l>c&&(o=c,c=l,l=o)}return{width:c,height:l,unit:e,k:r,orientation:t}},t.html=function(t,e){(e=e||{}).callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this,e.fontFaces=e.fontFaces?e.fontFaces.map(Qb):null;var i=new a(e);return e.worker?i:i.from(t).doCallback()}}(nb.API),nb.API.addJS=function(t){return oS=t,this.internal.events.subscribe("postPutResources",(function(){sS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(sS+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),aS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+oS+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){void 0!==sS&&void 0!==aS&&this.internal.out("/Names <</JavaScript "+sS+" 0 R>>")})),this},function(t){var e;t.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=t.outline.render().split(/\r\n/),r=0;r<n.length;r++){var s=n[r],a=i.exec(s);if(null!=a){var o=a[1];t.internal.newObjectDeferredBegin(o,!1)}t.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(r=0;r<l;r++){var u=t.internal.newObject();c.push(u);var h=t.internal.getPageInfo(r+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var d=t.internal.newObject();for(t.internal.write("<< /Names [ "),r=0;r<c.length;r++)t.internal.write("(page_"+(r+1)+")"+c[r]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+d+" 0 R"),t.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(t,e,i){var n={title:e,options:i,children:[]};return null==t&&(t=this.root),t.children.push(n),n},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(e){e.id=t.internal.newObjectDeferred();for(var i=0;i<e.children.length;i++)this.genIds_r(e.children[i])},t.outline.renderRoot=function(t){this.objStart(t),this.line("/Type /Outlines"),t.children.length>0&&(this.line("/First "+this.makeRef(t.children[0])),this.line("/Last "+this.makeRef(t.children[t.children.length-1]))),this.line("/Count "+this.count_r({count:0},t)),this.objEnd()},t.outline.renderItems=function(e){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,n=0;n<e.children.length;n++){var r=e.children[n];this.objStart(r),this.line("/Title "+this.makeString(r.title)),this.line("/Parent "+this.makeRef(e)),n>0&&this.line("/Prev "+this.makeRef(e.children[n-1])),n<e.children.length-1&&this.line("/Next "+this.makeRef(e.children[n+1])),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1])));var s=this.count=this.count_r({count:0},r);if(s>0&&this.line("/Count "+s),r.options&&r.options.pageNumber){var a=t.internal.getPageInfo(r.options.pageNumber);this.line("/Dest ["+a.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var o=0;o<e.children.length;o++)this.renderItems(e.children[o])},t.outline.line=function(t){this.ctx.val+=t+"\r\n"},t.outline.makeRef=function(t){return t.id+" 0 R"},t.outline.makeString=function(e){return"("+t.internal.pdfEscape(e)+")"},t.outline.objStart=function(t){this.ctx.val+="\r\n"+t.id+" 0 obj\r\n<<\r\n"},t.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},t.outline.count_r=function(t,e){for(var i=0;i<e.children.length;i++)t.count++,this.count_r(t,e.children[i]);return t.count}}])}(nb.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(t,i,n,r,s,a){var o,l=this.decode.DCT_DECODE,c=null;if("string"==typeof t||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=s||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(o=function(t){for(var i,n=256*t.charCodeAt(4)+t.charCodeAt(5),r=t.length,s={width:0,height:0,numcomponents:1},a=4;a<r;a+=2){if(a+=n,-1!==e.indexOf(t.charCodeAt(a+1))){i=256*t.charCodeAt(a+5)+t.charCodeAt(a+6),s={width:256*t.charCodeAt(a+7)+t.charCodeAt(a+8),height:i,numcomponents:t.charCodeAt(a+9)};break}n=256*t.charCodeAt(a+2)+t.charCodeAt(a+3)}return s}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}c={data:t,width:o.width,height:o.height,colorSpace:a,bitsPerComponent:8,filter:l,index:i,alias:n}}return c}}(nb.API);var uS,hS,dS,fS,pS,gS=function(){var t,e,i;function n(t){var e,i,n,r,s,a,o,l,c,u,h,d,f,p;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},a=null;;){switch(e=this.readUInt32(),c=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":a&&this.animation.frames.push(a),this.pos+=4,a={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},s=this.readUInt16(),r=this.readUInt16()||100,a.delay=1e3*s/r,a.disposeOp=this.data[this.pos++],a.blendOp=this.data[this.pos++],a.data=[];break;case"IDAT":case"fdAT":for("fdAT"===c&&(this.pos+=4,e-=4),t=(null!=a?a.data:void 0)||this.imgData,d=0;0<=e?d<e:d>e;0<=e?++d:--d)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(n=this.palette.length/3,this.transparency.indexed=this.read(e),this.transparency.indexed.length>n)throw new Error("More transparent colors than palette size");if((u=n-this.transparency.indexed.length)>0)for(f=0;0<=u?f<u:f>u;0<=u?++f:--f)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":o=(h=this.read(e)).indexOf(0),l=String.fromCharCode.apply(String,h.slice(0,o)),this.text[l]=String.fromCharCode.apply(String,h.slice(o+1));break;case"IEND":return a&&this.animation.frames.push(a),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)i.push(this.data[this.pos++]);return i},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(t){var e=this.pixelBitlength/8,i=new Uint8Array(this.width*this.height*e),n=0,r=this;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);function s(s,a,o,l){var c,u,h,d,f,p,g,m,v,y,b,S,w,x,E,L,T,A,_,k,P,R=Math.ceil((r.width-s)/o),I=Math.ceil((r.height-a)/l),C=r.width==R&&r.height==I;for(x=e*R,S=C?i:new Uint8Array(x*I),p=t.length,w=0,u=0;w<I&&n<p;){switch(t[n++]){case 0:for(d=T=0;T<x;d=T+=1)S[u++]=t[n++];break;case 1:for(d=A=0;A<x;d=A+=1)c=t[n++],f=d<e?0:S[u-e],S[u++]=(c+f)%256;break;case 2:for(d=_=0;_<x;d=_+=1)c=t[n++],h=(d-d%e)/e,E=w&&S[(w-1)*x+h*e+d%e],S[u++]=(E+c)%256;break;case 3:for(d=k=0;k<x;d=k+=1)c=t[n++],h=(d-d%e)/e,f=d<e?0:S[u-e],E=w&&S[(w-1)*x+h*e+d%e],S[u++]=(c+Math.floor((f+E)/2))%256;break;case 4:for(d=P=0;P<x;d=P+=1)c=t[n++],h=(d-d%e)/e,f=d<e?0:S[u-e],0===w?E=L=0:(E=S[(w-1)*x+h*e+d%e],L=h&&S[(w-1)*x+(h-1)*e+d%e]),g=f+E-L,m=Math.abs(g-f),y=Math.abs(g-E),b=Math.abs(g-L),v=m<=y&&m<=b?f:y<=b?E:L,S[u++]=(c+v)%256;break;default:throw new Error("Invalid filter algorithm: "+t[n-1])}if(!C){var D=((a+w*l)*r.width+s)*e,N=w*x;for(d=0;d<R;d+=1){for(var O=0;O<e;O+=1)i[D++]=S[N++];D+=(o-1)*e}}w++}}return t=xy(t),1==r.interlaceMethod?(s(0,0,8,8),s(4,0,8,8),s(0,4,4,8),s(2,0,4,4),s(0,2,2,4),s(1,0,2,2),s(0,1,1,2)):s(0,0,1,1),i},n.prototype.decodePalette=function(){var t,e,i,n,r,s,a,o,l;for(i=this.palette,s=this.transparency.indexed||[],r=new Uint8Array((s.length||0)+i.length),n=0,t=0,e=a=0,o=i.length;a<o;e=a+=3)r[n++]=i[e],r[n++]=i[e+1],r[n++]=i[e+2],r[n++]=null!=(l=s[t++])?l:255;return r},n.prototype.copyToImageData=function(t,e){var i,n,r,s,a,o,l,c,u,h,d;if(n=this.colors,u=null,i=this.hasAlphaChannel,this.palette.length&&(u=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),n=4,i=!0),c=(r=t.data||t).length,a=u||e,s=o=0,1===n)for(;s<c;)l=u?4*e[s/4]:o,h=a[l++],r[s++]=h,r[s++]=h,r[s++]=h,r[s++]=i?a[l++]:255,o=l;else for(;s<c;)l=u?4*e[s/4]:o,r[s++]=a[l++],r[s++]=a[l++],r[s++]=a[l++],r[s++]=i?a[l++]:255,o=l},n.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t};var r=function(){if("[object Window]"===Object.prototype.toString.call(Ly)){try{e=Ly.document.createElement("canvas"),i=e.getContext("2d")}catch(t){return!1}return!0}return!1};return r(),t=function(t){var n;if(!0===r())return i.width=t.width,i.height=t.height,i.clearRect(0,0,t.width,t.height),i.putImageData(t,0,0),(n=new Image).src=e.toDataURL(),n;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(e){var i,n,r,s,a,o,l,c;if(this.animation){for(c=[],n=a=0,o=(l=this.animation.frames).length;a<o;n=++a)i=l[n],r=e.createImageData(i.width,i.height),s=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(r,s),i.imageData=r,c.push(i.image=t(r));return c}},n.prototype.renderFrame=function(t,e){var i,n,r;return i=(n=this.animation.frames)[e],r=n[e-1],0===e&&t.clearRect(0,0,this.width,this.height),1===(null!=r?r.disposeOp:void 0)?t.clearRect(r.xOffset,r.yOffset,r.width,r.height):2===(null!=r?r.disposeOp:void 0)&&t.putImageData(r.imageData,r.xOffset,r.yOffset),0===i.blendOp&&t.clearRect(i.xOffset,i.yOffset,i.width,i.height),t.drawImage(i.image,i.xOffset,i.yOffset)},n.prototype.animate=function(t){var e,i,n,r,s,a,o=this;return i=0,a=this.animation,r=a.numFrames,n=a.frames,s=a.numPlays,(e=function(){var a,l;if(a=i++%r,l=n[a],o.renderFrame(t,a),r>1&&i/r<s)return o.animation._timeout=setTimeout(e,l.delay)})()},n.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},n.prototype.render=function(t){var e,i;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(i=e.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0))},n}();function mS(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw new Error("Invalid GIF 87a/89a header.");var i=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,r=t[e++],s=r>>7,a=1<<1+(7&r);t[e++],t[e++];var o=null,l=null;s&&(o=e,l=a,e+=3*a);var c=!0,u=[],h=0,d=null,f=0,p=null;for(this.width=i,this.height=n;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,p=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(0===_)break;e+=_}break;case 249:if(4!==t[e++]||0!==t[e+4])throw new Error("Invalid graphics extension block.");var g=t[e++];h=t[e++]|t[e++]<<8,d=t[e++],0==(1&g)&&(d=null),f=g>>2&7,e++;break;case 254:for(;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(0===_)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var m=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,S=t[e++],w=S>>6&1,x=1<<1+(7&S),E=o,L=l,T=!1;S>>7&&(T=!0,E=e,L=x,e+=3*x);var A=e;for(e++;;){var _;if(!((_=t[e++])>=0))throw Error("Invalid block size");if(0===_)break;e+=_}u.push({x:m,y:v,width:y,height:b,has_local_palette:T,palette_offset:E,palette_size:L,data_offset:A,data_length:e-A,transparent_index:d,interlaced:!!w,delay:h,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(t){if(t<0||t>=u.length)throw new Error("Frame index out of range.");return u[t]},this.decodeAndBlitFrameBGRA=function(e,n){var r=this.frameInfo(e),s=r.width*r.height,a=new Uint8Array(s);vS(t,r.data_offset,a,s);var o=r.palette_offset,l=r.transparent_index;null===l&&(l=256);var c=r.width,u=i-c,h=c,d=4*(r.y*i+r.x),f=4*((r.y+r.height)*i+r.x),p=d,g=4*u;!0===r.interlaced&&(g+=4*i*7);for(var m=8,v=0,y=a.length;v<y;++v){var b=a[v];if(0===h&&(h=c,(p+=g)>=f&&(g=4*u+4*i*(m-1),p=d+(c+u)*(m<<1),m>>=1)),b===l)p+=4;else{var S=t[o+3*b],w=t[o+3*b+1],x=t[o+3*b+2];n[p++]=x,n[p++]=w,n[p++]=S,n[p++]=255}--h}},this.decodeAndBlitFrameRGBA=function(e,n){var r=this.frameInfo(e),s=r.width*r.height,a=new Uint8Array(s);vS(t,r.data_offset,a,s);var o=r.palette_offset,l=r.transparent_index;null===l&&(l=256);var c=r.width,u=i-c,h=c,d=4*(r.y*i+r.x),f=4*((r.y+r.height)*i+r.x),p=d,g=4*u;!0===r.interlaced&&(g+=4*i*7);for(var m=8,v=0,y=a.length;v<y;++v){var b=a[v];if(0===h&&(h=c,(p+=g)>=f&&(g=4*u+4*i*(m-1),p=d+(c+u)*(m<<1),m>>=1)),b===l)p+=4;else{var S=t[o+3*b],w=t[o+3*b+1],x=t[o+3*b+2];n[p++]=S,n[p++]=w,n[p++]=x,n[p++]=255}--h}}}function vS(t,e,i,n){for(var r=t[e++],s=1<<r,a=s+1,o=a+1,l=r+1,c=(1<<l)-1,u=0,h=0,d=0,f=t[e++],p=new Int32Array(4096),g=null;;){for(;u<16&&0!==f;)h|=t[e++]<<u,u+=8,1===f?f=t[e++]:--f;if(u<l)break;var m=h&c;if(h>>=l,u-=l,m!==s){if(m===a)break;for(var v=m<o?m:g,y=0,b=v;b>s;)b=p[b]>>8,++y;var S=b;if(d+y+(v!==m?1:0)>n)return void Ay.log("Warning, gif stream longer than expected.");i[d++]=S;var w=d+=y;for(v!==m&&(i[d++]=S),b=v;y--;)b=p[b],i[--w]=255&b,b>>=8;null!==g&&o<4096&&(p[o++]=g<<8|S,o>=c+1&&l<12&&(++l,c=c<<1|1)),g=m}else o=a+1,c=(1<<(l=r+1))-1,g=null}return d!==n&&Ay.log("Warning, gif stream shorter than expected."),i}function yS(t){var e,i,n,r,s,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),d=new Array(65535),f=new Array(64),p=new Array(64),g=[],m=0,v=7,y=new Array(64),b=new Array(64),S=new Array(64),w=new Array(256),x=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],L=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],k=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],I=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function C(t,e){for(var i=0,n=0,r=new Array,s=1;s<=16;s++){for(var a=1;a<=t[s];a++)r[e[n]]=[],r[e[n]][0]=i,r[e[n]][1]=s,n++,i++;i*=2}return r}function D(t){for(var e=t[0],i=t[1]-1;i>=0;)e&1<<i&&(m|=1<<v),i--,--v<0&&(255==m?(N(255),N(0)):N(m),v=7,m=0)}function N(t){g.push(t)}function O(t){N(t>>8&255),N(255&t)}function M(t,e,i,n,r){for(var s,a=r[0],o=r[240],l=function(t,e){var i,n,r,s,a,o,l,c,u,h,d=0;for(u=0;u<8;++u){i=t[d],n=t[d+1],r=t[d+2],s=t[d+3],a=t[d+4],o=t[d+5],l=t[d+6];var p=i+(c=t[d+7]),g=i-c,m=n+l,v=n-l,y=r+o,b=r-o,S=s+a,w=s-a,x=p+S,E=p-S,L=m+y,T=m-y;t[d]=x+L,t[d+4]=x-L;var A=.707106781*(T+E);t[d+2]=E+A,t[d+6]=E-A;var _=.382683433*((x=w+b)-(T=v+g)),k=.5411961*x+_,P=1.306562965*T+_,R=.707106781*(L=b+v),I=g+R,C=g-R;t[d+5]=C+k,t[d+3]=C-k,t[d+1]=I+P,t[d+7]=I-P,d+=8}for(d=0,u=0;u<8;++u){i=t[d],n=t[d+8],r=t[d+16],s=t[d+24],a=t[d+32],o=t[d+40],l=t[d+48];var D=i+(c=t[d+56]),N=i-c,O=n+l,M=n-l,F=r+o,B=r-o,U=s+a,j=s-a,$=D+U,z=D-U,H=O+F,q=O-F;t[d]=$+H,t[d+32]=$-H;var G=.707106781*(q+z);t[d+16]=z+G,t[d+48]=z-G;var V=.382683433*(($=j+B)-(q=M+N)),W=.5411961*$+V,K=1.306562965*q+V,Y=.707106781*(H=B+M),X=N+Y,Q=N-Y;t[d+40]=Q+W,t[d+24]=Q-W,t[d+8]=X+K,t[d+56]=X-K,d++}for(u=0;u<64;++u)h=t[u]*e[u],f[u]=h>0?h+.5|0:h-.5|0;return f}(t,e),c=0;c<64;++c)p[E[c]]=l[c];var u=p[0]-i;i=p[0],0==u?D(n[0]):(D(n[d[s=32767+u]]),D(h[s]));for(var g=63;g>0&&0==p[g];)g--;if(0==g)return D(a),i;for(var m,v=1;v<=g;){for(var y=v;0==p[v]&&v<=g;)++v;var b=v-y;if(b>=16){m=b>>4;for(var S=1;S<=m;++S)D(o);b&=15}s=32767+p[v],D(r[(b<<4)+d[s]]),D(h[s]),v++}return 63!=g&&D(a),i}function F(t){t=Math.min(Math.max(t,1),100),s!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=a((e[i]*t+50)/100);n=Math.min(Math.max(n,1),255),o[E[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var h=a((r[s]*t+50)/100);h=Math.min(Math.max(h,1),255),l[E[s]]=h}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var g=0;g<8;g++)c[f]=1/(o[E[f]]*d[p]*d[g]*8),u[f]=1/(l[E[f]]*d[p]*d[g]*8),f++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t)}this.encode=function(t,s){s&&F(s),g=new Array,m=0,v=7,O(65496),O(65504),O(16),N(74),N(70),N(73),N(70),N(0),N(1),N(1),N(0),O(1),O(1),N(0),N(0),function(){O(65499),O(132),N(0);for(var t=0;t<64;t++)N(o[t]);N(1);for(var e=0;e<64;e++)N(l[e])}(),function(t,e){O(65472),O(17),N(8),O(e),O(t),N(3),N(1),N(17),N(0),N(2),N(17),N(1),N(3),N(17),N(1)}(t.width,t.height),function(){O(65476),O(418),N(0);for(var t=0;t<16;t++)N(L[t+1]);for(var e=0;e<=11;e++)N(T[e]);N(16);for(var i=0;i<16;i++)N(A[i+1]);for(var n=0;n<=161;n++)N(_[n]);N(1);for(var r=0;r<16;r++)N(k[r+1]);for(var s=0;s<=11;s++)N(P[s]);N(17);for(var a=0;a<16;a++)N(R[a+1]);for(var o=0;o<=161;o++)N(I[o])}(),O(65498),O(12),N(3),N(1),N(0),N(2),N(17),N(3),N(17),N(0),N(63),N(0);var a=0,h=0,d=0;m=0,v=7,this.encode.displayName="_encode_";for(var f,p,w,E,C,B,U,j,$,z=t.data,H=t.width,q=t.height,G=4*H,V=0;V<q;){for(f=0;f<G;){for(C=G*V+f,U=-1,j=0,$=0;$<64;$++)B=C+(j=$>>3)*G+(U=4*(7&$)),V+j>=q&&(B-=G*(V+1+j-q)),f+U>=G&&(B-=f+U-G+4),p=z[B++],w=z[B++],E=z[B++],y[$]=(x[p]+x[w+256|0]+x[E+512|0]>>16)-128,b[$]=(x[p+768|0]+x[w+1024|0]+x[E+1280|0]>>16)-128,S[$]=(x[p+1280|0]+x[w+1536|0]+x[E+1792|0]>>16)-128;a=M(y,c,a,e,n),h=M(b,u,h,i,r),d=M(S,u,d,i,r),f+=32}V+=8}if(v>=0){var W=[];W[1]=v+1,W[0]=(1<<v+1)-1,D(W)}return O(65497),new Uint8Array(g)},t=t||50,function(){for(var t=String.fromCharCode,e=0;e<256;e++)w[e]=t(e)}(),e=C(L,T),i=C(k,P),n=C(A,_),r=C(R,I),function(){for(var t=1,e=2,i=1;i<=15;i++){for(var n=t;n<e;n++)d[32767+n]=i,h[32767+n]=[],h[32767+n][1]=i,h[32767+n][0]=n;for(var r=-(e-1);r<=-t;r++)d[32767+r]=i,h[32767+r]=[],h[32767+r][1]=i,h[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256|0]=38470*t,x[t+512|0]=7471*t+32768,x[t+768|0]=-11059*t,x[t+1024|0]=-21709*t,x[t+1280|0]=32768*t+8421375,x[t+1536|0]=-27439*t,x[t+1792|0]=-5329*t}(),F(t)}function bS(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function SS(t){function e(t){if(!t)throw Error("assert :P")}function i(t,e,i){for(var n=0;4>n;n++)if(t[e+n]!=i.charCodeAt(n))return!0;return!1}function n(t,e,i,n,r){for(var s=0;s<r;s++)t[e+s]=i[n+s]}function r(t,e,i,n){for(var r=0;r<n;r++)t[e+r]=i}function s(t){return new Int32Array(t)}function a(t,e){for(var i=[],n=0;n<t;n++)i.push(new e);return i}function o(t,e){var i=[];return function t(i,n,r){for(var s=r[n],a=0;a<s&&(i.push(r.length>n+1?[]:new e),!(r.length<n+1));a++)t(i[a],n+1,r)}(i,0,t),i}var l=function(){var t=this;function l(t,e){for(var i=1<<e-1>>>0;t&i;)i>>>=1;return i?(t&i-1)+i:t}function c(t,i,n,r,s){e(!(r%n));do{t[i+(r-=n)]=s}while(0<r)}function u(t,i,n,r,a){if(e(2328>=a),512>=a)var o=s(512);else if(null==(o=s(a)))return 0;return function(t,i,n,r,a,o){var u,d,f=i,p=1<<n,g=s(16),m=s(16);for(e(0!=a),e(null!=r),e(null!=t),e(0<n),d=0;d<a;++d){if(15<r[d])return 0;++g[r[d]]}if(g[0]==a)return 0;for(m[1]=0,u=1;15>u;++u){if(g[u]>1<<u)return 0;m[u+1]=m[u]+g[u]}for(d=0;d<a;++d)u=r[d],0<r[d]&&(o[m[u]++]=d);if(1==m[15])return(r=new h).g=0,r.value=o[0],c(t,f,1,p,r),p;var v,y=-1,b=p-1,S=0,w=1,x=1,E=1<<n;for(d=0,u=1,a=2;u<=n;++u,a<<=1){if(w+=x<<=1,0>(x-=g[u]))return 0;for(;0<g[u];--g[u])(r=new h).g=u,r.value=o[d++],c(t,f+S,a,E,r),S=l(S,u)}for(u=n+1,a=2;15>=u;++u,a<<=1){if(w+=x<<=1,0>(x-=g[u]))return 0;for(;0<g[u];--g[u]){if(r=new h,(S&b)!=y){for(f+=E,v=1<<(y=u)-n;15>y&&!(0>=(v-=g[y]));)++y,v<<=1;p+=E=1<<(v=y-n),t[i+(y=S&b)].g=v+n,t[i+y].value=f-i-y}r.g=u-n,r.value=o[d++],c(t,f+(S>>n),a,E,r),S=l(S,u)}}return w!=2*m[15]-1?0:p}(t,i,n,r,a,o)}function h(){this.value=this.g=0}function d(){this.value=this.g=0}function f(){this.G=a(5,h),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Bi,d)}function p(t,i,n,r){e(null!=t),e(null!=i),e(2147483648>r),t.Ca=254,t.I=0,t.b=-8,t.Ka=0,t.oa=i,t.pa=n,t.Jd=i,t.Yc=n+r,t.Zc=4<=r?n+r-4+1:n,A(t)}function g(t,e){for(var i=0;0<e--;)i|=k(t,128)<<e;return i}function m(t,e){var i=g(t,e);return _(t)?-i:i}function v(t,i,n,r){var s,a=0;for(e(null!=t),e(null!=i),e(4294967288>r),t.Sb=r,t.Ra=0,t.u=0,t.h=0,4<r&&(r=4),s=0;s<r;++s)a+=i[n+s]<<8*s;t.Ra=a,t.bb=r,t.oa=i,t.pa=n}function y(t){for(;8<=t.u&&t.bb<t.Sb;)t.Ra>>>=8,t.Ra+=t.oa[t.pa+t.bb]<<$i-8>>>0,++t.bb,t.u-=8;E(t)&&(t.h=1,t.u=0)}function b(t,i){if(e(0<=i),!t.h&&i<=ji){var n=x(t)&Ui[i];return t.u+=i,y(t),n}return t.h=1,t.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function x(t){return t.Ra>>>(t.u&$i-1)>>>0}function E(t){return e(t.bb<=t.Sb),t.h||t.bb==t.Sb&&t.u>$i}function L(t,e){t.u=e,t.h=E(t)}function T(t){t.u>=zi&&(e(t.u>=zi),y(t))}function A(t){e(null!=t&&null!=t.oa),t.pa<t.Zc?(t.I=(t.oa[t.pa++]|t.I<<8)>>>0,t.b+=8):(e(null!=t&&null!=t.oa),t.pa<t.Yc?(t.b+=8,t.I=t.oa[t.pa++]|t.I<<8):t.Ka?t.b=0:(t.I<<=8,t.b+=8,t.Ka=1))}function _(t){return g(t,1)}function k(t,e){var i=t.Ca;0>t.b&&A(t);var n=t.b,r=i*e>>>8,s=(t.I>>>n>r)+0;for(s?(i-=r,t.I-=r+1<<n>>>0):i=r+1,n=i,r=0;256<=n;)r+=8,n>>=8;return n=7^r+Hi[n],t.b-=n,t.Ca=(i<<n)-1,s}function P(t,e,i){t[e+0]=i>>24&255,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i}function R(t,e){return t[e+0]|t[e+1]<<8}function I(t,e){return R(t,e)|t[e+2]<<16}function C(t,e){return R(t,e)|R(t,e+2)<<16}function D(t,i){var n=1<<i;return e(null!=t),e(0<i),t.X=s(n),null==t.X?0:(t.Mb=32-i,t.Xa=i,1)}function N(t,i){e(null!=t),e(null!=i),e(t.Xa==i.Xa),n(i.X,0,t.X,0,1<<i.Xa)}function O(){this.X=[],this.Xa=this.Mb=0}function M(t,i,n,r){e(null!=n),e(null!=r);var s=n[0],a=r[0];return 0==s&&(s=(t*a+i/2)/i),0==a&&(a=(i*s+t/2)/t),0>=s||0>=a?0:(n[0]=s,r[0]=a,1)}function F(t,e){return t+(1<<e)-1>>>e}function B(t,e){return((4278255360&t)+(4278255360&e)>>>0&4278255360)+((16711935&t)+(16711935&e)>>>0&16711935)>>>0}function U(e,i){t[i]=function(i,n,r,s,a,o,l){var c;for(c=0;c<a;++c){var u=t[e](o[l+c-1],r,s+c);o[l+c]=B(i[n+c],u)}}}function j(){this.ud=this.hd=this.jd=0}function $(t,e){return((4278124286&(t^e))>>>1)+(t&e)>>>0}function z(t){return 0<=t&&256>t?t:0>t?0:255<t?255:void 0}function H(t,e){return z(t+(t-e+.5>>1))}function q(t,e,i){return Math.abs(e-i)-Math.abs(t-i)}function G(t,e,i,n,r,s,a){for(n=s[a-1],i=0;i<r;++i)s[a+i]=n=B(t[e+i],n)}function V(t,e,i,n,r){var s;for(s=0;s<i;++s){var a=t[e+s],o=a>>8&255,l=16711935&(l=(l=16711935&a)+((o<<16)+o));n[r+s]=(4278255360&a)+l>>>0}}function W(t,e){e.jd=255&t,e.hd=t>>8&255,e.ud=t>>16&255}function K(t,e,i,n,r,s){var a;for(a=0;a<n;++a){var o=e[i+a],l=o>>>8,c=o,u=255&(u=(u=o>>>16)+((t.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(t.hd<<24>>24)*(l<<24>>24)>>>5)+((t.ud<<24>>24)*(u<<24>>24)>>>5)),r[s+a]=(4278255360&o)+(u<<16)+c}}function Y(e,i,n,r,s){t[i]=function(t,e,i,n,a,o,l,c,u){for(n=l;n<c;++n)for(l=0;l<u;++l)a[o++]=s(i[r(t[e++])])},t[e]=function(e,i,a,o,l,c,u){var h=8>>e.b,d=e.Ea,f=e.K[0],p=e.w;if(8>h)for(e=(1<<e.b)-1,p=(1<<h)-1;i<a;++i){var g,m=0;for(g=0;g<d;++g)g&e||(m=r(o[l++])),c[u++]=s(f[m&p]),m>>=h}else t["VP8LMapColor"+n](o,l,f,p,c,u,i,a,d)}}function X(t,e,i,n,r){for(i=e+i;e<i;){var s=t[e++];n[r++]=s>>16&255,n[r++]=s>>8&255,n[r++]=255&s}}function Q(t,e,i,n,r){for(i=e+i;e<i;){var s=t[e++];n[r++]=s>>16&255,n[r++]=s>>8&255,n[r++]=255&s,n[r++]=s>>24&255}}function J(t,e,i,n,r){for(i=e+i;e<i;){var s=(a=t[e++])>>16&240|a>>12&15,a=240&a|a>>28&15;n[r++]=s,n[r++]=a}}function Z(t,e,i,n,r){for(i=e+i;e<i;){var s=(a=t[e++])>>16&248|a>>13&7,a=a>>5&224|a>>3&31;n[r++]=s,n[r++]=a}}function tt(t,e,i,n,r){for(i=e+i;e<i;){var s=t[e++];n[r++]=255&s,n[r++]=s>>8&255,n[r++]=s>>16&255}}function et(t,e,i,r,s,a){if(0==a)for(i=e+i;e<i;)P(r,((a=t[e++])[0]>>24|a[1]>>8&65280|a[2]<<8&16711680|a[3]<<24)>>>0),s+=32;else n(r,s,t,e,i)}function it(e,i){t[i][0]=t[e+"0"],t[i][1]=t[e+"1"],t[i][2]=t[e+"2"],t[i][3]=t[e+"3"],t[i][4]=t[e+"4"],t[i][5]=t[e+"5"],t[i][6]=t[e+"6"],t[i][7]=t[e+"7"],t[i][8]=t[e+"8"],t[i][9]=t[e+"9"],t[i][10]=t[e+"10"],t[i][11]=t[e+"11"],t[i][12]=t[e+"12"],t[i][13]=t[e+"13"],t[i][14]=t[e+"0"],t[i][15]=t[e+"0"]}function nt(t){return t==Hn||t==qn||t==Gn||t==Vn}function rt(){this.eb=[],this.size=this.A=this.fb=0}function st(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function at(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new rt,this.f.kb=new st,this.sd=null}function ot(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ct(t){return alert("todo:WebPSamplerProcessPlane"),t.T}function ut(t,e){var i=t.T,r=e.ba.f.RGBA,s=r.eb,a=r.fb+t.ka*r.A,o=vr[e.ba.S],l=t.y,c=t.O,u=t.f,h=t.N,d=t.ea,f=t.W,p=e.cc,g=e.dc,m=e.Mc,v=e.Nc,y=t.ka,b=t.ka+t.T,S=t.U,w=S+1>>1;for(0==y?o(l,c,null,null,u,h,d,f,u,h,d,f,s,a,null,null,S):(o(e.ec,e.fc,l,c,p,g,m,v,u,h,d,f,s,a-r.A,s,a,S),++i);y+2<b;y+=2)p=u,g=h,m=d,v=f,h+=t.Rc,f+=t.Rc,a+=2*r.A,o(l,(c+=2*t.fa)-t.fa,l,c,p,g,m,v,u,h,d,f,s,a-r.A,s,a,S);return c+=t.fa,t.j+b<t.o?(n(e.ec,e.fc,l,c,S),n(e.cc,e.dc,u,h,w),n(e.Mc,e.Nc,d,f,w),i--):1&b||o(l,c,null,null,u,h,d,f,u,h,d,f,s,a+r.A,null,null,S),i}function ht(t,i,n){var r=t.F,s=[t.J];if(null!=r){var a=t.U,o=i.ba.S,l=o==jn||o==Gn;i=i.ba.f.RGBA;var c=[0],u=t.ka;c[0]=t.T,t.Kb&&(0==u?--c[0]:(--u,s[0]-=t.width),t.j+t.ka+t.T==t.o&&(c[0]=t.o-t.j-u));var h=i.eb;u=i.fb+u*i.A,t=Tn(r,s[0],t.width,a,c,h,u+(l?0:3),i.A),e(n==c),t&&nt(o)&&En(h,u,l,a,c,i.A)}return 0}function dt(t){var e=t.ma,i=e.ba.S,n=11>i,r=i==Fn||i==Un||i==jn||i==$n||12==i||nt(i);if(e.memory=null,e.Ib=null,e.Jb=null,e.Nd=null,!Oi(e.Oa,t,r?11:12))return 0;if(r&&nt(i)&&yi(),t.da)alert("todo:use_scaling");else{if(n){if(e.Ib=ct,t.Kb){if(i=t.U+1>>1,e.memory=s(t.U+2*i),null==e.memory)return 0;e.ec=e.memory,e.fc=0,e.cc=e.ec,e.dc=e.fc+t.U,e.Mc=e.cc,e.Nc=e.dc+i,e.Ib=ut,yi()}}else alert("todo:EmitYUV");r&&(e.Jb=ht,n&&mi())}if(n&&!Ir){for(t=0;256>t;++t)Cr[t]=89858*(t-128)+Ar>>Tr,Or[t]=-22014*(t-128)+Ar,Nr[t]=-45773*(t-128),Dr[t]=113618*(t-128)+Ar>>Tr;for(t=_r;t<kr;++t)e=76283*(t-16)+Ar>>Tr,Mr[t-_r]=Gt(e,255),Fr[t-_r]=Gt(e+8>>4,15);Ir=1}return 1}function ft(t){var i=t.ma,n=t.U,r=t.T;return e(!(1&t.ka)),0>=n||0>=r?0:(n=i.Ib(t,i),null!=i.Jb&&i.Jb(t,i,n),i.Dc+=n,1)}function pt(t){t.ma.memory=null}function gt(t,e,i,n){return 47!=b(t,8)?0:(e[0]=b(t,14)+1,i[0]=b(t,14)+1,n[0]=b(t,1),0!=b(t,3)?0:!t.h)}function mt(t,e){if(4>t)return t+1;var i=t-2>>1;return(2+(1&t)<<i)+b(e,i)+1}function vt(t,e){return 120<e?e-120:1<=(i=((i=Jn[e-1])>>4)*t+(8-(15&i)))?i:1;var i}function yt(t,e,i){var n=x(i),r=t[e+=255&n].g-8;return 0<r&&(L(i,i.u+8),n=x(i),e+=t[e].value,e+=n&(1<<r)-1),L(i,i.u+t[e].g),t[e].value}function bt(t,i,n){return n.g+=t.g,n.value+=t.value<<i>>>0,e(8>=n.g),t.g}function St(t,i,n){var r=t.xc;return e((i=0==r?0:t.vc[t.md*(n>>r)+(i>>r)])<t.Wb),t.Ya[i]}function wt(t,i,r,s){var a=t.ab,o=t.c*i,l=t.C;i=l+i;var c=r,u=s;for(s=t.Ta,r=t.Ua;0<a--;){var h=t.gc[a],d=l,f=i,p=c,g=u,m=(u=s,c=r,h.Ea);switch(e(d<f),e(f<=h.nc),h.hc){case 2:Vi(p,g,(f-d)*m,u,c);break;case 0:var v=d,y=f,b=u,S=c,w=(A=h).Ea;0==v&&(qi(p,g,null,null,1,b,S),G(p,g+1,0,0,w-1,b,S+1),g+=w,S+=w,++v);for(var x=1<<A.b,E=x-1,L=F(w,A.b),T=A.K,A=A.w+(v>>A.b)*L;v<y;){var _=T,k=A,P=1;for(Gi(p,g,b,S-w,1,b,S);P<w;){var R=(P&~E)+x;R>w&&(R=w),(0,Qi[_[k++]>>8&15])(p,g+ +P,b,S+P-w,R-P,b,S+P),P=R}g+=w,S+=w,++v&E||(A+=L)}f!=h.nc&&n(u,c-m,u,c+(f-d-1)*m,m);break;case 1:for(m=p,y=g,w=(p=h.Ea)-(S=p&~(b=(g=1<<h.b)-1)),v=F(p,h.b),x=h.K,h=h.w+(d>>h.b)*v;d<f;){for(E=x,L=h,T=new j,A=y+S,_=y+p;y<A;)W(E[L++],T),Ji(T,m,y,g,u,c),y+=g,c+=g;y<_&&(W(E[L++],T),Ji(T,m,y,w,u,c),y+=w,c+=w),++d&b||(h+=v)}break;case 3:if(p==u&&g==c&&0<h.b){for(y=u,p=m=c+(f-d)*m-(S=(f-d)*F(h.Ea,h.b)),g=u,b=c,v=[],S=(w=S)-1;0<=S;--S)v[S]=g[b+S];for(S=w-1;0<=S;--S)y[p+S]=v[S];Wi(h,d,f,u,m,u,c)}else Wi(h,d,f,p,g,u,c)}c=s,u=r}u!=r&&n(s,r,c,u,o)}function xt(t,i){var n=t.V,r=t.Ba+t.c*t.C,s=i-t.C;if(e(i<=t.l.o),e(16>=s),0<s){var a=t.l,o=t.Ta,l=t.Ua,c=a.width;if(wt(t,s,n,r),s=l=[l],e((n=t.C)<(r=i)),e(a.v<a.va),r>a.o&&(r=a.o),n<a.j){var u=a.j-n;n=a.j,s[0]+=u*c}if(n>=r?n=0:(s[0]+=4*a.v,a.ka=n-a.j,a.U=a.va-a.v,a.T=r-n,n=1),n){if(l=l[0],11>(n=t.ca).S){var h=n.f.RGBA,d=(r=n.S,s=a.U,a=a.T,u=h.eb,h.A),f=a;for(h=h.fb+t.Ma*h.A;0<f--;){var p=o,g=l,m=s,v=u,y=h;switch(r){case Mn:Zi(p,g,m,v,y);break;case Fn:tn(p,g,m,v,y);break;case Hn:tn(p,g,m,v,y),En(v,y,0,m,1,0);break;case Bn:rn(p,g,m,v,y);break;case Un:et(p,g,m,v,y,1);break;case qn:et(p,g,m,v,y,1),En(v,y,0,m,1,0);break;case jn:et(p,g,m,v,y,0);break;case Gn:et(p,g,m,v,y,0),En(v,y,1,m,1,0);break;case $n:en(p,g,m,v,y);break;case Vn:en(p,g,m,v,y),Ln(v,y,m,1,0);break;case zn:nn(p,g,m,v,y);break;default:e(0)}l+=c,h+=d}t.Ma+=a}else alert("todo:EmitRescaledRowsYUVA");e(t.Ma<=n.height)}}t.C=i,e(t.C<=t.i)}function Et(t){var e;if(0<t.ua)return 0;for(e=0;e<t.Wb;++e){var i=t.Ya[e].G,n=t.Ya[e].H;if(0<i[1][n[1]+0].g||0<i[2][n[2]+0].g||0<i[3][n[3]+0].g)return 0}return 1}function Lt(t,i,n,r,s,a){if(0!=t.Z){var o=t.qd,l=t.rd;for(e(null!=mr[t.Z]);i<n;++i)mr[t.Z](o,l,r,s,r,s,a),o=r,l=s,s+=a;t.qd=o,t.rd=l}}function Tt(t,i){var n=t.l.ma,r=0==n.Z||1==n.Z?t.l.j:t.C;if(r=t.C<r?r:t.C,e(i<=t.l.o),i>r){var s=t.l.width,a=n.ca,o=n.tb+s*r,l=t.V,c=t.Ba+t.c*r,u=t.gc;e(1==t.ab),e(3==u[0].hc),Yi(u[0],r,i,l,c,a,o),Lt(n,r,i,a,o,s)}t.C=t.Ma=i}function At(t,i,n,r,s,a,o){var l=t.$/r,c=t.$%r,u=t.m,h=t.s,d=n+t.$,f=d;s=n+r*s;var p=n+r*a,g=280+h.ua,m=t.Pb?l:16777216,v=0<h.ua?h.Wa:null,y=h.wc,b=d<p?St(h,c,l):null;e(t.C<a),e(p<=s);var S=!1;t:for(;;){for(;S||d<p;){var w=0;if(l>=m){var A=d-n;e((m=t).Pb),m.wd=m.m,m.xd=A,0<m.s.ua&&N(m.s.Wa,m.s.vb),m=l+tr}if(c&y||(b=St(h,c,l)),e(null!=b),b.Qb&&(i[d]=b.qb,S=!0),!S)if(T(u),b.jc){w=u,A=i;var _=d,k=b.pd[x(w)&Bi-1];e(b.jc),256>k.g?(L(w,w.u+k.g),A[_]=k.value,w=0):(L(w,w.u+k.g-256),e(256<=k.value),w=k.value),0==w&&(S=!0)}else w=yt(b.G[0],b.H[0],u);if(u.h)break;if(S||256>w){if(!S)if(b.nd)i[d]=(b.qb|w<<8)>>>0;else{if(T(u),S=yt(b.G[1],b.H[1],u),T(u),A=yt(b.G[2],b.H[2],u),_=yt(b.G[3],b.H[3],u),u.h)break;i[d]=(_<<24|S<<16|w<<8|A)>>>0}if(S=!1,++d,++c>=r&&(c=0,++l,null!=o&&l<=a&&!(l%16)&&o(t,l),null!=v))for(;f<d;)w=i[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w}else if(280>w){if(w=mt(w-256,u),A=yt(b.G[4],b.H[4],u),T(u),A=vt(r,A=mt(A,u)),u.h)break;if(d-n<A||s-d<w)break t;for(_=0;_<w;++_)i[d+_]=i[d+_-A];for(d+=w,c+=w;c>=r;)c-=r,++l,null!=o&&l<=a&&!(l%16)&&o(t,l);if(e(d<=s),c&y&&(b=St(h,c,l)),null!=v)for(;f<d;)w=i[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w}else{if(!(w<g))break t;for(S=w-280,e(null!=v);f<d;)w=i[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w;w=d,e(!(S>>>(A=v).Xa)),i[w]=A.X[S],S=!0}S||e(u.h==E(u))}if(t.Pb&&u.h&&d<s)e(t.m.h),t.a=5,t.m=t.wd,t.$=t.xd,0<t.s.ua&&N(t.s.vb,t.s.Wa);else{if(u.h)break t;null!=o&&o(t,l>a?a:l),t.a=0,t.$=d-n}return 1}return t.a=3,0}function _t(t){e(null!=t),t.vc=null,t.yc=null,t.Ya=null;var i=t.Wa;null!=i&&(i.X=null),t.vb=null,e(null!=t)}function kt(){var e=new ai;return null==e?null:(e.a=0,e.xb=gr,it("Predictor","VP8LPredictors"),it("Predictor","VP8LPredictors_C"),it("PredictorAdd","VP8LPredictorsAdd"),it("PredictorAdd","VP8LPredictorsAdd_C"),Vi=V,Ji=K,Zi=X,tn=Q,en=J,nn=Z,rn=tt,t.VP8LMapColor32b=Ki,t.VP8LMapColor8b=Xi,e)}function Pt(t,i,n,o,l){var c=1,d=[t],p=[i],g=o.m,m=o.s,v=null,y=0;t:for(;;){if(n)for(;c&&b(g,1);){var S=d,w=p,E=o,A=1,_=E.m,k=E.gc[E.ab],P=b(_,2);if(E.Oc&1<<P)c=0;else{switch(E.Oc|=1<<P,k.hc=P,k.Ea=S[0],k.nc=w[0],k.K=[null],++E.ab,e(4>=E.ab),P){case 0:case 1:k.b=b(_,3)+2,A=Pt(F(k.Ea,k.b),F(k.nc,k.b),0,E,k.K),k.K=k.K[0];break;case 3:var R,I=b(_,8)+1,C=16<I?0:4<I?1:2<I?2:3;if(S[0]=F(k.Ea,C),k.b=C,R=A=Pt(I,1,0,E,k.K)){var N,O=I,M=k,U=1<<(8>>M.b),j=s(U);if(null==j)R=0;else{var $=M.K[0],z=M.w;for(j[0]=M.K[0][0],N=1;N<1*O;++N)j[N]=B($[z+N],j[N-1]);for(;N<4*U;++N)j[N]=0;M.K[0]=null,M.K[0]=j,R=1}}A=R;break;case 2:break;default:e(0)}c=A}}if(d=d[0],p=p[0],c&&b(g,1)&&!(c=1<=(y=b(g,4))&&11>=y)){o.a=3;break t}var H;if(H=c)e:{var q,G,V,W=o,K=d,Y=p,X=y,Q=n,J=W.m,Z=W.s,tt=[null],et=1,it=0,nt=Zn[X];i:for(;;){if(Q&&b(J,1)){var rt=b(J,3)+2,st=F(K,rt),at=F(Y,rt),ot=st*at;if(!Pt(st,at,0,W,tt))break i;for(tt=tt[0],Z.xc=rt,q=0;q<ot;++q){var lt=tt[q]>>8&65535;tt[q]=lt,lt>=et&&(et=lt+1)}}if(J.h)break i;for(G=0;5>G;++G){var ct=Yn[G];!G&&0<X&&(ct+=1<<X),it<ct&&(it=ct)}var ut=a(et*nt,h),ht=et,dt=a(ht,f);if(null==dt)var ft=null;else e(65536>=ht),ft=dt;var pt=s(it);if(null==ft||null==pt||null==ut){W.a=1;break i}var gt=ut;for(q=V=0;q<et;++q){var mt=ft[q],vt=mt.G,yt=mt.H,St=0,wt=1,xt=0;for(G=0;5>G;++G){ct=Yn[G],vt[G]=gt,yt[G]=V,!G&&0<X&&(ct+=1<<X);n:{var Et,Lt=ct,Tt=W,kt=pt,Rt=gt,It=V,Ct=0,Dt=Tt.m,Nt=b(Dt,1);if(r(kt,0,0,Lt),Nt){var Ot=b(Dt,1)+1,Mt=b(Dt,1),Ft=b(Dt,0==Mt?1:8);kt[Ft]=1,2==Ot&&(kt[Ft=b(Dt,8)]=1);var Bt=1}else{var Ut=s(19),jt=b(Dt,4)+4;if(19<jt){Tt.a=3;var $t=0;break n}for(Et=0;Et<jt;++Et)Ut[Qn[Et]]=b(Dt,3);var zt=void 0,Ht=void 0,qt=Tt,Gt=Ut,Vt=Lt,Wt=kt,Kt=0,Yt=qt.m,Xt=8,Qt=a(128,h);r:for(;u(Qt,0,7,Gt,19);){if(b(Yt,1)){var Jt=2+2*b(Yt,3);if((zt=2+b(Yt,Jt))>Vt)break r}else zt=Vt;for(Ht=0;Ht<Vt&&zt--;){T(Yt);var Zt=Qt[0+(127&x(Yt))];L(Yt,Yt.u+Zt.g);var te=Zt.value;if(16>te)Wt[Ht++]=te,0!=te&&(Xt=te);else{var ee=16==te,ie=te-16,ne=Kn[ie],re=b(Yt,Wn[ie])+ne;if(Ht+re>Vt)break r;for(var se=ee?Xt:0;0<re--;)Wt[Ht++]=se}}Kt=1;break r}Kt||(qt.a=3),Bt=Kt}(Bt=Bt&&!Dt.h)&&(Ct=u(Rt,It,8,kt,Lt)),Bt&&0!=Ct?$t=Ct:(Tt.a=3,$t=0)}if(0==$t)break i;if(wt&&1==Xn[G]&&(wt=0==gt[V].g),St+=gt[V].g,V+=$t,3>=G){var ae,oe=pt[0];for(ae=1;ae<ct;++ae)pt[ae]>oe&&(oe=pt[ae]);xt+=oe}}if(mt.nd=wt,mt.Qb=0,wt&&(mt.qb=(vt[3][yt[3]+0].value<<24|vt[1][yt[1]+0].value<<16|vt[2][yt[2]+0].value)>>>0,0==St&&256>vt[0][yt[0]+0].value&&(mt.Qb=1,mt.qb+=vt[0][yt[0]+0].value<<8)),mt.jc=!mt.Qb&&6>xt,mt.jc){var le,ce=mt;for(le=0;le<Bi;++le){var ue=le,he=ce.pd[ue],de=ce.G[0][ce.H[0]+ue];256<=de.value?(he.g=de.g+256,he.value=de.value):(he.g=0,he.value=0,ue>>=bt(de,8,he),ue>>=bt(ce.G[1][ce.H[1]+ue],16,he),ue>>=bt(ce.G[2][ce.H[2]+ue],0,he),bt(ce.G[3][ce.H[3]+ue],24,he))}}}Z.vc=tt,Z.Wb=et,Z.Ya=ft,Z.yc=ut,H=1;break e}H=0}if(!(c=H)){o.a=3;break t}if(0<y){if(m.ua=1<<y,!D(m.Wa,y)){o.a=1,c=0;break t}}else m.ua=0;var fe=o,pe=d,ge=p,me=fe.s,ve=me.xc;if(fe.c=pe,fe.i=ge,me.md=F(pe,ve),me.wc=0==ve?-1:(1<<ve)-1,n){o.xb=pr;break t}if(null==(v=s(d*p))){o.a=1,c=0;break t}c=(c=At(o,v,0,d,p,p,null))&&!g.h;break t}return c?(null!=l?l[0]=v:(e(null==v),e(n)),o.$=0,n||_t(m)):_t(m),c}function Rt(t,i){var n=t.c*t.i,r=n+i+16*i;return e(t.c<=i),t.V=s(r),null==t.V?(t.Ta=null,t.Ua=0,t.a=1,0):(t.Ta=t.V,t.Ua=t.Ba+n+i,1)}function It(t,i){var n=t.C,r=i-n,s=t.V,a=t.Ba+t.c*n;for(e(i<=t.l.o);0<r;){var o=16<r?16:r,l=t.l.ma,c=t.l.width,u=c*o,h=l.ca,d=l.tb+c*n,f=t.Ta,p=t.Ua;wt(t,o,s,a),An(f,p,h,d,u),Lt(l,n,n+o,h,d,c),r-=o,s+=o*t.c,n+=o}e(n==i),t.C=t.Ma=i}function Ct(){this.ub=this.yd=this.td=this.Rb=0}function Dt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ot(){this.Yb=function(){var t=[];return function t(e,i,n){for(var r=n[i],s=0;s<r&&(e.push(n.length>i+1?[]:0),!(n.length<i+1));s++)t(e[s],i+1,n)}(t,0,[3,11]),t}()}function Mt(){this.jb=s(3),this.Wc=o([4,8],Ot),this.Xc=o([4,17],Ot)}function Ft(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Bt(){this.ld=this.La=this.dd=this.tc=0}function Ut(){this.Na=this.la=0}function jt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function $t(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function zt(){this.uc=this.M=this.Nb=0,this.wa=Array(new Bt),this.Y=0,this.ya=Array(new $t),this.aa=0,this.l=new Vt}function Ht(){this.y=s(16),this.f=s(8),this.ea=s(8)}function qt(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new Ct,this.Kc=new Dt,this.ed=new Ft,this.Qa=new Nt,this.Ic=this.$c=this.Aa=0,this.D=new zt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,S),this.ia=0,this.pb=a(4,jt),this.Pa=new Mt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ht),this.Hd=0,this.rb=Array(new Ut),this.sb=0,this.wa=Array(new Bt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new $t),this.L=this.aa=0,this.gd=o([4,2],Bt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Gt(t,e){return 0>t?0:t>e?e:t}function Vt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wt(){var t=new qt;return null!=t&&(t.a=0,t.sc="OK",t.cb=0,t.Xb=0,nr||(nr=Qt)),t}function Kt(t,e,i){return 0==t.a&&(t.a=e,t.sc=i,t.cb=0),0}function Yt(t,e,i){return 3<=i&&157==t[e+0]&&1==t[e+1]&&42==t[e+2]}function Xt(t,i){if(null==t)return 0;if(t.a=0,t.sc="OK",null==i)return Kt(t,2,"null VP8Io passed to VP8GetHeaders()");var n=i.data,s=i.w,a=i.ha;if(4>a)return Kt(t,7,"Truncated header.");var o=n[s+0]|n[s+1]<<8|n[s+2]<<16,l=t.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return Kt(t,3,"Incorrect keyframe parameters.");if(!l.yd)return Kt(t,4,"Frame not displayable.");s+=3,a-=3;var c=t.Kc;if(l.Rb){if(7>a)return Kt(t,7,"cannot parse picture header");if(!Yt(n,s,a))return Kt(t,3,"Bad code word");c.c=16383&(n[s+4]<<8|n[s+3]),c.Td=n[s+4]>>6,c.i=16383&(n[s+6]<<8|n[s+5]),c.Ud=n[s+6]>>6,s+=7,a-=7,t.za=c.c+15>>4,t.Ub=c.i+15>>4,i.width=c.c,i.height=c.i,i.Da=0,i.j=0,i.v=0,i.va=i.width,i.o=i.height,i.da=0,i.ib=i.width,i.hb=i.height,i.U=i.width,i.T=i.height,r((o=t.Pa).jb,0,255,o.jb.length),e(null!=(o=t.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,r(o.Zb,0,0,o.Zb.length),r(o.Lb,0,0,o.Lb)}if(l.ub>a)return Kt(t,7,"bad partition length");p(o=t.m,n,s,l.ub),s+=l.ub,a-=l.ub,l.Rb&&(c.Ld=_(o),c.Kd=_(o)),c=t.Qa;var u,h=t.Pa;if(e(null!=o),e(null!=c),c.Cb=_(o),c.Cb){if(c.Bb=_(o),_(o)){for(c.Fb=_(o),u=0;4>u;++u)c.Zb[u]=_(o)?m(o,7):0;for(u=0;4>u;++u)c.Lb[u]=_(o)?m(o,6):0}if(c.Bb)for(u=0;3>u;++u)h.jb[u]=_(o)?g(o,8):255}else c.Bb=0;if(o.Ka)return Kt(t,3,"cannot parse segment header");if((c=t.ed).zd=_(o),c.Tb=g(o,6),c.wb=g(o,3),c.Pc=_(o),c.Pc&&_(o)){for(h=0;4>h;++h)_(o)&&(c.vd[h]=m(o,6));for(h=0;4>h;++h)_(o)&&(c.od[h]=m(o,6))}if(t.L=0==c.Tb?0:c.zd?1:2,o.Ka)return Kt(t,3,"cannot parse filter header");var d=a;if(a=u=s,s=u+d,c=d,t.Xb=(1<<g(t.m,2))-1,d<3*(h=t.Xb))n=7;else{for(u+=3*h,c-=3*h,d=0;d<h;++d){var f=n[a+0]|n[a+1]<<8|n[a+2]<<16;f>c&&(f=c),p(t.Jc[+d],n,u,f),u+=f,c-=f,a+=3}p(t.Jc[+h],n,u,c),n=u<s?0:5}if(0!=n)return Kt(t,n,"cannot parse partitions");for(n=g(u=t.m,7),a=_(u)?m(u,4):0,s=_(u)?m(u,4):0,c=_(u)?m(u,4):0,h=_(u)?m(u,4):0,u=_(u)?m(u,4):0,d=t.Qa,f=0;4>f;++f){if(d.Cb){var v=d.Zb[f];d.Fb||(v+=n)}else{if(0<f){t.pb[f]=t.pb[0];continue}v=n}var y=t.pb[f];y.Sc[0]=er[Gt(v+a,127)],y.Sc[1]=ir[Gt(v+0,127)],y.Eb[0]=2*er[Gt(v+s,127)],y.Eb[1]=101581*ir[Gt(v+c,127)]>>16,8>y.Eb[1]&&(y.Eb[1]=8),y.Qc[0]=er[Gt(v+h,117)],y.Qc[1]=ir[Gt(v+u,127)],y.lc=v+u}if(!l.Rb)return Kt(t,4,"Not a key frame.");for(_(o),l=t.Pa,n=0;4>n;++n){for(a=0;8>a;++a)for(s=0;3>s;++s)for(c=0;11>c;++c)h=k(o,cr[n][a][s][c])?g(o,8):or[n][a][s][c],l.Wc[n][a].Yb[s][c]=h;for(a=0;17>a;++a)l.Xc[n][a]=l.Wc[n][ur[a]]}return t.kc=_(o),t.kc&&(t.Bd=g(o,8)),t.cb=1}function Qt(t,e,i,n,r,s,a){var o=e[r].Yb[i];for(i=0;16>r;++r){if(!k(t,o[i+0]))return r;for(;!k(t,o[i+1]);)if(o=e[++r].Yb[0],i=0,16==r)return 16;var l=e[r+1].Yb;if(k(t,o[i+2])){var c=t,u=0;if(k(c,(d=o)[(h=i)+3]))if(k(c,d[h+6])){for(o=0,h=2*(u=k(c,d[h+8]))+(d=k(c,d[h+9+u])),u=0,d=rr[h];d[o];++o)u+=u+k(c,d[o]);u+=3+(8<<h)}else k(c,d[h+7])?(u=7+2*k(c,165),u+=k(c,145)):u=5+k(c,159);else u=k(c,d[h+4])?3+k(c,d[h+5]):2;o=l[2]}else u=1,o=l[1];l=a+sr[r],0>(c=t).b&&A(c);var h,d=c.b,f=(h=c.Ca>>1)-(c.I>>d)>>31;--c.b,c.Ca+=f,c.Ca|=1,c.I-=(h+1&f)<<d,s[l]=((u^f)-f)*n[(0<r)+0]}return 16}function Jt(t){var e=t.rb[t.sb-1];e.la=0,e.Na=0,r(t.zc,0,0,t.zc.length),t.ja=0}function Zt(t,i){if(null==t)return 0;if(null==i)return Kt(t,2,"NULL VP8Io parameter in VP8Decode().");if(!t.cb&&!Xt(t,i))return 0;if(e(t.cb),null==i.ac||i.ac(i)){i.ob&&(t.L=0);var o=Ur[t.L];if(2==t.L?(t.yb=0,t.zb=0):(t.yb=i.v-o>>4,t.zb=i.j-o>>4,0>t.yb&&(t.yb=0),0>t.zb&&(t.zb=0)),t.Va=i.o+15+o>>4,t.Hb=i.va+15+o>>4,t.Hb>t.za&&(t.Hb=t.za),t.Va>t.Ub&&(t.Va=t.Ub),0<t.L){var l=t.ed;for(o=0;4>o;++o){var c;if(t.Qa.Cb){var u=t.Qa.Lb[o];t.Qa.Fb||(u+=l.Tb)}else u=l.Tb;for(c=0;1>=c;++c){var h=t.gd[o][c],d=u;if(l.Pc&&(d+=l.vd[0],c&&(d+=l.od[0])),0<(d=0>d?0:63<d?63:d)){var f=d;0<l.wb&&(f=4<l.wb?f>>2:f>>1)>9-l.wb&&(f=9-l.wb),1>f&&(f=1),h.dd=f,h.tc=2*d+f,h.ld=40<=d?2:15<=d?1:0}else h.tc=0;h.La=c}}}o=0}else Kt(t,6,"Frame setup failed"),o=t.a;if(o=0==o){if(o){t.$c=0,0<t.Aa||(t.Ic=$r);t:{o=t.Ic,l=4*(f=t.za);var p=32*f,g=f+1,m=0<t.L?f*(0<t.Aa?2:1):0,v=(2==t.Aa?2:1)*f;if((h=l+832+(c=3*(16*o+Ur[t.L])/2*p)+(u=null!=t.Fa&&0<t.Fa.length?t.Kc.c*t.Kc.i:0))!=h)o=0;else{if(h>t.Vb){if(t.Vb=0,t.Ec=s(h),t.Fc=0,null==t.Ec){o=Kt(t,1,"no memory during frame initialization.");break t}t.Vb=h}h=t.Ec,d=t.Fc,t.Ac=h,t.Bc=d,d+=l,t.Gd=a(p,Ht),t.Hd=0,t.rb=a(g+1,Ut),t.sb=1,t.wa=m?a(m,Bt):null,t.Y=0,t.D.Nb=0,t.D.wa=t.wa,t.D.Y=t.Y,0<t.Aa&&(t.D.Y+=f),e(!0),t.oc=h,t.pc=d,d+=832,t.ya=a(v,$t),t.aa=0,t.D.ya=t.ya,t.D.aa=t.aa,2==t.Aa&&(t.D.aa+=f),t.R=16*f,t.B=8*f,f=(p=Ur[t.L])*t.R,p=p/2*t.B,t.sa=h,t.ta=d+f,t.qa=t.sa,t.ra=t.ta+16*o*t.R+p,t.Ha=t.qa,t.Ia=t.ra+8*o*t.B+p,t.$c=0,d+=c,t.mb=u?h:null,t.nb=u?d:null,e(d+u<=t.Fc+t.Vb),Jt(t),r(t.Ac,t.Bc,0,l),o=1}}if(o){if(i.ka=0,i.y=t.sa,i.O=t.ta,i.f=t.qa,i.N=t.ra,i.ea=t.Ha,i.Vd=t.Ia,i.fa=t.R,i.Rc=t.B,i.F=null,i.J=0,!In){for(o=-255;255>=o;++o)_n[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)kn[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)Pn[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Rn[255+o]=0>o?0:255<o?255:o;In=1}sn=ce,an=se,ln=ae,cn=oe,un=le,on=re,hn=Ke,dn=Ye,fn=Je,pn=Ze,gn=Xe,mn=Qe,vn=ti,yn=ei,bn=ze,Sn=He,wn=qe,xn=Ge,dr[0]=Le,dr[1]=he,dr[2]=xe,dr[3]=Ee,dr[4]=Te,dr[5]=_e,dr[6]=Ae,dr[7]=ke,dr[8]=Re,dr[9]=Pe,hr[0]=ve,hr[1]=fe,hr[2]=pe,hr[3]=ge,hr[4]=ye,hr[5]=be,hr[6]=Se,fr[0]=Ne,fr[1]=de,fr[2]=Ie,fr[3]=Ce,fr[4]=Me,fr[5]=Oe,fr[6]=Fe,o=1}else o=0}o&&(o=function(t,i){for(t.M=0;t.M<t.Va;++t.M){var a,o=t.Jc[t.M&t.Xb],l=t.m,c=t;for(a=0;a<c.za;++a){var u=l,h=c,d=h.Ac,f=h.Bc+4*a,p=h.zc,g=h.ya[h.aa+a];if(h.Qa.Bb?g.$b=k(u,h.Pa.jb[0])?2+k(u,h.Pa.jb[2]):k(u,h.Pa.jb[1]):g.$b=0,h.kc&&(g.Ad=k(u,h.Bd)),g.Za=!k(u,145)+0,g.Za){var m=g.Ob,v=0;for(h=0;4>h;++h){var y,b=p[0+h];for(y=0;4>y;++y){b=lr[d[f+y]][b];for(var S=ar[k(u,b[0])];0<S;)S=ar[2*S+k(u,b[S])];b=-S,d[f+y]=b}n(m,v,d,f,4),v+=4,p[0+h]=b}}else b=k(u,156)?k(u,128)?1:3:k(u,163)?2:0,g.Ob[0]=b,r(d,f,b,4),r(p,0,b,4);g.Dd=k(u,142)?k(u,114)?k(u,183)?1:3:2:0}if(c.m.Ka)return Kt(t,7,"Premature end-of-partition0 encountered.");for(;t.ja<t.za;++t.ja){if(c=o,u=(l=t).rb[l.sb-1],d=l.rb[l.sb+l.ja],a=l.ya[l.aa+l.ja],f=l.kc?a.Ad:0)u.la=d.la=0,a.Za||(u.Na=d.Na=0),a.Hc=0,a.Gc=0,a.ia=0;else{var w,x;if(u=d,d=c,f=l.Pa.Xc,p=l.ya[l.aa+l.ja],g=l.pb[p.$b],h=p.ad,m=0,v=l.rb[l.sb-1],b=y=0,r(h,m,0,384),p.Za)var E=0,L=f[3];else{S=s(16);var T=u.Na+v.Na;if(T=nr(d,f[1],T,g.Eb,0,S,0),u.Na=v.Na=(0<T)+0,1<T)sn(S,0,h,m);else{var A=S[0]+3>>3;for(S=0;256>S;S+=16)h[m+S]=A}E=1,L=f[0]}var _=15&u.la,P=15&v.la;for(S=0;4>S;++S){var R=1&P;for(A=x=0;4>A;++A)_=_>>1|(R=(T=nr(d,L,T=R+(1&_),g.Sc,E,h,m))>E)<<7,x=x<<2|(3<T?3:1<T?2:0!=h[m+0]),m+=16;_>>=4,P=P>>1|R<<7,y=(y<<8|x)>>>0}for(L=_,E=P>>4,w=0;4>w;w+=2){for(x=0,_=u.la>>4+w,P=v.la>>4+w,S=0;2>S;++S){for(R=1&P,A=0;2>A;++A)T=R+(1&_),_=_>>1|(R=0<(T=nr(d,f[2],T,g.Qc,0,h,m)))<<3,x=x<<2|(3<T?3:1<T?2:0!=h[m+0]),m+=16;_>>=2,P=P>>1|R<<5}b|=x<<4*w,L|=_<<4<<w,E|=(240&P)<<w}u.la=L,v.la=E,p.Hc=y,p.Gc=b,p.ia=43690&b?0:g.ia,f=!(y|b)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[a.$b][a.Za],l.wa[l.Y+l.ja].La|=!f),c.Ka)return Kt(t,7,"Premature end-of-file encountered.")}if(Jt(t),l=i,c=1,a=(o=t).D,u=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)t:{if(a.M=o.M,a.uc=u,Di(o,a),c=1,a=(x=o.D).Nb,u=(b=Ur[o.L])*o.R,d=b/2*o.B,S=16*a*o.R,A=8*a*o.B,f=o.sa,p=o.ta-u+S,g=o.qa,h=o.ra-d+A,m=o.Ha,v=o.Ia-d+A,P=0==(_=x.M),y=_>=o.Va-1,2==o.Aa&&Di(o,x),x.uc)for(R=(T=o).D.M,e(T.D.uc),x=T.yb;x<T.Hb;++x){E=x,L=R;var I=(C=($=T).D).Nb;w=$.R;var C=C.wa[C.Y+E],D=$.sa,N=$.ta+16*I*w+16*E,O=C.dd,M=C.tc;if(0!=M)if(e(3<=M),1==$.L)0<E&&Sn(D,N,w,M+4),C.La&&xn(D,N,w,M),0<L&&bn(D,N,w,M+4),C.La&&wn(D,N,w,M);else{var F=$.B,B=$.qa,U=$.ra+8*I*F+8*E,j=$.Ha,$=$.Ia+8*I*F+8*E;I=C.ld,0<E&&(dn(D,N,w,M+4,O,I),pn(B,U,j,$,F,M+4,O,I)),C.La&&(mn(D,N,w,M,O,I),yn(B,U,j,$,F,M,O,I)),0<L&&(hn(D,N,w,M+4,O,I),fn(B,U,j,$,F,M+4,O,I)),C.La&&(gn(D,N,w,M,O,I),vn(B,U,j,$,F,M,O,I))}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(x=16*_,_=16*(_+1),P?(l.y=o.sa,l.O=o.ta+S,l.f=o.qa,l.N=o.ra+A,l.ea=o.Ha,l.W=o.Ia+A):(x-=b,l.y=f,l.O=p,l.f=g,l.N=h,l.ea=m,l.W=v),y||(_-=b),_>l.o&&(_=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&x<_&&(l.J=hi(o,l,x,_-x),l.F=o.mb,null==l.F&&0==l.F.length)){c=Kt(o,3,"Could not decode alpha data.");break t}x<l.j&&(b=l.j-x,x=l.j,e(!(1&b)),l.O+=o.R*b,l.N+=o.B*(b>>1),l.W+=o.B*(b>>1),null!=l.F&&(l.J+=l.width*b)),x<_&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=x-l.j,l.U=l.va-l.v,l.T=_-x,c=l.put(l))}a+1!=o.Ic||y||(n(o.sa,o.ta-u,f,p+16*o.R,u),n(o.qa,o.ra-d,g,h+8*o.B,d),n(o.Ha,o.Ia-d,m,v+8*o.B,d))}if(!c)return Kt(t,6,"Output aborted.")}return 1}(t,i)),null!=i.bc&&i.bc(i),o&=1}return o?(t.cb=0,o):0}function te(t,e,i,n,r){r=t[e+i+32*n]+(r>>3),t[e+i+32*n]=-256&r?0>r?0:255:r}function ee(t,e,i,n,r,s){te(t,e,0,i,n+r),te(t,e,1,i,n+s),te(t,e,2,i,n-s),te(t,e,3,i,n-r)}function ie(t){return(20091*t>>16)+t}function ne(t,e,i,n){var r,a=0,o=s(16);for(r=0;4>r;++r){var l=t[e+0]+t[e+8],c=t[e+0]-t[e+8],u=(35468*t[e+4]>>16)-ie(t[e+12]),h=ie(t[e+4])+(35468*t[e+12]>>16);o[a+0]=l+h,o[a+1]=c+u,o[a+2]=c-u,o[a+3]=l-h,a+=4,e++}for(r=a=0;4>r;++r)l=(t=o[a+0]+4)+o[a+8],c=t-o[a+8],u=(35468*o[a+4]>>16)-ie(o[a+12]),te(i,n,0,0,l+(h=ie(o[a+4])+(35468*o[a+12]>>16))),te(i,n,1,0,c+u),te(i,n,2,0,c-u),te(i,n,3,0,l-h),a++,n+=32}function re(t,e,i,n){var r=t[e+0]+4,s=35468*t[e+4]>>16,a=ie(t[e+4]),o=35468*t[e+1]>>16;ee(i,n,0,r+a,t=ie(t[e+1]),o),ee(i,n,1,r+s,t,o),ee(i,n,2,r-s,t,o),ee(i,n,3,r-a,t,o)}function se(t,e,i,n,r){ne(t,e,i,n),r&&ne(t,e+16,i,n+4)}function ae(t,e,i,n){an(t,e+0,i,n,1),an(t,e+32,i,n+128,1)}function oe(t,e,i,n){var r;for(t=t[e+0]+4,r=0;4>r;++r)for(e=0;4>e;++e)te(i,n,e,r,t)}function le(t,e,i,n){t[e+0]&&cn(t,e+0,i,n),t[e+16]&&cn(t,e+16,i,n+4),t[e+32]&&cn(t,e+32,i,n+128),t[e+48]&&cn(t,e+48,i,n+128+4)}function ce(t,e,i,n){var r,a=s(16);for(r=0;4>r;++r){var o=t[e+0+r]+t[e+12+r],l=t[e+4+r]+t[e+8+r],c=t[e+4+r]-t[e+8+r],u=t[e+0+r]-t[e+12+r];a[0+r]=o+l,a[8+r]=o-l,a[4+r]=u+c,a[12+r]=u-c}for(r=0;4>r;++r)o=(t=a[0+4*r]+3)+a[3+4*r],l=a[1+4*r]+a[2+4*r],c=a[1+4*r]-a[2+4*r],u=t-a[3+4*r],i[n+0]=o+l>>3,i[n+16]=u+c>>3,i[n+32]=o-l>>3,i[n+48]=u-c>>3,n+=64}function ue(t,e,i){var n,r=e-32,s=Nn,a=255-t[r-1];for(n=0;n<i;++n){var o,l=s,c=a+t[e-1];for(o=0;o<i;++o)t[e+o]=l[c+t[r+o]];e+=32}}function he(t,e){ue(t,e,4)}function de(t,e){ue(t,e,8)}function fe(t,e){ue(t,e,16)}function pe(t,e){var i;for(i=0;16>i;++i)n(t,e+32*i,t,e-32,16)}function ge(t,e){var i;for(i=16;0<i;--i)r(t,e,t[e-1],16),e+=32}function me(t,e,i){var n;for(n=0;16>n;++n)r(e,i+32*n,t,16)}function ve(t,e){var i,n=16;for(i=0;16>i;++i)n+=t[e-1+32*i]+t[e+i-32];me(n>>5,t,e)}function ye(t,e){var i,n=8;for(i=0;16>i;++i)n+=t[e-1+32*i];me(n>>4,t,e)}function be(t,e){var i,n=8;for(i=0;16>i;++i)n+=t[e+i-32];me(n>>4,t,e)}function Se(t,e){me(128,t,e)}function we(t,e,i){return t+2*e+i+2>>2}function xe(t,e){var i,r=e-32;for(r=new Uint8Array([we(t[r-1],t[r+0],t[r+1]),we(t[r+0],t[r+1],t[r+2]),we(t[r+1],t[r+2],t[r+3]),we(t[r+2],t[r+3],t[r+4])]),i=0;4>i;++i)n(t,e+32*i,r,0,r.length)}function Ee(t,e){var i=t[e-1],n=t[e-1+32],r=t[e-1+64],s=t[e-1+96];P(t,e+0,16843009*we(t[e-1-32],i,n)),P(t,e+32,16843009*we(i,n,r)),P(t,e+64,16843009*we(n,r,s)),P(t,e+96,16843009*we(r,s,s))}function Le(t,e){var i,n=4;for(i=0;4>i;++i)n+=t[e+i-32]+t[e-1+32*i];for(n>>=3,i=0;4>i;++i)r(t,e+32*i,n,4)}function Te(t,e){var i=t[e-1+0],n=t[e-1+32],r=t[e-1+64],s=t[e-1-32],a=t[e+0-32],o=t[e+1-32],l=t[e+2-32],c=t[e+3-32];t[e+0+96]=we(n,r,t[e-1+96]),t[e+1+96]=t[e+0+64]=we(i,n,r),t[e+2+96]=t[e+1+64]=t[e+0+32]=we(s,i,n),t[e+3+96]=t[e+2+64]=t[e+1+32]=t[e+0+0]=we(a,s,i),t[e+3+64]=t[e+2+32]=t[e+1+0]=we(o,a,s),t[e+3+32]=t[e+2+0]=we(l,o,a),t[e+3+0]=we(c,l,o)}function Ae(t,e){var i=t[e+1-32],n=t[e+2-32],r=t[e+3-32],s=t[e+4-32],a=t[e+5-32],o=t[e+6-32],l=t[e+7-32];t[e+0+0]=we(t[e+0-32],i,n),t[e+1+0]=t[e+0+32]=we(i,n,r),t[e+2+0]=t[e+1+32]=t[e+0+64]=we(n,r,s),t[e+3+0]=t[e+2+32]=t[e+1+64]=t[e+0+96]=we(r,s,a),t[e+3+32]=t[e+2+64]=t[e+1+96]=we(s,a,o),t[e+3+64]=t[e+2+96]=we(a,o,l),t[e+3+96]=we(o,l,l)}function _e(t,e){var i=t[e-1+0],n=t[e-1+32],r=t[e-1+64],s=t[e-1-32],a=t[e+0-32],o=t[e+1-32],l=t[e+2-32],c=t[e+3-32];t[e+0+0]=t[e+1+64]=s+a+1>>1,t[e+1+0]=t[e+2+64]=a+o+1>>1,t[e+2+0]=t[e+3+64]=o+l+1>>1,t[e+3+0]=l+c+1>>1,t[e+0+96]=we(r,n,i),t[e+0+64]=we(n,i,s),t[e+0+32]=t[e+1+96]=we(i,s,a),t[e+1+32]=t[e+2+96]=we(s,a,o),t[e+2+32]=t[e+3+96]=we(a,o,l),t[e+3+32]=we(o,l,c)}function ke(t,e){var i=t[e+0-32],n=t[e+1-32],r=t[e+2-32],s=t[e+3-32],a=t[e+4-32],o=t[e+5-32],l=t[e+6-32],c=t[e+7-32];t[e+0+0]=i+n+1>>1,t[e+1+0]=t[e+0+64]=n+r+1>>1,t[e+2+0]=t[e+1+64]=r+s+1>>1,t[e+3+0]=t[e+2+64]=s+a+1>>1,t[e+0+32]=we(i,n,r),t[e+1+32]=t[e+0+96]=we(n,r,s),t[e+2+32]=t[e+1+96]=we(r,s,a),t[e+3+32]=t[e+2+96]=we(s,a,o),t[e+3+64]=we(a,o,l),t[e+3+96]=we(o,l,c)}function Pe(t,e){var i=t[e-1+0],n=t[e-1+32],r=t[e-1+64],s=t[e-1+96];t[e+0+0]=i+n+1>>1,t[e+2+0]=t[e+0+32]=n+r+1>>1,t[e+2+32]=t[e+0+64]=r+s+1>>1,t[e+1+0]=we(i,n,r),t[e+3+0]=t[e+1+32]=we(n,r,s),t[e+3+32]=t[e+1+64]=we(r,s,s),t[e+3+64]=t[e+2+64]=t[e+0+96]=t[e+1+96]=t[e+2+96]=t[e+3+96]=s}function Re(t,e){var i=t[e-1+0],n=t[e-1+32],r=t[e-1+64],s=t[e-1+96],a=t[e-1-32],o=t[e+0-32],l=t[e+1-32],c=t[e+2-32];t[e+0+0]=t[e+2+32]=i+a+1>>1,t[e+0+32]=t[e+2+64]=n+i+1>>1,t[e+0+64]=t[e+2+96]=r+n+1>>1,t[e+0+96]=s+r+1>>1,t[e+3+0]=we(o,l,c),t[e+2+0]=we(a,o,l),t[e+1+0]=t[e+3+32]=we(i,a,o),t[e+1+32]=t[e+3+64]=we(n,i,a),t[e+1+64]=t[e+3+96]=we(r,n,i),t[e+1+96]=we(s,r,n)}function Ie(t,e){var i;for(i=0;8>i;++i)n(t,e+32*i,t,e-32,8)}function Ce(t,e){var i;for(i=0;8>i;++i)r(t,e,t[e-1],8),e+=32}function De(t,e,i){var n;for(n=0;8>n;++n)r(e,i+32*n,t,8)}function Ne(t,e){var i,n=8;for(i=0;8>i;++i)n+=t[e+i-32]+t[e-1+32*i];De(n>>4,t,e)}function Oe(t,e){var i,n=4;for(i=0;8>i;++i)n+=t[e+i-32];De(n>>3,t,e)}function Me(t,e){var i,n=4;for(i=0;8>i;++i)n+=t[e-1+32*i];De(n>>3,t,e)}function Fe(t,e){De(128,t,e)}function Be(t,e,i){var n=t[e-i],r=t[e+0],s=3*(r-n)+Cn[1020+t[e-2*i]-t[e+i]],a=Dn[112+(s+4>>3)];t[e-i]=Nn[255+n+Dn[112+(s+3>>3)]],t[e+0]=Nn[255+r-a]}function Ue(t,e,i,n){var r=t[e+0],s=t[e+i];return On[255+t[e-2*i]-t[e-i]]>n||On[255+s-r]>n}function je(t,e,i,n){return 4*On[255+t[e-i]-t[e+0]]+On[255+t[e-2*i]-t[e+i]]<=n}function $e(t,e,i,n,r){var s=t[e-3*i],a=t[e-2*i],o=t[e-i],l=t[e+0],c=t[e+i],u=t[e+2*i],h=t[e+3*i];return 4*On[255+o-l]+On[255+a-c]>n?0:On[255+t[e-4*i]-s]<=r&&On[255+s-a]<=r&&On[255+a-o]<=r&&On[255+h-u]<=r&&On[255+u-c]<=r&&On[255+c-l]<=r}function ze(t,e,i,n){var r=2*n+1;for(n=0;16>n;++n)je(t,e+n,i,r)&&Be(t,e+n,i)}function He(t,e,i,n){var r=2*n+1;for(n=0;16>n;++n)je(t,e+n*i,1,r)&&Be(t,e+n*i,1)}function qe(t,e,i,n){var r;for(r=3;0<r;--r)ze(t,e+=4*i,i,n)}function Ge(t,e,i,n){var r;for(r=3;0<r;--r)He(t,e+=4,i,n)}function Ve(t,e,i,n,r,s,a,o){for(s=2*s+1;0<r--;){if($e(t,e,i,s,a))if(Ue(t,e,i,o))Be(t,e,i);else{var l=t,c=e,u=i,h=l[c-2*u],d=l[c-u],f=l[c+0],p=l[c+u],g=l[c+2*u],m=27*(y=Cn[1020+3*(f-d)+Cn[1020+h-p]])+63>>7,v=18*y+63>>7,y=9*y+63>>7;l[c-3*u]=Nn[255+l[c-3*u]+y],l[c-2*u]=Nn[255+h+v],l[c-u]=Nn[255+d+m],l[c+0]=Nn[255+f-m],l[c+u]=Nn[255+p-v],l[c+2*u]=Nn[255+g-y]}e+=n}}function We(t,e,i,n,r,s,a,o){for(s=2*s+1;0<r--;){if($e(t,e,i,s,a))if(Ue(t,e,i,o))Be(t,e,i);else{var l=t,c=e,u=i,h=l[c-u],d=l[c+0],f=l[c+u],p=Dn[112+(4+(g=3*(d-h))>>3)],g=Dn[112+(g+3>>3)],m=p+1>>1;l[c-2*u]=Nn[255+l[c-2*u]+m],l[c-u]=Nn[255+h+g],l[c+0]=Nn[255+d-p],l[c+u]=Nn[255+f-m]}e+=n}}function Ke(t,e,i,n,r,s){Ve(t,e,i,1,16,n,r,s)}function Ye(t,e,i,n,r,s){Ve(t,e,1,i,16,n,r,s)}function Xe(t,e,i,n,r,s){var a;for(a=3;0<a;--a)We(t,e+=4*i,i,1,16,n,r,s)}function Qe(t,e,i,n,r,s){var a;for(a=3;0<a;--a)We(t,e+=4,1,i,16,n,r,s)}function Je(t,e,i,n,r,s,a,o){Ve(t,e,r,1,8,s,a,o),Ve(i,n,r,1,8,s,a,o)}function Ze(t,e,i,n,r,s,a,o){Ve(t,e,1,r,8,s,a,o),Ve(i,n,1,r,8,s,a,o)}function ti(t,e,i,n,r,s,a,o){We(t,e+4*r,r,1,8,s,a,o),We(i,n+4*r,r,1,8,s,a,o)}function ei(t,e,i,n,r,s,a,o){We(t,e+4,1,r,8,s,a,o),We(i,n+4,1,r,8,s,a,o)}function ii(){this.ba=new at,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ni(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ri(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function si(){this.ua=0,this.Wa=new O,this.vb=new O,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new f,this.yc=new h}function ai(){this.xb=this.a=0,this.l=new Vt,this.ca=new at,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new si,this.ab=0,this.gc=a(4,ri),this.Oc=0}function oi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Vt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function li(t,e,i,n,r,s,a){for(t=null==t?0:t[e+0],e=0;e<a;++e)r[s+e]=t+i[n+e]&255,t=r[s+e]}function ci(t,e,i,n,r,s,a){var o;if(null==t)li(null,null,i,n,r,s,a);else for(o=0;o<a;++o)r[s+o]=t[e+o]+i[n+o]&255}function ui(t,e,i,n,r,s,a){if(null==t)li(null,null,i,n,r,s,a);else{var o,l=t[e+0],c=l,u=l;for(o=0;o<a;++o)c=u+(l=t[e+o])-c,u=i[n+o]+(-256&c?0>c?0:255:c)&255,c=l,r[s+o]=u}}function hi(t,i,r,a){var o=i.width,l=i.o;if(e(null!=t&&null!=i),0>r||0>=a||r+a>l)return null;if(!t.Cc){if(null==t.ga){var c;if(t.ga=new oi,(c=null==t.ga)||(c=i.width*i.o,e(0==t.Gb.length),t.Gb=s(c),t.Uc=0,null==t.Gb?c=0:(t.mb=t.Gb,t.nb=t.Uc,t.rc=null,c=1),c=!c),!c){c=t.ga;var u=t.Fa,h=t.P,d=t.qc,f=t.mb,p=t.nb,g=h+1,m=d-1,y=c.l;if(e(null!=u&&null!=f&&null!=i),mr[0]=null,mr[1]=li,mr[2]=ci,mr[3]=ui,c.ca=f,c.tb=p,c.c=i.width,c.i=i.height,e(0<c.c&&0<c.i),1>=d)i=0;else if(c.$a=3&u[h+0],c.Z=u[h+0]>>2&3,c.Lc=u[h+0]>>4&3,h=u[h+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||h)i=0;else if(y.put=ft,y.ac=dt,y.bc=pt,y.ma=c,y.width=i.width,y.height=i.height,y.Da=i.Da,y.v=i.v,y.va=i.va,y.j=i.j,y.o=i.o,c.$a)t:{e(1==c.$a),i=kt();e:for(;;){if(null==i){i=0;break t}if(e(null!=c),c.mc=i,i.c=c.c,i.i=c.i,i.l=c.l,i.l.ma=c,i.l.width=c.c,i.l.height=c.i,i.a=0,v(i.m,u,g,m),!Pt(c.c,c.i,1,i,null))break e;if(1==i.ab&&3==i.gc[0].hc&&Et(i.s)?(c.ic=1,u=i.c*i.i,i.Ta=null,i.Ua=0,i.V=s(u),i.Ba=0,null==i.V?(i.a=1,i=0):i=1):(c.ic=0,i=Rt(i,c.c)),!i)break e;i=1;break t}c.mc=null,i=0}else i=m>=c.c*c.i;c=!i}if(c)return null;1!=t.ga.Lc?t.Ga=0:a=l-r}e(null!=t.ga),e(r+a<=l);t:{if(i=(u=t.ga).c,l=u.l.o,0==u.$a){if(g=t.rc,m=t.Vc,y=t.Fa,h=t.P+1+r*i,d=t.mb,f=t.nb+r*i,e(h<=t.P+t.qc),0!=u.Z)for(e(null!=mr[u.Z]),c=0;c<a;++c)mr[u.Z](g,m,y,h,d,f,i),g=d,m=f,f+=i,h+=i;else for(c=0;c<a;++c)n(d,f,y,h,i),g=d,m=f,f+=i,h+=i;t.rc=g,t.Vc=m}else{if(e(null!=u.mc),i=r+a,e(null!=(c=u.mc)),e(i<=c.i),c.C>=i)i=1;else if(u.ic||mi(),u.ic){u=c.V,g=c.Ba,m=c.c;var b=c.i,S=(y=1,h=c.$/m,d=c.$%m,f=c.m,p=c.s,c.$),w=m*b,x=m*i,L=p.wc,A=S<x?St(p,d,h):null;e(S<=w),e(i<=b),e(Et(p));e:for(;;){for(;!f.h&&S<x;){if(d&L||(A=St(p,d,h)),e(null!=A),T(f),256>(b=yt(A.G[0],A.H[0],f)))u[g+S]=b,++S,++d>=m&&(d=0,++h<=i&&!(h%16)&&Tt(c,h));else{if(!(280>b)){y=0;break e}b=mt(b-256,f);var _,k=yt(A.G[4],A.H[4],f);if(T(f),!(S>=(k=vt(m,k=mt(k,f)))&&w-S>=b)){y=0;break e}for(_=0;_<b;++_)u[g+S+_]=u[g+S+_-k];for(S+=b,d+=b;d>=m;)d-=m,++h<=i&&!(h%16)&&Tt(c,h);S<x&&d&L&&(A=St(p,d,h))}e(f.h==E(f))}Tt(c,h>i?i:h);break e}!y||f.h&&S<w?(y=0,c.a=f.h?5:3):c.$=S,i=y}else i=At(c,c.V,c.Ba,c.c,c.i,i,It);if(!i){a=0;break t}}r+a>=l&&(t.Cc=1),a=1}if(!a)return null;if(t.Cc&&(null!=(a=t.ga)&&(a.mc=null),t.ga=null,0<t.Ga))return alert("todo:WebPDequantizeLevels"),null}return t.nb+r*o}function di(t,e,i,n,r,s){for(;0<r--;){var a,o=t,l=e+(i?1:0),c=t,u=e+(i?0:3);for(a=0;a<n;++a){var h=c[u+4*a];255!=h&&(h*=32897,o[l+4*a+0]=o[l+4*a+0]*h>>23,o[l+4*a+1]=o[l+4*a+1]*h>>23,o[l+4*a+2]=o[l+4*a+2]*h>>23)}e+=s}}function fi(t,e,i,n,r){for(;0<n--;){var s;for(s=0;s<i;++s){var a=t[e+2*s+0],o=15&(c=t[e+2*s+1]),l=4369*o,c=(240&c|c>>4)*l>>16;t[e+2*s+0]=(240&a|a>>4)*l>>16&240|(15&a|a<<4)*l>>16>>4&15,t[e+2*s+1]=240&c|o}e+=r}}function pi(t,e,i,n,r,s,a,o){var l,c,u=255;for(c=0;c<r;++c){for(l=0;l<n;++l){var h=t[e+l];s[a+4*l]=h,u&=h}e+=i,a+=o}return 255!=u}function gi(t,e,i,n,r){var s;for(s=0;s<r;++s)i[n+s]=t[e+s]>>8}function mi(){En=di,Ln=fi,Tn=pi,An=gi}function vi(i,n,r){t[i]=function(t,i,s,a,o,l,c,u,h,d,f,p,g,m,v,y,b){var S,w=b-1>>1,x=o[l+0]|c[u+0]<<16,E=h[d+0]|f[p+0]<<16;e(null!=t);var L=3*x+E+131074>>2;for(n(t[i+0],255&L,L>>16,g,m),null!=s&&(L=3*E+x+131074>>2,n(s[a+0],255&L,L>>16,v,y)),S=1;S<=w;++S){var T=o[l+S]|c[u+S]<<16,A=h[d+S]|f[p+S]<<16,_=x+T+E+A+524296,k=_+2*(T+E)>>3;L=k+x>>1,x=(_=_+2*(x+A)>>3)+T>>1,n(t[i+2*S-1],255&L,L>>16,g,m+(2*S-1)*r),n(t[i+2*S-0],255&x,x>>16,g,m+(2*S-0)*r),null!=s&&(L=_+E>>1,x=k+A>>1,n(s[a+2*S-1],255&L,L>>16,v,y+(2*S-1)*r),n(s[a+2*S+0],255&x,x>>16,v,y+(2*S+0)*r)),x=T,E=A}1&b||(L=3*x+E+131074>>2,n(t[i+b-1],255&L,L>>16,g,m+(b-1)*r),null!=s&&(L=3*E+x+131074>>2,n(s[a+b-1],255&L,L>>16,v,y+(b-1)*r)))}}function yi(){vr[Mn]=yr,vr[Fn]=Sr,vr[Bn]=br,vr[Un]=wr,vr[jn]=xr,vr[$n]=Er,vr[zn]=Lr,vr[Hn]=Sr,vr[qn]=wr,vr[Gn]=xr,vr[Vn]=Er}function bi(t){return t&~Rr?0>t?0:255:t>>Pr}function Si(t,e){return bi((19077*t>>8)+(26149*e>>8)-14234)}function wi(t,e,i){return bi((19077*t>>8)-(6419*e>>8)-(13320*i>>8)+8708)}function xi(t,e){return bi((19077*t>>8)+(33050*e>>8)-17685)}function Ei(t,e,i,n,r){n[r+0]=Si(t,i),n[r+1]=wi(t,e,i),n[r+2]=xi(t,e)}function Li(t,e,i,n,r){n[r+0]=xi(t,e),n[r+1]=wi(t,e,i),n[r+2]=Si(t,i)}function Ti(t,e,i,n,r){var s=wi(t,e,i);e=s<<3&224|xi(t,e)>>3,n[r+0]=248&Si(t,i)|s>>5,n[r+1]=e}function Ai(t,e,i,n,r){var s=240&xi(t,e)|15;n[r+0]=240&Si(t,i)|wi(t,e,i)>>4,n[r+1]=s}function _i(t,e,i,n,r){n[r+0]=255,Ei(t,e,i,n,r+1)}function ki(t,e,i,n,r){Li(t,e,i,n,r),n[r+3]=255}function Pi(t,e,i,n,r){Ei(t,e,i,n,r),n[r+3]=255}function Gt(t,e){return 0>t?0:t>e?e:t}function Ri(e,i,n){t[e]=function(t,e,r,s,a,o,l,c,u){for(var h=c+(-2&u)*n;c!=h;)i(t[e+0],r[s+0],a[o+0],l,c),i(t[e+1],r[s+0],a[o+0],l,c+n),e+=2,++s,++o,c+=2*n;1&u&&i(t[e+0],r[s+0],a[o+0],l,c)}}function Ii(t,e,i){return 0==i?0==t?0==e?6:5:0==e?4:0:i}function Ci(t,e,i,n,r){switch(t>>>30){case 3:an(e,i,n,r,0);break;case 2:on(e,i,n,r);break;case 1:cn(e,i,n,r)}}function Di(t,e){var i,s,a=e.M,o=e.Nb,l=t.oc,c=t.pc+40,u=t.oc,h=t.pc+584,d=t.oc,f=t.pc+600;for(i=0;16>i;++i)l[c+32*i-1]=129;for(i=0;8>i;++i)u[h+32*i-1]=129,d[f+32*i-1]=129;for(0<a?l[c-1-32]=u[h-1-32]=d[f-1-32]=129:(r(l,c-32-1,127,21),r(u,h-32-1,127,9),r(d,f-32-1,127,9)),s=0;s<t.za;++s){var p=e.ya[e.aa+s];if(0<s){for(i=-1;16>i;++i)n(l,c+32*i-4,l,c+32*i+12,4);for(i=-1;8>i;++i)n(u,h+32*i-4,u,h+32*i+4,4),n(d,f+32*i-4,d,f+32*i+4,4)}var g=t.Gd,m=t.Hd+s,v=p.ad,y=p.Hc;if(0<a&&(n(l,c-32,g[m].y,0,16),n(u,h-32,g[m].f,0,8),n(d,f-32,g[m].ea,0,8)),p.Za){var b=l,S=c-32+16;for(0<a&&(s>=t.za-1?r(b,S,g[m].y[15],4):n(b,S,g[m+1].y,0,4)),i=0;4>i;i++)b[S+128+i]=b[S+256+i]=b[S+384+i]=b[S+0+i];for(i=0;16>i;++i,y<<=2)b=l,S=c+Br[i],dr[p.Ob[i]](b,S),Ci(y,v,16*+i,b,S)}else if(b=Ii(s,a,p.Ob[0]),hr[b](l,c),0!=y)for(i=0;16>i;++i,y<<=2)Ci(y,v,16*+i,l,c+Br[i]);for(i=p.Gc,b=Ii(s,a,p.Dd),fr[b](u,h),fr[b](d,f),y=v,b=u,S=h,255&(p=i|0)&&(170&p?ln(y,256,b,S):un(y,256,b,S)),p=d,y=f,255&(i>>=8)&&(170&i?ln(v,320,p,y):un(v,320,p,y)),a<t.Ub-1&&(n(g[m].y,0,l,c+480,16),n(g[m].f,0,u,h+224,8),n(g[m].ea,0,d,f+224,8)),i=8*o*t.B,g=t.sa,m=t.ta+16*s+16*o*t.R,v=t.qa,p=t.ra+8*s+i,y=t.Ha,b=t.Ia+8*s+i,i=0;16>i;++i)n(g,m+i*t.R,l,c+32*i,16);for(i=0;8>i;++i)n(v,p+i*t.B,u,h+32*i,8),n(y,b+i*t.B,d,f+32*i,8)}}function Ni(t,n,r,s,a,o,l,c,u){var h=[0],d=[0],f=0,p=null!=u?u.kd:0,g=null!=u?u:new ni;if(null==t||12>r)return 7;g.data=t,g.w=n,g.ha=r,n=[n],r=[r],g.gb=[g.gb];t:{var m=n,y=r,b=g.gb;if(e(null!=t),e(null!=y),e(null!=b),b[0]=0,12<=y[0]&&!i(t,m[0],"RIFF")){if(i(t,m[0]+8,"WEBP")){b=3;break t}var S=C(t,m[0]+4);if(12>S||4294967286<S){b=3;break t}if(p&&S>y[0]-8){b=7;break t}b[0]=S,m[0]+=12,y[0]-=12}b=0}if(0!=b)return b;for(S=0<g.gb[0],r=r[0];;){t:{var x=t;y=n,b=r;var E=h,L=d,T=m=[0];if((k=f=[f])[0]=0,8>b[0])b=7;else{if(!i(x,y[0],"VP8X")){if(10!=C(x,y[0]+4)){b=3;break t}if(18>b[0]){b=7;break t}var A=C(x,y[0]+8),_=1+I(x,y[0]+12);if(2147483648<=_*(x=1+I(x,y[0]+15))){b=3;break t}null!=T&&(T[0]=A),null!=E&&(E[0]=_),null!=L&&(L[0]=x),y[0]+=18,b[0]-=18,k[0]=1}b=0}}if(f=f[0],m=m[0],0!=b)return b;if(y=!!(2&m),!S&&f)return 3;if(null!=o&&(o[0]=!!(16&m)),null!=l&&(l[0]=y),null!=c&&(c[0]=0),l=h[0],m=d[0],f&&y&&null==u){b=0;break}if(4>r){b=7;break}if(S&&f||!S&&!f&&!i(t,n[0],"ALPH")){r=[r],g.na=[g.na],g.P=[g.P],g.Sa=[g.Sa];t:{A=t,b=n,S=r;var k=g.gb;E=g.na,L=g.P,T=g.Sa,_=22,e(null!=A),e(null!=S),x=b[0];var P=S[0];for(e(null!=E),e(null!=T),E[0]=null,L[0]=null,T[0]=0;;){if(b[0]=x,S[0]=P,8>P){b=7;break t}var R=C(A,x+4);if(4294967286<R){b=3;break t}var D=8+R+1&-2;if(_+=D,0<k&&_>k){b=3;break t}if(!i(A,x,"VP8 ")||!i(A,x,"VP8L")){b=0;break t}if(P[0]<D){b=7;break t}i(A,x,"ALPH")||(E[0]=A,L[0]=x+8,T[0]=R),x+=D,P-=D}}if(r=r[0],g.na=g.na[0],g.P=g.P[0],g.Sa=g.Sa[0],0!=b)break}r=[r],g.Ja=[g.Ja],g.xa=[g.xa];t:if(k=t,b=n,S=r,E=g.gb[0],L=g.Ja,T=g.xa,A=b[0],x=!i(k,A,"VP8 "),_=!i(k,A,"VP8L"),e(null!=k),e(null!=S),e(null!=L),e(null!=T),8>S[0])b=7;else{if(x||_){if(k=C(k,A+4),12<=E&&k>E-12){b=3;break t}if(p&&k>S[0]-8){b=7;break t}L[0]=k,b[0]+=8,S[0]-=8,T[0]=_}else T[0]=5<=S[0]&&47==k[A+0]&&!(k[A+4]>>5),L[0]=S[0];b=0}if(r=r[0],g.Ja=g.Ja[0],g.xa=g.xa[0],n=n[0],0!=b)break;if(4294967286<g.Ja)return 3;if(null==c||y||(c[0]=g.xa?2:1),l=[l],m=[m],g.xa){if(5>r){b=7;break}c=l,p=m,y=o,null==t||5>r?t=0:5<=r&&47==t[n+0]&&!(t[n+4]>>5)?(S=[0],k=[0],E=[0],v(L=new w,t,n,r),gt(L,S,k,E)?(null!=c&&(c[0]=S[0]),null!=p&&(p[0]=k[0]),null!=y&&(y[0]=E[0]),t=1):t=0):t=0}else{if(10>r){b=7;break}c=m,null==t||10>r||!Yt(t,n+3,r-3)?t=0:(p=t[n+0]|t[n+1]<<8|t[n+2]<<16,y=16383&(t[n+7]<<8|t[n+6]),t=16383&(t[n+9]<<8|t[n+8]),1&p||3<(p>>1&7)||!(p>>4&1)||p>>5>=g.Ja||!y||!t?t=0:(l&&(l[0]=y),c&&(c[0]=t),t=1))}if(!t)return 3;if(l=l[0],m=m[0],f&&(h[0]!=l||d[0]!=m))return 3;null!=u&&(u[0]=g,u.offset=n-u.w,e(4294967286>n-u.w),e(u.offset==u.ha-r));break}return 0==b||7==b&&f&&null==u?(null!=o&&(o[0]|=null!=g.na&&0<g.na.length),null!=s&&(s[0]=l),null!=a&&(a[0]=m),0):b}function Oi(t,e,i){var n=e.width,r=e.height,s=0,a=0,o=n,l=r;if(e.Da=null!=t&&0<t.Da,e.Da&&(o=t.cd,l=t.bd,s=t.v,a=t.j,11>i||(s&=-2,a&=-2),0>s||0>a||0>=o||0>=l||s+o>n||a+l>r))return 0;if(e.v=s,e.j=a,e.va=s+o,e.o=a+l,e.U=o,e.T=l,e.da=null!=t&&0<t.da,e.da){if(!M(o,l,i=[t.ib],s=[t.hb]))return 0;e.ib=i[0],e.hb=s[0]}return e.ob=null!=t&&t.ob,e.Kb=null==t||!t.Sd,e.da&&(e.ob=e.ib<3*n/4&&e.hb<3*r/4,e.Kb=0),1}function Mi(t){if(null==t)return 2;if(11>t.S){var e=t.f.RGBA;e.fb+=(t.height-1)*e.A,e.A=-e.A}else e=t.f.kb,t=t.height,e.O+=(t-1)*e.fa,e.fa=-e.fa,e.N+=(t-1>>1)*e.Ab,e.Ab=-e.Ab,e.W+=(t-1>>1)*e.Db,e.Db=-e.Db,null!=e.F&&(e.J+=(t-1)*e.lb,e.lb=-e.lb);return 0}function Fi(t,e,i,n){if(null==n||0>=t||0>=e)return 2;if(null!=i){if(i.Da){var r=i.cd,a=i.bd,o=-2&i.v,l=-2&i.j;if(0>o||0>l||0>=r||0>=a||o+r>t||l+a>e)return 2;t=r,e=a}if(i.da){if(!M(t,e,r=[i.ib],a=[i.hb]))return 2;t=r[0],e=a[0]}}n.width=t,n.height=e;t:{var c=n.width,u=n.height;if(t=n.S,0>=c||0>=u||!(t>=Mn&&13>t))t=2;else{if(0>=n.Rd&&null==n.sd){o=a=r=e=0;var h=(l=c*zr[t])*u;if(11>t||(a=(u+1)/2*(e=(c+1)/2),12==t&&(o=(r=c)*u)),null==(u=s(h+2*a+o))){t=1;break t}n.sd=u,11>t?((c=n.f.RGBA).eb=u,c.fb=0,c.A=l,c.size=h):((c=n.f.kb).y=u,c.O=0,c.fa=l,c.Fd=h,c.f=u,c.N=0+h,c.Ab=e,c.Cd=a,c.ea=u,c.W=0+h+a,c.Db=e,c.Ed=a,12==t&&(c.F=u,c.J=0+h+2*a),c.Tc=o,c.lb=r)}if(e=1,r=n.S,a=n.width,o=n.height,r>=Mn&&13>r)if(11>r)t=n.f.RGBA,e&=(l=Math.abs(t.A))*(o-1)+a<=t.size,e&=l>=a*zr[r],e&=null!=t.eb;else{t=n.f.kb,l=(a+1)/2,h=(o+1)/2,c=Math.abs(t.fa),u=Math.abs(t.Ab);var d=Math.abs(t.Db),f=Math.abs(t.lb),p=f*(o-1)+a;e&=c*(o-1)+a<=t.Fd,e&=u*(h-1)+l<=t.Cd,e=(e&=d*(h-1)+l<=t.Ed)&c>=a&u>=l&d>=l,e&=null!=t.y,e&=null!=t.f,e&=null!=t.ea,12==r&&(e&=f>=a,e&=p<=t.Tc,e&=null!=t.F)}else e=0;t=e?0:2}}return 0!=t||null!=i&&i.fd&&(t=Mi(n)),t}var Bi=64,Ui=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ji=24,$i=32,zi=8,Hi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];U("Predictor0","PredictorAdd0"),t.Predictor0=function(){return 4278190080},t.Predictor1=function(t){return t},t.Predictor2=function(t,e,i){return e[i+0]},t.Predictor3=function(t,e,i){return e[i+1]},t.Predictor4=function(t,e,i){return e[i-1]},t.Predictor5=function(t,e,i){return $($(t,e[i+1]),e[i+0])},t.Predictor6=function(t,e,i){return $(t,e[i-1])},t.Predictor7=function(t,e,i){return $(t,e[i+0])},t.Predictor8=function(t,e,i){return $(e[i-1],e[i+0])},t.Predictor9=function(t,e,i){return $(e[i+0],e[i+1])},t.Predictor10=function(t,e,i){return $($(t,e[i-1]),$(e[i+0],e[i+1]))},t.Predictor11=function(t,e,i){var n=e[i+0];return 0>=q(n>>24&255,t>>24&255,(e=e[i-1])>>24&255)+q(n>>16&255,t>>16&255,e>>16&255)+q(n>>8&255,t>>8&255,e>>8&255)+q(255&n,255&t,255&e)?n:t},t.Predictor12=function(t,e,i){var n=e[i+0];return(z((t>>24&255)+(n>>24&255)-((e=e[i-1])>>24&255))<<24|z((t>>16&255)+(n>>16&255)-(e>>16&255))<<16|z((t>>8&255)+(n>>8&255)-(e>>8&255))<<8|z((255&t)+(255&n)-(255&e)))>>>0},t.Predictor13=function(t,e,i){var n=e[i-1];return(H((t=$(t,e[i+0]))>>24&255,n>>24&255)<<24|H(t>>16&255,n>>16&255)<<16|H(t>>8&255,n>>8&255)<<8|H(255&t,255&n))>>>0};var qi=t.PredictorAdd0;t.PredictorAdd1=G,U("Predictor2","PredictorAdd2"),U("Predictor3","PredictorAdd3"),U("Predictor4","PredictorAdd4"),U("Predictor5","PredictorAdd5"),U("Predictor6","PredictorAdd6"),U("Predictor7","PredictorAdd7"),U("Predictor8","PredictorAdd8"),U("Predictor9","PredictorAdd9"),U("Predictor10","PredictorAdd10"),U("Predictor11","PredictorAdd11"),U("Predictor12","PredictorAdd12"),U("Predictor13","PredictorAdd13");var Gi=t.PredictorAdd2;Y("ColorIndexInverseTransform","MapARGB","32b",(function(t){return t>>8&255}),(function(t){return t})),Y("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(t){return t}),(function(t){return t>>8&255}));var Vi,Wi=t.ColorIndexInverseTransform,Ki=t.MapARGB,Yi=t.VP8LColorIndexInverseTransformAlpha,Xi=t.MapAlpha,Qi=t.VP8LPredictorsAdd=[];Qi.length=16,(t.VP8LPredictors=[]).length=16,(t.VP8LPredictorsAdd_C=[]).length=16,(t.VP8LPredictors_C=[]).length=16;var Ji,Zi,tn,en,nn,rn,sn,an,on,ln,cn,un,hn,dn,fn,pn,gn,mn,vn,yn,bn,Sn,wn,xn,En,Ln,Tn,An,_n=s(511),kn=s(2041),Pn=s(225),Rn=s(767),In=0,Cn=kn,Dn=Pn,Nn=Rn,On=_n,Mn=0,Fn=1,Bn=2,Un=3,jn=4,$n=5,zn=6,Hn=7,qn=8,Gn=9,Vn=10,Wn=[2,3,7],Kn=[3,3,11],Yn=[280,256,256,256,40],Xn=[0,1,1,1,0],Qn=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Jn=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Zn=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],tr=8,er=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ir=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],nr=null,rr=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],sr=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ar=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],or=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],lr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],cr=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ur=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],hr=[],dr=[],fr=[],pr=1,gr=2,mr=[],vr=[];vi("UpsampleRgbLinePair",Ei,3),vi("UpsampleBgrLinePair",Li,3),vi("UpsampleRgbaLinePair",Pi,4),vi("UpsampleBgraLinePair",ki,4),vi("UpsampleArgbLinePair",_i,4),vi("UpsampleRgba4444LinePair",Ai,2),vi("UpsampleRgb565LinePair",Ti,2);var yr=t.UpsampleRgbLinePair,br=t.UpsampleBgrLinePair,Sr=t.UpsampleRgbaLinePair,wr=t.UpsampleBgraLinePair,xr=t.UpsampleArgbLinePair,Er=t.UpsampleRgba4444LinePair,Lr=t.UpsampleRgb565LinePair,Tr=16,Ar=1<<Tr-1,_r=-227,kr=482,Pr=6,Rr=(256<<Pr)-1,Ir=0,Cr=s(256),Dr=s(256),Nr=s(256),Or=s(256),Mr=s(kr-_r),Fr=s(kr-_r);Ri("YuvToRgbRow",Ei,3),Ri("YuvToBgrRow",Li,3),Ri("YuvToRgbaRow",Pi,4),Ri("YuvToBgraRow",ki,4),Ri("YuvToArgbRow",_i,4),Ri("YuvToRgba4444Row",Ai,2),Ri("YuvToRgb565Row",Ti,2);var Br=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ur=[0,2,8],jr=[8,7,6,4,4,2,2,2,1,1,1,1],$r=1;this.WebPDecodeRGBA=function(t,i,n,r,s){var a=Fn,o=new ii,l=new at;o.ba=l,l.S=a,l.width=[l.width],l.height=[l.height];var c=l.width,u=l.height,h=new ot;if(null==h||null==t)var d=2;else e(null!=h),d=Ni(t,i,n,h.width,h.height,h.Pd,h.Qd,h.format,null);if(0!=d?c=0:(null!=c&&(c[0]=h.width[0]),null!=u&&(u[0]=h.height[0]),c=1),c){l.width=l.width[0],l.height=l.height[0],null!=r&&(r[0]=l.width),null!=s&&(s[0]=l.height);t:{if(r=new Vt,(s=new ni).data=t,s.w=i,s.ha=n,s.kd=1,i=[0],e(null!=s),(0==(t=Ni(s.data,s.w,s.ha,null,null,null,i,null,s))||7==t)&&i[0]&&(t=4),0==(i=t)){if(e(null!=o),r.data=s.data,r.w=s.w+s.offset,r.ha=s.ha-s.offset,r.put=ft,r.ac=dt,r.bc=pt,r.ma=o,s.xa){if(null==(t=kt())){o=1;break t}if(function(t,i){var n=[0],r=[0],s=[0];e:for(;;){if(null==t)return 0;if(null==i)return t.a=2,0;if(t.l=i,t.a=0,v(t.m,i.data,i.w,i.ha),!gt(t.m,n,r,s)){t.a=3;break e}if(t.xb=gr,i.width=n[0],i.height=r[0],!Pt(n[0],r[0],1,t,null))break e;return 1}return e(0!=t.a),0}(t,r)){if(r=0==(i=Fi(r.width,r.height,o.Oa,o.ba))){e:{r=t;i:for(;;){if(null==r){r=0;break e}if(e(null!=r.s.yc),e(null!=r.s.Ya),e(0<r.s.Wb),e(null!=(n=r.l)),e(null!=(s=n.ma)),0!=r.xb){if(r.ca=s.ba,r.tb=s.tb,e(null!=r.ca),!Oi(s.Oa,n,Un)){r.a=2;break i}if(!Rt(r,n.width))break i;if(n.da)break i;if((n.da||nt(r.ca.S))&&mi(),11>r.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=r.ca.f.kb.F&&mi()),r.Pb&&0<r.s.ua&&null==r.s.vb.X&&!D(r.s.vb,r.s.Wa.Xa)){r.a=1;break i}r.xb=0}if(!At(r,r.V,r.Ba,r.c,r.i,n.o,xt))break i;s.Dc=r.Ma,r=1;break e}e(0!=r.a),r=0}r=!r}r&&(i=t.a)}else i=t.a}else{if(null==(t=new Wt)){o=1;break t}if(t.Fa=s.na,t.P=s.P,t.qc=s.Sa,Xt(t,r)){if(0==(i=Fi(r.width,r.height,o.Oa,o.ba))){if(t.Aa=0,n=o.Oa,e(null!=(s=t)),null!=n){if(0<(c=0>(c=n.Md)?0:100<c?255:255*c/100)){for(u=h=0;4>u;++u)12>(d=s.pb[u]).lc&&(d.ia=c*jr[0>d.lc?0:d.lc]>>3),h|=d.ia;h&&(alert("todo:VP8InitRandom"),s.ia=1)}s.Ga=n.Id,100<s.Ga?s.Ga=100:0>s.Ga&&(s.Ga=0)}Zt(t,r)||(i=t.a)}}else i=t.a}0==i&&null!=o.Oa&&o.Oa.fd&&(i=Mi(o.ba))}o=i}a=0!=o?null:11>a?l.f.RGBA.eb:l.f.kb.y}else a=null;return a};var zr=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(t,e){for(var i="",n=0;n<4;n++)i+=String.fromCharCode(t[e++]);return i}function u(t,e){return(t[e+0]|t[e+1]<<8|t[e+2]<<16)>>>0}function h(t,e){return(t[e+0]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}new l;var d=[0],f=[0],p=[],g=new l,m=t,v=function(t,e){var i={},n=0,r=!1,s=0,a=0;if(i.frames=[],!function(t,e){for(var i=0;i<4;i++)if(t[e+i]!="RIFF".charCodeAt(i))return!0;return!1}(t,e)){for(h(t,e+=4),e+=8;e<t.length;){var o=c(t,e),l=h(t,e+=4);e+=4;var d=l+(1&l);switch(o){case"VP8 ":case"VP8L":void 0===i.frames[n]&&(i.frames[n]={}),(g=i.frames[n]).src_off=r?a:e-8,g.src_size=s+l+8,n++,r&&(r=!1,s=0,a=0);break;case"VP8X":(g=i.header={}).feature_flags=t[e];var f=e+4;g.canvas_width=1+u(t,f),f+=3,g.canvas_height=1+u(t,f),f+=3;break;case"ALPH":r=!0,s=d+8,a=e-8;break;case"ANIM":(g=i.header).bgcolor=h(t,e),f=e+4,g.loop_count=(m=t)[(v=f)+0]|m[v+1]<<8,f+=2;break;case"ANMF":var p,g;(g=i.frames[n]={}).offset_x=2*u(t,e),e+=3,g.offset_y=2*u(t,e),e+=3,g.width=1+u(t,e),e+=3,g.height=1+u(t,e),e+=3,g.duration=u(t,e),e+=3,p=t[e++],g.dispose=1&p,g.blend=p>>1&1}"ANMF"!=o&&(e+=d)}var m,v;return i}}(m,0);v.response=m,v.rgbaoutput=!0,v.dataurl=!1;var y=v.header?v.header:null,b=v.frames?v.frames:null;if(y){y.loop_counter=y.loop_count,d=[y.canvas_height],f=[y.canvas_width];for(var S=0;S<b.length&&0!=b[S].blend;S++);}var w=b[0],x=g.WebPDecodeRGBA(m,w.src_off,w.src_size,f,d);w.rgba=x,w.imgwidth=f[0],w.imgheight=d[0];for(var E=0;E<f[0]*d[0]*4;E++)p[E]=x[E];return this.width=f,this.height=d,this.data=p,this}!function(t){var e=function(e,n,l,c){var u=4,h=s;switch(c){case t.image_compression.FAST:u=1,h=r;break;case t.image_compression.MEDIUM:u=6,h=a;break;case t.image_compression.SLOW:u=9,h=o}var d=wy(e=i(e,n,l,h),{level:u});return t.__addimage__.arrayBufferToBinaryString(d)},i=function(t,e,i,n){for(var r,s,a,o=t.length/e,l=new Uint8Array(t.length+o),h=c(),d=0;d<o;d+=1){if(a=d*e,r=t.subarray(a,a+e),n)l.set(n(r,i,s),a+d);else{for(var f,p=h.length,g=[];f<p;f+=1)g[f]=h[f](r,i,s);var m=u(g.concat());l.set(g[m],a+d)}s=r}return l},n=function(t){var e=Array.apply([],t);return e.unshift(0),e},r=function(t,e){var i,n=[],r=t.length;n[0]=1;for(var s=0;s<r;s+=1)i=t[s-e]||0,n[s+1]=t[s]-i+256&255;return n},s=function(t,e,i){var n,r=[],s=t.length;r[0]=2;for(var a=0;a<s;a+=1)n=i&&i[a]||0,r[a+1]=t[a]-n+256&255;return r},a=function(t,e,i){var n,r,s=[],a=t.length;s[0]=3;for(var o=0;o<a;o+=1)n=t[o-e]||0,r=i&&i[o]||0,s[o+1]=t[o]+256-(n+r>>>1)&255;return s},o=function(t,e,i){var n,r,s,a,o=[],c=t.length;o[0]=4;for(var u=0;u<c;u+=1)n=t[u-e]||0,r=i&&i[u]||0,s=i&&i[u-e]||0,a=l(n,r,s),o[u+1]=t[u]-a+256&255;return o},l=function(t,e,i){if(t===e&&e===i)return t;var n=Math.abs(e-i),r=Math.abs(t-i),s=Math.abs(t+e-i-i);return n<=r&&n<=s?t:r<=s?e:i},c=function(){return[n,r,s,a,o]},u=function(t){var e=t.map((function(t){return t.reduce((function(t,e){return t+Math.abs(e)}),0)}));return e.indexOf(Math.min.apply(null,e))};t.processPNG=function(i,n,r,s){var a,o,l,c,u,h,d,f,p,g,m,v,y,b,S,w=this.decode.FLATE_DECODE,x="";if(this.__addimage__.isArrayBuffer(i)&&(i=new Uint8Array(i)),this.__addimage__.isArrayBufferView(i)){if(i=(l=new gS(i)).imgData,o=l.bits,a=l.colorSpace,u=l.colors,-1!==[4,6].indexOf(l.colorType)){if(8===l.bits){p=(f=32==l.pixelBitlength?new Uint32Array(l.decodePixels().buffer):16==l.pixelBitlength?new Uint16Array(l.decodePixels().buffer):new Uint8Array(l.decodePixels().buffer)).length,m=new Uint8Array(p*l.colors),g=new Uint8Array(p);var E,L=l.pixelBitlength-l.bits;for(b=0,S=0;b<p;b++){for(y=f[b],E=0;E<L;)m[S++]=y>>>E&255,E+=l.bits;g[b]=y>>>E&255}}if(16===l.bits){p=(f=new Uint32Array(l.decodePixels().buffer)).length,m=new Uint8Array(p*(32/l.pixelBitlength)*l.colors),g=new Uint8Array(p*(32/l.pixelBitlength)),v=l.colors>1,b=0,S=0;for(var T=0;b<p;)y=f[b++],m[S++]=y>>>0&255,v&&(m[S++]=y>>>16&255,y=f[b++],m[S++]=y>>>0&255),g[T++]=y>>>16&255;o=8}s!==t.image_compression.NONE?(i=e(m,l.width*l.colors,l.colors,s),d=e(g,l.width,1,s)):(i=m,d=g,w=void 0)}if(3===l.colorType&&(a=this.color_spaces.INDEXED,h=l.palette,l.transparency.indexed)){var A=l.transparency.indexed,_=0;for(b=0,p=A.length;b<p;++b)_+=A[b];if((_/=255)===p-1&&-1!==A.indexOf(0))c=[A.indexOf(0)];else if(_!==p){for(f=l.decodePixels(),g=new Uint8Array(f.length),b=0,p=f.length;b<p;b++)g[b]=A[f[b]];d=e(g,l.width,1)}}var k=function(e){var i;switch(e){case t.image_compression.FAST:i=11;break;case t.image_compression.MEDIUM:i=13;break;case t.image_compression.SLOW:i=14;break;default:i=12}return i}(s);return w===this.decode.FLATE_DECODE&&(x="/Predictor "+k+" "),x+="/Colors "+u+" /BitsPerComponent "+o+" /Columns "+l.width,(this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i))&&(i=this.__addimage__.arrayBufferToBinaryString(i)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:i,index:n,filter:w,decodeParameters:x,transparency:c,palette:h,sMask:d,predictor:k,width:l.width,height:l.height,bitsPerComponent:o,colorSpace:a}}}}(nb.API),function(t){t.processGIF89A=function(e,i,n,r){var s=new mS(e),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},u=new yS(100).encode(c,100);return t.processJPEG.call(this,u,i,n,r)},t.processGIF87A=t.processGIF89A}(nb.API),bS.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:n,blue:i,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},bS.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(t){Ay.log("bit decode error:"+t)}},bS.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),i=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}0!==i&&(this.pos+=4-i)}},bS.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<t;r++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*r*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}0!==e&&(this.pos+=4-e)}},bS.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=i*this.width*4+4*n;if(r<this.palette.length){var a=this.palette[r];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==t&&(this.pos+=4-t)}},bS.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,c=s>>15?255:0,u=n*this.width*4+4*r;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=c}this.pos+=t}},bS.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),i=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&i)/i*255|0,c=(a>>11)/e*255|0,u=r*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},bS.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*i;this.data[a]=s,this.data[a+1]=r,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},bS.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*i;this.data[o]=s,this.data[o+1]=r,this.data[o+2]=n,this.data[o+3]=a}},bS.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,i,n,r){var s=new bS(e,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new yS(100).encode(l,100);return t.processJPEG.call(this,c,i,n,r)}}(nb.API),SS.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,i,n,r){var s=new SS(e),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new yS(100).encode(l,100);return t.processJPEG.call(this,c,i,n,r)}}(nb.API),nb.API.processRGBA=function(t,e,i){for(var n=t.data,r=n.length,s=new Uint8Array(r/4*3),a=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var u=n[c],h=n[c+1],d=n[c+2],f=n[c+3];s[o++]=u,s[o++]=h,s[o++]=d,a[l++]=f}var p=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:p,index:e,alias:i,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},nb.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},uS=nb.API,hS=uS.getCharWidthsArray=function(t,e){var i,n,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=c.fof?c.fof:1,h=!1!==e.doKerning,d=0,f=t.length,p=0,g=o[0]||l,m=[];for(i=0;i<f;i++)n=t.charCodeAt(i),"function"==typeof r.metadata.widthOfString?m.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(d=h&&"object"===(0,_v.A)(c[n])&&!isNaN(parseInt(c[n][p],10))?c[n][p]/u:0,m.push((o[n]||g)/l+d)),p=n;return m},dS=uS.getStringUnitWidth=function(t,e){var i=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return uS.processArabic&&(t=uS.processArabic(t)),"function"==typeof n.metadata.widthOfString?n.metadata.widthOfString(t,i,r)/i:hS.apply(this,arguments).reduce((function(t,e){return t+e}),0)},fS=function(t,e,i,n){for(var r=[],s=0,a=t.length,o=0;s!==a&&o+e[s]<i;)o+=e[s],s++;r.push(t.slice(0,s));var l=s;for(o=0;s!==a;)o+e[s]>n&&(r.push(t.slice(l,s)),o=0,l=s),o+=e[s],s++;return l!==s&&r.push(t.slice(l,s)),r},pS=function(t,e,i){i||(i={});var n,r,s,a,o,l,c,u=[],h=[u],d=i.textIndent||0,f=0,p=0,g=t.split(" "),m=hS.apply(this,[" ",i])[0];if(l=-1===i.lineIndent?g[0].length+2:i.lineIndent||0){var v=Array(l).join(" "),y=[];g.map((function(t){(t=t.split(/\s*\n/)).length>1?y=y.concat(t.map((function(t,e){return(e&&t.length?"\n":"")+t}))):y.push(t[0])})),g=y,l=dS.apply(this,[v,i])}for(s=0,a=g.length;s<a;s++){var b=0;if(n=g[s],l&&"\n"==n[0]&&(n=n.substr(1),b=1),d+f+(p=(r=hS.apply(this,[n,i])).reduce((function(t,e){return t+e}),0))>e||b){if(p>e){for(o=fS.apply(this,[n,r,e-(d+f),e]),u.push(o.shift()),u=[o.pop()];o.length;)h.push([o.shift()]);p=r.slice(n.length-(u[0]?u[0].length:0)).reduce((function(t,e){return t+e}),0)}else u=[n];h.push(u),d=p+l,f=m}else u.push(n),d+=f+p,f=m}return c=l?function(t,e){return(e?v:"")+t.join(" ")}:function(t){return t.join(" ")},h.map(c)},uS.splitTextToSize=function(t,e,i){var n,r=(i=i||{}).fontSize||this.internal.getFontSize(),s=function(t){if(t.widths&&t.kerning)return{widths:t.widths,kerning:t.kerning};var e=this.internal.getFont(t.fontName,t.fontStyle);return e.metadata.Unicode?{widths:e.metadata.Unicode.widths||{0:1},kerning:e.metadata.Unicode.kerning||{}}:{font:e.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,i);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/r;s.textIndent=i.textIndent?1*i.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=i.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(pS.apply(this,[n[o],a,s]));return c},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",i={},n={},r=0;r<16;r++)i[e[r]]="0123456789abcdef"[r],n["0123456789abcdef"[r]]=e[r];var s=function(t){return"0x"+parseInt(t,10).toString(16)},a=t.__fontmetrics__.compress=function(t){var e,i,r,o,l=["{"];for(var c in t){if(e=t[c],isNaN(parseInt(c,10))?i="'"+c+"'":(c=parseInt(c,10),i=(i=s(c).slice(2)).slice(0,-1)+n[i.slice(-1)]),"number"==typeof e)e<0?(r=s(e).slice(3),o="-"):(r=s(e).slice(2),o=""),r=o+r.slice(0,-1)+n[r.slice(-1)];else{if("object"!==(0,_v.A)(e))throw new Error("Don't know what to do with value type "+(0,_v.A)(e)+".");r=a(e)}l.push(i+r)}return l.push("}"),l.join("")},o=t.__fontmetrics__.uncompress=function(t){if("string"!=typeof t)throw new Error("Invalid argument passed to uncompress.");for(var e,n,r,s,a={},o=1,l=a,c=[],u="",h="",d=t.length-1,f=1;f<d;f+=1)"'"==(s=t[f])?e?(r=e.join(""),e=void 0):e=[]:e?e.push(s):"{"==s?(c.push([l,r]),l={},r=void 0):"}"==s?((n=c.pop())[0][n[1]]=l,r=void 0,l=n[0]):"-"==s?o=-1:void 0===r?i.hasOwnProperty(s)?(u+=i[s],r=parseInt(u,16)*o,o=1,u=""):u+=s:i.hasOwnProperty(s)?(h+=i[s],l[r]=parseInt(h,16)*o,o=1,r=void 0,h=""):h+=s;return a},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(t){var e=t.font,i=u.Unicode[e.postScriptName];i&&(e.metadata.Unicode={},e.metadata.Unicode.widths=i.widths,e.metadata.Unicode.kerning=i.kerning);var n=c.Unicode[e.postScriptName];n&&(e.metadata.Unicode.encoding=n,e.encoding=n.codePages[0])}])}(nb.API),function(t){var e=function(t){for(var e=t.length,i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.charCodeAt(n);return i};t.API.events.push(["addFont",function(i){var n=void 0,r=i.font,s=i.instance;if(!r.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if("string"!=typeof(n=!1===s.existsFileInVFS(r.postScriptName)?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");!function(i,n){n=/^\x00\x01\x00\x00/.test(n)?e(n):e(Ry(n)),i.metadata=t.API.TTFFont.open(n),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]}(r,n)}}])}(nb),function(){function t(){return(Ly.canvg?Promise.resolve(Ly.canvg):i.e(732).then(i.bind(i,732))).catch((function(t){return Promise.reject(new Error("Could not load canvg: "+t))})).then((function(t){return t.default?t.default:t}))}nb.API.addSvgAsImage=function(e,i,n,r,s,a,o,l){if(isNaN(i)||isNaN(n))throw Ay.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(s))throw Ay.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=s;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return t().then((function(t){return t.fromString(u,e,h)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(t){return t.render(h)})).then((function(){d.addImage(c.toDataURL("image/jpeg",1),i,n,r,s,o,l)}))}}(),nb.API.putTotalPages=function(t){var e,i=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),i=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),i=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(e,i);return this},nb.API.viewerPreferences=function(t,e){var i;t=t||{},e=e||!1;var n,r,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,u=0,h=0;function d(t,e){var i,n=!1;for(i=0;i<t.length;i+=1)t[i]===e&&(n=!0);return n}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),i=this.internal.viewerpreferences.configuration,"reset"===t||!0===e){var f=o.length;for(h=0;h<f;h+=1)i[o[h]].value=i[o[h]].defaultValue,i[o[h]].explicitSet=!1}if("object"===(0,_v.A)(t))for(r in t)if(s=t[r],d(o,r)&&void 0!==s){if("boolean"===i[r].type&&"boolean"==typeof s)i[r].value=s;else if("name"===i[r].type&&d(i[r].valueSet,s))i[r].value=s;else if("integer"===i[r].type&&Number.isInteger(s))i[r].value=s;else if("array"===i[r].type){for(c=0;c<s.length;c+=1)if(n=!0,1===s[c].length&&"number"==typeof s[c][0])l.push(String(s[c]-1));else if(s[c].length>1){for(u=0;u<s[c].length;u+=1)"number"!=typeof s[c][u]&&(n=!1);!0===n&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}i[r].value="["+l.join(" ")+"]"}else i[r].value=i[r].defaultValue;i[r].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){var t,e=[];for(t in i)!0===i[t].explicitSet&&("name"===i[t].type?e.push("/"+t+" /"+i[t].value):e.push("/"+t+" "+i[t].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=i,this},function(t){var e=function(){var t='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',e=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(t)),n=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),r=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),a=i.length+n.length+r.length+e.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+a+" >>"),this.internal.write("stream"),this.internal.write(e+i+n+r+s),this.internal.write("endstream"),this.internal.write("endobj")},i=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(t,n){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:t,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",i),this.internal.events.subscribe("postPutResources",e)),this}}(nb.API),function(t){var e=t.API,i=e.pdfEscape16=function(t,e){for(var i,n=e.metadata.Unicode.widths,r=["","0","00","000","0000"],s=[""],a=0,o=t.length;a<o;++a){if(i=e.metadata.characterToGlyph(t.charCodeAt(a)),e.metadata.glyIdsUsed.push(i),e.metadata.toUnicode[i]=t.charCodeAt(a),-1==n.indexOf(i)&&(n.push(i),n.push([parseInt(e.metadata.widthOfGlyph(i),10)])),"0"==i)return s.join("");i=i.toString(16),s.push(r[4-i.length],i)}return s.join("")},n=function(t){var e,i,n,r,s,a,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",n=[],a=0,o=(i=Object.keys(t).sort((function(t,e){return t-e}))).length;a<o;a++)e=i[a],n.length>=100&&(s+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar",n=[]),void 0!==t[e]&&null!==t[e]&&"function"==typeof t[e].toString&&(r=("0000"+t[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),n.push("<"+e+"><"+r+">"));return n.length&&(s+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar\n"),s+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};e.events.push(["putFont",function(e){!function(e){var i=e.font,r=e.out,s=e.newObject,a=e.putStream;if(i.metadata instanceof t.API.TTFFont&&"Identity-H"===i.encoding){for(var o=i.metadata.Unicode.widths,l=i.metadata.subset.encode(i.metadata.glyIdsUsed,1),c="",u=0;u<l.length;u++)c+=String.fromCharCode(l[u]);var h=s();a({data:c,addLength1:!0,objectId:h}),r("endobj");var d=s();a({data:n(i.metadata.toUnicode),addLength1:!0,objectId:d}),r("endobj");var f=s();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+Qy(i.fontName)),r("/FontFile2 "+h+" 0 R"),r("/FontBBox "+t.API.PDFObject.convert(i.metadata.bbox)),r("/Flags "+i.metadata.flags),r("/StemV "+i.metadata.stemV),r("/ItalicAngle "+i.metadata.italicAngle),r("/Ascent "+i.metadata.ascender),r("/Descent "+i.metadata.decender),r("/CapHeight "+i.metadata.capHeight),r(">>"),r("endobj");var p=s();r("<<"),r("/Type /Font"),r("/BaseFont /"+Qy(i.fontName)),r("/FontDescriptor "+f+" 0 R"),r("/W "+t.API.PDFObject.convert(o)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+i.encoding+")"),r(">>"),r(">>"),r("endobj"),i.objectNumber=s(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+d+" 0 R"),r("/BaseFont /"+Qy(i.fontName)),r("/Encoding /"+i.encoding),r("/DescendantFonts ["+p+" 0 R]"),r(">>"),r("endobj"),i.isAlreadyPutted=!0}}(e)}]),e.events.push(["putFont",function(e){!function(e){var i=e.font,r=e.out,s=e.newObject,a=e.putStream;if(i.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===i.encoding){for(var o=i.metadata.rawData,l="",c=0;c<o.length;c++)l+=String.fromCharCode(o[c]);var u=s();a({data:l,addLength1:!0,objectId:u}),r("endobj");var h=s();a({data:n(i.metadata.toUnicode),addLength1:!0,objectId:h}),r("endobj");var d=s();r("<<"),r("/Descent "+i.metadata.decender),r("/CapHeight "+i.metadata.capHeight),r("/StemV "+i.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+u+" 0 R"),r("/Flags 96"),r("/FontBBox "+t.API.PDFObject.convert(i.metadata.bbox)),r("/FontName /"+Qy(i.fontName)),r("/ItalicAngle "+i.metadata.italicAngle),r("/Ascent "+i.metadata.ascender),r(">>"),r("endobj"),i.objectNumber=s();for(var f=0;f<i.metadata.hmtx.widths.length;f++)i.metadata.hmtx.widths[f]=parseInt(i.metadata.hmtx.widths[f]*(1e3/i.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+h+" 0 R/BaseFont/"+Qy(i.fontName)+"/FontDescriptor "+d+" 0 R/Encoding/"+i.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(i.metadata.hmtx.widths)+">>"),r("endobj"),i.isAlreadyPutted=!0}}(e)}]);var r=function(t){var e,n=t.text||"",r=t.x,s=t.y,a=t.options||{},o=t.mutex||{},l=o.pdfEscape,c=o.activeFontKey,u=o.fonts,h=c,d="",f=0,p="",g=u[h].encoding;if("Identity-H"!==u[h].encoding)return{text:n,x:r,y:s,options:a,mutex:o};for(p=n,h=c,Array.isArray(n)&&(p=n[0]),f=0;f<p.length;f+=1)u[h].metadata.hasOwnProperty("cmap")&&(e=u[h].metadata.cmap.unicode.codeMap[p[f].charCodeAt(0)]),e||p[f].charCodeAt(0)<256&&u[h].metadata.hasOwnProperty("Unicode")?d+=p[f]:d+="";var m="";return parseInt(h.slice(1))<14||"WinAnsiEncoding"===g?m=l(d,h).split("").map((function(t){return t.charCodeAt(0).toString(16)})).join(""):"Identity-H"===g&&(m=i(d,u[h])),o.isHex=!0,{text:m,x:r,y:s,options:a,mutex:o}};e.events.push(["postProcessText",function(t){var e=t.text||"",i=[],n={text:e,x:t.x,y:t.y,options:t.options,mutex:t.mutex};if(Array.isArray(e)){var s=0;for(s=0;s<e.length;s+=1)Array.isArray(e[s])&&3===e[s].length?i.push([r(Object.assign({},n,{text:e[s][0]})).text,e[s][1],e[s][2]]):i.push(r(Object.assign({},n,{text:e[s]})).text);t.text=i}else t.text=r(Object.assign({},n,{text:e})).text}])}(nb),function(t){var e=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(t){return e.call(this),void 0!==this.internal.vFS[t]},t.addFileToVFS=function(t,i){return e.call(this),this.internal.vFS[t]=i,this},t.getFileFromVFS=function(t){return e.call(this),void 0!==this.internal.vFS[t]?this.internal.vFS[t]:null}}(nb.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(t){var i,n,r,s,a,o,l,c=e,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],d={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,v=0;this.__bidiEngine__={};var y=function(t){var e=t.charCodeAt(),i=e>>8,n=f[i];return void 0!==n?c[256*n+(255&e)]:252===i||253===i?"AL":g.test(i)?"L":8===i?"R":"N"},b=function(t){for(var e,i=0;i<t.length;i++){if("L"===(e=y(t.charAt(i))))return!1;if("R"===e)return!0}return!1},S=function(t,e,a,o){var l,c,u,h,d=e[o];switch(d){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(d="AN");break;case"AL":m=!0,d="R";break;case"WS":case"BN":d="N";break;case"CS":o<1||o+1>=e.length||"EN"!==(l=a[o-1])&&"AN"!==l||"EN"!==(c=e[o+1])&&"AN"!==c?d="N":m&&(c="AN"),d=c===l?c:"N";break;case"ES":d="EN"===(l=o>0?a[o-1]:"B")&&o+1<e.length&&"EN"===e[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===a[o-1]){d="EN";break}if(m){d="N";break}for(u=o+1,h=e.length;u<h&&"ET"===e[u];)u++;d=u<h&&"EN"===e[u]?"EN":"N";break;case"NSM":if(r&&!s){for(h=e.length,u=o+1;u<h&&"NSM"===e[u];)u++;if(u<h){var f=t[o],p=f>=1425&&f<=2303||64286===f;if(l=e[u],p&&("R"===l||"AL"===l)){d="R";break}}}d=o<1||"B"===(l=e[o-1])?"N":a[o-1];break;case"B":m=!1,i=!0,d=v;break;case"S":n=!0,d="N"}return d},w=function(t,e,i){var n=t.split("");return i&&x(n,i,{hiLevel:v}),n.reverse(),e&&e.reverse(),n.join("")},x=function(t,e,r){var s,a,o,l,c,f=-1,p=t.length,g=0,b=[],w=v?h:u,x=[];for(m=!1,i=!1,n=!1,a=0;a<p;a++)x[a]=y(t[a]);for(o=0;o<p;o++){if(c=g,b[o]=S(t,x,b,o),s=240&(g=w[c][d[b[o]]]),g&=15,e[o]=l=w[g][5],s>0)if(16===s){for(a=f;a<o;a++)e[a]=1;f=-1}else f=-1;if(w[g][6])-1===f&&(f=o);else if(f>-1){for(a=f;a<o;a++)e[a]=l;f=-1}"B"===x[o]&&(e[o]=0),r.hiLevel|=l}n&&function(t,e,i){for(var n=0;n<i;n++)if("S"===t[n]){e[n]=v;for(var r=n-1;r>=0&&"WS"===t[r];r--)e[r]=v}}(x,e,p)},E=function(t,e,n,r,s){if(!(s.hiLevel<t)){if(1===t&&1===v&&!i)return e.reverse(),void(n&&n.reverse());for(var a,o,l,c,u=e.length,h=0;h<u;){if(r[h]>=t){for(l=h+1;l<u&&r[l]>=t;)l++;for(c=h,o=l-1;c<o;c++,o--)a=e[c],e[c]=e[o],e[o]=a,n&&(a=n[c],n[c]=n[o],n[o]=a);h=l}h++}}},L=function(t,e,i){var n=t.split(""),r={hiLevel:v};return i||(i=[]),x(n,i,r),function(t,e,i){if(0!==i.hiLevel&&l)for(var n,r=0;r<t.length;r++)1===e[r]&&(n=p.indexOf(t[r]))>=0&&(t[r]=p[n+1])}(n,i,r),E(2,n,e,i,r),E(1,n,e,i,r),n.join("")};return this.__bidiEngine__.doBidiReorder=function(t,e,i){if(function(t,e){if(e)for(var i=0;i<t.length;i++)e[i]=i;void 0===s&&(s=b(t)),void 0===o&&(o=b(t))}(t,e),r||!a||o)if(r&&a&&s^o)v=s?1:0,t=w(t,e,i);else if(!r&&a&&o)v=s?1:0,t=L(t,e,i),t=w(t,e);else if(!r||s||a||o){if(r&&!a&&s^o)t=w(t,e),s?(v=0,t=L(t,e,i)):(v=1,t=L(t,e,i),t=w(t,e));else if(r&&s&&!a&&o)v=1,t=L(t,e,i),t=w(t,e);else if(!r&&!a&&s^o){var n=l;s?(v=1,t=L(t,e,i),v=0,l=!1,t=L(t,e,i),l=n):(v=0,t=L(t,e,i),t=w(t,e),v=1,l=!1,t=L(t,e,i),l=n,t=w(t,e))}}else v=0,t=L(t,e,i);else v=s?1:0,t=L(t,e,i);return t},this.__bidiEngine__.setOptions=function(t){t&&(r=t.isInputVisual,a=t.isOutputVisual,s=t.isInputRtl,o=t.isOutputRtl,l=t.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],i=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(t){var e=t.text;t.x,t.y;var n=t.options||{};t.mutex,n.lang;var r=[];if(n.isInputVisual="boolean"!=typeof n.isInputVisual||n.isInputVisual,i.setOptions(n),"[object Array]"===Object.prototype.toString.call(e)){var s=0;for(r=[],s=0;s<e.length;s+=1)"[object Array]"===Object.prototype.toString.call(e[s])?r.push([i.doBidiReorder(e[s][0]),e[s][1],e[s][2]]):r.push([i.doBidiReorder(e[s])]);t.text=r}else t.text=i.doBidiReorder(e);i.setOptions({isInputVisual:!0})}])}(nb),nb.API.TTFFont=function(){function t(t){var e;if(this.rawData=t,e=this.contents=new xS(t),this.contents.pos=4,"ttcf"===e.readString(4))throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new $S(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new ES(this.contents),this.head=new AS(this),this.name=new DS(this),this.cmap=new kS(this),this.toUnicode={},this.hhea=new PS(this),this.maxp=new NS(this),this.hmtx=new OS(this),this.post=new IS(this),this.os2=new RS(this),this.loca=new jS(this),this.glyf=new FS(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var t,e,i,n,r;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e,i,n,r;for(r=[],e=0,i=(n=this.bbox).length;e<i;e++)t=n[e],r.push(Math.round(t*this.scaleFactor));return r}.call(this),this.stemV=0,this.post.exists?(i=255&(n=this.post.italic_angle),0!=(32768&(e=n>>16))&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(r=this.familyClass)||2===r||3===r||4===r||5===r||7===r,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(t){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[t]:void 0)||0},t.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},t.prototype.widthOfString=function(t,e,i){var n,r,s,a;for(s=0,r=0,a=(t=""+t).length;0<=a?r<a:r>a;r=0<=a?++r:--r)n=t.charCodeAt(r),s+=this.widthOfGlyph(this.characterToGlyph(n))+i*(1e3/e)||0;return s*(e/1e3)},t.prototype.lineHeight=function(t,e){var i;return null==e&&(e=!1),i=e?this.lineGap:0,(this.ascender+i-this.decender)/1e3*t},t}();var wS,xS=function(){function t(t){this.data=null!=t?t:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(t){return this.data[this.pos++]=t},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},t.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},t.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},t.prototype.readString=function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)i[e]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(t){var e,i,n;for(n=[],e=0,i=t.length;0<=i?e<i:e>i;e=0<=i?++e:--e)n.push(this.writeByte(t.charCodeAt(e)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(t){return this.writeInt16(t)},t.prototype.readLongLong=function(){var t,e,i,n,r,s,a,o;return t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^i)+4294967296*(255^n)+16777216*(255^r)+65536*(255^s)+256*(255^a)+(255^o)+1):72057594037927940*t+281474976710656*e+1099511627776*i+4294967296*n+16777216*r+65536*s+256*a+o},t.prototype.writeLongLong=function(t){var e,i;return e=Math.floor(t/4294967296),i=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(t){return this.writeInt32(t)},t.prototype.read=function(t){var e,i;for(e=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)e.push(this.readByte());return e},t.prototype.write=function(t){var e,i,n,r;for(r=[],i=0,n=t.length;i<n;i++)e=t[i],r.push(this.writeByte(e));return r},t}(),ES=function(){var t;function e(t){var e,i,n;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,n=this.tableCount;0<=n?i<n:i>n;i=0<=n?++i:--i)e={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[e.tag]=e}return e.prototype.encode=function(e){var i,n,r,s,a,o,l,c,u,h,d,f,p;for(p in d=Object.keys(e).length,o=Math.log(2),u=16*Math.floor(Math.log(d)/o),s=Math.floor(u/o),c=16*d-u,(n=new xS).writeInt(this.scalarType),n.writeShort(d),n.writeShort(u),n.writeShort(s),n.writeShort(c),r=16*d,l=n.pos+r,a=null,f=[],e)for(h=e[p],n.writeString(p),n.writeInt(t(h)),n.writeInt(l),n.writeInt(h.length),f=f.concat(h),"head"===p&&(a=l),l+=h.length;l%4;)f.push(0),l++;return n.write(f),i=2981146554-t(n.data),n.pos=a+8,n.writeUInt32(i),n.data},t=function(t){var e,i,n,r;for(t=MS.call(t);t.length%4;)t.push(0);for(n=new xS(t),i=0,e=0,r=t.length;e<r;e=e+=4)i+=n.readUInt32();return 4294967295&i},e}(),LS={}.hasOwnProperty,TS=function(t,e){for(var i in e)LS.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};wS=function(){function t(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var AS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="head",t.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},t.prototype.encode=function(t){var e;return(e=new xS).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},t}(),_S=function(){function t(t,e){var i,n,r,s,a,o,l,c,u,h,d,f,p,g,m,v,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),u=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=t.readByte();break;case 4:for(d=t.readUInt16(),h=d/2,t.pos+=6,r=function(){var e,i;for(i=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)i.push(t.readUInt16());return i}(),t.pos+=2,p=function(){var e,i;for(i=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)i.push(t.readUInt16());return i}(),l=function(){var e,i;for(i=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)i.push(t.readUInt16());return i}(),c=function(){var e,i;for(i=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)i.push(t.readUInt16());return i}(),n=(this.length-t.pos+this.offset)/2,a=function(){var e,i;for(i=[],o=e=0;0<=n?e<n:e>n;o=0<=n?++e:--e)i.push(t.readUInt16());return i}(),o=m=0,y=r.length;m<y;o=++m)for(g=r[o],i=v=f=p[o];f<=g?v<=g:v>=g;i=f<=g?++v:--v)0===c[o]?s=i+l[o]:0!==(s=a[c[o]/2+(i-f)-(h-o)]||0)&&(s+=l[o]),this.codeMap[i]=65535&s}t.pos=u}return t.encode=function(t,e){var i,n,r,s,a,o,l,c,u,h,d,f,p,g,m,v,y,b,S,w,x,E,L,T,A,_,k,P,R,I,C,D,N,O,M,F,B,U,j,$,z,H,q,G,V,W;switch(P=new xS,s=Object.keys(t).sort((function(t,e){return t-e})),e){case"macroman":for(p=0,g=function(){var t=[];for(f=0;f<256;++f)t.push(0);return t}(),v={0:0},r={},R=0,N=s.length;R<N;R++)null==v[q=t[n=s[R]]]&&(v[q]=++p),r[n]={old:t[n],new:v[t[n]]},g[n]=v[t[n]];return P.writeUInt16(1),P.writeUInt16(0),P.writeUInt32(12),P.writeUInt16(0),P.writeUInt16(262),P.writeUInt16(0),P.write(g),{charMap:r,subtable:P.data,maxGlyphID:p+1};case"unicode":for(_=[],u=[],y=0,v={},i={},m=l=null,I=0,O=s.length;I<O;I++)null==v[S=t[n=s[I]]]&&(v[S]=++y),i[n]={old:S,new:v[S]},a=v[S]-n,null!=m&&a===l||(m&&u.push(m),_.push(n),l=a),m=n;for(m&&u.push(m),u.push(65535),_.push(65535),T=2*(L=_.length),E=2*Math.pow(Math.log(L)/Math.LN2,2),h=Math.log(E/2)/Math.LN2,x=2*L-E,o=[],w=[],d=[],f=C=0,M=_.length;C<M;f=++C){if(A=_[f],c=u[f],65535===A){o.push(0),w.push(0);break}if(A-(k=i[A].new)>=32768)for(o.push(0),w.push(2*(d.length+L-f)),n=D=A;A<=c?D<=c:D>=c;n=A<=c?++D:--D)d.push(i[n].new);else o.push(k-A),w.push(0)}for(P.writeUInt16(3),P.writeUInt16(1),P.writeUInt32(12),P.writeUInt16(4),P.writeUInt16(16+8*L+2*d.length),P.writeUInt16(0),P.writeUInt16(T),P.writeUInt16(E),P.writeUInt16(h),P.writeUInt16(x),z=0,F=u.length;z<F;z++)n=u[z],P.writeUInt16(n);for(P.writeUInt16(0),H=0,B=_.length;H<B;H++)n=_[H],P.writeUInt16(n);for(G=0,U=o.length;G<U;G++)a=o[G],P.writeUInt16(a);for(V=0,j=w.length;V<j;V++)b=w[V],P.writeUInt16(b);for(W=0,$=d.length;W<$;W++)p=d[W],P.writeUInt16(p);return{charMap:i,subtable:P.data,maxGlyphID:y+1}}},t}(),kS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="cmap",t.prototype.parse=function(t){var e,i,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)e=new _S(t,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},t.encode=function(t,e){var i,n;return null==e&&(e="macroman"),i=_S.encode(t,e),(n=new xS).writeUInt16(0),n.writeUInt16(1),i.table=n.data.concat(i.subtable),i},t}(),PS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="hhea",t.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},t}(),RS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="OS/2",t.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var e,i;for(i=[],e=0;e<10;++e)i.push(t.readByte());return i}(),this.charRange=function(){var e,i;for(i=[],e=0;e<4;++e)i.push(t.readInt());return i}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var e,i;for(i=[],e=0;e<2;e=++e)i.push(t.readInt());return i}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},t}(),IS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="post",t.prototype.parse=function(t){var e,i,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var r;for(i=t.readUInt16(),this.glyphNameIndex=[],r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)e=t.readByte(),n.push(this.names.push(t.readString(e)));return n;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 262144:return this.map=function(){var e,i,n;for(n=[],r=e=0,i=this.file.maxp.numGlyphs;0<=i?e<i:e>i;r=0<=i?++e:--e)n.push(t.readUInt32());return n}.call(this)}},t}(),CS=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},DS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="name",t.prototype.parse=function(t){var e,i,n,r,s,a,o,l,c,u,h;for(t.pos=this.offset,t.readShort(),e=t.readShort(),a=t.readShort(),i=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(o={},r=c=0,u=i.length;c<u;r=++c)n=i[r],t.pos=n.offset,l=t.readString(n.length),s=new CS(l,n),null==o[h=n.nameID]&&(o[h]=[]),o[n.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(t){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},t}(),NS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="maxp",t.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},t}(),OS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="hmtx",t.prototype.parse=function(t){var e,i,n,r,s,a,o;for(t.pos=this.offset,this.metrics=[],e=0,a=this.file.hhea.numberOfMetrics;0<=a?e<a:e>a;e=0<=a?++e:--e)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var i,r;for(r=[],e=i=0;0<=n?i<n:i>n;e=0<=n?++i:--i)r.push(t.readInt16());return r}(),this.widths=function(){var t,e,i,n;for(n=[],t=0,e=(i=this.metrics).length;t<e;t++)r=i[t],n.push(r.advance);return n}.call(this),i=this.widths[this.widths.length-1],o=[],e=s=0;0<=n?s<n:s>n;e=0<=n?++s:--s)o.push(this.widths.push(i));return o},t.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},t}(),MS=[].slice,FS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(t){var e,i,n,r,s,a,o,l,c,u;return t in this.cache?this.cache[t]:(r=this.file.loca,e=this.file.contents,i=r.indexOf(t),0===(n=r.lengthOf(t))?this.cache[t]=null:(e.pos=this.offset+i,s=(a=new xS(e.read(n))).readShort(),l=a.readShort(),u=a.readShort(),o=a.readShort(),c=a.readShort(),this.cache[t]=-1===s?new US(a,l,u,o,c):new BS(a,s,l,u,o,c),this.cache[t]))},t.prototype.encode=function(t,e,i){var n,r,s,a,o;for(s=[],r=[],a=0,o=e.length;a<o;a++)n=t[e[a]],r.push(s.length),n&&(s=s.concat(n.encode(i)));return r.push(s.length),{table:s,offsets:r}},t}(),BS=function(){function t(t,e,i,n,r,s){this.raw=t,this.numberOfContours=e,this.xMin=i,this.yMin=n,this.xMax=r,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),US=function(){function t(t,e,i,n,r){var s,a;for(this.raw=t,this.xMin=e,this.yMin=i,this.xMax=n,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return t.prototype.encode=function(){var t,e,i;for(e=new xS(MS.call(this.raw.data)),t=0,i=this.glyphIDs.length;t<i;++t)e.pos=this.glyphOffsets[t];return e.data},t}(),jS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return TS(t,wS),t.prototype.tag="loca",t.prototype.parse=function(t){var e,i;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=0===e?function(){var e,n;for(n=[],i=0,e=this.length;i<e;i+=2)n.push(2*t.readUInt16());return n}.call(this):function(){var e,n;for(n=[],i=0,e=this.length;i<e;i+=4)n.push(t.readUInt32());return n}.call(this)},t.prototype.indexOf=function(t){return this.offsets[t]},t.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},t.prototype.encode=function(t,e){for(var i=new Uint32Array(this.offsets.length),n=0,r=0,s=0;s<i.length;++s)if(i[s]=n,r<e.length&&e[r]==s){++r,i[s]=n;var a=this.offsets[s],o=this.offsets[s+1]-a;o>0&&(n+=o)}for(var l=new Array(4*i.length),c=0;c<i.length;++c)l[4*c+3]=255&i[c],l[4*c+2]=(65280&i[c])>>8,l[4*c+1]=(16711680&i[c])>>16,l[4*c]=(4278190080&i[c])>>24;return l},t}(),$S=function(){function t(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var t,e,i,n,r;for(e in n=this.font.cmap.tables[0].codeMap,t={},r=this.subset)i=r[e],t[e]=n[i];return t},t.prototype.glyphsFor=function(t){var e,i,n,r,s,a,o;for(n={},s=0,a=t.length;s<a;s++)n[r=t[s]]=this.font.glyf.glyphFor(r);for(r in e=[],n)(null!=(i=n[r])?i.compound:void 0)&&e.push.apply(e,i.glyphIDs);if(e.length>0)for(r in o=this.glyphsFor(e))i=o[r],n[r]=i;return n},t.prototype.encode=function(t,e){var i,n,r,s,a,o,l,c,u,h,d,f,p,g,m;for(n in i=kS.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),d={0:0},m=i.charMap)d[(o=m[n]).old]=o.new;for(f in h=i.maxGlyphID,s)f in d||(d[f]=h++);return c=function(t){var e,i;for(e in i={},t)i[t[e]]=e;return i}(d),u=Object.keys(c).sort((function(t,e){return t-e})),p=function(){var t,e,i;for(i=[],t=0,e=u.length;t<e;t++)a=u[t],i.push(c[a]);return i}(),r=this.font.glyf.encode(s,p,d),l=this.font.loca.encode(r.offsets,p),g={cmap:this.font.cmap.raw(),glyf:r.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},t}();function zS(t,e,i,n,r){n=n||{};var s=r.internal.scaleFactor,a=r.internal.getFontSize()/s,o=a*(r.getLineHeightFactor?r.getLineHeightFactor():1.15),l="",c=1;if("middle"!==n.valign&&"bottom"!==n.valign&&"center"!==n.halign&&"right"!==n.halign||(c=(l="string"===typeof t?t.split(/\r\n|\r|\n/g):t).length||1),i+=a*(2-1.15),"middle"===n.valign?i-=c/2*o:"bottom"===n.valign&&(i-=c*o),"center"===n.halign||"right"===n.halign){var u=a;if("center"===n.halign&&(u*=.5),l&&c>=1){for(var h=0;h<l.length;h++)r.text(l[h],e-r.getStringUnitWidth(l[h])*u,i),i+=o;return r}e-=r.getStringUnitWidth(t)*u}return"justify"===n.halign?r.text(t,e,i,{maxWidth:n.maxWidth||100,align:"justify"}):r.text(t,e,i),r}nb.API.PDFObject=function(){var t;function e(){}return t=function(t,e){return(Array(e+1).join("0")+t).slice(-e)},e.convert=function(i){var n,r,s,a;if(Array.isArray(i))return"["+function(){var t,r,s;for(s=[],t=0,r=i.length;t<r;t++)n=i[t],s.push(e.convert(n));return s}().join(" ")+"]";if("string"==typeof i)return"/"+i;if(null!=i?i.isString:void 0)return"("+i+")";if(i instanceof Date)return"(D:"+t(i.getUTCFullYear(),4)+t(i.getUTCMonth(),2)+t(i.getUTCDate(),2)+t(i.getUTCHours(),2)+t(i.getUTCMinutes(),2)+t(i.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(i)){for(r in s=["<<"],i)a=i[r],s.push("/"+r+" "+e.convert(a));return s.push(">>"),s.join("\n")}return""+i},e}();var HS={},qS=function(){function t(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(t,e){void 0===e&&(e=null),e?e.__autoTableDocumentDefaults=t:HS=t},t.unifyColor=function(t){return Array.isArray(t)?t:"number"===typeof t?[t,t,t]:"string"===typeof t?[t]:null},t.prototype.applyStyles=function(e,i){var n,r,s;void 0===i&&(i=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var a=this.jsPDFDocument.internal.getFont(),o=a.fontStyle,l=a.fontName;if(e.font&&(l=e.font),e.fontStyle){o=e.fontStyle;var c=this.getFontList()[l];c&&-1===c.indexOf(o)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!i){var u=t.unifyColor(e.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),(u=t.unifyColor(e.textColor))&&(r=this.jsPDFDocument).setTextColor.apply(r,u),(u=t.unifyColor(e.lineColor))&&(s=this.jsPDFDocument).setDrawColor.apply(s,u),"number"===typeof e.lineWidth&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(t,e,i){return this.jsPDFDocument.splitTextToSize(t,e,i)},t.prototype.rect=function(t,e,i,n,r){return this.jsPDFDocument.rect(t,e,i,n,r)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return HS||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return null==t.width&&(t={width:t.getWidth(),height:t.getHeight()}),t},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),GS=function(t,e){return GS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},GS(t,e)};function VS(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}GS(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}"function"===typeof SuppressedError&&SuppressedError;var WS=function(t){function e(e){var i=t.call(this)||this;return i._element=e,i}return VS(e,t),e}(Array);function KS(t,e,i){i.applyStyles(e,!0);var n=(Array.isArray(t)?t:[t]).map((function(t){return i.getTextWidth(t)})).reduce((function(t,e){return Math.max(t,e)}),0);return n}function YS(t,e,i,n){var r=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:r,lineColor:s});var a=XS(r,!1);a&&t.rect(i.x,i.y,e.getWidth(t.pageSize().width),n.y-i.y,a)}function XS(t,e){var i=t>0,n=e||0===e;return i&&n?"DF":i?"S":n?"F":null}function QS(t,e){var i,n,r,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(3===t.length)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(2===t.length)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t=1===t.length?t[0]:e}return"object"===typeof t?("number"===typeof t.vertical&&(t.top=t.vertical,t.bottom=t.vertical),"number"===typeof t.horizontal&&(t.right=t.horizontal,t.left=t.horizontal),{left:null!==(i=t.left)&&void 0!==i?i:e,top:null!==(n=t.top)&&void 0!==n?n:e,right:null!==(r=t.right)&&void 0!==r?r:e,bottom:null!==(s=t.bottom)&&void 0!==s?s:e}):("number"!==typeof t&&(t=e),{top:t,right:t,bottom:t,left:t})}function JS(t,e){var i=QS(e.settings.margin,0);return t.pageSize().width-(i.left+i.right)}function ZS(t,e,i,n,r){var s={},a=96/72,o=tw(e,(function(t){return r.getComputedStyle(t).backgroundColor}));null!=o&&(s.fillColor=o);var l=tw(e,(function(t){return r.getComputedStyle(t).color}));null!=l&&(s.textColor=l);var c=function(t,e){var i=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),r=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=i.map((function(t){return parseInt(t||"0")/n})),a=QS(s,0);r>a.top&&(a.top=r);r>a.bottom&&(a.bottom=r);return a}(n,i);c&&(s.cellPadding=c);var u="borderTopColor",h=a*i,d=n.borderTopWidth;if(n.borderBottomWidth===d&&n.borderRightWidth===d&&n.borderLeftWidth===d){var f=(parseFloat(d)||0)/h;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},s.lineWidth.top||(s.lineWidth.right?u="borderRightColor":s.lineWidth.bottom?u="borderBottomColor":s.lineWidth.left&&(u="borderLeftColor"));var p=tw(e,(function(t){return r.getComputedStyle(t)[u]}));null!=p&&(s.lineColor=p);var g=["left","right","center","justify"];-1!==g.indexOf(n.textAlign)&&(s.halign=n.textAlign),-1!==(g=["middle","bottom","top"]).indexOf(n.verticalAlign)&&(s.valign=n.verticalAlign);var m=parseInt(n.fontSize||"");isNaN(m)||(s.fontSize=m/a);var v=function(t){var e="";("bold"===t.fontWeight||"bolder"===t.fontWeight||parseInt(t.fontWeight)>=700)&&(e="bold");"italic"!==t.fontStyle&&"oblique"!==t.fontStyle||(e+="italic");return e}(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return-1!==t.indexOf(y)&&(s.font=y),s}function tw(t,e){var i=ew(t,e);if(!i)return null;var n=i.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];return 0===parseInt(n[4])||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function ew(t,e){var i=e(t);return"rgba(0, 0, 0, 0)"===i||"transparent"===i||"initial"===i||"inherit"===i?null==t.parentElement?null:ew(t.parentElement,e):i}function iw(t,e,i,n,r){var s,a,o;void 0===n&&(n=!1),void 0===r&&(r=!1),o="string"===typeof e?i.document.querySelector(e):e;var l=Object.keys(t.getFontList()),c=t.scaleFactor(),u=[],h=[],d=[];if(!o)return console.error("Html table could not be found with input: ",e),{head:u,body:h,foot:d};for(var f=0;f<o.rows.length;f++){var p=o.rows[f],g=null===(a=null===(s=null===p||void 0===p?void 0:p.parentElement)||void 0===s?void 0:s.tagName)||void 0===a?void 0:a.toLowerCase(),m=nw(l,c,i,p,n,r);m&&("thead"===g?u.push(m):"tfoot"===g?d.push(m):h.push(m))}return{head:u,body:h,foot:d}}function nw(t,e,i,n,r,s){for(var a=new WS(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=i.getComputedStyle(l);if(r||"none"!==c.display){var u=void 0;s&&(u=ZS(t,l,e,c,i)),a.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:u,_element:l,content:rw(l)})}}var h=i.getComputedStyle(n);if(a.length>0&&(r||"none"!==h.display))return a}function rw(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map((function(t){return t.trim()})).join("\n"),e.innerText||e.textContent||""}function sw(t,e,i,n,r){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),a=1;a<arguments.length;a++){var o=arguments[a];if(null!=o)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(s[l]=o[l])}return s}function aw(t,e){var i=new qS(t),n=i.getDocumentOptions(),r=i.getGlobalOptions();!function(t,e,i){for(var n=0,r=[t,e,i];n<r.length;n++){var s=r[n];s&&"object"!==typeof s&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&"number"!==typeof s.startY&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}(r,n,e);var s,a=sw({},r,n,e);"undefined"!==typeof window&&(s=window);var o=function(t,e,i){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(r){if("columnStyles"===r){var s=t[r],a=e[r],o=i[r];n.columnStyles=sw({},s,a,o)}else{var l=[t,e,i].map((function(t){return t[r]||{}}));n[r]=sw({},l[0],l[1],l[2])}},s=0,a=Object.keys(n);s<a.length;s++){r(a[s])}return n}(r,n,e),l=function(t,e,i){for(var n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},r=0,s=[t,e,i];r<s.length;r++){var a=s[r];a.didParseCell&&n.didParseCell.push(a.didParseCell),a.willDrawCell&&n.willDrawCell.push(a.willDrawCell),a.didDrawCell&&n.didDrawCell.push(a.didDrawCell),a.willDrawPage&&n.willDrawPage.push(a.willDrawPage),a.didDrawPage&&n.didDrawPage.push(a.didDrawPage)}return n}(r,n,e),c=function(t,e){var i,n,r,s,a,o,l,c,u,h,d,f,p,g,m=QS(e.margin,40/t.scaleFactor()),v=null!==(i=function(t,e){var i=t.getLastAutoTable(),n=t.scaleFactor(),r=t.pageNumber(),s=!1;if(i&&i.startPageNumber){s=i.startPageNumber+i.pageNumber-1===r}if("number"===typeof e)return e;if((null==e||!1===e)&&s&&null!=(null===i||void 0===i?void 0:i.finalY))return i.finalY+20/n;return null}(t,e.startY))&&void 0!==i?i:m.top;p=!0===e.showFoot?"everyPage":!1===e.showFoot?"never":null!==(n=e.showFoot)&&void 0!==n?n:"everyPage";g=!0===e.showHead?"everyPage":!1===e.showHead?"never":null!==(r=e.showHead)&&void 0!==r?r:"everyPage";var y=null!==(s=e.useCss)&&void 0!==s&&s,b=e.theme||(y?"plain":"striped"),S=!!e.horizontalPageBreak,w=null!==(a=e.horizontalPageBreakRepeat)&&void 0!==a?a:null;return{includeHiddenHtml:null!==(o=e.includeHiddenHtml)&&void 0!==o&&o,useCss:y,theme:b,startY:v,margin:m,pageBreak:null!==(l=e.pageBreak)&&void 0!==l?l:"auto",rowPageBreak:null!==(c=e.rowPageBreak)&&void 0!==c?c:"auto",tableWidth:null!==(u=e.tableWidth)&&void 0!==u?u:"auto",showHead:g,showFoot:p,tableLineWidth:null!==(h=e.tableLineWidth)&&void 0!==h?h:0,tableLineColor:null!==(d=e.tableLineColor)&&void 0!==d?d:200,horizontalPageBreak:S,horizontalPageBreakRepeat:w,horizontalPageBreakBehaviour:null!==(f=e.horizontalPageBreakBehaviour)&&void 0!==f?f:"afterAllRows"}}(i,a),u=function(t,e,i){var n=e.head||[],r=e.body||[],s=e.foot||[];if(e.html){var a=e.includeHiddenHtml;if(i){var o=iw(t,e.html,i,a,e.useCss)||{};n=o.head||n,r=o.body||n,s=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=e.columns||function(t,e,i){var n=t[0]||e[0]||i[0]||[],r=[];return Object.keys(n).filter((function(t){return"_element"!==t})).forEach((function(t){var e,i=1;"object"!==typeof(e=Array.isArray(n)?n[parseInt(t)]:n[t])||Array.isArray(e)||(i=(null===e||void 0===e?void 0:e.colSpan)||1);for(var s=0;s<i;s++){var a={dataKey:Array.isArray(n)?r.length:t+(s>0?"_".concat(s):"")};r.push(a)}})),r}(n,r,s);return{columns:l,head:n,body:r,foot:s}}(i,a,s);return{id:e.tableId,content:u,hooks:l,styles:o,settings:c}}var ow,lw=function(t,e,i){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=i,this.doc=t.getDocument()},cw=function(t){function e(e,i,n,r,s,a){var o=t.call(this,e,i,a)||this;return o.cell=n,o.row=r,o.column=s,o.section=r.section,o}return VS(e,t),e}(lw),uw=function(){function t(t,e){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return t.prototype.getHeadHeight=function(t){return this.head.reduce((function(e,i){return e+i.getMaxCellHeight(t)}),0)},t.prototype.getFootHeight=function(t){return this.foot.reduce((function(e,i){return e+i.getMaxCellHeight(t)}),0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(t,e,i,n,r,s){for(var a=0,o=e;a<o.length;a++){var l=!1===(0,o[a])(new cw(t,this,i,n,r,s));if(i.text=Array.isArray(i.text)?i.text:[i.text],l)return!1}return!0},t.prototype.callEndPageHooks=function(t,e){t.applyStyles(t.userStyles);for(var i=0,n=this.hooks.didDrawPage;i<n.length;i++){(0,n[i])(new lw(t,this,e))}},t.prototype.callWillDrawPageHooks=function(t,e){for(var i=0,n=this.hooks.willDrawPage;i<n.length;i++){(0,n[i])(new lw(t,this,e))}},t.prototype.getWidth=function(t){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce((function(t,e){return t+e.wrappedWidth}),0);var e=this.settings.margin;return t-e.left-e.right},t}(),hw=function(){function t(t,e,i,n,r){void 0===r&&(r=!1),this.height=0,this.raw=t,t instanceof WS&&(this.raw=t._element,this.element=t._element),this.index=e,this.section=i,this.cells=n,this.spansMultiplePages=r}return t.prototype.getMaxCellHeight=function(t){var e=this;return t.reduce((function(t,i){var n;return Math.max(t,(null===(n=e.cells[i.index])||void 0===n?void 0:n.height)||0)}),0)},t.prototype.hasRowSpan=function(t){var e=this;return t.filter((function(t){var i=e.cells[t.index];return!!i&&i.rowSpan>1})).length>0},t.prototype.canEntireRowFit=function(t,e){return this.getMaxCellHeight(e)<=t},t.prototype.getMinimumRowHeight=function(t,e){var i=this;return t.reduce((function(t,n){var r=i.cells[n.index];if(!r)return 0;var s=e.getLineHeight(r.styles.fontSize),a=r.padding("vertical")+s;return a>t?a:t}),0)},t}(),dw=function(){function t(t,e,i){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=i,this.raw=t;var r=t;null==t||"object"!==typeof t||Array.isArray(t)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,r=null!==(n=t.content)&&void 0!==n?n:t,t._element&&(this.raw=t._element));var s=null!=r?""+r:"";this.text=s.split(/\r\n|\r|\n/g)}return t.prototype.getTextPos=function(){var t,e;if("top"===this.styles.valign)t=this.y+this.padding("top");else if("bottom"===this.styles.valign)t=this.y+this.height-this.padding("bottom");else{var i=this.height-this.padding("vertical");t=this.y+i/2+this.padding("top")}if("right"===this.styles.halign)e=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var n=this.width-this.padding("horizontal");e=this.x+n/2+this.padding("left")}else e=this.x+this.padding("left");return{x:e,y:t}},t.prototype.getContentHeight=function(t,e){void 0===e&&(e=1.15);var i=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/t*e)+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(t){var e=QS(this.styles.cellPadding,0);return"vertical"===t?e.top+e.bottom:"horizontal"===t?e.left+e.right:e[t]},t}(),fw=function(){function t(t,e,i){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=e,this.index=i}return t.prototype.getMaxCustomCellWidth=function(t){for(var e=0,i=0,n=t.allRows();i<n.length;i++){var r=n[i].cells[this.index];r&&"number"===typeof r.styles.cellWidth&&(e=Math.max(e,r.styles.cellWidth))}return e},t}();function pw(t,e){!function(t,e){var i=t.scaleFactor(),n=e.settings.horizontalPageBreak,r=JS(t,e);e.allRows().forEach((function(s){for(var a=0,o=e.columns;a<o.length;a++){var l=o[a],c=s.cells[l.index];if(c){var u=e.hooks.didParseCell;e.callCellHooks(t,u,c,s,l,null);var h=c.padding("horizontal");c.contentWidth=KS(c.text,c.styles,t)+h;var d=KS(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,t);if(c.minReadableWidth=d+c.padding("horizontal"),"number"===typeof c.styles.cellWidth)c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if("wrap"===c.styles.cellWidth||!0===n)c.contentWidth>r?(c.minWidth=r,c.wrappedWidth=r):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var f=10/i;c.minWidth=c.styles.minCellWidth||f,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}})),e.allRows().forEach((function(t){for(var i=0,n=e.columns;i<n.length;i++){var r=n[i],s=t.cells[r.index];if(s&&1===s.colSpan)r.wrappedWidth=Math.max(r.wrappedWidth,s.wrappedWidth),r.minWidth=Math.max(r.minWidth,s.minWidth),r.minReadableWidth=Math.max(r.minReadableWidth,s.minReadableWidth);else{var a=e.styles.columnStyles[r.dataKey]||e.styles.columnStyles[r.index]||{},o=a.cellWidth||a.minCellWidth;o&&"number"===typeof o&&(r.minWidth=o,r.wrappedWidth=o)}s&&(s.colSpan>1&&!r.minWidth&&(r.minWidth=s.minWidth),s.colSpan>1&&!r.wrappedWidth&&(r.wrappedWidth=s.minWidth))}}))}(t,e);var i=[],n=0;e.columns.forEach((function(t){var r=t.getMaxCustomCellWidth(e);r?t.width=r:(t.width=t.wrappedWidth,i.push(t)),n+=t.width}));var r=e.getWidth(t.pageSize().width)-n;r&&(r=gw(i,r,(function(t){return Math.max(t.minReadableWidth,t.minWidth)}))),r&&(r=gw(i,r,(function(t){return t.minWidth}))),r=Math.abs(r),!e.settings.horizontalPageBreak&&r>.1/t.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),function(t){for(var e=t.allRows(),i=0;i<e.length;i++)for(var n=e[i],r=null,s=0,a=0,o=0;o<t.columns.length;o++){var l=t.columns[o];if((a-=1)>1&&t.columns[o+1])s+=l.width,delete n.cells[l.index];else if(r){var c=r;delete n.cells[l.index],r=null,c.width=l.width+s}else{if(!(c=n.cells[l.index]))continue;if(a=c.colSpan,s=0,c.colSpan>1){r=c,s+=l.width;continue}c.width=l.width+s}}}(e),function(t,e){for(var i={count:0,height:0},n=0,r=t.allRows();n<r.length;n++){for(var s=r[n],a=0,o=t.columns;a<o.length;a++){var l=o[a],c=s.cells[l.index];if(c){e.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if("linebreak"===c.styles.overflow)c.text=e.splitTextToSize(c.text,u+1/e.scaleFactor(),{fontSize:c.styles.fontSize});else if("ellipsize"===c.styles.overflow)c.text=mw(c.text,u,c.styles,e,"...");else if("hidden"===c.styles.overflow)c.text=mw(c.text,u,c.styles,e,"");else if("function"===typeof c.styles.overflow){var h=c.styles.overflow(c.text,u);c.text="string"===typeof h?[h]:h}c.contentHeight=c.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var d=c.contentHeight/c.rowSpan;c.rowSpan>1&&i.count*i.height<d*c.rowSpan?i={height:d,count:c.rowSpan}:i&&i.count>0&&i.height>d&&(d=i.height),d>s.height&&(s.height=d)}}i.count--}}(e,t),function(t){for(var e={},i=1,n=t.allRows(),r=0;r<n.length;r++)for(var s=n[r],a=0,o=t.columns;a<o.length;a++){var l=o[a],c=e[l.index];if(i>1)i--,delete s.cells[l.index];else if(c)c.cell.height+=s.height,i=c.cell.colSpan,delete s.cells[l.index],c.left--,c.left<=1&&delete e[l.index];else{var u=s.cells[l.index];if(!u)continue;if(u.height=s.height,u.rowSpan>1){var h=n.length-r,d=u.rowSpan>h?h:u.rowSpan;e[l.index]={cell:u,left:d,row:s}}}}}(e)}function gw(t,e,i){for(var n=e,r=t.reduce((function(t,e){return t+e.wrappedWidth}),0),s=0;s<t.length;s++){var a=t[s],o=n*(a.wrappedWidth/r),l=a.width+o,c=i(a),u=l<c?c:l;e-=u-a.width,a.width=u}if(e=Math.round(1e10*e)/1e10){var h=t.filter((function(t){return!(e<0)||t.width>i(t)}));h.length&&(e=gw(h,e,i))}return e}function mw(t,e,i,n,r){return t.map((function(t){return function(t,e,i,n,r){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=KS(t,i,n))return t;for(;e<KS(t+r,i,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+r}(t,e,i,n,r)}))}function vw(t,e){var i=new qS(t),n=function(t,e){var i=t.content,n=function(t){return t.map((function(t,e){var i,n;return n="object"===typeof t&&null!==(i=t.dataKey)&&void 0!==i?i:e,new fw(n,t,e)}))}(i.columns);if(0===i.head.length){(r=bw(n,"head"))&&i.head.push(r)}if(0===i.foot.length){var r;(r=bw(n,"foot"))&&i.foot.push(r)}var s=t.settings.theme,a=t.styles;return{columns:n,head:yw("head",i.head,n,a,s,e),body:yw("body",i.body,n,a,s,e),foot:yw("foot",i.foot,n,a,s,e)}}(e,i.scaleFactor()),r=new uw(e,n);return pw(i,r),i.applyStyles(i.userStyles),r}function yw(t,e,i,n,r,s){var a={};return e.map((function(e,o){for(var l=0,c={},u=0,h=0,d=0,f=i;d<f.length;d++){var p=f[d];if(null==a[p.index]||0===a[p.index].left)if(0===h){var g=void 0,m={};"object"!==typeof(g=Array.isArray(e)?e[p.index-u-l]:e[p.dataKey])||Array.isArray(g)||(m=(null===g||void 0===g?void 0:g.styles)||{});var v=Sw(t,p,o,r,n,s,m),y=new dw(g,v,t);c[p.dataKey]=y,c[p.index]=y,h=y.colSpan-1,a[p.index]={left:y.rowSpan-1,times:h}}else h--,u++;else a[p.index].left--,h=a[p.index].times,l++}return new hw(e,o,t,c)}))}function bw(t,e){var i={};return t.forEach((function(t){if(null!=t.raw){var n=function(t,e){if("head"===t){if("object"===typeof e)return e.header||null;if("string"===typeof e||"number"===typeof e)return e}else if("foot"===t&&"object"===typeof e)return e.footer;return null}(e,t.raw);null!=n&&(i[t.dataKey]=n)}})),Object.keys(i).length>0?i:null}function Sw(t,e,i,n,r,s,a){var o,l={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[n];"head"===t?o=r.headStyles:"body"===t?o=r.bodyStyles:"foot"===t&&(o=r.footStyles);var c=sw({},l.table,l[t],r.styles,o),u=r.columnStyles[e.dataKey]||r.columnStyles[e.index]||{},h="body"===t?u:{},d="body"===t&&i%2===0?sw({},l.alternateRow,r.alternateRowStyles):{},f=function(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(s),p=sw({},f,c,d,h);return sw(p,a)}function ww(t,e,i){var n;void 0===i&&(i={});var r=JS(t,e),s=new Map,a=[],o=[],l=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?l=e.settings.horizontalPageBreakRepeat:"string"!==typeof e.settings.horizontalPageBreakRepeat&&"number"!==typeof e.settings.horizontalPageBreakRepeat||(l=[e.settings.horizontalPageBreakRepeat]),l.forEach((function(t){var i=e.columns.find((function(e){return e.dataKey===t||e.index===t}));i&&!s.has(i.index)&&(s.set(i.index,!0),a.push(i.index),o.push(e.columns[i.index]),r-=i.wrappedWidth)}));for(var c=!0,u=null!==(n=null===i||void 0===i?void 0:i.start)&&void 0!==n?n:0;u<e.columns.length;)if(s.has(u))u++;else{var h=e.columns[u].wrappedWidth;if(!(c||r>=h))break;c=!1,a.push(u),o.push(e.columns[u]),r-=h,u++}return{colIndexes:a,columns:o,lastIndex:u-1}}function xw(t,e){var i=e.settings,n=i.startY,r=i.margin,s={x:r.left,y:n},a=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),o=n+r.bottom+a;"avoid"===i.pageBreak&&(o+=e.body.reduce((function(t,e){return t+e.height}),0));var l=new qS(t);("always"===i.pageBreak||null!=i.startY&&o>l.pageSize().height)&&(Cw(l),s.y=r.top),e.callWillDrawPageHooks(l,s);var c=sw({},s);e.startPageNumber=l.pageNumber(),i.horizontalPageBreak?function(t,e,i,n){var r=function(t,e){for(var i=[],n=0;n<e.columns.length;n++){var r=ww(t,e,{start:n});r.columns.length&&(i.push(r),n=r.lastIndex)}return i}(t,e),s=e.settings;if("afterAllRows"===s.horizontalPageBreakBehaviour)r.forEach((function(r,s){t.applyStyles(t.userStyles),s>0?Iw(t,e,i,n,r.columns,!0):Ew(t,e,n,r.columns),function(t,e,i,n,r){t.applyStyles(t.userStyles),e.body.forEach((function(s,a){var o=a===e.body.length-1;_w(t,e,s,o,i,n,r)}))}(t,e,i,n,r.columns),Tw(t,e,n,r.columns)}));else for(var a=-1,o=r[0],l=function(){var s=a;if(o){t.applyStyles(t.userStyles);var l=o.columns;a>=0?Iw(t,e,i,n,l,!0):Ew(t,e,n,l),s=Lw(t,e,a+1,n,l),Tw(t,e,n,l)}var c=s-a;r.slice(1).forEach((function(r){t.applyStyles(t.userStyles),Iw(t,e,i,n,r.columns,!0),Lw(t,e,a+1,n,r.columns,c),Tw(t,e,n,r.columns)})),a=s};a<e.body.length-1;)l()}(l,e,c,s):(l.applyStyles(l.userStyles),"firstPage"!==i.showHead&&"everyPage"!==i.showHead||e.head.forEach((function(t){return kw(l,e,t,s,e.columns)})),l.applyStyles(l.userStyles),e.body.forEach((function(t,i){var n=i===e.body.length-1;_w(l,e,t,n,c,s,e.columns)})),l.applyStyles(l.userStyles),"lastPage"!==i.showFoot&&"everyPage"!==i.showFoot||e.foot.forEach((function(t){return kw(l,e,t,s,e.columns)}))),YS(l,e,c,s),e.callEndPageHooks(l,s),e.finalY=s.y,t.lastAutoTable=e,l.applyStyles(l.userStyles)}function Ew(t,e,i,n){var r=e.settings;t.applyStyles(t.userStyles),"firstPage"!==r.showHead&&"everyPage"!==r.showHead||e.head.forEach((function(r){return kw(t,e,r,i,n)}))}function Lw(t,e,i,n,r,s){t.applyStyles(t.userStyles),s=null!==s&&void 0!==s?s:e.body.length;var a=Math.min(i+s,e.body.length),o=-1;return e.body.slice(i,a).forEach((function(s,a){var l=i+a===e.body.length-1,c=Rw(t,e,l,n);s.canEntireRowFit(c,r)&&(kw(t,e,s,n,r),o=i+a)})),o}function Tw(t,e,i,n){var r=e.settings;t.applyStyles(t.userStyles),"lastPage"!==r.showFoot&&"everyPage"!==r.showFoot||e.foot.forEach((function(r){return kw(t,e,r,i,n)}))}function Aw(t,e,i){var n=i.getLineHeight(t.styles.fontSize),r=t.padding("vertical"),s=Math.floor((e-r)/n);return Math.max(0,s)}function _w(t,e,i,n,r,s,a){var o=Rw(t,e,n,s);if(i.canEntireRowFit(o,a))kw(t,e,i,s,a);else if(function(t,e,i,n){var r=t.pageSize().height,s=n.settings.margin,a=r-(s.top+s.bottom);"body"===e.section&&(a-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var o=e.getMinimumRowHeight(n.columns,t),l=o<i;if(o>a)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!l)return!1;var c=e.hasRowSpan(n.columns);return e.getMaxCellHeight(n.columns)>a?(c&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!c&&"avoid"!==n.settings.rowPageBreak}(t,i,o,e)){var l=function(t,e,i,n){var r={};t.spansMultiplePages=!0,t.height=0;for(var s=0,a=0,o=i.columns;a<o.length;a++){var l=o[a];if(m=t.cells[l.index]){Array.isArray(m.text)||(m.text=[m.text]),(g=sw(g=new dw(m.raw,m.styles,m.section),m)).text=[];var c=Aw(m,e,n);m.text.length>c&&(g.text=m.text.splice(c,m.text.length));var u=n.scaleFactor(),h=n.getLineHeightFactor();m.contentHeight=m.getContentHeight(u,h),m.contentHeight>=e&&(m.contentHeight=e,g.styles.minCellHeight-=e),m.contentHeight>t.height&&(t.height=m.contentHeight),g.contentHeight=g.getContentHeight(u,h),g.contentHeight>s&&(s=g.contentHeight),r[l.index]=g}}var d=new hw(t.raw,-1,t.section,r,!0);d.height=s;for(var f=0,p=i.columns;f<p.length;f++){var g,m;l=p[f],(g=d.cells[l.index])&&(g.height=d.height),(m=t.cells[l.index])&&(m.height=t.height)}return d}(i,o,e,t);kw(t,e,i,s,a),Iw(t,e,r,s,a),_w(t,e,l,n,r,s,a)}else Iw(t,e,r,s,a),_w(t,e,i,n,r,s,a)}function kw(t,e,i,n,r){n.x=e.settings.margin.left;for(var s=0,a=r;s<a.length;s++){var o=a[s],l=i.cells[o.index];if(l)if(t.applyStyles(l.styles),l.x=n.x,l.y=n.y,!1!==e.callCellHooks(t,e.hooks.willDrawCell,l,i,o,n)){Pw(t,l,n);var c=l.getTextPos();zS(l.text,c.x,c.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,l,i,o,n),n.x+=o.width}else n.x+=o.width;else n.x+=o.width}n.y+=i.height}function Pw(t,e,i){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),"number"===typeof n.lineWidth){var r=XS(n.lineWidth,n.fillColor);r&&t.rect(e.x,i.y,e.width,e.height,r)}else"object"===typeof n.lineWidth&&(n.fillColor&&t.rect(e.x,i.y,e.width,e.height,"F"),function(t,e,i,n){var r,s,a,o;n.top&&(r=i.x,s=i.y,a=i.x+e.width,o=i.y,n.right&&(a+=.5*n.right),n.left&&(r-=.5*n.left),l(n.top,r,s,a,o));n.bottom&&(r=i.x,s=i.y+e.height,a=i.x+e.width,o=i.y+e.height,n.right&&(a+=.5*n.right),n.left&&(r-=.5*n.left),l(n.bottom,r,s,a,o));n.left&&(r=i.x,s=i.y,a=i.x,o=i.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,r,s,a,o));n.right&&(r=i.x+e.width,s=i.y,a=i.x+e.width,o=i.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,r,s,a,o));function l(e,i,n,r,s){t.getDocument().setLineWidth(e),t.getDocument().line(i,n,r,s,"S")}}(t,e,i,n.lineWidth))}function Rw(t,e,i,n){var r=e.settings.margin.bottom,s=e.settings.showFoot;return("everyPage"===s||"lastPage"===s&&i)&&(r+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-r}function Iw(t,e,i,n,r,s){void 0===r&&(r=[]),void 0===s&&(s=!1),t.applyStyles(t.userStyles),"everyPage"!==e.settings.showFoot||s||e.foot.forEach((function(i){return kw(t,e,i,n,r)})),e.callEndPageHooks(t,n);var a=e.settings.margin;YS(t,e,i,n),Cw(t),e.pageNumber++,n.x=a.left,n.y=a.top,i.y=a.top,e.callWillDrawPageHooks(t,n),"everyPage"===e.settings.showHead&&(e.head.forEach((function(i){return kw(t,e,i,n,r)})),t.applyStyles(t.userStyles))}function Cw(t){var e=t.pageNumber();return t.setPage(e+1),t.pageNumber()===e&&(t.addPage(),!0)}try{if("undefined"!==typeof window&&window){var Dw=window,Nw=Dw.jsPDF||(null===(ow=Dw.jspdf)||void 0===ow?void 0:ow.jsPDF);Nw&&function(t){t.API.autoTable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return xw(this,vw(this,aw(this,t[0]))),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(t,e,i,n){zS(t,e,i,n,this)},t.API.autoTableSetDefaults=function(t){return qS.setDefaults(t,this),this},t.autoTableSetDefaults=function(t,e){qS.setDefaults(t,e)},t.API.autoTableHtmlToJson=function(t,e){var i;if(void 0===e&&(e=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=iw(new qS(this),t,window,e,!1),r=n.head,s=n.body,a=(null===(i=r[0])||void 0===i?void 0:i.map((function(t){return t.content})))||[];return{columns:a,rows:s,data:s}}}(Nw)}}catch(Uw){console.error("Could not apply autoTable plugin",Uw)}const Ow=()=>{const{uid:t}=function(){let{matches:t}=s.useContext(J),e=t[t.length-1];return e?e.params:{}}(),[e,i]=(0,s.useState)([]);(0,s.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),n=await ji.get(`/api/nft/history/${t}`,{headers:{Authorization:`Bearer ${e}`}});i(n.data)}catch(ny){console.error("Error al obtener historial:",ny)}})()}),[t]);return(0,zi.jsxs)("div",{className:"chip-history-container",children:[(0,zi.jsxs)("h2",{children:["Historial del Chip: ",t]}),(0,zi.jsx)("button",{className:"pdf-btn",onClick:()=>{const i=new nb;i.text(`Historial del chip: ${t}`,14,16),function(t,e){xw(t,vw(t,aw(t,e)))}(i,{startY:20,head:[["Fecha","Evento","Descripci\xf3n","Rol","Usuario"]],body:e.map((t=>{var e;return[new Date(t.timestamp).toLocaleString(),t.eventType,t.description||"\u2014",t.role,(null===(e=t.createdBy)||void 0===e?void 0:e.username)||"\u2014"]}))}),i.save(`Historial_${t}.pdf`)},children:"Exportar PDF"}),(0,zi.jsx)("ul",{className:"history-list",children:e.map(((t,e)=>(0,zi.jsxs)("li",{children:[(0,zi.jsx)("strong",{children:t.eventType})," \u2014 ",t.description||"Sin descripci\xf3n",(0,zi.jsx)("br",{}),(0,zi.jsxs)("small",{children:[new Date(t.timestamp).toLocaleString()," \u2014 ",(0,zi.jsx)("b",{children:t.role})]})]},e)))})]})},Mw=()=>{const[t,e]=(0,s.useState)(null),[i,n]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const t=t=>{t.preventDefault(),e(t),n(!0)};return window.addEventListener("beforeinstallprompt",t),()=>{window.removeEventListener("beforeinstallprompt",t)}}),[]);return i?(0,zi.jsx)("div",{style:{position:"fixed",bottom:20,right:20},children:(0,zi.jsx)("button",{onClick:()=>{t&&(t.prompt(),t.userChoice.then((()=>{n(!1)})))},className:"capture-button",children:"\ud83d\udcf2 Instalar aplicaci\xf3n"})}):null},Fw=()=>(0,zi.jsxs)(xt,{children:[(0,zi.jsx)(Mw,{}),(0,zi.jsxs)(bt,{children:[(0,zi.jsx)(vt,{path:"/",element:(0,zi.jsx)(Hi,{})}),(0,zi.jsx)(vt,{path:"/login",element:(0,zi.jsx)(Hi,{})}),(0,zi.jsx)(vt,{path:"/register",element:(0,zi.jsx)(qi,{})}),(0,zi.jsx)(vt,{path:"/dashboard",element:(0,zi.jsx)(Av,{})}),(0,zi.jsx)(vt,{path:"/create-worker",element:(0,zi.jsx)(Vi,{})}),(0,zi.jsx)(vt,{path:"/historial/:uid",element:(0,zi.jsx)(Ow,{})})]})]});o.createRoot(document.getElementById("root")).render((0,zi.jsx)(s.StrictMode,{children:(0,zi.jsx)(Fw,{})})),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js").then((t=>{console.log("SW registrado",t)})).catch((t=>{console.error("Error SW:",t)}))}))})();
//# sourceMappingURL=main.e784f912.js.map